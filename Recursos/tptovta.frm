VERSION 5.00
Object = "{648A5603-2C6E-101B-82B6-000000000014}#1.1#0"; "MSCOMM32.OCX"
Object = "{00028C01-0000-0000-0000-000000000046}#1.0#0"; "DBGRID32.OCX"
Object = "{CDE57A40-8B86-11D0-B3C6-00A0C90AEA82}#1.0#0"; "MSDATGRD.OCX"
Object = "{86CF1D34-0C5F-11D2-A9FC-0000F8754DA1}#2.0#0"; "MSCOMCT2.OCX"
Object = "{19BD1EA6-6E36-45BA-AEBD-BCF3093017CC}#11.0#0"; "GorditoButton.ocx"
Object = "{5C6863A4-877B-4EF1-9BD4-A17AD61FBEDB}#1.0#0"; "ChamaleonButton.ocx"
Begin VB.Form tptovta 
   BackColor       =   &H00404040&
   BorderStyle     =   3  'Fixed Dialog
   Caption         =   "VisiOrion"
   ClientHeight    =   49335
   ClientLeft      =   150
   ClientTop       =   540
   ClientWidth     =   19905
   Icon            =   "tptovta.frx":0000
   KeyPreview      =   -1  'True
   LinkTopic       =   "Form1"
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   49335
   ScaleWidth      =   19905
   ShowInTaskbar   =   0   'False
   Begin VB.ComboBox crucefa 
      Height          =   315
      Left            =   15600
      Style           =   2  'Dropdown List
      TabIndex        =   13
      Top             =   600
      Width           =   2880
   End
   Begin VB.PictureBox Picture4 
      BackColor       =   &H00404040&
      Height          =   3855
      Left            =   12360
      ScaleHeight     =   3795
      ScaleWidth      =   2760
      TabIndex        =   263
      TabStop         =   0   'False
      Top             =   5280
      Visible         =   0   'False
      Width           =   2820
      Begin VB.ComboBox CboTipoIgv 
         Height          =   315
         Left            =   1080
         Style           =   2  'Dropdown List
         TabIndex        =   309
         Top             =   3240
         Width           =   1575
      End
      Begin VB.ComboBox CboTipoOperacion 
         Height          =   315
         Left            =   1080
         Style           =   2  'Dropdown List
         TabIndex        =   308
         Top             =   2520
         Width           =   1575
      End
      Begin ChamaleonButton.ChameleonBtn xopciones 
         Height          =   825
         Index           =   31
         Left            =   35
         TabIndex        =   264
         Top             =   825
         Width           =   935
         _ExtentX        =   1640
         _ExtentY        =   1455
         BTYPE           =   4
         TX              =   "Graba    OT"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":058A
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn xopciones 
         Height          =   825
         Index           =   32
         Left            =   965
         TabIndex        =   265
         Top             =   840
         Width           =   930
         _ExtentX        =   1640
         _ExtentY        =   1455
         BTYPE           =   4
         TX              =   "Abono OT"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":05A6
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn xopciones 
         Height          =   825
         Index           =   33
         Left            =   35
         TabIndex        =   266
         Top             =   1635
         Width           =   935
         _ExtentX        =   1640
         _ExtentY        =   1455
         BTYPE           =   4
         TX              =   "Entrega OT"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   0   'False
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":05C2
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn xopciones 
         Height          =   825
         Index           =   34
         Left            =   965
         TabIndex        =   267
         Top             =   15
         Width           =   930
         _ExtentX        =   1640
         _ExtentY        =   1455
         BTYPE           =   4
         TX              =   "Cobro Crédito"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   0   'False
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":05DE
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn xopciones 
         Height          =   825
         Index           =   23
         Left            =   30
         TabIndex        =   285
         Top             =   0
         Width           =   930
         _ExtentX        =   1640
         _ExtentY        =   1455
         BTYPE           =   4
         TX              =   "CORTESIA"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   0   'False
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":05FA
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn xopciones 
         Height          =   810
         Index           =   28
         Left            =   960
         TabIndex        =   295
         Top             =   1620
         Width           =   930
         _ExtentX        =   1640
         _ExtentY        =   1429
         BTYPE           =   4
         TX              =   "Acceso Personal"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   0   'False
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":0616
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn xopciones 
         Height          =   825
         Index           =   3
         Left            =   1920
         TabIndex        =   299
         Top             =   15
         Width           =   810
         _ExtentX        =   1429
         _ExtentY        =   1455
         BTYPE           =   4
         TX              =   "?"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":0632
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn ChaColorFamilia 
         Height          =   825
         Index           =   35
         Left            =   1920
         TabIndex        =   300
         Top             =   840
         Width           =   810
         _ExtentX        =   1429
         _ExtentY        =   1455
         BTYPE           =   4
         TX              =   "Color Familia"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":064E
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn ChaColorProducto 
         Height          =   825
         Index           =   0
         Left            =   1920
         TabIndex        =   301
         Top             =   1620
         Width           =   810
         _ExtentX        =   1429
         _ExtentY        =   1455
         BTYPE           =   4
         TX              =   "Color Producto"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":066A
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin VB.Label Label1 
         BackStyle       =   0  'Transparent
         Caption         =   "Tipo Operación>                           Tipo IGV>"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H8000000B&
         Height          =   1035
         Left            =   120
         TabIndex        =   310
         Top             =   2520
         Width           =   945
      End
   End
   Begin VB.Frame frmClientesRUC 
      BackColor       =   &H00808080&
      Caption         =   "Búsqueda de cliente por RUC"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   4080
      Left            =   5640
      TabIndex        =   244
      Top             =   10440
      Visible         =   0   'False
      Width           =   6735
      Begin VB.CommandButton cmdCorreo 
         Caption         =   "Placa/ Correo"
         Height          =   480
         Left            =   240
         TabIndex        =   302
         Top             =   2350
         Width           =   735
      End
      Begin VB.CommandButton mesa 
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "Arial Black"
            Size            =   12
            Charset         =   0
            Weight          =   900
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   315
         Left            =   1035
         Picture         =   "tptovta.frx":0686
         Style           =   1  'Graphical
         TabIndex        =   262
         ToolTipText     =   "Seleccionar Mesa"
         Top             =   3240
         Width           =   345
      End
      Begin VB.CommandButton salon 
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "Arial Black"
            Size            =   12
            Charset         =   0
            Weight          =   900
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   345
         Left            =   1425
         Picture         =   "tptovta.frx":0CB0
         Style           =   1  'Graphical
         TabIndex        =   261
         ToolTipText     =   "Seleccionar Salòn"
         Top             =   3240
         Width           =   405
      End
      Begin VB.ComboBox clasesunat 
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "Arial Narrow"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   360
         Left            =   5520
         Style           =   2  'Dropdown List
         TabIndex        =   258
         Top             =   720
         Width           =   1080
      End
      Begin VB.TextBox correo 
         BackColor       =   &H00C0C0C0&
         Height          =   450
         Left            =   1020
         MaxLength       =   80
         TabIndex        =   250
         Top             =   2400
         Width           =   5505
      End
      Begin VB.TextBox ydireccion 
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   450
         Left            =   1020
         MaxLength       =   200
         TabIndex        =   249
         Top             =   1890
         Width           =   5505
      End
      Begin VB.TextBox nombre 
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   450
         Left            =   1020
         MaxLength       =   80
         TabIndex        =   248
         Top             =   1350
         Width           =   5505
      End
      Begin VB.TextBox codigo 
         BackColor       =   &H00C0C0C0&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   450
         Left            =   1020
         MaxLength       =   11
         TabIndex        =   247
         Top             =   735
         Width           =   3825
      End
      Begin VB.CommandButton btnCon 
         BackColor       =   &H00E0E0E0&
         Caption         =   "Codigo"
         Height          =   420
         Left            =   240
         Style           =   1  'Graphical
         TabIndex        =   246
         ToolTipText     =   "Busca RUC en Sunat"
         Top             =   795
         Width           =   720
      End
      Begin VB.CommandButton cmdBuscarCodigo 
         Height          =   420
         Left            =   5040
         Picture         =   "tptovta.frx":1322
         Style           =   1  'Graphical
         TabIndex        =   245
         ToolTipText     =   "Buscar cliente"
         Top             =   720
         Width           =   435
      End
      Begin GorditoButton.Boton Boton1 
         Height          =   675
         Left            =   5880
         TabIndex        =   307
         ToolTipText     =   "Cancelar"
         Top             =   3000
         Width           =   705
         _ExtentX        =   1244
         _ExtentY        =   1191
         PicturePosition =   4
         Caption         =   "X"
         BackColor       =   4210752
         ResalteColor    =   12632256
         PictureDown     =   "tptovta.frx":1AD0
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin VB.Image Image11 
         Height          =   1965
         Left            =   240
         Picture         =   "tptovta.frx":295A
         Top             =   720
         Width           =   645
      End
   End
   Begin VB.Frame Frame1 
      BackColor       =   &H00808080&
      Caption         =   "Consultas"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   10455
      Left            =   19800
      TabIndex        =   117
      Top             =   39120
      Visible         =   0   'False
      Width           =   15570
      Begin VB.TextBox buffer 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Left            =   3150
         MaxLength       =   30
         TabIndex        =   119
         TabStop         =   0   'False
         Top             =   240
         Width           =   3840
      End
      Begin VB.ComboBox Combo1 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   360
         Left            =   180
         Style           =   2  'Dropdown List
         TabIndex        =   118
         TabStop         =   0   'False
         Top             =   390
         Width           =   2910
      End
      Begin MSDataGridLib.DataGrid dbgrid6 
         Height          =   9255
         Left            =   480
         TabIndex        =   120
         Top             =   960
         Visible         =   0   'False
         Width           =   12975
         _ExtentX        =   22886
         _ExtentY        =   16325
         _Version        =   393216
         AllowUpdate     =   0   'False
         HeadLines       =   2
         RowHeight       =   19
         BeginProperty HeadFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ColumnCount     =   2
         BeginProperty Column00 
            DataField       =   ""
            Caption         =   ""
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   3082
               SubFormatType   =   0
            EndProperty
         EndProperty
         BeginProperty Column01 
            DataField       =   ""
            Caption         =   ""
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   3082
               SubFormatType   =   0
            EndProperty
         EndProperty
         SplitCount      =   1
         BeginProperty Split0 
            BeginProperty Column00 
            EndProperty
            BeginProperty Column01 
            EndProperty
         EndProperty
      End
      Begin MSDataGridLib.DataGrid dbGrid1 
         Height          =   7935
         Left            =   165
         TabIndex        =   121
         Top             =   960
         Width           =   12975
         _ExtentX        =   22886
         _ExtentY        =   13996
         _Version        =   393216
         AllowUpdate     =   0   'False
         HeadLines       =   2
         RowHeight       =   22
         BeginProperty HeadFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ColumnCount     =   2
         BeginProperty Column00 
            DataField       =   ""
            Caption         =   ""
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   3082
               SubFormatType   =   0
            EndProperty
         EndProperty
         BeginProperty Column01 
            DataField       =   ""
            Caption         =   ""
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   3082
               SubFormatType   =   0
            EndProperty
         EndProperty
         SplitCount      =   1
         BeginProperty Split0 
            BeginProperty Column00 
            EndProperty
            BeginProperty Column01 
            EndProperty
         EndProperty
      End
      Begin ChamaleonButton.ChameleonBtn Label26 
         Height          =   930
         Left            =   13380
         TabIndex        =   289
         Top             =   960
         Width           =   1575
         _ExtentX        =   2778
         _ExtentY        =   1640
         BTYPE           =   5
         TX              =   "Aceptar"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   255
         BCOLO           =   255
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":38FE
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn Label31 
         Height          =   750
         Left            =   13500
         TabIndex        =   290
         Top             =   2160
         Width           =   1305
         _ExtentX        =   2302
         _ExtentY        =   1323
         BTYPE           =   5
         TX              =   "Cerrar"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   8421504
         BCOLO           =   8421504
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":391A
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn Label19 
         Height          =   930
         Left            =   13380
         TabIndex        =   291
         Top             =   3870
         Width           =   1575
         _ExtentX        =   2778
         _ExtentY        =   1640
         BTYPE           =   5
         TX              =   "Entrega"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   8421504
         BCOLO           =   8421504
         FCOL            =   4210752
         FCOLO           =   4210752
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":3936
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn Command1 
         Height          =   495
         Left            =   7440
         TabIndex        =   293
         Top             =   255
         Width           =   2085
         _ExtentX        =   3678
         _ExtentY        =   873
         BTYPE           =   5
         TX              =   "Buscar"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   8421504
         BCOLO           =   8421504
         FCOL            =   4210752
         FCOLO           =   4210752
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":3952
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin VB.Label Label27 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "NOTA: Cuando es Delivery, colocar F2 para que aparezca ENTREGADO, en el campo OK..."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00C0FFFF&
         Height          =   240
         Left            =   330
         TabIndex        =   204
         Top             =   10410
         Width           =   9465
      End
      Begin VB.Label label56 
         BackColor       =   &H00E0E0E0&
         BorderStyle     =   1  'Fixed Single
         Height          =   495
         Left            =   0
         TabIndex        =   122
         Top             =   9480
         Width           =   14505
      End
   End
   Begin VB.Frame Frame7 
      BackColor       =   &H00808080&
      Caption         =   "Ingreso de Tipos de Documentos"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   4995
      Left            =   -6720
      TabIndex        =   78
      Top             =   46440
      Visible         =   0   'False
      Width           =   14295
      Begin VB.CommandButton btnCon2 
         BackColor       =   &H00C0C0C0&
         Caption         =   "Codigo"
         Height          =   495
         Left            =   255
         Style           =   1  'Graphical
         TabIndex        =   205
         ToolTipText     =   "Busca RUC en Sunat"
         Top             =   1230
         Width           =   1950
      End
      Begin VB.TextBox horaentrega 
         Height          =   615
         Left            =   5520
         MaxLength       =   10
         TabIndex        =   92
         Top             =   3120
         Width           =   2055
      End
      Begin VB.TextBox xtipo 
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Left            =   2160
         MaxLength       =   1
         TabIndex        =   91
         Top             =   240
         Width           =   1455
      End
      Begin VB.TextBox xvendedor 
         Height          =   495
         IMEMode         =   3  'DISABLE
         Left            =   2160
         MaxLength       =   11
         TabIndex        =   90
         Top             =   720
         Width           =   2175
      End
      Begin VB.TextBox xruc 
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Left            =   2160
         MaxLength       =   11
         TabIndex        =   89
         Top             =   1200
         Width           =   2175
      End
      Begin VB.TextBox xnombre 
         Height          =   495
         Left            =   2160
         MaxLength       =   60
         TabIndex        =   88
         Top             =   1680
         Width           =   5415
      End
      Begin VB.TextBox xdireccion 
         Height          =   495
         Left            =   2160
         MaxLength       =   200
         TabIndex        =   87
         Top             =   2160
         Width           =   5415
      End
      Begin VB.TextBox xdistrito 
         Height          =   495
         Left            =   2160
         MaxLength       =   60
         TabIndex        =   86
         Top             =   2640
         Width           =   3375
      End
      Begin VB.TextBox xnumero 
         Enabled         =   0   'False
         Height          =   495
         Left            =   2160
         MaxLength       =   11
         TabIndex        =   85
         Top             =   4200
         Width           =   2175
      End
      Begin VB.TextBox xserie 
         Enabled         =   0   'False
         Height          =   495
         Left            =   2160
         MaxLength       =   4
         TabIndex        =   84
         Top             =   3720
         Width           =   1335
      End
      Begin VB.TextBox sentido 
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Left            =   3600
         MaxLength       =   1
         TabIndex        =   83
         Top             =   240
         Visible         =   0   'False
         Width           =   735
      End
      Begin VB.CommandButton Command13 
         BackColor       =   &H00E0E0E0&
         Caption         =   "&Guardar"
         Height          =   975
         Left            =   12480
         Picture         =   "tptovta.frx":396E
         Style           =   1  'Graphical
         TabIndex        =   82
         Top             =   240
         Width           =   1470
      End
      Begin VB.CommandButton Command14 
         Appearance      =   0  'Flat
         BackColor       =   &H00E0E0E0&
         Caption         =   "&Cerrar"
         Height          =   1020
         Left            =   12480
         Picture         =   "tptovta.frx":4238
         Style           =   1  'Graphical
         TabIndex        =   81
         ToolTipText     =   "Imprimir todo"
         Top             =   1320
         Width           =   1470
      End
      Begin VB.TextBox fechae 
         Height          =   615
         Left            =   2160
         MaxLength       =   10
         TabIndex        =   80
         Top             =   3120
         Width           =   2055
      End
      Begin VB.ComboBox dphora 
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   13.5
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   7800
         Style           =   2  'Dropdown List
         TabIndex        =   79
         Top             =   3120
         Width           =   1215
      End
      Begin MSComCtl2.MonthView MonthView1 
         Height          =   2370
         Left            =   9600
         TabIndex        =   93
         Top             =   1680
         Visible         =   0   'False
         Width           =   2595
         _ExtentX        =   4577
         _ExtentY        =   4180
         _Version        =   393216
         ForeColor       =   -2147483630
         BackColor       =   16777152
         Appearance      =   1
         StartOfWeek     =   227082241
         CurrentDate     =   41762
      End
      Begin VB.Label Label25 
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "HoraEntrega HH:MM:SS"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Left            =   4200
         TabIndex        =   105
         Top             =   3120
         Width           =   1335
      End
      Begin VB.Label Label14 
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Fecha Entrega  dd/mm/yyyy"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Left            =   240
         TabIndex        =   104
         Top             =   3120
         Width           =   1935
      End
      Begin VB.Label Label18 
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   $"tptovta.frx":4B02
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1455
         Left            =   225
         TabIndex        =   103
         Top             =   1710
         Width           =   1995
      End
      Begin VB.Label Label36 
         Alignment       =   2  'Center
         BackColor       =   &H00E0E0E0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Codigo"
         Height          =   495
         Left            =   4350
         TabIndex        =   102
         Top             =   1215
         Width           =   1935
      End
      Begin VB.Label Label13 
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Vendedor"
         Height          =   495
         Left            =   240
         TabIndex        =   101
         Top             =   720
         Width           =   1935
      End
      Begin VB.Label nbxtipo 
         BackColor       =   &H00E0E0E0&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   495
         Index           =   2
         Left            =   5760
         TabIndex        =   100
         Top             =   240
         Width           =   735
      End
      Begin VB.Label nbxtipo 
         BackColor       =   &H00E0E0E0&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   495
         Index           =   1
         Left            =   5040
         TabIndex        =   99
         Top             =   240
         Width           =   735
      End
      Begin VB.Label nbxtipo 
         BackColor       =   &H00E0E0E0&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   495
         Index           =   0
         Left            =   4335
         TabIndex        =   98
         Top             =   240
         Width           =   735
      End
      Begin VB.Label Label24 
         BackColor       =   &H00C0FFFF&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Tipo Documento"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Left            =   225
         TabIndex        =   97
         Top             =   255
         Width           =   1935
      End
      Begin VB.Label Label48 
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Serie                                              Numero"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Left            =   240
         TabIndex        =   96
         Top             =   3720
         Width           =   1935
      End
      Begin VB.Label ntipox 
         BackColor       =   &H00E0E0E0&
         BorderStyle     =   1  'Fixed Single
         Height          =   495
         Left            =   6480
         TabIndex        =   95
         Top             =   240
         Width           =   3855
      End
      Begin VB.Label nvendedorx 
         BackColor       =   &H00E0E0E0&
         BorderStyle     =   1  'Fixed Single
         Height          =   495
         Left            =   6480
         TabIndex        =   94
         Top             =   750
         Visible         =   0   'False
         Width           =   3855
      End
   End
   Begin VB.Frame Frame9 
      BackColor       =   &H00808080&
      Caption         =   "--------------------CONGELA PEDIDOS INGRESADOS--------------------"
      BeginProperty Font 
         Name            =   "Arial Black"
         Size            =   9.75
         Charset         =   0
         Weight          =   900
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   3645
      Left            =   5160
      TabIndex        =   28
      Top             =   18840
      Visible         =   0   'False
      Width           =   6780
      Begin VB.TextBox xcongelax 
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   12
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   840
         Left            =   450
         MaxLength       =   25
         TabIndex        =   30
         TabStop         =   0   'False
         Top             =   990
         Width           =   4275
      End
      Begin VB.TextBox clavecongela 
         Height          =   615
         IMEMode         =   3  'DISABLE
         Left            =   500
         MaxLength       =   10
         PasswordChar    =   "*"
         TabIndex        =   29
         TabStop         =   0   'False
         Top             =   2205
         Visible         =   0   'False
         Width           =   4245
      End
      Begin GorditoButton.Boton cmdgrabar 
         Height          =   1035
         Left            =   4980
         TabIndex        =   283
         Top             =   585
         Width           =   1275
         _ExtentX        =   2249
         _ExtentY        =   1826
         PicturePosition =   4
         Caption         =   "Ok"
         BackColor       =   4210752
         ResalteColor    =   49152
         PictureDown     =   "tptovta.frx":4BAE
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton cmdCancelar 
         Height          =   1035
         Left            =   4965
         TabIndex        =   284
         ToolTipText     =   "Cancelar"
         Top             =   1815
         Width           =   1275
         _ExtentX        =   2249
         _ExtentY        =   1826
         PicturePosition =   4
         Caption         =   "X"
         BackColor       =   4210752
         ResalteColor    =   12632256
         PictureDown     =   "tptovta.frx":5A38
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin VB.Label Label50 
         Alignment       =   2  'Center
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Digite un Nombre "
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   450
         TabIndex        =   32
         Top             =   660
         Width           =   4275
      End
      Begin VB.Label Label23 
         Alignment       =   2  'Center
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Clave"
         Height          =   375
         Left            =   495
         TabIndex        =   31
         Top             =   1845
         Visible         =   0   'False
         Width           =   4245
      End
   End
   Begin VB.Frame Frame2 
      BackColor       =   &H00808080&
      Caption         =   "Delivery"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   10560
      Left            =   960
      TabIndex        =   106
      Top             =   34800
      Visible         =   0   'False
      Width           =   15180
      Begin VB.CommandButton cmdBuscar 
         Height          =   465
         Left            =   4470
         Picture         =   "tptovta.frx":68C2
         Style           =   1  'Graphical
         TabIndex        =   203
         ToolTipText     =   "Buscar cliente"
         Top             =   495
         Width           =   675
      End
      Begin VB.ComboBox coclasifica 
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   465
         Left            =   4440
         Style           =   2  'Dropdown List
         TabIndex        =   113
         Top             =   3000
         Width           =   5535
      End
      Begin VB.TextBox referencia 
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   510
         Left            =   2640
         MaxLength       =   120
         TabIndex        =   112
         Top             =   1920
         Width           =   8295
      End
      Begin VB.TextBox ddireccion 
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   510
         Left            =   2640
         MaxLength       =   200
         TabIndex        =   111
         Top             =   1440
         Width           =   8295
      End
      Begin VB.TextBox dnombre 
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   510
         Left            =   2640
         MaxLength       =   60
         TabIndex        =   110
         Top             =   960
         Width           =   8295
      End
      Begin VB.TextBox dcodigo 
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   525
         Left            =   6120
         MaxLength       =   11
         TabIndex        =   109
         Top             =   10560
         Width           =   2055
      End
      Begin VB.TextBox telefono 
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FF0000&
         Height          =   525
         Left            =   2640
         MaxLength       =   11
         TabIndex        =   108
         Top             =   480
         Width           =   1815
      End
      Begin VB.TextBox fechanac 
         BackColor       =   &H00FFFFFF&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   540
         Left            =   2640
         MaxLength       =   10
         TabIndex        =   107
         Top             =   2400
         Width           =   1695
      End
      Begin ChamaleonButton.ChameleonBtn command11 
         Height          =   825
         Left            =   11520
         TabIndex        =   303
         Top             =   1560
         Width           =   1485
         _ExtentX        =   2619
         _ExtentY        =   1455
         BTYPE           =   4
         TX              =   "GRABAR"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   255
         BCOLO           =   255
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":7624
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn command10 
         Height          =   585
         Left            =   11520
         TabIndex        =   304
         Top             =   2400
         Width           =   1485
         _ExtentX        =   2619
         _ExtentY        =   1032
         BTYPE           =   4
         TX              =   "CERRAR"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":7640
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin ChamaleonButton.ChameleonBtn command12 
         Height          =   585
         Left            =   11520
         TabIndex        =   305
         Top             =   960
         Width           =   1485
         _ExtentX        =   2619
         _ExtentY        =   1032
         BTYPE           =   4
         TX              =   "CLEAR"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":765C
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin VB.Image Image7 
         Height          =   2970
         Left            =   270
         Picture         =   "tptovta.frx":7678
         Top             =   495
         Width           =   2340
      End
      Begin VB.Label felizc 
         BackColor       =   &H00808080&
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   13.5
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H000000FF&
         Height          =   495
         Left            =   4440
         TabIndex        =   116
         Top             =   2520
         Width           =   6495
      End
      Begin VB.Label clasificacion 
         BackColor       =   &H00FFFFFF&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Left            =   2640
         TabIndex        =   115
         Top             =   2880
         Width           =   1695
      End
      Begin VB.Label Label9 
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Codigo"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Left            =   4800
         TabIndex        =   114
         Top             =   10560
         Width           =   1215
      End
   End
   Begin VB.Frame Frame6 
      BackColor       =   &H00808080&
      Caption         =   "Entrega"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   5145
      Left            =   9360
      TabIndex        =   55
      Top             =   24960
      Visible         =   0   'False
      Width           =   13590
      Begin VB.Frame Frame3 
         BackColor       =   &H00808080&
         Height          =   4620
         Left            =   4800
         TabIndex        =   77
         Top             =   360
         Width           =   7605
      End
      Begin VB.CommandButton Command3 
         BackColor       =   &H00C0C0C0&
         Caption         =   "Ok"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   15.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1095
         Left            =   2430
         MaskColor       =   &H00FFFFFF&
         Picture         =   "tptovta.frx":9CA9
         Style           =   1  'Graphical
         TabIndex        =   64
         Top             =   3885
         UseMaskColor    =   -1  'True
         Width           =   1455
      End
      Begin VB.CommandButton Command2 
         Appearance      =   0  'Flat
         BackColor       =   &H00C0C0C0&
         Caption         =   "&Cerrar"
         BeginProperty Font 
            Name            =   "Tahoma"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1065
         Left            =   135
         Picture         =   "tptovta.frx":A457
         Style           =   1  'Graphical
         TabIndex        =   63
         ToolTipText     =   "Imprimir todo"
         Top             =   3915
         Width           =   1455
      End
      Begin VB.TextBox RGPAGO 
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   13.5
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Left            =   90
         MaxLength       =   10
         TabIndex        =   62
         Top             =   360
         Width           =   3780
      End
      Begin VB.TextBox tcampo1 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   7515
         MaxLength       =   11
         TabIndex        =   61
         Top             =   700
         Width           =   2385
      End
      Begin VB.TextBox tcampo2 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   7515
         MaxLength       =   60
         TabIndex        =   60
         Top             =   1400
         Width           =   4470
      End
      Begin VB.TextBox tcampo3 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   7515
         MaxLength       =   30
         TabIndex        =   59
         Top             =   2100
         Visible         =   0   'False
         Width           =   2385
      End
      Begin VB.TextBox tcampo4 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   7560
         MaxLength       =   30
         TabIndex        =   58
         Top             =   2760
         Width           =   2385
      End
      Begin VB.TextBox tcampo5 
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   7560
         MaxLength       =   20
         TabIndex        =   57
         Top             =   3480
         Width           =   2385
      End
      Begin VB.TextBox tcampo6 
         Height          =   480
         Left            =   7515
         MaxLength       =   5
         TabIndex        =   56
         Top             =   4320
         Visible         =   0   'False
         Width           =   2385
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   15
         Left            =   90
         TabIndex        =   271
         Top             =   1080
         Width           =   935
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "0"
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   0
         Left            =   1035
         TabIndex        =   272
         Top             =   1065
         Width           =   930
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "1"
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   1
         Left            =   1980
         TabIndex        =   273
         Top             =   1080
         Width           =   935
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "2"
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   2
         Left            =   2925
         TabIndex        =   274
         Top             =   1080
         Width           =   935
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "3"
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   3
         Left            =   90
         TabIndex        =   275
         Top             =   1935
         Width           =   930
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "4"
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   4
         Left            =   1035
         TabIndex        =   276
         Top             =   1935
         Width           =   935
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "5"
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   5
         Left            =   1980
         TabIndex        =   277
         Top             =   1935
         Width           =   935
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "6"
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   6
         Left            =   2925
         TabIndex        =   278
         Top             =   1935
         Width           =   935
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "7"
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   7
         Left            =   105
         TabIndex        =   279
         Top             =   2775
         Width           =   930
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "8"
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   8
         Left            =   1035
         TabIndex        =   280
         Top             =   2775
         Width           =   930
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "9"
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   9
         Left            =   1980
         TabIndex        =   281
         Top             =   2775
         Width           =   935
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "."
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin GorditoButton.Boton znumbert 
         Height          =   825
         Index           =   11
         Left            =   2925
         TabIndex        =   282
         Top             =   2775
         Width           =   930
         _ExtentX        =   1640
         _ExtentY        =   1455
         PicturePosition =   0
         Caption         =   "CR"
         BackColor       =   4210752
         ResalteColor    =   12632256
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin VB.Line Line1 
         BorderColor     =   &H00FFFFFF&
         X1              =   4845
         X2              =   4845
         Y1              =   315
         Y2              =   4935
      End
      Begin VB.Label limite_credito 
         BackColor       =   &H00C0C000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Berlin Sans FB"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   10290
         TabIndex        =   76
         Top             =   1980
         Visible         =   0   'False
         Width           =   1695
      End
      Begin VB.Label descripcio1 
         BackColor       =   &H00C0C000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Berlin Sans FB"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   5800
         TabIndex        =   75
         Top             =   700
         Visible         =   0   'False
         Width           =   1600
      End
      Begin VB.Label descripcio2 
         BackColor       =   &H00C0C000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Berlin Sans FB"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   5805
         TabIndex        =   74
         Top             =   1400
         Visible         =   0   'False
         Width           =   1605
      End
      Begin VB.Label descripcio3 
         BackColor       =   &H00C0C000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Berlin Sans FB"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   5820
         TabIndex        =   73
         Top             =   2100
         Width           =   1605
      End
      Begin VB.Label descripcio4 
         BackColor       =   &H00C0C000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Berlin Sans FB"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   5820
         TabIndex        =   72
         Top             =   3500
         Visible         =   0   'False
         Width           =   1605
      End
      Begin VB.Label descripcio5 
         BackColor       =   &H00C0C000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Berlin Sans FB"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   5820
         TabIndex        =   71
         Top             =   2800
         Visible         =   0   'False
         Width           =   1605
      End
      Begin VB.Label fpago 
         BackColor       =   &H00C0C000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Berlin Sans FB"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   10110
         TabIndex        =   70
         Top             =   495
         Visible         =   0   'False
         Width           =   615
      End
      Begin VB.Label fpmoneda 
         BackColor       =   &H00C0C000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Berlin Sans FB"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   255
         Left            =   10020
         TabIndex        =   69
         Top             =   420
         Visible         =   0   'False
         Width           =   615
      End
      Begin VB.Label saldoabo 
         BackColor       =   &H00C0C000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Berlin Sans FB"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   480
         Left            =   10590
         TabIndex        =   68
         Top             =   690
         Width           =   1350
      End
      Begin VB.Label descripcio6 
         BackColor       =   &H00000000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   495
         Left            =   5940
         TabIndex        =   67
         Top             =   4365
         Visible         =   0   'False
         Width           =   1455
      End
      Begin VB.Label acufp 
         AutoSize        =   -1  'True
         BorderStyle     =   1  'Fixed Single
         Height          =   255
         Left            =   5145
         TabIndex        =   66
         Top             =   3705
         Visible         =   0   'False
         Width           =   105
      End
      Begin VB.Label totpedido 
         BackColor       =   &H00C0C000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Berlin Sans FB"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   510
         Left            =   10305
         TabIndex        =   65
         Top             =   2685
         Visible         =   0   'False
         Width           =   1680
      End
   End
   Begin VB.Frame Frame5 
      BackColor       =   &H00808080&
      Caption         =   "Lista Precios y Saldos "
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   10300
      Left            =   5880
      TabIndex        =   123
      Top             =   16320
      Visible         =   0   'False
      Width           =   9308
      Begin ChamaleonButton.ChameleonBtn ChameleonBtn1 
         Height          =   930
         Left            =   7320
         TabIndex        =   287
         Top             =   480
         Width           =   1380
         _ExtentX        =   2434
         _ExtentY        =   1640
         BTYPE           =   5
         TX              =   "Selecciona"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   255
         BCOLO           =   255
         FCOL            =   4210752
         FCOLO           =   4210752
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":AD21
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin VB.TextBox dvendedor 
         DataField       =   "vendedor"
         DataSource      =   "Data2"
         Height          =   375
         Left            =   3960
         MaxLength       =   11
         TabIndex        =   125
         Top             =   8760
         Width           =   2460
      End
      Begin VB.ComboBox dcvendedor 
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   360
         Left            =   3960
         Style           =   2  'Dropdown List
         TabIndex        =   124
         Top             =   9240
         Width           =   2505
      End
      Begin MSDataGridLib.DataGrid dbgrid7 
         Height          =   1785
         Left            =   240
         TabIndex        =   126
         Top             =   6000
         Width           =   6615
         _ExtentX        =   11668
         _ExtentY        =   3149
         _Version        =   393216
         AllowUpdate     =   0   'False
         Enabled         =   0   'False
         HeadLines       =   2
         RowHeight       =   17
         BeginProperty HeadFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ColumnCount     =   2
         BeginProperty Column00 
            DataField       =   ""
            Caption         =   ""
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   3082
               SubFormatType   =   0
            EndProperty
         EndProperty
         BeginProperty Column01 
            DataField       =   ""
            Caption         =   ""
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   3082
               SubFormatType   =   0
            EndProperty
         EndProperty
         SplitCount      =   1
         BeginProperty Split0 
            BeginProperty Column00 
            EndProperty
            BeginProperty Column01 
            EndProperty
         EndProperty
      End
      Begin ChamaleonButton.ChameleonBtn Command8 
         Height          =   750
         Left            =   7440
         TabIndex        =   288
         Top             =   1920
         Width           =   1305
         _ExtentX        =   2302
         _ExtentY        =   1323
         BTYPE           =   5
         TX              =   "Cerrar"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   11.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   8421504
         BCOLO           =   8421504
         FCOL            =   4210752
         FCOLO           =   4210752
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":AD3D
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin MSDBGrid.DBGrid DBGrid4 
         Height          =   5055
         Left            =   120
         OleObjectBlob   =   "tptovta.frx":AD59
         TabIndex        =   297
         Top             =   360
         Width           =   6615
      End
      Begin VB.Label Label5 
         Alignment       =   2  'Center
         BackColor       =   &H00404040&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Vendedor"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   375
         Left            =   3960
         TabIndex        =   128
         Top             =   8280
         Width           =   2415
      End
      Begin VB.Image foto 
         BorderStyle     =   1  'Fixed Single
         Height          =   2505
         Left            =   240
         Picture         =   "tptovta.frx":BDB8
         Stretch         =   -1  'True
         Top             =   7800
         Width           =   3360
      End
      Begin VB.Label descorto 
         BackColor       =   &H00FFFFFF&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   375
         Left            =   240
         TabIndex        =   127
         Top             =   5640
         Width           =   6615
      End
   End
   Begin VB.Frame Framefp 
      BackColor       =   &H00808080&
      Caption         =   "COBRANZAS"
      BeginProperty Font 
         Name            =   "Verdana"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   10530
      Left            =   -3240
      TabIndex        =   33
      Top             =   44880
      Visible         =   0   'False
      Width           =   15225
      Begin VB.CommandButton COMMAND6 
         Appearance      =   0  'Flat
         Caption         =   "&Cerrar"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   1020
         Left            =   12120
         Picture         =   "tptovta.frx":43049
         Style           =   1  'Graphical
         TabIndex        =   34
         ToolTipText     =   "Imprimir todo"
         Top             =   3600
         Width           =   1215
      End
      Begin MSDBGrid.DBGrid DBGrid9 
         Bindings        =   "tptovta.frx":43913
         Height          =   4695
         Left            =   5040
         OleObjectBlob   =   "tptovta.frx":43927
         TabIndex        =   35
         Top             =   2280
         Width           =   6975
      End
      Begin MSDataGridLib.DataGrid dbgrid10 
         Height          =   6375
         Left            =   120
         TabIndex        =   36
         Top             =   2280
         Width           =   4815
         _ExtentX        =   8493
         _ExtentY        =   11245
         _Version        =   393216
         AllowUpdate     =   0   'False
         HeadLines       =   2
         RowHeight       =   29
         FormatLocked    =   -1  'True
         BeginProperty HeadFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ColumnCount     =   5
         BeginProperty Column00 
            DataField       =   "Descripcio"
            Caption         =   "Descripcio"
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   3082
               SubFormatType   =   0
            EndProperty
         EndProperty
         BeginProperty Column01 
            DataField       =   "Fpago"
            Caption         =   "Fpago"
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   3082
               SubFormatType   =   0
            EndProperty
         EndProperty
         BeginProperty Column02 
            DataField       =   "Moneda"
            Caption         =   "Moneda"
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   10250
               SubFormatType   =   0
            EndProperty
         EndProperty
         BeginProperty Column03 
            DataField       =   "Tipo"
            Caption         =   "Tipo"
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   10250
               SubFormatType   =   0
            EndProperty
         EndProperty
         BeginProperty Column04 
            DataField       =   "Dias"
            Caption         =   "Dias"
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   10250
               SubFormatType   =   0
            EndProperty
         EndProperty
         SplitCount      =   1
         BeginProperty Split0 
            BeginProperty Column00 
               ColumnWidth     =   5325.166
            EndProperty
            BeginProperty Column01 
               ColumnWidth     =   3915.213
            EndProperty
            BeginProperty Column02 
               ColumnWidth     =   705.26
            EndProperty
            BeginProperty Column03 
               ColumnWidth     =   464.882
            EndProperty
            BeginProperty Column04 
               ColumnWidth     =   494.929
            EndProperty
         EndProperty
      End
      Begin VB.Label Label6 
         BackColor       =   &H00E0E0E0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "T/C"
         ForeColor       =   &H00FF0000&
         Height          =   375
         Left            =   5160
         TabIndex        =   54
         Top             =   840
         Width           =   615
      End
      Begin VB.Label paridadfp 
         BackColor       =   &H00FFFFFF&
         BorderStyle     =   1  'Fixed Single
         ForeColor       =   &H00FF0000&
         Height          =   375
         Left            =   5760
         TabIndex        =   53
         Top             =   840
         Width           =   1095
      End
      Begin VB.Label Label41 
         Alignment       =   2  'Center
         BackColor       =   &H00404040&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "COMO PAGA"
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FFFF00&
         Height          =   375
         Left            =   5040
         TabIndex        =   52
         Top             =   1920
         Width           =   6975
      End
      Begin VB.Label Label42 
         Alignment       =   2  'Center
         BackColor       =   &H00404040&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Formas de Pago"
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FFFF00&
         Height          =   375
         Left            =   120
         TabIndex        =   51
         Top             =   1920
         Width           =   4815
      End
      Begin VB.Label Label43 
         Alignment       =   2  'Center
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "TOTAL"
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   21.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   1695
         Left            =   5040
         TabIndex        =   50
         Top             =   240
         Width           =   2055
      End
      Begin VB.Label Label45 
         Alignment       =   2  'Center
         BackColor       =   &H00808080&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "FALTA"
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   21.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   1695
         Left            =   5040
         TabIndex        =   49
         Top             =   6960
         Width           =   2055
      End
      Begin VB.Label Label46 
         Alignment       =   1  'Right Justify
         BackColor       =   &H000000FF&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "   S/."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   855
         Left            =   7200
         TabIndex        =   48
         Top             =   240
         Width           =   495
      End
      Begin VB.Label ttxtotals 
         Alignment       =   1  'Right Justify
         BackColor       =   &H00000000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   36
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   855
         Left            =   7680
         TabIndex        =   47
         Top             =   240
         Width           =   4335
      End
      Begin VB.Label Label47 
         Alignment       =   1  'Right Justify
         BackColor       =   &H0080FF80&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "  US$"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   855
         Left            =   7200
         TabIndex        =   46
         Top             =   1080
         Width           =   495
      End
      Begin VB.Label ttxtotald 
         Alignment       =   1  'Right Justify
         BackColor       =   &H00000000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   36
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FF00&
         Height          =   855
         Left            =   7680
         TabIndex        =   45
         Top             =   1080
         Width           =   4335
      End
      Begin VB.Label Label51 
         Alignment       =   1  'Right Justify
         BackColor       =   &H000000FF&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "   S/."
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0080FFFF&
         Height          =   855
         Left            =   7080
         TabIndex        =   44
         Top             =   6960
         Width           =   495
      End
      Begin VB.Label stxtotals 
         Alignment       =   1  'Right Justify
         BackColor       =   &H00000000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   36
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FFFF&
         Height          =   855
         Left            =   7560
         TabIndex        =   43
         Top             =   6960
         Width           =   4455
      End
      Begin VB.Label Label52 
         Alignment       =   1  'Right Justify
         BackColor       =   &H0080FF80&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "  US$"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   855
         Left            =   7080
         TabIndex        =   42
         Top             =   7800
         Width           =   495
      End
      Begin VB.Label stxtotald 
         Alignment       =   1  'Right Justify
         BackColor       =   &H00000000&
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   36
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H0000FF00&
         Height          =   855
         Left            =   7560
         TabIndex        =   41
         Top             =   7800
         Width           =   4455
      End
      Begin VB.Label Label70 
         Alignment       =   2  'Center
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "              <Acepta>"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Left            =   120
         TabIndex        =   40
         Top             =   1200
         Width           =   1095
      End
      Begin VB.Label Label71 
         Alignment       =   2  'Center
         BorderStyle     =   1  'Fixed Single
         Caption         =   "              Borra"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Left            =   12090
         TabIndex        =   39
         Top             =   2595
         Width           =   1215
      End
      Begin VB.Label Label72 
         Alignment       =   2  'Center
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "             <Baja>"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Left            =   2400
         TabIndex        =   38
         Top             =   1200
         Width           =   1215
      End
      Begin VB.Label Label73 
         Alignment       =   2  'Center
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "                    <Sube>"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Left            =   1200
         TabIndex        =   37
         Top             =   1200
         Width           =   1215
      End
   End
   Begin VB.Frame Frame8 
      BackColor       =   &H00808080&
      Caption         =   "Personal"
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   9135
      Left            =   11040
      TabIndex        =   129
      Top             =   37920
      Visible         =   0   'False
      Width           =   8655
      Begin MSDataGridLib.DataGrid table6 
         Height          =   8415
         Left            =   135
         TabIndex        =   130
         Top             =   360
         Width           =   6615
         _ExtentX        =   11668
         _ExtentY        =   14843
         _Version        =   393216
         AllowUpdate     =   0   'False
         HeadLines       =   3
         RowHeight       =   26
         FormatLocked    =   -1  'True
         BeginProperty HeadFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   14.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ColumnCount     =   2
         BeginProperty Column00 
            DataField       =   "Nombre"
            Caption         =   "Nombre"
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   10250
               SubFormatType   =   0
            EndProperty
         EndProperty
         BeginProperty Column01 
            DataField       =   "Codigo"
            Caption         =   "Codigo"
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   10250
               SubFormatType   =   0
            EndProperty
         EndProperty
         SplitCount      =   1
         BeginProperty Split0 
            MarqueeStyle    =   3
            BeginProperty Column00 
               ColumnWidth     =   4710.047
            EndProperty
            BeginProperty Column01 
            EndProperty
         EndProperty
      End
      Begin VB.Label Label53 
         Alignment       =   2  'Center
         BackColor       =   &H000000FF&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "<SELEC>"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00FFFFFF&
         Height          =   1095
         Left            =   6960
         TabIndex        =   132
         Top             =   1680
         Width           =   1335
      End
      Begin VB.Label Label54 
         Alignment       =   2  'Center
         BorderStyle     =   1  'Fixed Single
         Caption         =   "<CLOSE>"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   975
         Left            =   6960
         TabIndex        =   131
         Top             =   2880
         Width           =   1335
      End
   End
   Begin VB.Timer timerInternet 
      Interval        =   500
      Left            =   30
      Top             =   270
   End
   Begin VB.Frame Frame11 
      BackColor       =   &H00C0C0C0&
      Caption         =   "RUCCLIENTE"
      Height          =   1815
      Left            =   10440
      TabIndex        =   148
      Top             =   12720
      Visible         =   0   'False
      Width           =   3840
      Begin VB.CommandButton Command9 
         Caption         =   "Close"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Left            =   8880
         TabIndex        =   154
         Top             =   360
         Width           =   1215
      End
      Begin VB.CommandButton Command15 
         Caption         =   "Graba"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Left            =   8880
         TabIndex        =   153
         Top             =   1800
         Width           =   1215
      End
      Begin VB.CommandButton Command16 
         Caption         =   "BorraLinea"
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   615
         Left            =   8880
         TabIndex        =   152
         Top             =   1080
         Width           =   1215
      End
      Begin VB.PictureBox PicCaptcha 
         AutoSize        =   -1  'True
         Height          =   810
         Left            =   180
         Picture         =   "tptovta.frx":447FA
         ScaleHeight     =   750
         ScaleWidth      =   1500
         TabIndex        =   151
         TabStop         =   0   'False
         Top             =   420
         Width           =   1560
      End
      Begin VB.TextBox TxtCaptcha 
         Height          =   375
         Left            =   195
         TabIndex        =   150
         Top             =   1245
         Width           =   1560
      End
      Begin VB.ComboBox CboDocumento 
         Height          =   315
         ItemData        =   "tptovta.frx":44DD7
         Left            =   1830
         List            =   "tptovta.frx":44DE1
         Style           =   2  'Dropdown List
         TabIndex        =   149
         Top             =   1275
         Width           =   1215
      End
      Begin VB.Label xpesocobrar 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   7080
         TabIndex        =   158
         Top             =   5760
         Width           =   1695
      End
      Begin VB.Label Label35 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "TotalCobrar"
         Height          =   375
         Left            =   5280
         TabIndex        =   157
         Top             =   5760
         Width           =   1575
      End
      Begin VB.Label xpesoneto 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         BeginProperty Font 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   375
         Left            =   7080
         TabIndex        =   156
         Top             =   5400
         Width           =   1695
      End
      Begin VB.Label Label30 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         BorderStyle     =   1  'Fixed Single
         Caption         =   "TotalPesoNeto"
         Height          =   375
         Left            =   5280
         TabIndex        =   155
         Top             =   5400
         Width           =   1575
      End
   End
   Begin VB.Timer Timer2 
      Interval        =   10
      Left            =   1215
      Top             =   12345
   End
   Begin VB.PictureBox Picture2 
      BackColor       =   &H00404040&
      Height          =   8415
      Left            =   9480
      ScaleHeight     =   8355
      ScaleWidth      =   6720
      TabIndex        =   26
      Top             =   0
      Visible         =   0   'False
      Width           =   6780
      Begin MSDataGridLib.DataGrid table2 
         Height          =   9585
         Left            =   120
         TabIndex        =   27
         Top             =   480
         Width           =   5640
         _ExtentX        =   9948
         _ExtentY        =   16907
         _Version        =   393216
         AllowUpdate     =   0   'False
         BackColor       =   12632256
         HeadLines       =   2
         RowHeight       =   27
         BeginProperty HeadFont {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   9.75
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ColumnCount     =   2
         BeginProperty Column00 
            DataField       =   ""
            Caption         =   ""
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   1
               Format          =   """S/."" #,##0;(""S/."" #,##0)"
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   3082
               SubFormatType   =   0
            EndProperty
         EndProperty
         BeginProperty Column01 
            DataField       =   ""
            Caption         =   ""
            BeginProperty DataFormat {6D835690-900B-11D0-9484-00A0C91110ED} 
               Type            =   0
               Format          =   ""
               HaveTrueFalseNull=   0
               FirstDayOfWeek  =   0
               FirstWeekOfYear =   0
               LCID            =   3082
               SubFormatType   =   0
            EndProperty
         EndProperty
         SplitCount      =   1
         BeginProperty Split0 
            MarqueeStyle    =   4
            BeginProperty Column00 
            EndProperty
            BeginProperty Column01 
            EndProperty
         EndProperty
      End
      Begin ChamaleonButton.ChameleonBtn xopciones 
         Height          =   270
         Index           =   29
         Left            =   4830
         TabIndex        =   206
         Top             =   60
         Width           =   870
         _ExtentX        =   1535
         _ExtentY        =   476
         BTYPE           =   4
         TX              =   ""
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "MS Sans Serif"
            Size            =   8.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   -1  'True
         BCOL            =   4210752
         BCOLO           =   8421504
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":44DEF
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin GorditoButton.Boton BotX 
         Height          =   825
         Left            =   5775
         TabIndex        =   292
         ToolTipText     =   "Cancelar"
         Top             =   5340
         Width           =   840
         _ExtentX        =   1482
         _ExtentY        =   1455
         PicturePosition =   4
         Caption         =   "X"
         BackColor       =   4210752
         ResalteColor    =   12632256
         PictureDown     =   "tptovta.frx":44E0B
         BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Verdana"
            Size            =   18
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   16777215
      End
      Begin ChamaleonButton.ChameleonBtn ChaEstado 
         Height          =   810
         Index           =   35
         Left            =   5760
         TabIndex        =   296
         Top             =   3840
         Width           =   870
         _ExtentX        =   1535
         _ExtentY        =   1429
         BTYPE           =   4
         TX              =   "Estado Mesas"
         ENAB            =   -1  'True
         BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
            Name            =   "Arial"
            Size            =   9
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         COLTYPE         =   2
         FOCUSR          =   0   'False
         BCOL            =   4210752
         BCOLO           =   4210752
         FCOL            =   16777215
         FCOLO           =   16777215
         MCOL            =   12632256
         MPTR            =   1
         MICON           =   "tptovta.frx":45C95
         UMCOL           =   -1  'True
         SOFT            =   0   'False
         PICPOS          =   0
         NGREY           =   0   'False
         FX              =   0
         HAND            =   0   'False
         CHECK           =   0   'False
         VALUE           =   0   'False
      End
      Begin VB.Label Label21 
         Alignment       =   2  'Center
         AutoSize        =   -1  'True
         BackColor       =   &H00FFFFFF&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "Todos"
         Height          =   255
         Left            =   3360
         TabIndex        =   270
         Top             =   60
         Width           =   855
      End
      Begin VB.Label Label15 
         Alignment       =   2  'Center
         BackColor       =   &H00FFFFFF&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "LL"
         Height          =   255
         Left            =   2445
         TabIndex        =   269
         Top             =   60
         Width           =   735
      End
      Begin VB.Label Label60 
         Alignment       =   2  'Center
         BackColor       =   &H00C0C0C0&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "01"
         Height          =   255
         Left            =   90
         TabIndex        =   209
         Top             =   60
         Width           =   735
      End
      Begin VB.Label Label61 
         Alignment       =   2  'Center
         BackColor       =   &H00FFFFFF&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "02"
         Height          =   255
         Left            =   780
         TabIndex        =   208
         Top             =   60
         Width           =   855
      End
      Begin VB.Label Label67 
         Alignment       =   2  'Center
         BackColor       =   &H00FFFFFF&
         BorderStyle     =   1  'Fixed Single
         Caption         =   "DE"
         Height          =   255
         Left            =   1620
         TabIndex        =   207
         Top             =   60
         Width           =   855
      End
      Begin VB.Image Image1 
         BorderStyle     =   1  'Fixed Single
         Height          =   1140
         Left            =   5760
         Picture         =   "tptovta.frx":45CB1
         Stretch         =   -1  'True
         ToolTipText     =   "Fin de lista de las comandas"
         Top             =   1430
         Width           =   800
      End
      Begin VB.Image Image2 
         BorderStyle     =   1  'Fixed Single
         Height          =   1080
         Left            =   5760
         Picture         =   "tptovta.frx":4729F
         Stretch         =   -1  'True
         ToolTipText     =   "Inicio de lista de las comandas"
         Top             =   300
         Width           =   795
      End
      Begin VB.Image Image3 
         BorderStyle     =   1  'Fixed Single
         Height          =   1095
         Left            =   5775
         Picture         =   "tptovta.frx":4888D
         Stretch         =   -1  'True
         ToolTipText     =   "Refresca lista de las comandas"
         Top             =   2610
         Width           =   795
      End
   End
   Begin MSDBGrid.DBGrid DBGrid2 
      Bindings        =   "tptovta.frx":4C97F
      Height          =   4710
      Left            =   0
      OleObjectBlob   =   "tptovta.frx":4C993
      TabIndex        =   0
      Top             =   360
      Width           =   8535
   End
   Begin VB.ListBox List1 
      BackColor       =   &H0000FF00&
      Height          =   255
      Left            =   15600
      TabIndex        =   16
      Top             =   1920
      Visible         =   0   'False
      Width           =   615
   End
   Begin VB.Timer Timer1 
      Interval        =   500
      Left            =   16680
      Top             =   240
   End
   Begin VB.Data Data6 
      Caption         =   "Data6"
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   345
      Left            =   12495
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   ""
      Top             =   11790
      Visible         =   0   'False
      Width           =   1830
   End
   Begin VB.Data Data5 
      Caption         =   "Data5"
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   345
      Left            =   4650
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   ""
      Top             =   10350
      Visible         =   0   'False
      Width           =   1140
   End
   Begin VB.Data Data4 
      Caption         =   "Data4"
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   345
      Left            =   12360
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   ""
      Top             =   12480
      Visible         =   0   'False
      Width           =   1140
   End
   Begin VB.Data Data9 
      Caption         =   "Data4"
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   345
      Left            =   9720
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   ""
      Top             =   11760
      Visible         =   0   'False
      Width           =   1335
   End
   Begin VB.Data Data10 
      Caption         =   "Data4"
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   375
      Left            =   9720
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   ""
      Top             =   11400
      Visible         =   0   'False
      Width           =   1335
   End
   Begin VB.Data Data3 
      Caption         =   "Data3"
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   345
      Left            =   11160
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   ""
      Top             =   11400
      Visible         =   0   'False
      Width           =   1140
   End
   Begin VB.Data Data2 
      Caption         =   "Data2"
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   375
      Left            =   13200
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   ""
      Top             =   8760
      Visible         =   0   'False
      Width           =   1695
   End
   Begin VB.Data Data1 
      Caption         =   "Data1"
      Connect         =   "Access"
      DatabaseName    =   ""
      DefaultCursorType=   0  'DefaultCursor
      DefaultType     =   2  'UseODBC
      Exclusive       =   0   'False
      Height          =   375
      Left            =   4380
      Options         =   0
      ReadOnly        =   0   'False
      RecordsetType   =   1  'Dynaset
      RecordSource    =   ""
      Top             =   11040
      Visible         =   0   'False
      Width           =   1905
   End
   Begin MSCommLib.MSComm MSComm1 
      Left            =   16200
      Top             =   4590
      _ExtentX        =   1005
      _ExtentY        =   1005
      _Version        =   393216
      DTREnable       =   0   'False
      OutBufferSize   =   1024
      RThreshold      =   13
      RTSEnable       =   -1  'True
      SThreshold      =   2
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   0
      Left            =   960
      TabIndex        =   133
      Top             =   9465
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "0"
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   1
      Left            =   960
      TabIndex        =   134
      Top             =   8670
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "1"
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   2
      Left            =   1895
      TabIndex        =   135
      Top             =   8670
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "2"
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   3
      Left            =   2855
      TabIndex        =   136
      Top             =   8670
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "3"
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   4
      Left            =   960
      TabIndex        =   137
      Top             =   7845
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "4"
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   5
      Left            =   1895
      TabIndex        =   138
      Top             =   7845
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "5"
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   6
      Left            =   2855
      TabIndex        =   139
      Top             =   7845
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "6"
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   7
      Left            =   960
      TabIndex        =   140
      Top             =   7035
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "7"
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   8
      Left            =   1895
      TabIndex        =   141
      Top             =   7035
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "8"
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   9
      Left            =   2855
      TabIndex        =   142
      Top             =   7035
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "9"
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   10
      Left            =   2855
      TabIndex        =   143
      Top             =   9465
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "."
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   11
      Left            =   1895
      TabIndex        =   144
      Top             =   6210
      WhatsThisHelpID =   870
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "/"
      BackColor       =   4210752
      ResalteColor    =   12632256
      ButtonStyle     =   3
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial Black"
         Size            =   14.25
         Charset         =   0
         Weight          =   900
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   13
      Left            =   960
      TabIndex        =   145
      Top             =   6210
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "Clear"
      BackColor       =   4210752
      ResalteColor    =   12632256
      ButtonStyle     =   3
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin GorditoButton.Boton cmdCobrar 
      Height          =   795
      Left            =   3810
      TabIndex        =   146
      Top             =   9480
      Width           =   1905
      _ExtentX        =   3360
      _ExtentY        =   1402
      PicturePosition =   0
      Caption         =   "Efectivo"
      BackColor       =   255
      ResalteColor    =   12632256
      ButtonStyle     =   3
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   14.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   0
      Left            =   8565
      TabIndex        =   159
      Top             =   6765
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53AC2
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   1
      Left            =   10260
      TabIndex        =   160
      Top             =   6765
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53ADE
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   2
      Left            =   11955
      TabIndex        =   161
      Top             =   6765
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53AFA
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   3
      Left            =   13650
      TabIndex        =   162
      Top             =   6765
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53B16
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   4
      Left            =   8565
      TabIndex        =   163
      Top             =   7635
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53B32
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   5
      Left            =   10260
      TabIndex        =   164
      Top             =   7635
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53B4E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   6
      Left            =   11955
      TabIndex        =   165
      Top             =   7635
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53B6A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   7
      Left            =   13650
      TabIndex        =   166
      Top             =   7635
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53B86
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   9
      Left            =   10260
      TabIndex        =   168
      Top             =   8505
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53BA2
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   10
      Left            =   11955
      TabIndex        =   169
      Top             =   8505
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53BBE
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   12
      Left            =   8565
      TabIndex        =   171
      Top             =   9375
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53BDA
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   13
      Left            =   10260
      TabIndex        =   172
      Top             =   9375
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53BF6
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   15
      Left            =   13650
      TabIndex        =   174
      Top             =   9375
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53C12
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   8
      Left            =   8565
      TabIndex        =   167
      Top             =   8505
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53C2E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   11
      Left            =   13650
      TabIndex        =   170
      Top             =   8505
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53C4A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zFamilias 
      Height          =   860
      Index           =   14
      Left            =   11955
      TabIndex        =   173
      Top             =   9375
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1508
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   13160660
      BCOLO           =   13160660
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53C66
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   0
      Left            =   8550
      TabIndex        =   175
      Top             =   420
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53C82
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   1
      Left            =   10245
      TabIndex        =   176
      Top             =   420
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53C9E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   2
      Left            =   11940
      TabIndex        =   177
      Top             =   420
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53CBA
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   825
      Index           =   3
      Left            =   13635
      TabIndex        =   178
      Top             =   420
      Width           =   1680
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53CD6
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   6
      Left            =   11940
      TabIndex        =   181
      Top             =   1260
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53CF2
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   7
      Left            =   13635
      TabIndex        =   182
      Top             =   1260
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53D0E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   8
      Left            =   8550
      TabIndex        =   183
      Top             =   2100
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53D2A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   9
      Left            =   10245
      TabIndex        =   184
      Top             =   2100
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53D46
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   12
      Left            =   8550
      TabIndex        =   187
      Top             =   2940
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53D62
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   13
      Left            =   10245
      TabIndex        =   188
      Top             =   2940
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53D7E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   14
      Left            =   11940
      TabIndex        =   189
      Top             =   2940
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53D9A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   825
      Index           =   15
      Left            =   13635
      TabIndex        =   190
      Top             =   2940
      Width           =   1680
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53DB6
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   825
      Index           =   18
      Left            =   11940
      TabIndex        =   193
      Top             =   3780
      Width           =   1680
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53DD2
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   19
      Left            =   13635
      TabIndex        =   194
      Top             =   3780
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53DEE
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   20
      Left            =   8550
      TabIndex        =   195
      Top             =   4620
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53E0A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   21
      Left            =   10245
      TabIndex        =   196
      Top             =   4620
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53E26
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   22
      Left            =   11940
      TabIndex        =   197
      Top             =   4620
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53E42
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   23
      Left            =   13635
      TabIndex        =   198
      Top             =   4620
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53E5E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   24
      Left            =   8550
      TabIndex        =   199
      Top             =   5460
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53E7A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   25
      Left            =   10245
      TabIndex        =   200
      Top             =   5460
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53E96
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   26
      Left            =   11940
      TabIndex        =   201
      Top             =   5460
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53EB2
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   27
      Left            =   13635
      TabIndex        =   202
      Top             =   5460
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53ECE
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   4
      Left            =   8550
      TabIndex        =   179
      Top             =   1260
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53EEA
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   5
      Left            =   10245
      TabIndex        =   180
      Top             =   1260
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53F06
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   10
      Left            =   11940
      TabIndex        =   185
      Top             =   2100
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53F22
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   11
      Left            =   13635
      TabIndex        =   186
      Top             =   2100
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53F3E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   16
      Left            =   8550
      TabIndex        =   191
      Top             =   3780
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53F5A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn zproductos 
      Height          =   830
      Index           =   17
      Left            =   10245
      TabIndex        =   192
      Top             =   3780
      Width           =   1685
      _ExtentX        =   2963
      _ExtentY        =   1455
      BTYPE           =   3
      TX              =   ""
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   12632256
      BCOLO           =   12632256
      FCOL            =   0
      FCOLO           =   0
      MCOL            =   8421504
      MPTR            =   1
      MICON           =   "tptovta.frx":53F76
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   14
      Left            =   1895
      TabIndex        =   210
      Top             =   9465
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "*"
      UseGif          =   -1  'True
      BackColor       =   4210752
      ResalteColor    =   12632256
      PlayGif         =   1
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Verdana"
         Size            =   18
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   6
      Left            =   30
      TabIndex        =   211
      Top             =   6210
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Limpia pedido"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53F92
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   12
      Left            =   4770
      TabIndex        =   212
      Top             =   7035
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Des congela"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53FAE
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   8
      Left            =   30
      TabIndex        =   213
      Top             =   8655
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Copia   Ventas"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53FCA
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   1
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   7
      Left            =   3815
      TabIndex        =   214
      ToolTipText     =   "Cuadre Parcial"
      Top             =   6210
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "  Cierre    X"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":53FE6
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   10
      Left            =   30
      TabIndex        =   215
      Top             =   7020
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Borra   Linea"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":54002
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   13
      Left            =   3815
      TabIndex        =   216
      Top             =   7035
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Congela"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":5401E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   9
      Left            =   30
      TabIndex        =   217
      Top             =   7830
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Anula venta"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":5403A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   20
      Left            =   4770
      TabIndex        =   218
      Top             =   6210
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   " Cierre   Z"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":54056
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   1635
      Index           =   14
      Left            =   7615
      TabIndex        =   219
      Top             =   7020
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   2884
      BTYPE           =   4
      TX              =   "Graba  Comanda"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":54072
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   15
      Left            =   7615
      TabIndex        =   220
      Top             =   6210
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Comen tario"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":5408E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   18
      Left            =   5720
      TabIndex        =   221
      Top             =   7035
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Ingreso"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":540AA
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   11
      Left            =   15
      TabIndex        =   222
      Top             =   9450
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Abre gaveta"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":540C6
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   19
      Left            =   6670
      TabIndex        =   223
      Top             =   7020
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Egreso"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":540E2
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   1
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   2
      Left            =   7615
      TabIndex        =   224
      Top             =   8670
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Cuenta sepa rada"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":540FE
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   840
      Index           =   0
      Left            =   3815
      TabIndex        =   225
      Top             =   7845
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1482
      BTYPE           =   4
      TX              =   "Auto   servicio"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":5411A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   5
      Left            =   6670
      TabIndex        =   226
      Top             =   8685
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "% Desc."
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":54136
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   4
      Left            =   17400
      TabIndex        =   227
      Top             =   3720
      Width           =   900
      _ExtentX        =   1588
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Cobrar Delivery"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":54152
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   25
      Left            =   5720
      TabIndex        =   228
      Top             =   7845
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "VER DELIVERY"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":5416E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   1
      Left            =   4770
      TabIndex        =   229
      Top             =   7845
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Pedido Delivery"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":5418A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   22
      Left            =   3815
      TabIndex        =   230
      Top             =   8685
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Visa"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":541A6
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   24
      Left            =   5720
      TabIndex        =   231
      Top             =   8685
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Credito Cliente"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":541C2
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   1
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   30
      Left            =   15915
      TabIndex        =   232
      Top             =   2460
      Width           =   855
      _ExtentX        =   1508
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Normal"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Copperplate Gothic Light"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   32768
      BCOLO           =   32768
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":541DE
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   27
      Left            =   6670
      TabIndex        =   233
      Top             =   6210
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "+"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "MS Sans Serif"
         Size            =   24
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":541FA
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   16
      Left            =   6670
      TabIndex        =   234
      Top             =   7845
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "VER MESA"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":54216
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   26
      Left            =   5720
      TabIndex        =   235
      Top             =   6210
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Ruc Cliente"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":54232
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   825
      Index           =   17
      Left            =   4770
      TabIndex        =   236
      Top             =   8685
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "Master Card"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":5424E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn image5 
      Height          =   500
      Left            =   13655
      TabIndex        =   237
      Top             =   6280
      Width           =   1710
      _ExtentX        =   3016
      _ExtentY        =   873
      BTYPE           =   4
      TX              =   ">>"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Copperplate Gothic Bold"
         Size            =   12.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   0
      BCOLO           =   0
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":5426A
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn image6 
      Height          =   500
      Left            =   8550
      TabIndex        =   238
      Top             =   6280
      Width           =   1710
      _ExtentX        =   3016
      _ExtentY        =   873
      BTYPE           =   4
      TX              =   "<<"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Copperplate Gothic Bold"
         Size            =   12.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   0
      BCOLO           =   0
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":54286
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn image4 
      Height          =   440
      Left            =   13620
      TabIndex        =   239
      Top             =   0
      Width           =   1740
      _ExtentX        =   3069
      _ExtentY        =   767
      BTYPE           =   4
      TX              =   ">>"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Copperplate Gothic Bold"
         Size            =   12.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   0
      BCOLO           =   0
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":542A2
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn image9 
      Height          =   440
      Left            =   8565
      TabIndex        =   240
      Top             =   0
      Width           =   1710
      _ExtentX        =   3016
      _ExtentY        =   767
      BTYPE           =   4
      TX              =   "<<"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Copperplate Gothic Bold"
         Size            =   12.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   -1  'True
      BCOL            =   0
      BCOLO           =   0
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":542BE
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn cmd50 
      Height          =   825
      Left            =   5720
      TabIndex        =   241
      Top             =   9465
      Width           =   935
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "50"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial Black"
         Size            =   14.25
         Charset         =   0
         Weight          =   900
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":542DA
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn cmd100 
      Height          =   825
      Left            =   6670
      TabIndex        =   242
      Top             =   9465
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "100"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial Black"
         Size            =   14.25
         Charset         =   0
         Weight          =   900
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":542F6
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin ChamaleonButton.ChameleonBtn cmd200 
      Height          =   825
      Left            =   7615
      TabIndex        =   243
      Top             =   9465
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      BTYPE           =   4
      TX              =   "200"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial Black"
         Size            =   14.25
         Charset         =   0
         Weight          =   900
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   4210752
      BCOLO           =   4210752
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":54312
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin GorditoButton.Boton znumber 
      Height          =   825
      Index           =   12
      Left            =   2850
      TabIndex        =   257
      Top             =   6240
      WhatsThisHelpID =   870
      Width           =   930
      _ExtentX        =   1640
      _ExtentY        =   1455
      PicturePosition =   0
      Caption         =   "Código"
      BackColor       =   4210752
      ResalteColor    =   12632256
      ButtonStyle     =   3
      BeginProperty Font {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   16777215
   End
   Begin VB.PictureBox picSubTotal 
      Appearance      =   0  'Flat
      BackColor       =   &H00FFFFC0&
      ForeColor       =   &H80000008&
      Height          =   585
      Left            =   0
      ScaleHeight     =   555
      ScaleWidth      =   9810
      TabIndex        =   251
      TabStop         =   0   'False
      Top             =   5640
      Width           =   9840
      Begin VB.TextBox txtVuelto 
         Alignment       =   1  'Right Justify
         Appearance      =   0  'Flat
         BackColor       =   &H00FFFFC0&
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   285
         Left            =   7280
         TabIndex        =   253
         Text            =   "0.00"
         Top             =   255
         Width           =   1185
      End
      Begin VB.TextBox txtDineroEntregado 
         Alignment       =   1  'Right Justify
         BackColor       =   &H00FFFFC0&
         BorderStyle     =   0  'None
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   285
         Left            =   7310
         TabIndex        =   252
         Text            =   "0.00"
         Top             =   0
         Width           =   1155
      End
      Begin VB.Label hknumero 
         Alignment       =   2  'Center
         Appearance      =   0  'Flat
         AutoSize        =   -1  'True
         BackColor       =   &H00FFFFC0&
         BeginProperty Font 
            Name            =   "Verdana"
            Size            =   14.25
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00004080&
         Height          =   345
         Left            =   630
         TabIndex        =   256
         ToolTipText     =   "Colocar codigo del producto y presionar el botón Prod"
         Top             =   30
         Width           =   120
      End
      Begin VB.Label Label7 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "Efectivo:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   285
         Left            =   6255
         TabIndex        =   255
         Top             =   0
         Width           =   1560
         WordWrap        =   -1  'True
      End
      Begin VB.Label Label11 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "Vuelto:"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000000&
         Height          =   285
         Left            =   6250
         TabIndex        =   254
         Top             =   240
         Width           =   825
         WordWrap        =   -1  'True
      End
   End
   Begin VB.PictureBox Picture3 
      BackColor       =   &H00C0FFFF&
      Height          =   630
      Left            =   1830
      ScaleHeight     =   570
      ScaleWidth      =   915
      TabIndex        =   259
      TabStop         =   0   'False
      Top             =   5085
      Width           =   980
      Begin VB.Label lblItems 
         AutoSize        =   -1  'True
         BackStyle       =   0  'Transparent
         Caption         =   "Items:"
         BeginProperty Font 
            Name            =   "Impact"
            Size            =   9
            Charset         =   0
            Weight          =   400
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         Height          =   240
         Left            =   270
         TabIndex        =   298
         Top             =   90
         Width           =   450
      End
      Begin VB.Label ntcant 
         Alignment       =   1  'Right Justify
         AutoSize        =   -1  'True
         BackColor       =   &H00C0FFFF&
         Caption         =   "0.00"
         BeginProperty Font 
            Name            =   "Arial"
            Size            =   12
            Charset         =   0
            Weight          =   700
            Underline       =   0   'False
            Italic          =   0   'False
            Strikethrough   =   0   'False
         EndProperty
         ForeColor       =   &H00000080&
         Height          =   480
         Left            =   -55
         TabIndex        =   260
         Top             =   300
         Width           =   975
      End
   End
   Begin ChamaleonButton.ChameleonBtn xopciones 
      Height          =   675
      Index           =   21
      Left            =   16200
      TabIndex        =   294
      Top             =   3600
      Width           =   885
      _ExtentX        =   1561
      _ExtentY        =   1191
      BTYPE           =   4
      TX              =   "EFECTIVO"
      ENAB            =   -1  'True
      BeginProperty FONT {0BE35203-8F91-11CE-9DE3-00AA004BB851} 
         Name            =   "Copperplate Gothic Light"
         Size            =   9
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      COLTYPE         =   2
      FOCUSR          =   0   'False
      BCOL            =   32768
      BCOLO           =   32768
      FCOL            =   16777215
      FCOLO           =   16777215
      MCOL            =   12632256
      MPTR            =   1
      MICON           =   "tptovta.frx":5432E
      UMCOL           =   -1  'True
      SOFT            =   0   'False
      PICPOS          =   0
      NGREY           =   0   'False
      FX              =   0
      HAND            =   0   'False
      CHECK           =   0   'False
      VALUE           =   0   'False
   End
   Begin VB.Label cajero 
      Alignment       =   2  'Center
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   420
      Left            =   -15
      TabIndex        =   3
      Top             =   0
      Width           =   1380
   End
   Begin VB.Label vendedor 
      Alignment       =   2  'Center
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "VEND."
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   11.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   420
      Left            =   7625
      TabIndex        =   306
      Top             =   0
      Width           =   980
   End
   Begin VB.Label Label29 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      AutoSize        =   -1  'True
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "PRODUCTOS"
      BeginProperty Font 
         Name            =   "Baskerville Old Face"
         Size            =   18
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   435
      Left            =   10250
      TabIndex        =   286
      Top             =   -15
      Width           =   3375
   End
   Begin VB.Label Label22 
      AutoSize        =   -1  'True
      BackStyle       =   0  'Transparent
      Caption         =   "Label22"
      Height          =   330
      Left            =   17760
      TabIndex        =   268
      Top             =   3120
      Width           =   585
   End
   Begin VB.Label campo3 
      AutoSize        =   -1  'True
      BackColor       =   &H00000000&
      BackStyle       =   0  'Transparent
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial Narrow"
         Size            =   12
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   210
      Left            =   495
      TabIndex        =   147
      Top             =   3765
      Visible         =   0   'False
      Width           =   735
   End
   Begin VB.Label stkminimo 
      Alignment       =   2  'Center
      BackColor       =   &H00C0FFFF&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   11.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H000000FF&
      Height          =   600
      Left            =   15
      TabIndex        =   25
      Top             =   5085
      Width           =   1815
      WordWrap        =   -1  'True
   End
   Begin VB.Label Label12 
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   12
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   495
      Left            =   17400
      TabIndex        =   24
      Top             =   2400
      Visible         =   0   'False
      Width           =   1575
   End
   Begin VB.Label Label10 
      Alignment       =   2  'Center
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "Hoy:"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   420
      Left            =   4260
      TabIndex        =   23
      Top             =   0
      Width           =   480
   End
   Begin VB.Label Label8 
      Alignment       =   2  'Center
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "DiaVenta"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   420
      Left            =   2145
      TabIndex        =   22
      Top             =   0
      Width           =   1035
   End
   Begin VB.Label diasistema 
      Alignment       =   2  'Center
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   420
      Left            =   3165
      TabIndex        =   21
      Top             =   0
      Width           =   1095
   End
   Begin VB.Label txpercepcion 
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   1  'Fixed Single
      Height          =   495
      Left            =   15765
      TabIndex        =   20
      Top             =   1140
      Visible         =   0   'False
      Width           =   735
   End
   Begin VB.Label serviciocobro 
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   1  'Fixed Single
      Height          =   255
      Left            =   15840
      TabIndex        =   19
      Top             =   5295
      Width           =   1095
   End
   Begin VB.Label mesero 
      BackColor       =   &H00FFFFFF&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   420
      Left            =   16680
      TabIndex        =   18
      Top             =   840
      Width           =   1080
   End
   Begin VB.Label comanda 
      AutoSize        =   -1  'True
      BackColor       =   &H0080FF80&
      Height          =   195
      Left            =   16680
      TabIndex        =   17
      Top             =   1680
      Visible         =   0   'False
      Width           =   285
   End
   Begin VB.Label Label2 
      Alignment       =   2  'Center
      Appearance      =   0  'Flat
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      Caption         =   "FAMILIA"
      BeginProperty Font 
         Name            =   "Baskerville Old Face"
         Size            =   18
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   510
      Left            =   10230
      TabIndex        =   15
      Top             =   6240
      Width           =   3425
   End
   Begin VB.Label tiposervicio1 
      BackColor       =   &H000000FF&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   7200
      TabIndex        =   14
      Top             =   12120
      Visible         =   0   'False
      Width           =   855
   End
   Begin VB.Label rtxtotald 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00C0FFFF&
      Caption         =   "0.00"
      BeginProperty Font 
         Name            =   "Impact"
         Size            =   21.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   615
      Left            =   3450
      TabIndex        =   12
      Top             =   5085
      Width           =   2100
   End
   Begin VB.Label Label34 
      Alignment       =   2  'Center
      BackColor       =   &H00C0FFFF&
      Caption         =   "     S/"
      BeginProperty Font 
         Name            =   "Verdana"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   690
      Left            =   5535
      TabIndex        =   11
      Top             =   5055
      Width           =   630
   End
   Begin VB.Label Label33 
      Alignment       =   2  'Center
      BackColor       =   &H00C0FFFF&
      Caption         =   "      US$:"
      BeginProperty Font 
         Name            =   "Verdana"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   660
      Left            =   2820
      TabIndex        =   10
      Top             =   5040
      Width           =   825
   End
   Begin VB.Label CAMPO2 
      BackColor       =   &H00E0E0E0&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "MS Sans Serif"
         Size            =   9.75
         Charset         =   0
         Weight          =   400
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   255
      Left            =   3120
      TabIndex        =   9
      Top             =   12120
      Visible         =   0   'False
      Width           =   1455
   End
   Begin VB.Label moneda 
      Alignment       =   2  'Center
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   420
      Left            =   6720
      TabIndex        =   8
      Top             =   0
      Width           =   315
   End
   Begin VB.Label paridad 
      Alignment       =   2  'Center
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   11.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   420
      Left            =   6960
      TabIndex        =   7
      Top             =   0
      Width           =   660
   End
   Begin VB.Label fechasis 
      Alignment       =   2  'Center
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   9.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   420
      Left            =   4680
      TabIndex        =   6
      Top             =   0
      Width           =   1095
   End
   Begin VB.Label horasis 
      Alignment       =   2  'Center
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   11.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   420
      Left            =   5760
      TabIndex        =   5
      Top             =   0
      Width           =   975
   End
   Begin VB.Label turno 
      Alignment       =   2  'Center
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   420
      Left            =   1755
      TabIndex        =   4
      Top             =   0
      Width           =   405
   End
   Begin VB.Label caja 
      Alignment       =   2  'Center
      BackColor       =   &H00808080&
      BorderStyle     =   1  'Fixed Single
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   12
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   420
      Left            =   1365
      TabIndex        =   2
      Top             =   0
      Width           =   375
   End
   Begin VB.Label rtxtotal 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00C0FFFF&
      Caption         =   "0.00"
      BeginProperty Font 
         Name            =   "Impact"
         Size            =   21.75
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00000000&
      Height          =   600
      Left            =   6090
      TabIndex        =   1
      Top             =   5085
      Width           =   2445
   End
   Begin VB.Menu menju232 
      Caption         =   "&Menu"
      Begin VB.Menu dli892 
         Caption         =   "&0.LimpiaPantalla"
         Shortcut        =   ^E
      End
      Begin VB.Menu dju523a 
         Caption         =   "&1.Facturacion Mensual"
      End
      Begin VB.Menu dcrt6622 
         Caption         =   "&2.Carga Venta Anterior en Pedido Actual"
         Shortcut        =   ^{F4}
      End
      Begin VB.Menu dcrt6623 
         Caption         =   "&3.Carga Venta Anterior de Otra Fecha"
      End
      Begin VB.Menu juhyua 
         Caption         =   "&4.GuiaEntrada"
      End
      Begin VB.Menu lio82 
         Caption         =   "&5.GuiaSalida"
      End
      Begin VB.Menu dhyori83 
         Caption         =   "&9.Cargar Proformas terminales"
         Shortcut        =   {F6}
      End
      Begin VB.Menu fsdfsdf 
         Caption         =   "&A.Menu Pedido"
      End
      Begin VB.Menu dj78232 
         Caption         =   "&B.CargaPedidos"
      End
      Begin VB.Menu kumabo9 
         Caption         =   "&C.Menu Cotización"
      End
      Begin VB.Menu dk8923 
         Caption         =   "&D.Cargar Cotizaciones "
      End
      Begin VB.Menu djk78232 
         Caption         =   "&E.Modificar Pedido Reposicion"
         Enabled         =   0   'False
         Visible         =   0   'False
      End
      Begin VB.Menu d892323 
         Caption         =   "&F.Cuadre Rapido"
         Shortcut        =   ^I
      End
      Begin VB.Menu NotaCredito 
         Caption         =   "&G.NotaCredito"
      End
      Begin VB.Menu fdk9235 
         Caption         =   "&G.Anulacion Otra Fecha"
      End
      Begin VB.Menu dfk992325 
         Caption         =   "&H.Copia Otra Fecha"
      End
   End
   Begin VB.Menu cuj6721 
      Caption         =   "&Cuadres"
      Begin VB.Menu dcupar1 
         Caption         =   "&1.Parcial - Totales de Venta"
         Shortcut        =   ^T
      End
      Begin VB.Menu hundv1 
         Caption         =   "&2.Parcial - Unidades Vendidas"
         Shortcut        =   ^Q
      End
      Begin VB.Menu pado8911 
         Caption         =   "&3.Parcial - Documentos Emitidos "
      End
      Begin VB.Menu d8do82 
         Caption         =   "&4.Parcial - Productos Vs Documentos"
      End
      Begin VB.Menu forma671 
         Caption         =   "&5.Parcial - Formas de Pago"
      End
      Begin VB.Menu eju78se 
         Caption         =   "&6.Ingreso/Egreso/Seccion"
      End
      Begin VB.Menu gt666 
         Caption         =   "&7.Envio  Local-->Central"
      End
   End
   Begin VB.Menu fk88332 
      Caption         =   "&Reportes"
   End
   Begin VB.Menu losao94 
      Caption         =   "&Salir"
   End
End
Attribute VB_Name = "tptovta"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit
'CUANDO ES A CUENTA SE GENERA UN PEDIDO
'EL TIPO DOCUMENTO PEDIDO DEBE ESTAR EN TIPO DOCUMENTO
'Y GRABAR EN EL PEDIDO CUANDO QUEDA SALDO Y CUANTO FUE DADO A CUENTA

'Combos Combinaciones 07/07/2018
Dim combinac        As String

'Combos Combinaciones 07/07/2018

'24/08/2018  Delivery por mesa
Dim ijkl            As Integer

'24/08/2018  Delivery por mesa

Dim local1          As String

Dim xrepite         As String

Dim mytablepeso     As New ADODB.Recordset

Dim octipo          As String

Dim ocserie         As String

Dim ocnumero        As String

Dim ot              As String

Dim flagsubfamilia  As String

Dim grtipo          As String

Dim grserie         As String

Dim grnumero        As String

Dim axclocal        As String

Dim axctipo         As String

Dim axcserie        As String

Dim axcnumero       As String

Dim axctotal        As String

Dim acuenta         As String

Dim cuenta_separa   As String

Dim mytablefpago    As New ADODB.Recordset

Dim InBuff          As String

'subfamilia
Dim msfamcod(15000) As String

Dim wsfamcod(15000) As String

Dim wwsfamcod(30)   As String

Dim PUERTOD2        As String

Dim msfampag        As Integer

Dim msfamtop        As Integer

'LEONARDO - variable para el precio de descuento por cliente, en la tabla precio1
Dim xprecioDsctox, xprecioDsctox2, xprecioDsctox3, xprecioDsctox4, xprecioDsctox5, xprecioDsctox6, xprecioDsctox7, xprecioDsctox8, xprecioDsctox9, xprecioDsctox10 As Double

Dim xfactorDsctox, xfactorDsctox2, xfactorDsctox3, xfactorDsctox4, xfactorDsctox5, xfactorDsctox6, xfactorDsctox7, xfactorDsctox8, xfactorDsctox9, xfactorDsctox10 As Double

Dim xunidadDsctox, xunidadDsctox2, xunidadDsctox3, xunidadDsctox4, xunidadDsctox5, xunidadDsctox6, xunidadDsctox7, xunidadDsctox8, xunidadDsctox9, xunidadDsctox10 As String

Dim mfamcod(15000)  As String

Dim wfamcod(15000)  As String

Dim wwfamcod(30)    As String

Dim mfampag         As Integer

Dim mfamtop         As Integer

Dim destopo         As Double

Dim mcobcod(30)     As String

Dim wcobcod(30)     As String

Dim wwcobcod(31)    As String

Dim mcobpag         As Integer

Dim mcobtop         As Integer

Dim trdescuento     As String

Dim mprodcod(15000) As String

Dim wprodcod(15000) As String

Dim wwprodcod(31)   As String

Dim mprodpag        As Integer

Dim mprodtop        As Integer

Dim acu             As String

Dim cmytablex       As New ADODB.Recordset   'comandas maneja

Dim rcconsulta      As New ADODB.Recordset

Dim saldo           As String

Dim pedido          As String

Dim tdetra          As String

Dim tpeaje          As String

Dim ndetraccion     As String

Dim xxacu           As String

Dim swprecio        As Integer

Dim bk2             As Variant

Dim xproducto       As String

Dim exisdev         As Integer

Private Type campo_precio

    unidad As String
    factor As String
    precio As String
    costo As String
    margen As String
    stock As String
    svirtual As String

End Type

'------- globales de proformas
'Dim trdescuento As Double 'descuento global automatico
Dim nrodecimal        As String

Dim tivap             As Double

Dim tisc              As Double

Dim txtotald          As String

Dim txtotal           As String

Dim cprotipo          As String

Dim cproven           As String

Dim cprocod           As String

'Dim InBuff As String
Dim xptipo            As String

Dim xpserie           As String

Dim xpnumero          As String

Dim campo_precios(50) As campo_precio

Dim nrolineas         As Integer

Dim tiposervicio      As String

Dim flag_servicio     As String

Dim flag_carga        As String

Dim c1                As String

Dim c2                As String

Dim c3                As String

Dim c4                As String

Dim c5                As String

Dim c6                As String

Dim c7                As String

Dim c8                As String

Dim c9                As String

Dim gravado           As String

Dim control_flujo     As Integer

Dim protipo           As String

Dim proserie          As String

Dim pronumero         As String

Dim tximpuesto        As String

Dim xestado           As String

Dim txdescuento       As String

Dim txneto            As String

Dim txsubtotal        As String

Dim petipo            As String

Dim peserie           As String

Dim penumero          As String

Dim flage             As String

'16/06/2017 kenyo NOTA DE CREDITO
Dim nctipo            As String

Dim ncserie           As String

Dim ncnumero          As String

'16/06/2017 kenyo NOTA DE CREDITO

Dim personasx         As String

Dim dbvarios          As New ADODB.Recordset

'LEONARDO: HACER SONAR UN BOTON CHAMALEON

Private Declare Function mciExecute Lib "winmm.dll" (ByVal lpstrCommand As String) As Long

Dim iResultadoSound As Variant

'----LEONARDO: CODIGO Y VARIABLES PARA BUSUEDA DE CLIENTE POR RUC ----
Private Declare Function GetPixel _
                Lib "gdi32" (ByVal hDC As Long, _
                             ByVal X As Long, _
                             ByVal Y As Long) As Long

Private Declare Function SetPixelV _
                Lib "gdi32" (ByVal hDC As Long, _
                             ByVal X As Long, _
                             ByVal Y As Long, _
                             ByVal crColor As Long) As Long

Dim Rred

Dim Ggreen

Dim Bblue

Dim Pixel

Dim xDat     As String

Dim xRazSoc  As String, xEst As String, xCon As String, xdir As String

Dim xRazSocX As Long, xEstX As Long, xConX As Long, xDirX As Long

Dim xRazSocY As Long, xEstY As Long, xConY As Long, xDirY As Long

'------LEONARDO: SEGUNDA PARTE PARA CONSULTAR PRIMERO SI HAY INTERNET O NO
'Option Explicit
'Funcion Api que obtiene información sobre el estado de Red
Private Declare Function InternetGetConnectedState _
                Lib "wininet.dll" (ByRef lpdwFlags As Long, _
                                   ByVal dwReserved As Long) As Long
  
Private Const INTERNET_CONNECTION_MODEM_BUSY As Long = &H8

Private Const INTERNET_CONNECTION_OFFLINE    As Long = &H20

Private Const INTERNET_CONNECTION_CONFIGURED As Long = &H40

Private dwFlags                              As Long

Dim vHabitacion                              As String

Dim vInternet                                As Integer

'Constantes para SendMessage enviar click a otra ventana
Private Declare Function SendMessage _
                Lib "user32" _
                Alias "SendMessageA" (ByVal hwnd As Long, _
                                      ByVal wMsg As Long, _
                                      ByVal wParam As Long, _
                                      lParam As Any) As Long

Private Const BM_SETSTATE = &HF3

Private Const WM_LBUTTONDOWN = &H201 ' botón izquierdo abajo

Private Const WM_LBUTTONUP = &H202 ' izquierdo arriba

Private Const WM_LBUTTONDBLCLK As Long = &H203 ' izquierdo doble click

'Color por familia y producto  30/05/2018
Dim flagcolorfamprod           As String

'Color por familia y producto  30/05/2018
    
Sub Enviar_Pulsacion(handle As Long)
    ' enviar pulsación de mouse al Hwnd indicado
    Call SendMessage(handle, BM_SETSTATE, 0, ByVal 0&)
    Call SendMessage(handle, WM_LBUTTONDOWN, 0, ByVal 0&)
    Call SendMessage(handle, WM_LBUTTONUP, 0, ByVal 0&)
    Call SendMessage(handle, BM_SETSTATE, 1, ByVal 0&)

End Sub

' Función Booleana para saber si se está conectado a internet
'Private Function Online() As Boolean
Public Function Online() As Boolean
    Online = InternetGetConnectedState(0&, 0&)

End Function

Private Sub Boton1_Click()
    Me.frmClientesRUC.Visible = False

End Sub

Private Sub BotX_Click()

    '24/08/2018  Delivery por mesa
    nombre = ""
    codigo = ""
    '24/08/2018  Delivery por mesa
        
    Picture2.Visible = False

    '''21/09/2017 kenyo Mejora  cobranza de mesas
    If frmClientesRUC.Visible = True Then
        frmClientesRUC.Visible = False

    End If

    ''''21/09/2017 kenyo Mejora  cobranza de mesas
    
End Sub

Private Sub ChaColorFamilia_Click(Index As Integer)
    'valida_camara
    trgb.tipo = "FAMILIA"
    trgb.Show 1
    inicia_color_familia
    Picture4.Visible = False

End Sub

Private Sub ChaColorProducto_Click(Index As Integer)
    trgb.tipo = "PRODUCTO"
    trgb.Show 1
    inicia_color_producto
    Picture4.Visible = False

End Sub

Private Sub ChaEstado_Click(Index As Integer)
    tmesasta.Show 1
    consulta_comanda "" & mytable11.Fields("salon")

End Sub

Private Sub ChameleonBtn1_Click()
    DBGrid4_KeyDown 13, 0

End Sub

Private Sub cmd100_Click()
    hknumero.Caption = "100"

End Sub

Private Sub cmd200_Click()
    hknumero.Caption = "200"

End Sub

Private Sub cmd50_Click()
    hknumero.Caption = "50"

    ''graba_guia_mensual
End Sub

Private Sub cmdBuscar_Click()

    Dim found As Integer

    found = consulta_cliente("")

End Sub

Private Sub cmdBuscarCodigo_Click()
    'Dim found As Integer
    'found = consulta_cliente2("")
    consulta_cliente1
    frmClientesRUC.Visible = False

End Sub

Function consulta_cliente(buf As String)

    Dim found As Integer

    Dim buf1  As String

    buf1 = ""

    If Len(buf) > 0 Then
        buf1 = " where telefono='" & buf & "'"

    End If

    Combo1.Clear
    Combo1.AddItem "deliveri.telefono"
    Combo1.AddItem "Clientes.Nombre"
    Combo1.AddItem "deliveri.Direccion"
    Combo1.ListIndex = 0
    Frame1.Visible = True: Frame1.Enabled = True
    buffer = ""

    If Len(buf) > 0 Then
        buffer = buf

    End If

    opcion1 = "1"
    sw_consulta = 0
    found = sql_consulta(1)
    consulta_cliente = 0

End Function

Function consulta_cliente2(buf As String)

    Dim found As Integer

    Dim buf1  As String

    buf1 = ""
    'If Len(buf) > 0 Then
    '   buf1 = " where telefono='" & buf & "'"
    'End If
    Combo1.Clear
    Combo1.AddItem "Clientes.CODIGO"
    Combo1.AddItem "Clientes.Nombre"
    Combo1.AddItem "CLIENTES.Direccion"
    Combo1.ListIndex = 0
    Frame1.Visible = True: Frame1.Enabled = True
    buffer = ""

    If Len(buf) > 0 Then
        buffer = buf

    End If

    opcion1 = "2"
    sw_consulta = 0
    found = sql_consulta(2)
    consulta_cliente2 = 0

End Function

Function sql_consulta(sw As Integer)

    Dim buf       As String

    Dim queprecio As String

    Dim indx      As Integer

    Dim dbf1      As String

    Dim dbf2      As String

    Dim amfecha   As String

    On Error GoTo cmd8912_err

    'MsgBox buffer
    amfecha = Format(dia, "YYYYMMDD")
    indx = -1
    dbf1 = ""
    dbf2 = ""
    Label19.Visible = False
    Label22.Visible = False

    If Trim("" & mytable11.Fields("t0")) = "S" Then
        If Len("" & mytable11.Fields("t1")) > 0 Then
            dbf1 = "  (caja='" & "" & mytable11.Fields("t1") & "'"

            If Len("" & mytable11.Fields("t2")) > 0 Then
                dbf1 = dbf1 & " or caja='" & "" & mytable11.Fields("t2") & "'"

            End If

            If Len("" & mytable11.Fields("t3")) > 0 Then
                dbf1 = dbf1 & " or caja='" & "" & mytable11.Fields("t3") & "'"

            End If

            If Len("" & mytable11.Fields("t4")) > 0 Then
                dbf1 = dbf1 & " or caja='" & "" & mytable11.Fields("t4") & "'"

            End If

            If Len("" & mytable11.Fields("t5")) > 0 Then
                dbf1 = dbf1 & " or caja='" & "" & mytable11.Fields("t5") & "'"

            End If

            If Len("" & mytable11.Fields("t6")) > 0 Then
                dbf1 = dbf1 & " or caja='" & "" & mytable11.Fields("t6") & "'"

            End If

            If Len("" & mytable11.Fields("t7")) > 0 Then
                dbf1 = dbf1 & " or caja='" & "" & mytable11.Fields("t7") & "'"

            End If

            If Len("" & mytable11.Fields("t8")) > 0 Then
                dbf1 = dbf1 & " or caja='" & "" & mytable11.Fields("t8") & "'"

            End If

            If Len("" & mytable11.Fields("t9")) > 0 Then
                dbf1 = dbf1 & " or caja='" & "" & mytable11.Fields("t9") & "'"

            End If

            dbf1 = dbf1 & ")"

        End If

    End If

    dbf2 = "  (caja='" & "" & mytable11.Fields("caja") & "')"
    'If Len(dbf2) = 0 Then
    '   dbf2 = dbf1
    'End If
    'MsgBox dbf2
    queprecio = "precios.pventa1 as Precio "

    'MsgBox buffer
    '0 consulta delivery
    If opcion1 = "0" Then  'si es delivery
        If Len(buffer) = 0 Then  'AQUI DEBE APARECER
            buf = "select Telefono,Nombre,Codigo from telefono "
        Else
            buf = "select Telefono,Nombre,Codigo from telefono where "
            buf = buf & "" & Combo1 & " like '%" & buffer & "%'"

            'indx = dbGrid1.Col
        End If

    End If

    If opcion1 = "370" Then
        If Len(buffer) = 0 Then
            buf = "select Nombre,Numero,Fecha,Moneda as M,Total,Hora,Usuario,Caja,Turno from crequisa where local='" & "" & mytable11.Fields("local") & "'"
        Else
            buf = "select Nombre,Numero,Fecha,Moneda as M,Total,Hora,Usuario,Caja,Turno from reponec where "
            buf = buf & " local='" & "" & mytable11.Fields("local") & "'"
            buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"

            'indx = dbGrid1.Col
        End If

    End If

    '' 13/01/2018 Fecha de registro y cambio de congelados
    'If opcion1 = "150" Then  'descongela
    'If Len(buffer) = 0 Then
    '   buf = "select Nombre ,Numero,Fecha,Moneda as M,Total,Hora,Usuario,Caja,Turno,vendedor from congelac "
    '   If Len(dbf2) > 0 Then
    '      'buf = buf & " where "
    '   End If
    '   'buf = buf & dbf2
    '   Else
    '   buf = "select Nombre ,Numero,Fecha,Moneda as M,Total,Hora,Usuario,Caja,Turno,vendedor from congelac where "
    '   buf = buf & "" & Combo1 & " like '%" & buffer & "%'"
    '   If Len(dbf2) > 0 Then
    '      buf = buf & " and "
    '   End If
    '   buf = buf & dbf2
    '   'indx = dbGrid1.Col
    '   End If
    '   'MsgBox buf
    'End If

    If opcion1 = "150" Then  'descongela
        If Len(buffer) = 0 Then
            buf = "select Nombre ,Numero,Fecha,Fechae,Moneda as M,Total,Hora,Usuario,Caja,Turno,vendedor from congelac "

            If Len(dbf2) > 0 Then

                'buf = buf & " where "
            End If

            'buf = buf & dbf2
        Else
            buf = "select Nombre ,Numero,Fecha,Fechae,Moneda as M,Total,Hora,Usuario,Caja,Turno,vendedor from congelac where "
            buf = buf & "" & Combo1 & " like '%" & buffer & "%'"

            If Len(dbf2) > 0 Then
                buf = buf & " and "

            End If

            buf = buf & dbf2

            'indx = dbGrid1.Col
        End If

        'MsgBox buf
    End If

    '' 13/01/2018 Fecha de registro y cambio de congelados

    If opcion1 = "1900" Then
        If Len(buffer) = 0 Then
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Vendedor,Hora,Caja,Turno,Local from cproform  where local='" & "" & mytable11.Fields("local") & "'"

            If Len(dbf1) > 0 Then
                buf = buf & " and "

            End If

            buf = buf & dbf1
        Else
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Vendedor,Hora,Caja,Turno,Local from cproform where local='" & "" & mytable11.Fields("local") & "' and "
            buf = buf & "  " & Combo1 & " like '%" & buffer & "%'"

            If Len(dbf1) > 0 Then
                buf = buf & " and "

            End If

            buf = buf & dbf1
            buf = buf & "   order by tipo,str(numero) "
   
        End If

    End If

    'MsgBox buf

    ''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas
    If opcion1 = "70000" Then  'carga creditos pendientes
   
        If Len(buffer) = 0 Then
            buf = "select tipo,serie,Numero,Fecha,fechav,Nombre,Codigo,Moneda as M,Saldo,interes,abono,total,usuario,local,tipoclie from cuentac where local='" & "" & "" & mytable11.Fields("local") & "' and "
            buf = buf & "  saldo>0  "
            buf = buf & " order by fecha"
        Else
            buf = "select tipo,serie,Numero,Fecha,fechav,Nombre,Codigo,Moneda as M,Saldo,interes,abono,total,usuario,local,tipoclie from cuentac where local='" & "" & "" & mytable11.Fields("local") & "' and "
            buf = buf & "  saldo>0   "
            buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
            buf = buf & "  order by fecha "
   
        End If

    End If

    ''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas

    '''26/10/2017 Listas de ciertas caja para cobrar pedido
    If opcion1 = "15000" Then  'carga ordenes de trabajo
    
        Dim mytablep   As New ADODB.Recordset

        Dim mytablexyz As New ADODB.Recordset

        Dim rpta       As String

        Dim c1, c2, c3, c4, c5, c6, c7, c8, c9, c10, c11, c12, c13, c14, c15, c16 As String
     
        mytablep.Open "select  cajapedido from parame where codigo='01'", cn, adOpenStatic, adLockOptimistic

        If mytablep.RecordCount > 0 Then
          
            If mytablep.Fields("cajapedido") = "S" Then
                rpta = "S"
            Else
                rpta = "N"

            End If

        End If
    
        If rpta = "" Then
            rpta = "N"

        End If
    
        mytablep.Close
    
        mytablexyz.Open "select  * from usercajapedido where caja='" & caja & "' ", cn, adOpenStatic, adLockOptimistic

        If mytablexyz.RecordCount > 0 Then
      
            c1 = mytablexyz.Fields("p1")
            c2 = mytablexyz.Fields("p2")
            c3 = mytablexyz.Fields("p3")
            c4 = mytablexyz.Fields("p4")
      
            c5 = mytablexyz.Fields("p5")
            c6 = mytablexyz.Fields("p6")
            c7 = mytablexyz.Fields("p7")
            c8 = mytablexyz.Fields("p8")
      
            c9 = mytablexyz.Fields("p9")
            c10 = mytablexyz.Fields("p10")
            c11 = mytablexyz.Fields("p11")
            c12 = mytablexyz.Fields("p12")
      
            c13 = mytablexyz.Fields("p13")
            c14 = mytablexyz.Fields("p14")
            c15 = mytablexyz.Fields("p15")
            c16 = mytablexyz.Fields("p16")
      
        End If

        mytablexyz.Close
  
        ''''14/09/2017 cobra los pedidos de diferentes locales (Cobro OT)
        '     buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Vendedor,Hora,Caja,Turno,Local,acuenta from cpedidov where local='" & "" & "" & mytable11.Fields("local") & "' and "
        '    'buf = buf & "  fecha=" & "DateValue('" & dia & "'" & ")"
        '    'buf = buf & " yausado<>'1' and "
        '    buf = buf & "  yausado<>'1'  "
        '    'buf = buf & "  caja='" & caja & "'"
        '    buf = buf & " order by fecha,HORA"
        '    Else
        '    buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Vendedor,Hora,Caja,Turno,Local,acuenta from cpedidov where local='" & "" & "" & mytable11.Fields("local") & "' and "
        '    'buf = buf & "  fecha=" & "DateValue('" & dia & "'" & ")"
        '    'buf = buf & " yausado<>'1' and "
        '    buf = buf & "  yausado<>'1'  "
        '    'buf = buf & "  caja='" & caja & "'"
        '    buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
        '    buf = buf & "  order by fecha,HORA "
        '    'indx = dbGrid1.Col
   
        If Len(buffer) = 0 Then
            If rpta = "S" Then
                buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Vendedor,Hora,Caja,Turno,Local,acuenta from cpedidov where  "
                buf = buf & "  yausado<>'1' and (caja = '" & c1 & "' or caja = '" & c2 & "' or caja = '" & c3 & "' or caja = '" & c4 & "'or caja = '" & c5 & "'or caja = '" & c6 & "'or caja = '" & c7 & "'or caja = '" & c8 & "'or caja = '" & c9 & "'or caja = '" & c10 & "'or caja = '" & c11 & "'or caja = '" & c12 & "'or caja = '" & c13 & "'or caja = '" & c14 & "'or caja = '" & c15 & "'or caja = '" & c16 & "' )"
                buf = buf & " order by fecha,HORA"
            Else
                buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Vendedor,Hora,Caja,Turno,Local,acuenta from cpedidov where  "
                buf = buf & "  yausado<>'1'"
                buf = buf & " order by fecha,HORA"

            End If
   
        Else
        
            If rpta = "S" Then
                buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Vendedor,Hora,Caja,Turno,Local,acuenta from cpedidov where  "
                buf = buf & "  yausado<>'1' and (caja = '" & c1 & "' or caja = '" & c2 & "' or caja = '" & c3 & "' or caja = '" & c4 & "'or caja = '" & c5 & "'or caja = '" & c6 & "'or caja = '" & c7 & "'or caja = '" & c8 & "'or caja = '" & c9 & "'or caja = '" & c10 & "'or caja = '" & c11 & "'or caja = '" & c12 & "'or caja = '" & c13 & "'or caja = '" & c14 & "'or caja = '" & c15 & "'or caja = '" & c16 & "' )"
                buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
                buf = buf & "  order by fecha,HORA "
            Else
                buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Vendedor,Hora,Caja,Turno,Local,acuenta from cpedidov where  "
                buf = buf & "  yausado<>'1'"
                buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
                buf = buf & "  order by fecha,HORA "

            End If

        End If
   
        '''26/10/2017 Listas de ciertas caja para cobrar pedido
   
    End If

    If opcion1 = "15000Z" Then  'carga ordenes de trabajo para abonar
        Label22.Visible = True

        'MsgBox Label9.Visible
        If Len(buffer) = 0 Then
            buf = "select Reserva,Arribofecha,ArriboHora,Codigo,Nombre,Saldo from reserva where saldo>0 "
            'buf = buf & "  fecha=" & "DateValue('" & dia & "'" & ")"
            'buf = buf & " yausado<>'1' and "
            'buf = buf & "  yausado<>'1'  "
            'buf = buf & "  caja='" & caja & "'"
            buf = buf & " order by reserva"
        Else
            buf = "select Reserva,Arribofecha,ArriboHora,Codigo,Nombre,Saldo from reserva where saldo>0 "
            'buf = buf & "  fecha=" & "DateValue('" & dia & "'" & ")"
            'buf = buf & " yausado<>'1' and "
            'buf = buf & "  yausado<>'1'  "
            'buf = buf & "  caja='" & caja & "'"
            buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
            buf = buf & "  order by Reserva "
            'indx = dbGrid1.Col
   
        End If

    End If

    If opcion1 = "15000Y" Then  'carga ordenes de trabajo para abonar
        Label22.Visible = True

        'MsgBox Label9.Visible
        If Len(buffer) = 0 Then
            buf = "select Checkin,Arribofecha,ArriboHora,Codigo,Nombre,Saldo from checkin where saldo>0 "
            'buf = buf & "  fecha=" & "DateValue('" & dia & "'" & ")"
            'buf = buf & " yausado<>'1' and "
            'buf = buf & "  yausado<>'1'  "
            'buf = buf & "  caja='" & caja & "'"
            buf = buf & " order by checkin"
        Else
            buf = "select Reserva,Arribofecha,ArriboHora,Codigo,Nombre,Saldo from checkin where saldo>0 "
            'buf = buf & "  fecha=" & "DateValue('" & dia & "'" & ")"
            'buf = buf & " yausado<>'1' and "
            'buf = buf & "  yausado<>'1'  "
            'buf = buf & "  caja='" & caja & "'"
            buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
            buf = buf & "  order by checkin "
            'indx = dbGrid1.Col
   
        End If

    End If

    If opcion1 = "15000A" Then  'carga ordenes de trabajo para abonar
        Label22.Visible = True

        'MsgBox Label9.Visible
        If Len(buffer) = 0 Then
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,(Total-acuenta) as Saldop,Estado as E,Placa as Ok,Vendedor,FechaE,Hora,Caja,Turno,Local,acuenta from cpedidov where (total-acuenta)>0 and local='" & "" & "" & mytable11.Fields("local") & "' "
            'buf = buf & "  fecha=" & "DateValue('" & dia & "'" & ")"
            'buf = buf & " yausado<>'1' and "
            'buf = buf & "  yausado<>'1'  "
            'buf = buf & "  caja='" & caja & "'"
            buf = buf & " order by fecha,HORA"
        Else
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,(Total-acuenta) as Saldop,Estado as E,Placa as Ok,Vendedor,FechaE,Hora,Caja,Turno,Local,acuenta from cpedidov where (total-acuenta)>0 and local='" & "" & "" & mytable11.Fields("local") & "' "
            'buf = buf & "  fecha=" & "DateValue('" & dia & "'" & ")"
            'buf = buf & " yausado<>'1' and "
            'buf = buf & "  yausado<>'1'  "
            'buf = buf & "  caja='" & caja & "'"
            buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
            buf = buf & "  order by fecha,HORA "
            'indx = dbGrid1.Col
   
        End If

    End If

    If opcion1 = "15000B" Then  'carga ordenes de trabajo para abonar
 
        Label19.Visible = True

        'MsgBox Label9.Visible
        'MsgBox "abc"
        If Len(buffer) = 0 Then
            'buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,(Total-acuenta) as Saldop,Estado as E,Placa as Ok,Vendedor,FechaE,Hora,Caja,Turno,Local,acuenta from cpedidov where (total-acuenta)<=0 and local='" & "" & "" & mytable11.Fields("local") & "'"
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,(Total-acuenta) as Saldop,Estado as E,Placa as Ok,Vendedor,FechaE,Hora,Caja,Turno,Local,acuenta from cpedidov where yausado = 1 and local='" & "" & "" & mytable11.Fields("local") & "'"
            buf = buf & " and placa='PENDIENTE'  "
            'buf = buf & "  fecha=" & "DateValue('" & dia & "'" & ")"
            'buf = buf & " yausado<>'1' and "
            'buf = buf & "  yausado<>'1'  "
            'buf = buf & "  caja='" & caja & "'"
            buf = buf & " order by fecha,HORA"
        Else
            'buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,(Total-acuenta) as Saldop,Estado as E,Placa as Ok,Vendedor,FechaE,Hora,Caja,Turno,Local,acuenta from cpedidov where (total-acuenta)<=0 and local='" & "" & "" & mytable11.Fields("local") & "' and "
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,(Total-acuenta) as Saldop,Estado as E,Placa as Ok,Vendedor,FechaE,Hora,Caja,Turno,Local,acuenta from cpedidov where yausado = 1 and local='" & "" & "" & mytable11.Fields("local") & "' and "
            buf = buf & " and placa='PENDIENTE'  "
            'buf = buf & "  fecha=" & "DateValue('" & dia & "'" & ")"
            'buf = buf & " yausado<>'1' and "
            'buf = buf & "  yausado<>'1'  "
            'buf = buf & "  caja='" & caja & "'"
            buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
            buf = buf & "  order by fecha,HORA "
            'indx = dbGrid1.Col
   
        End If

    End If

    If opcion1 = "30000" Then  'carga cotizaciones
        If Len(buffer) = 0 Then
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Placa as Ok,Vendedor,Hora,Caja,Turno,Local,acuenta from ccotizav where local='" & "" & mytable11.Fields("local") & "'"
            'buf = buf & "  fecha=" & "DateValue('" & dia & "'" & ")"
            buf = buf & " and (yausado='0' or yausado=null)"
            buf = buf & " order by HORA"
        Else
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Placa as Ok,Vendedor,Hora,Caja,Turno,Local,acuenta from ccotizav where local='" & "" & mytable11.Fields("local") & "'"
            buf = buf & " and (yausado='0' or yausado=null)"
            buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
            buf = buf & "  order by HORA "

            'indx = dbGrid1.Col
        End If

    End If

    'MsgBox buf AQUI KENYO

    ''''20/09/2017 kenyo Salon y mesa en copia y anula de ventas
    If opcion1 = "10" Or opcion1 = "13" Or opcion1 = "14" Or opcion1 = "1500" Then
        If opcion1 = "100" Then
            Label19.Visible = True

        End If

        If Len(buffer) = 0 Then
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Servicio as S,Placa as Ok,Vendedor,Hora,Caja,Turno,Local,Tipo1,Serie1,Numero1 from " & gocabeza & " where local='" & "" & mytable11.Fields("local") & "' and "
            buf = buf & "  fecha='" & amfecha & "'"
            buf = buf & " and usuario='" & cajero & "'"
            buf = buf & " and caja='" & caja & "'"
            buf = buf & " and turno='" & turno & "'"
            buf = buf & " order by HORA"
        Else
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Servicio as S,Placa as Ok,Vendedor,Hora,Caja,Turno,Local,Tipo1,Serie1,Numero1 from " & gocabeza & " where local='" & "" & mytable11.Fields("local") & "' and "
            buf = buf & "  fecha='" & amfecha & "'"
            buf = buf & " and usuario='" & cajero & "'"
            buf = buf & " and caja='" & caja & "'"
            buf = buf & " and turno='" & turno & "'"
            buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
            buf = buf & "  order by HORA "

            'indx = dbGrid1.Col
        End If

    End If

    ''''20/09/2017 kenyo Salon y mesa en copia y anula de ventas

    ''''20/09/2017 kenyo Salon y mesa en copia y anula de ventas
    If opcion1 = "15" Or opcion1 = "100" Then
        If opcion1 = "100" Then
            Label19.Visible = True

        End If

        If Len(buffer) = 0 Then
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Servicio as S,Placa as Ok,Vendedor,Hora,Caja,Turno,Local,Tipo1,Serie1,Numero1,salon,mesa from " & gocabeza & " where local='" & "" & mytable11.Fields("local") & "' and "
            buf = buf & "  fecha='" & amfecha & "'"
            buf = buf & " and usuario='" & cajero & "'"
            buf = buf & " and caja='" & caja & "'"
            buf = buf & " and turno='" & turno & "'"
            buf = buf & " order by HORA"
        Else
            buf = "select tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Servicio as S,Placa as Ok,Vendedor,Hora,Caja,Turno,Local,Tipo1,Serie1,Numero1,salon,mesa from " & gocabeza & " where local='" & "" & mytable11.Fields("local") & "' and "
            buf = buf & "  fecha='" & amfecha & "'"
            buf = buf & " and usuario='" & cajero & "'"
            buf = buf & " and caja='" & caja & "'"
            buf = buf & " and turno='" & turno & "'"
            buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
            buf = buf & "  order by HORA "

            'indx = dbGrid1.Col
        End If

    End If

    ''''20/09/2017 kenyo Salon y mesa en copia y anula de ventas

    'If opcion1 = "1500" Then
    '   buf = "select FlaG_deli,tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Placa as Ok,Vendedor,Hora,Caja,Turno,Local from " & gocabeza & " where local='01'"
    '
    '
    'End If

    If opcion1 = "750" Then
        If Len(buffer) = 0 Then
            buf = "select FlaG_deli,tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Servico as S,Placa as Ok,Vendedor,Hora,Caja,Turno,Local from " & gocabeza & " where local='" & "" & mytable11.Fields("local") & "' and "
            buf = buf & "  fecha='" & amfecha & "'"
            buf = buf & " and servicio='D' "
            buf = buf & " and usuario='" & cajero & "'  order by tipo,str(numero)"
        Else
            buf = "select Flaf_deli as PDeli,tipo,serie,Numero,Fecha,Nombre,Codigo,Moneda as M,Total,Estado as E,Servicio as S,Placa as Ok,Vendedor,Hora,Caja,Turno,local from " & gocabeza & " where local='" & "" & mytable11.Fields("local") & "' and "
            buf = buf & "  fecha='" & amfecha & "'"
            buf = buf & " and usuario='" & cajero & "'"
            buf = buf & " and servicio='D' "
            buf = buf & " and " & Combo1 & " like '%" & buffer & "%'"
            buf = buf & "  order by HORA "

        End If

    End If

    If opcion1 = "19000" Then
        If Len(buffer) = 0 Then
            buf = "select Descripcio,Servicio from servicio where servicio<>'D' and servicio<>'C' and servicio<>'A' "
        Else
            buf = "select Descripcio,Servicio from servicio  where servicio<>'D' and servicio<>'C' and servicio<>'A' and " & "" & Combo1 & " like '%" & buffer & "%'"

        End If

    End If

    If opcion1 = "1" Then
        If Len(buffer) = 0 Then
            buf = "select Deliveri.telefono,Clientes.Nombre,deliveri.Direccion,deliveri.referencia,Clientes.Codigo,clientes.fechanac,clientes.clasifica from clientes inner join deliveri on deliveri.codigo=clientes.codigo "
        Else
            buf = "select Deliveri.telefono,Clientes.Nombre,clientes.Direccion,deliveri.referencia,Clientes.Codigo,clientes.fechanac,clientes.clasifica from  clientes inner join deliveri  on deliveri.codigo=clientes.codigo and " & "" & Combo1 & " like '%" & buffer & "%'"

        End If

    End If

    If opcion1 = "2" Then
        If Len(buffer) = 0 Then
            buf = "select CODIGO, NOMBRE, DIRECCION from clientes "
        Else
            buf = "select CODIGO, NOMBRE, DIRECCION from clientes "

        End If

    End If

    If opcion1 = "2003" Then
        If Len(buffer) = 0 Then
            buf = "select Local,Tipo,Serie,Numero,Fecha,Estado,Total,Acuenta,(Total-Acuenta) as saldo,codigo from cpedidov where codigo='" & tcampo1 & "' AND (Total-Acuenta)>0"
        Else
            buf = "select Local,Tipo,Serie,Numero,Fecha,Estado,Total,Acuenta,(Total-Acuenta) as saldo,codigo from cpedidov  where " & "" & Combo1 & " like '%" & buffer & "%' and codigo='" & tcampo1 & "' AND (Total-Acuenta)>0"

        End If

    End If

    If opcion1 = "30" Or opcion1 = "99" Then
        If Len(buffer) = 0 Then
            buf = "select Nombre,Codigo,Tipo,Codigo1,Direccion,Distrito from clientes "
        Else
            buf = "select Nombre,Codigo,Tipo,Codigo1,Direccion,Distrito from clientes  where " & "" & Combo1 & " like '%" & buffer & "%'"

            'indx = dbGrid1.Col
        End If

    End If

    If opcion1 = "300" Then
        If Len(buffer) = 0 Then
            buf = "select Nombre,Codigo,Tipo,Codigo1,Direccion,Distrito from bodega "
        Else
            buf = "select Nombre,Codigo,Tipo,Codigo1,Direccion,Distrito from bodega  where " & "" & Combo1 & " like '%" & buffer & "%'"

            'indx = dbGrid1.Col
        End If

    End If

    If opcion1 = "1750" Then  'consulta de telefonos de clientes
        If Len(buffer) = 0 Then
            buf = "select Nombre,Direccion,telefono,Distrito,Fechanac,Codigo,tipo,Codigo1 from clientes "
        Else
            buf = "select Nombre,Direccion,Telefono,Distrito,Fechanac,Codigo,Tipo,Codigo1 from clientes  where " & "" & Combo1 & " like '%" & buffer & "%'"

        End If

    End If

    If opcion1 = "300" Then
        If Len(buffer) = 0 Then
            buf = "select Nombre,Codigo,Direccion,Distrito from bodega "
        Else
            buf = "select Nombre,Codigo,Direccion,Distrito from bodega  where " & "" & Combo1 & " like '%" & buffer & "%'"

            'indx = dbGrid1.Col
        End If

    End If

    If opcion1 = "29" Then
        If Len(buffer) = 0 Then
            buf = "select Descripcio,Tipo from Tipo where (tipodoc='1' or tipodoc='A' or tipodoc='B' or tipodoc='C' or tipodoc='D' or tipodoc='E' or tipodoc='G') order by tipo"
        Else
            buf = "select Descripcio,Tipo from Tipo  where (tipodoc='1' or tipodoc='A' or tipodoc='B' or tipodoc='C' or tipodoc='D' or tipodoc='E' or tipodoc='G') and "
            buf = buf & "" & Combo1 & " like '%" & buffer & "%'"
            buf = buf & "  order by tipo"

            'indx = dbGrid1.Col
        End If

    End If

    If opcion1 = "31" Then
        If Len(buffer) = 0 Then
            buf = "select Nombre,Codigo from Vendedor "
        Else
            buf = "select Nombre,Codigo from Vendedor  where "
            buf = buf & "" & Combo1 & " like '%" & buffer & "%'"

            'indx = dbGrid1.Col
        End If

    End If

    If opcion1 = "200" Then
        If Len(buffer) = 0 Then
            buf = "select Descripcio,Banco from Banco "
        Else
            buf = "select Descripcio,Banco from Banco  where "
            buf = buf & "" & Combo1 & " like '%" & buffer & "%'"

            'indx = dbGrid1.Col
        End If

    End If

    If opcion1 = "2800" Then 'consulta cuenta corriente favor cliente
        If Len(buffer) = 0 Then
            buf = "select Nombre,Codigo,Local,Tipo,Serie,Numero,Fecha,Saldo,Abono,Total from cuentac where anticipo='1' order by nombre,fecha"
        Else
            buf = "select Nombre,Codigo,Local,Tipo,Serie,Numero,Fecha,Saldo,Abono,Total from cuentac   where  anticipo='1' and "
            buf = buf & "" & Combo1 & " like '%" & buffer & "%' order by nombre,fecha"
            'indx = dbGrid1.Col
   
        End If

    End If

    If opcion1 = "23" Then
        If Len(buffer) = 0 Then
            buf = "select Nombre,Codigo,Direccion,Distrito ,Fechanac from clientes "
        Else
            buf = "select Nombre,Codigo,Codigo,Direccion,Distrito,Fechanac from clientes  where "
            buf = buf & "" & Combo1 & " like '%" & buffer & "%'"
            'indx = dbGrid1.Col
   
        End If

    End If

    'BUSQUEDA DE CLIENTES
    If opcion1 = "12" Then
        If Len(buffer) = 0 Then
            buf = "select Nombre,Codigo,Direccion,Distrito,Fechanac from clientes "
        Else
            buf = "select Nombre,Codigo,Direccion,Distrito,Fechanac from clientes  where "
            buf = buf & "" & Combo1 & " like '%" & buffer & "%'"

            'indx = dbGrid1.Col
        End If

    End If

    If opcion1 = "8" Then
        If Len(buffer) = 0 Then
            buf = "select Producto.Descripcio,Producto.producto,Producto.Marca,precios.Unidad1 as Und1,precios.Factor1 as F," & queprecio & "  ,Producto.Monedav as M,Producto.Familia,Producto.barras,Producto.Remate,producto.estado from producto  left join precios on producto.producto=precios.producto  where  precios.local='" & "" & mytable11.Fields("listap") & "'"
        Else
            buf = "select Producto.Descripcio,Producto.producto,Producto.Marca,precios.Unidad1 as Und1,precios.Factor1 as F," & queprecio & " ,Producto.Monedav as M,Producto.Familia,Producto.barras,Producto.Remate,producto.estado from producto left join precios on producto.producto=precios.producto WHERE   precios.local='" & "" & mytable11.Fields("listap") & "' and "
            ''28/06/2017 'QUITAR PORCENTAJE EN BUSQUEDA DE PROD
            ' buf = buf & "" & Combo1 & " like '%" & buffer & "%'"
        
            buf = buf & "" & Combo1 & " like '%" & buffer & "%'"
            ''28/06/2017 'QUITAR PORCENTAJE EN BUSQUEDA DE PROD
        
        End If

    End If

    If opcion1 = "8" Then
        If "" & mytable11.Fields("ordenaproducto") = "S" Then
            buf = buf & " order by descripcio"

        End If

    End If
              
    Set rcconsulta = Nothing

    If rcconsulta.State = 1 Then
        rcconsulta.Close
        Set rcconsulta = Nothing

    End If
   
    'MsgBox buf & " " & opcion1
    rcconsulta.Open buf, cn, adOpenStatic, adLockOptimistic
    Set dbGrid1.DataSource = rcconsulta
    dbGrid1.refresh

    'MsgBox buf
    If rcconsulta.RecordCount = 0 Then
        buffer.SetFocus
        Exit Function
    
    End If
                 
    'sw_consulta = 1
    If opcion1 = "8" Then
        pone_precios "" & rcconsulta.Fields("producto")

    End If

    dbGrid1.columns(0).Width = 4000
    dbGrid1.columns(1).Width = 2000

    If opcion1 = "0" Then   'consulta deliveri
        dbGrid1.columns(0).Width = 1500
        dbGrid1.columns(1).Width = 4300
        dbGrid1.columns(2).Width = 1500

    End If

    If opcion1 = "750" Then
        dbGrid1.columns(0).Width = 700
        dbGrid1.columns(1).Width = 700
        dbGrid1.columns(2).Width = 700
        dbGrid1.columns(3).Width = 1300
        dbGrid1.columns(4).Width = 1500
        dbGrid1.columns(5).Width = 3000
        dbGrid1.columns(6).Width = 1500
        dbGrid1.columns(7).Width = 400
        dbGrid1.columns(8).Width = 1400
        dbGrid1.columns(9).Width = 400
        dbGrid1.columns(10).Width = 1300
        dbGrid1.columns(11).Width = 1300
        dbGrid1.columns(12).Width = 700
        dbGrid1.columns(13).Width = 700

    End If
              
    ''''20/09/2017 kenyo Salon y mesa en copia y anula de ventas
    If opcion1 = "10" Or opcion1 = "13" Or opcion1 = "14" Or opcion1 = "1500" Or opcion1 = "1900" Or opcion1 = "15000" Or opcion1 = "15000A" Or opcion1 = "15000B" Or opcion1 = "30000" Then
        dbGrid1.columns(0).Width = 700
        dbGrid1.columns(1).Width = 700
        dbGrid1.columns(2).Width = 1300
        dbGrid1.columns(3).Width = 1500
        dbGrid1.columns(4).Width = 3000
        dbGrid1.columns(5).Width = 1500
        dbGrid1.columns(6).Width = 400
        dbGrid1.columns(7).Width = 1400
        dbGrid1.columns(8).Width = 350
        dbGrid1.columns(9).Width = 400
        dbGrid1.columns(10).Width = 500
        dbGrid1.columns(11).Width = 1300
        dbGrid1.columns(12).Width = 1300
        dbGrid1.columns(13).Width = 700

        'dbgrid1.columns(14).Width = 700
    End If

    ''''20/09/2017 kenyo Salon y mesa en copia y anula de ventas
              
    ''''20/09/2017 kenyo Salon y mesa en copia y anula de ventas
    If opcion1 = "15" Or opcion1 = "100" Then
        dbGrid1.columns(0).Width = 700
        dbGrid1.columns(1).Width = 700
        dbGrid1.columns(2).Width = 1300
        dbGrid1.columns(3).Width = 1500
        dbGrid1.columns(4).Width = 3000
        dbGrid1.columns(5).Width = 1500
        dbGrid1.columns(6).Width = 400
        dbGrid1.columns(7).Width = 1400
        dbGrid1.columns(8).Width = 350
        dbGrid1.columns(9).Width = 400
        dbGrid1.columns(10).Width = 500
        dbGrid1.columns(11).Width = 1300
        dbGrid1.columns(12).Width = 1300
        dbGrid1.columns(13).Width = 700
        dbGrid1.columns(14).Width = 350
        dbGrid1.columns(15).Width = 350
        dbGrid1.columns(16).Width = 350

    End If

    ''''20/09/2017 kenyo Salon y mesa en copia y anula de ventas
              
    ''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas
    If opcion1 = "70000" Then
        dbGrid1.columns(0).Width = 300
        dbGrid1.columns(1).Width = 700
        dbGrid1.columns(2).Width = 1300
        dbGrid1.columns(3).Width = 1200
        dbGrid1.columns(4).Width = 1200
        dbGrid1.columns(5).Width = 3000
        dbGrid1.columns(6).Width = 1200
        dbGrid1.columns(7).Width = 400 ' moneda
        dbGrid1.columns(8).Width = 700
        dbGrid1.columns(9).Width = 1 'interes
        dbGrid1.columns(10).Width = 700
        dbGrid1.columns(11).Width = 700
        dbGrid1.columns(12).Width = 700
        dbGrid1.columns(13).Width = 1
        dbGrid1.columns(14).Width = 1

    End If

    ''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas
              
    If opcion1 = "8" Then
        dbGrid1.columns(0).Width = 5000
        dbGrid1.columns(1).Width = 1300
        dbGrid1.columns(2).Width = 1000
        dbGrid1.columns(3).Width = 900
        dbGrid1.columns(4).Width = 500
        dbGrid1.columns(5).Width = 800
        dbGrid1.columns(6).Width = 500
        dbGrid1.columns(7).Width = 1000
        dbGrid1.columns(8).Width = 1500
        dbGrid1.columns(9).Width = 1500

    End If
               
    '' 13/01/2018 Fecha de registro y cambio de congelados

    'If opcion1 = "150" Then
    'DBGrid1.columns(0).Width = 5000
    'DBGrid1.columns(1).Width = 1300
    'DBGrid1.columns(2).Width = 1500
    'DBGrid1.columns(3).Width = 900
    'DBGrid1.columns(4).Width = 1500
    'DBGrid1.columns(5).Width = 900
    'DBGrid1.columns(6).Width = 1200
    'DBGrid1.columns(7).Width = 700
    'End If
               
    If opcion1 = "150" Then
        dbGrid1.columns(0).Width = 5000
        dbGrid1.columns(1).Width = 1300
        dbGrid1.columns(2).Width = 1000
        dbGrid1.columns(3).Width = 1000
        dbGrid1.columns(4).Width = 900
        dbGrid1.columns(5).Width = 1500
        dbGrid1.columns(6).Width = 900
        dbGrid1.columns(7).Width = 1200
        dbGrid1.columns(8).Width = 700

    End If
               
    '' 13/01/2018 Fecha de registro y cambio de congelados

    If opcion1 = "2800" Then
        dbGrid1.columns(0).Width = 5000
        dbGrid1.columns(1).Width = 1300
        dbGrid1.columns(2).Width = 500
        dbGrid1.columns(3).Width = 500
        dbGrid1.columns(4).Width = 500
        dbGrid1.columns(5).Width = 1300
        dbGrid1.columns(6).Width = 1200
        dbGrid1.columns(7).Width = 900

    End If

    If sw = 1 Then
        dbGrid1.SetFocus

    End If

    If sw = 2 Then 'BUSCA CLIENTES GUARDADOS
        dbGrid1.SetFocus

    End If

    'MsgBox opcion1
               
    ''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas
    'If opcion1 = "150" Or opcion1 = "10" Or opcion1 = "13" Or opcion1 = "14" Or opcion1 = "15" Or opcion1 = "100" Or opcion1 = "1500" Or opcion1 = "1900" Or opcion1 = "15000" Or opcion1 = "15000A" Or opcion1 = "15000B" Or opcion1 = "30000"  Then
    'ir_hasta_ultimo rcconsulta
    'End If
                   
    If opcion1 = "150" Or opcion1 = "10" Or opcion1 = "13" Or opcion1 = "14" Or opcion1 = "15" Or opcion1 = "100" Or opcion1 = "1500" Or opcion1 = "1900" Or opcion1 = "15000" Or opcion1 = "15000A" Or opcion1 = "15000B" Or opcion1 = "30000" Or opcion1 = "70000" Then
        ir_hasta_ultimo rcconsulta

    End If

    ''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas
               
    sql_consulta = 1
    Exit Function
cmd8912_err:
    MsgBox "Aviso en sql_consulta " & error$, 48, "Aviso"
    buffer = ""
    Exit Function

End Function

Private Sub cmdCancelar_Click()
    Frame9.Visible = False
    DBGrid2.SetFocus

End Sub

Private Sub cmdCerrar_Click()
    Picture2.Visible = False

End Sub

Private Sub cmdGrabar_Click()

    Dim cad      As String

    Dim mytablex As New ADODB.Recordset

    Dim mytabley As Table

    Dim sdx      As Double

    Dim rs

    Dim i        As Integer

    Dim xcongela As String

    Dim sw       As Integer

    'inicio 01/06/2017  KENYO APARECE EN CONGELA NOMBRE DE CLIENTE PARA DESCONGELAR
    opcioncongela = 1
    'fin 01/06/2017  KENYO APARECE EN CONGELA NOMBRE DE CLIENTE PARA DESCONGELAR
      
    If Len(xcongelax) = 0 Then
        xcongelax.SetFocus
        Exit Sub

    End If

    If "" & mytable11.Fields("clavecongela") = "S" Then
        If Len(Trim(clavecongela)) = 0 Then
            clavecongela.SetFocus
            Exit Sub

        End If

    End If

    If Frame9.Caption = "PEDIDO PARA REPONER" Then
        pedido_reposicion
        'Label14_Click
        cmdCancelar_Click
        Exit Sub

    End If

    sdx = Val("" & mytable11.Fields("congela")) + 1
    xcongela = "" & sdx
denuevo1:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM congelac where numero='" & xcongela & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then

        sdx = Val(xcongela) + 1
        xcongela = "" & sdx
        GoTo denuevo1

    End If

    mytable11.Close
    cad = "UPDATE parameca SET "
    cad = cad & "congela = '" & Trim(xcongela) & "'"
    cad = cad & " WHERE  caja='" & Trim(caja) & "'"
    cn.Execute (cad)
   
    '' 13/01/2018 Fecha de registro y cambio de congelados
    'mytable11.Open "SELECT * FROM parameca where caja='" & caja & "'", cn, adOpenStatic, adLockOptimistic
    'cad = "INSERT INTO congelac (nombre,numero,fecha,moneda,paridad,dias,bodega,caja,turno,usuario,total,vendedor) VALUES('" & Trim(xcongelax) & "','"
    'cad = cad & Trim(xcongela) & "','"
    'cad = cad & Format(dia, "YYYYMMDD") & "','"
    'cad = cad & Trim("" & mytable11.Fields("moneda")) & "','"
    'cad = cad & Val(paridad) & "','"
    'cad = cad & Val("1") & "','"
    'cad = cad & Trim("" & mytable11.Fields("bodega")) & "','"
    'cad = cad & Trim(caja) & "','"
    'cad = cad & Trim(turno) & "','"
    'cad = cad & Trim(cajero) & "','"
   
    mytable11.Open "SELECT * FROM parameca where caja='" & caja & "'", cn, adOpenStatic, adLockOptimistic
    cad = "INSERT INTO congelac (nombre,numero,fecha,fechae,moneda,paridad,dias,bodega,caja,turno,usuario,total,vendedor) VALUES('" & Trim(xcongelax) & "','"
    cad = cad & Trim(xcongela) & "','"
    cad = cad & Format(dia, "YYYYMMDD") & "','"
    cad = cad & Format(fechaicongela, "YYYYMMDD") & "','"
    cad = cad & Trim("" & mytable11.Fields("moneda")) & "','"
    cad = cad & Val(paridad) & "','"
    cad = cad & Val("1") & "','"
    cad = cad & Trim("" & mytable11.Fields("bodega")) & "','"
    cad = cad & Trim(caja) & "','"
    cad = cad & Trim(turno) & "','"
    cad = cad & Trim(cajero) & "','"
    '' 13/01/2018 Fecha de registro y cambio de congelados
   
    '12/06/2017 kenyo selecciona vendedor congela
    'cad = cad & Val(txtotal) & "')"
    cad = cad & Val(txtotal) & "','"

    If vendedor = "VEND." Then
        vendedor = ""

    End If

    cad = cad & Trim(vendedor) & "')"
    '12/06/2017 kenyo selecciona vendedor congela
  
    cn.Execute (cad)
   
    '---ahora grabano detalle
    cn.Execute ("DELETE   FROM congelad WHERE numero='" & xnumero & "'")
    Data2.refresh
    Do

        If Data2.Recordset.EOF Then Exit Do
        cad = "INSERT INTO congelad VALUES('" & Trim("" & Data2.Recordset.Fields("tipo")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("serie")) & "','"
        cad = cad & Trim("" & xcongela) & "','"
        cad = cad & Trim("C") & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("codigo")) & "','"
        cad = cad & Trim("" & acu) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("acu1")) & "','"
        cad = cad & Format(dia, "YYYYMMDD") & "','"
        cad = cad & Trim("" & mytable11.Fields("moneda")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("producto")) & "','"
    
        ''' 14/11/2017 Mejora congela
        'cad = cad & Trim("" & Data2.Recordset.Fields("descripcio")) & "','"
        cad = cad & Trim("" & Replace$(Data2.Recordset.Fields("descripcio"), "'", Chr(34))) & "','"
        ''' 14/11/2017 Mejora congela
   
        cad = cad & Trim("" & Data2.Recordset.Fields("unidad")) & "',"
        cad = cad & Val("" & Data2.Recordset.Fields("factor")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("cantidad")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("precio")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("igv")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("neto")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("descuento")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("subtotal")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("impuesto")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("total")) & ",'"
        cad = cad & Trim("2") & "','"
        cad = cad & Trim("" & cajero) & "','"
        cad = cad & Trim("" & Format(Now, "YYYYMMDD")) & "','"
        cad = cad & Trim("" & Format(Now, "hh:mm:ss")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("vendedor")) & "','"
        cad = cad & Trim("" & mytable11.Fields("bodega")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("bodegaf")) & "',"
        cad = cad & Val("" & Data2.Recordset.Fields("deslipo")) & ",'"
        cad = cad & Trim("" & Data2.Recordset.Fields("flage")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("linea")) & "',"
        cad = cad & Val("" & Data2.Recordset.Fields("t1")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t2")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t3")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t4")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t5")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t6")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t7")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t8")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t9")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t10")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t11")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t12")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t13")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t14")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t15")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("t16")) & ",'"
        cad = cad & Trim("" & Data2.Recordset.Fields("l1")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("l2")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("l3")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("l4")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("local")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("proveedorP")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("observa1")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("observa2")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("observa3")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("observa4")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("zona")) & "',"
        cad = cad & Val("" & Data2.Recordset.Fields("isc")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("tax")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("vtaneta")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("tcosto")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("ganancia")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("comision")) & ",'"
        cad = cad & Trim("" & Data2.Recordset.Fields("cajero")) & "','"
        cad = cad & Trim("" & caja) & "','"
        cad = cad & Trim("" & turno) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("servicio")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("comanda")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("mesa")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("salon")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("mesero")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("sentido")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("ccosto")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("familia")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("subfamilia")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("marca")) & "',"
        cad = cad & Val("" & Data2.Recordset.Fields("percepcion")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("tpercepcio")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("flete")) & ",'"
        cad = cad & Trim("" & Data2.Recordset.Fields("localf")) & "',"
        cad = cad & Val("" & Data2.Recordset.Fields("ivap")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("tivap")) & ",'"
        cad = cad & Trim("" & Data2.Recordset.Fields("nroprecio")) & "',"
        cad = cad & Val("" & Data2.Recordset.Fields("tisc")) & ",'"
        cad = cad & Trim("" & Data2.Recordset.Fields("placa")) & "',"
        cad = cad & Val("" & Data2.Recordset.Fields("xneto")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("tdetra")) & ",'"
        cad = cad & Trim("" & Data2.Recordset.Fields("denumero")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("categoria")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("aduana")) & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("dua")) & "',"
        cad = cad & Val("" & Data2.Recordset.Fields("cantdev")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("servicioco")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("serviciopo")) & ","
        cad = cad & Val("" & Data2.Recordset.Fields("destopo")) & ",'"
        cad = cad & Format(Now, "YYYYMMDD") & "','"
        cad = cad & Format(Now, "HH:MM:SS") & "','"
        cad = cad & Trim("" & Data2.Recordset.Fields("administra")) & "',"
        cad = cad & Val("" & Data2.Recordset.Fields("detraccion")) & ")"
        'MsgBox cad
        cn.Execute (cad)
        Data2.Recordset.MoveNext
    Loop
    borra_congela
    cmdCancelar_Click

End Sub

Private Sub codigo_DblClick()
    tkeyboar.FLAG = "CODIGO"
    tkeyboar.Show 1

End Sub

Private Sub codigo_KeyDown(KeyCode As Integer, Shift As Integer)

    ''27/07/2017 kenyo OCULTA CONTROL DE CLIENTES
    If KeyCode = vbKeyEscape Then
        frmClientesRUC.Visible = False

    End If

    ''27/07/2017 kenyo OCULTA CONTROL DE CLIENTES
End Sub

Private Sub correo_DblClick()
    tkeyboar.FLAG = "CORREO"
    tkeyboar.Show 1

End Sub

Private Sub correo_KeyDown(KeyCode As Integer, Shift As Integer)

    ''27/07/2017 kenyo OCULTA CONTROL DE CLIENTES
    If KeyCode = vbKeyEscape Then
        frmClientesRUC.Visible = False

    End If

    ''27/07/2017 kenyo OCULTA CONTROL DE CLIENTES
End Sub

Private Sub dcrt6623_Click()
    '12/06/2017 kenyo oculta controles
    frmClientesRUC.Visible = False
    Picture2.Visible = False
    '12/06/2017 kenyo oculta controles

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub

    rrlocal11 = ""
    rrtipo = ""
    rrserie = ""
    rrnumero = ""
    cgusuario = gocabeza
    dgusuariog = godetalle
    found = sumar_detalle()

    If Val(txtotal) > 0 Then
        MsgBox "No deben existir pedidos Pendientes", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If
   
    mmenua.Caption = "CARGAPEDIDO"
    mmenua.Show 1

    If Len(rrlocal11) = 0 Then Exit Sub
    If Len(rrtipo) = 0 Then Exit Sub
    If Len(rrnumero) = 0 Then Exit Sub

    DBGrid2.SetFocus

End Sub

'27/08/2018 Producto delivery automatico
Private Sub fechasis_Click()

    If fechasis.Enabled = False Then Exit Sub
    'If DBGrid2.columns("producto") <> "DE" Then
    
    Dim mytablezx As New ADODB.Recordset
        
    '        If Len(DBGrid2.columns(0)) = 0 Then
    '          Exit Sub
    '        End If

    If mytablezx.State = 1 Then mytablezx.Close
        
    mytablezx.Open "SELECT * FROM PRODUCTO where deliveryautom='S'", cn, adOpenDynamic, adLockOptimistic

    If mytablezx.RecordCount > 0 Then
        Do

            If mytablezx.EOF Then Exit Do
            'DBGrid2.Col = 0
            'DBGrid2.SetFocus
            'DBGrid2.Row = DBGrid2.VisibleRows - 1
            busca_cod_producto "" & "" & mytablezx.Fields("producto"), 0
            mytablezx.MoveNext
        Loop
        mytablezx.Close

    End If
        
    fechasis.Enabled = False

    'End If
End Sub

'27/08/2018 Producto delivery automatico

'27/08/2018 Producto delivery automatico

'27/08/2018 Producto delivery automatico

Private Sub fsdfsdf_Click()
    cgusuario = "CPEDIDOV"
    dgusuario = "_d" & gusuario
    fgusuario = "_f" & gusuario
    dgusuariog = "DPEDIDOV"
    explorap.fechai = "01/" & Format(Month(Now), "00") & "/" & Format(Year(Now), "0000")
    explorap.fechaf = Format(Now, "dd/mm/yyyy")
    explorap.Caption = "Documentos Pedidos Ventas"
    explorap.tipoclie = "C"
    explorap.acu = "I"
    explorap.Show 1

End Sub

Private Sub Image3_Click()

    On Error GoTo cmd89012_err

    TBRCOMA.salon = Trim("" & cmytablex.Fields("salon"))

    ' 25/07/2018 Delivery y Para Llevar desde mozo
    'TBRCOMA.mesa = Trim("" & cmytablex.Fields(1))
    TBRCOMA.mesa = Trim("" & extra_loquesea(cmytablex.Fields(1)))
    ' 25/07/2018 Delivery y Para Llevar desde mozo

    TBRCOMA.Show 1
    consulta_comanda "" & mytable11.Fields("salon")
    Exit Sub
cmd89012_err:
    Exit Sub

End Sub

Private Sub Label16_Click()

End Sub

Private Sub Label17_Click()

End Sub

Private Sub kumabo9_Click()
    cgusuario = "ccotizav"
    dgusuario = "_d" & gusuario
    fgusuario = "_f" & gusuario
    dgusuariog = "dcotizav"
    'explorap.fechai = "01/" & Format(Month(Now), "00") & "/" & Format(Year(Now), "0000")
    'explorap.fechaf = Format(Now, "dd/mm/yyyy")
    explorap.Caption = "Documentos Cotizacion Ventas"
    explorap.tipoclie = "C"
    explorap.acu = "H"
    explorap.Show 1

End Sub

Private Sub Label19_Click()

    Dim found As Integer

    found = proceso_15000()

    If found = 1 Then
        MsgBox "Proceso Realizado ", 48, "Aviso"
        dbgrid1_KeyDown 27, 0
        Exit Sub

    End If

End Sub

Private Sub Label21_Click()
    consulta_comanda ""

End Sub

Private Sub Label26_Click()
    dbgrid1_KeyDown 13, 0

End Sub

Private Sub Label29_Click()

    If Len(telefono) = 0 Then Exit Sub
    If Len(dnombre) = 0 Then Exit Sub
    salon.Caption = ""
    mesa.Caption = ""
    mesero = ""
    cuenta_separa = ""
    flag_servicio = "D"
    proceso_cobross

End Sub

Private Sub Label31_Click()
    losao94_Click

End Sub

Private Sub Label9_Click()

    If Len(dcodigo) > 0 Then
        busca_codigo_clientedeliveri ("" & dcodigo)

    End If

End Sub

Private Sub nombre_DblClick()
    tkeyboar.FLAG = "NOMBREP"
    tkeyboar.Show 1

End Sub

Private Sub nombre_KeyDown(KeyCode As Integer, Shift As Integer)

    ''27/07/2017 kenyo OCULTA CONTROL DE CLIENTES
    If KeyCode = vbKeyEscape Then
        frmClientesRUC.Visible = False

    End If

    ''27/07/2017 kenyo OCULTA CONTROL DE CLIENTES
End Sub

Private Sub NotaCredito_Click()

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub

    flag_clave1 = 0
    tconcla.X = "ANULA"  '
    tconcla.Show 1

    If flag_clave1 <> 1 Then  'si es descongela
        DBGrid2.SetFocus
        Exit Sub

    End If

    rrlocal11 = ""
    rrtipo = ""
    rrserie = ""
    rrnumero = ""
    cgusuario = gocabeza
    dgusuariog = godetalle
    found = sumar_detalle()

    If Val(txtotal) > 0 Then
        MsgBox "No deben existir pedidos Pendientes", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If
   
    mmenua.Caption = "NOTACREDITO"
    mmenua.Show 1

    If Len(rrlocal11) = 0 Then Exit Sub
    If Len(rrtipo) = 0 Then Exit Sub
    If Len(rrnumero) = 0 Then Exit Sub

    DBGrid2.SetFocus

End Sub

Private Sub table2_Click()

    'ijkl = ijkl + 1
    'If ijkl = 1 Then
    'ijkl = 2
    'table2_DblClick
    'End If
    'table2_DblClick

    txtVuelto.Text = ""
    txtDineroEntregado.Text = ""
    hknumero.Caption = ""

    ''''21/09/2017 kenyo Mejora  cobranza de mesas
    'frmClientesRUC.Visible = True
    ''''21/09/2017 kenyo Mejora  cobranza de mesas
    If frmClientesRUC.Visible = True Then
        codigo.SetFocus

    End If
    
    ''''21/09/2017 kenyo Mejora  cobranza de mesas
End Sub
    
Private Sub table2_KeyDown(KeyCode As Integer, Shift As Integer)

    '''04/08/2017 kenyo. Cobra Mesa Con Enter
    If KeyCode = vbKeyEscape Then
        Picture2.Visible = False

    End If

    '''04/08/2017 kenyo. Cobra Mesa Con Enter
End Sub

Private Sub table2_KeyPress(KeyAscii As Integer)
    '''04/08/2017 kenyo. Cobra Mesa Con Enter

    Dim buf   As String

    Dim found As String

    If KeyAscii = 13 Then
  
        If cmytablex.RecordCount = 0 Then Exit Sub
        If Me.Picture2.Visible = False Then Exit Sub
    
        '''' 25/07/2018 Delivery y Para Llevar desde mozo
        ' Mesas Nombre 21/05/2018
        '24/08/2018  Delivery por mesa
        '    Dim rpta As String
        '    rpta = busca_clienteDeliveryXmesa(cmytablex.Fields("salon"), extra_loquesea(cmytablex.Fields(1)))
        '
        '    If Len(rpta) > 0 Then
        '        dcodigo = rpta
        '        busca_codigod
        '    End If
        '24/08/2018  Delivery por mesa
        ' Mesas Nombre 21/05/2018
        '''' 25/07/2018 Delivery y Para Llevar desde mozo
    
        buf = "Salon " & cmytablex.Fields("salon")
        buf = buf & glomesa & " " & extra_loquesea(cmytablex.Fields(1))
       
        If MsgBox("Desea Cobrar " & buf, 1, "Cobrar Comanda ") <> 1 Then Exit Sub
    
        ''''21/09/2017 kenyo Mejora  cobranza de mesas
        frmClientesRUC.Visible = False
        ''''21/09/2017 kenyo Mejora  cobranza de mesas
    
        found = carga_comanda(0)

        If found = 0 Then
            MsgBox "No se Puede Cobrar,No existen Comandas ", 48, "Aviso"
            Exit Sub

        End If

        salon.Caption = "" & cmytablex.Fields("salon")
    
        ' 25/07/2018 Delivery y Para Llevar desde mozo
    
        ' mesa.Caption = "" & cmytablex.Fields(1)
        mesa.Caption = "" & extra_loquesea(cmytablex.Fields(1))
        ' 25/07/2018 Delivery y Para Llevar desde mozo
    
        flag_servicio = "C"
        proceso_cobross
        Exit Sub

    End If

    '''04/08/2017 kenyo. Cobra Mesa Con Enter
    
End Sub

'24/08/2018  Delivery por mesa
Private Sub table2_RowColChange(LastRow As Variant, ByVal LastCol As Integer)

    'If table2.Row >= 4 Then Exit Sub
    nombre = ""
    codigo = ""

    If table2.Row >= 0 Then
        If Trim(table2.columns(0)) = "DE" Or Trim(table2.columns(0)) = "LL" Then

            codigo = extrae_datos_codnombre(1, Trim(table2.columns(0)), Trim(extra_loquesea(table2.columns(1))))
            nombre = extrae_datos_codnombre(2, Trim(table2.columns(0)), Trim(extra_loquesea(table2.columns(1))))
    
            If codigo = "" And Len(nombre) > 0 Then
                codigo = "000000"

            End If

        End If

    End If
  
End Sub

'24/08/2018  Delivery por mesa
  
Private Sub timerInternet_Timer()

    If CBool(Online()) Then
        vInternet = 1
        btnCon.BackColor = &H80FF80
        btnCon2.BackColor = &H80FF80
    Else
        vInternet = 0
        btnCon.BackColor = &HC0&
        btnCon2.BackColor = &HC0&

    End If

End Sub

Private Sub btnCon_Click()

    If vInternet = 0 Then MsgBox "No tiene internet en estos momentos": Exit Sub
    If Trim$(Len(codigo.Text)) = 11 Then
        If vInternet = 1 Then
            Call BUSCARRUC

        End If

    Else
        MsgBox "Ingrese ruc correctamente o minimo 11 caracteres"

    End If

End Sub

Private Sub btnCon2_Click()
    codigo = xruc
    btnCon_Click

    'If vInternet = 0 Then MsgBox "No tiene internet en estos momentos": Exit Sub
    'If Trim$(Len(xruc.Text)) = 11 Then
    '    If vInternet = 1 Then
    '        Call BUSCARRUC2
    '    End If
    'Else
    '    MsgBox "Ingrese ruc correctamente o minimo 11 caracteres"
    'End If
End Sub

Private Sub buffer_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 And KeyAscii <> 27 Then Exit Sub
    If KeyAscii = 27 Then
        'If opcion1 = "1" Then
        '   losao94_Click
        'End If
        losao94_Click
        Exit Sub

    End If

    Command1_Click

End Sub

Private Sub cajero_Click()
    dki3432_Click

End Sub

Private Sub clasesunat_Click()

    Dim found As Integer

    found = sumar_detalle()

    If Len(codigo) > 0 Then
        found = busca_codigo_descuento("" & codigo)

        If found = 1 Then
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1

            If DBGrid2.Enabled = True Then
                DBGrid2.SetFocus

            End If

            Exit Sub

        End If

    End If

End Sub

Private Sub cmdCobrar_Click()

    '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017
    If Frame5.Visible = True Then
        MsgBox "Seleccione precio", vbCritical
        Exit Sub

    End If
    
    'inicio 21/11/2017
    If Val(rtxtotal) >= 700 And codigo = "" Then
        frmClientesRUC.Visible = True
        Exit Sub

    End If

    'fin 21/11/2017
    '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017

    'Validación emisión de Factura Electronica
    If Len(codigo) > 0 And Len(nombre) = 0 Then
        frmClientesRUC.Visible = True
        MsgBox "Ingrese nombre ", 48, "Aviso"
        nombre.SetFocus
        Exit Sub

    End If
    
    'Validación emisión de Factura Electronica

    Dim buf   As String

    Dim found As String

    If Picture2.Visible = False Then  ' Cobro Para llevar Directo
        If Len(Trim(axcnumero)) > 0 Then
            If Val(axctotal) < Val(rtxtotal) Then
                MsgBox "Total a Cuenta no debe ser mayor que saldo ", 48, "Aviso"
                Exit Sub

            End If

        End If

        If Val(hknumero) < Val(rtxtotal) And Val(hknumero) > 0 Then
            MsgBox "Valores deben ser mayor de la venta ", 48, "Aviso"
            Exit Sub

        End If
        
        '''03/08/2017 kenyo. Correcion de total y cantidad 0
        ' If (hknumero.Caption = "" And Val(rtxtotal) <> 0)  Then
        ' hknumero = Val(rtxtotal)
        ' End If
            
        If (hknumero.Caption = "" And Val(rtxtotal) <> 0) Or (Val(hknumero) = 0) Then
            If Val(rtxtotal) > 0 Then
                hknumero = Val(rtxtotal)

            End If
         
        End If

        '''03/08/2017 kenyo. Correcion de total y cantidad 0
        
        cmdCobrar.Enabled = False
      
        ''08/07/2017 KENYO Correccion delivery
        If Trim("" & mytable11.Fields("obligavdelivery")) = "S" Or Trim("" & mytable11.Fields("obligavdelivery")) = "" Then
            If flag_servicio = "D" And vendedor = "VEND." Then
                consulta_xvendedor
                Exit Sub

            End If

        End If

        ''08/07/2017 KENYO Correccion delivery
        proceso_cierre_efectivo
        cmdCobrar.Enabled = True

    End If

    If Picture2.Visible = True Then  ' Cobro de mesa seleccionada
    
        'On Error GoTo cm89222_err
        If cmytablex.RecordCount = 0 Then Exit Sub
        If Me.Picture2.Visible = False Then Exit Sub
        'xopcioness_Click (16)
        buf = "Salon " & cmytablex.Fields("salon") '& Chr$("impuesto") & Chr$("neto")
    
        ' 25/07/2018 Delivery y Para Llevar desde mozo
        'buf = buf & glomesa & " " & cmytablex.Fields(1)
        buf = buf & glomesa & " " & extra_loquesea(cmytablex.Fields(1))
        ' 25/07/2018 Delivery y Para Llevar desde mozo
       
        If Val(hknumero) < Val(table2.columns(2)) And Val(hknumero) > 0 Then
            MsgBox "Valores deben ser mayor de la venta ", 48, "Aviso"
            Exit Sub

        End If
        
        If MsgBox("Desea Cobrar " & buf, 1, "Cobrar Comanda ") <> 1 Then Exit Sub
        found = carga_comanda(0)

        If found = 0 Then
            MsgBox "No se Puede Cobrar,No existen Comandas ", 48, "Aviso"
            Exit Sub

        End If
    
        ''' 14/11/2017 Correccion de Efectivo en Cobranza de mesa
        cmdCobrar.Enabled = False
        ''' 14/11/2017 Correccion de Efectivo en Cobranza de mesa
        
        '10/08/2018 Bloquear opciones por rapidez de efectivo
        xopciones(16).Enabled = False
        table2.Enabled = False
        ChaEstado(35).Enabled = False
        image3.Enabled = False
        '10/08/2018 Bloquear opciones por rapidez de efectivo
   
        If hknumero.Caption = "" And Val(rtxtotal) <> 0 Then
            hknumero = Val(rtxtotal)

        End If
        
        salon.Caption = "" & cmytablex.Fields("salon")
    
        ' 25/07/2018 Delivery y Para Llevar desde mozo
        'mesa.Caption = "" & cmytablex.Fields(1)
        mesa.Caption = "" & extra_loquesea(cmytablex.Fields(1))
        ' 25/07/2018 Delivery y Para Llevar desde mozo
    
        'cproven = cmytablex.Fields("vendedor")
    
        ' 25/07/2018 Delivery y Para Llevar desde mozo
        Dim found3 As Integer

        Dim buf3   As String

        V_EstadoMesa = "" & busca_tipoSalon(extra_loquesea(cmytablex.Fields(0)))
        ' 25/07/2018 Delivery y Para Llevar desde mozo

        flag_servicio = "C"
        proceso_cierre_efectivo
        ''' 14/11/2017 Correccion de Efectivo en Cobranza de mesa
        cmdCobrar.Enabled = True
        ''' 14/11/2017 Correccion de Efectivo en Cobranza de mesa
    
        '10/08/2018 Bloquear opciones por rapidez de efectivo
        xopciones(16).Enabled = True
        table2.Enabled = True
        ChaEstado(35).Enabled = True
          
        image3.Enabled = True
        '10/08/2018 Bloquear opciones por rapidez de efectivo
        
        Exit Sub

    End If

End Sub

Sub pedido_reposicion() 'sirva para que ingresen lo que necesitan que repongan

    Dim mytablex As New ADODB.Recordset

    Dim mytabley As New ADODB.Recordset

    Dim sdx      As Double

    Dim rs

    Dim i        As Integer

    Dim xcongela As String

    Dim sw       As Integer

    sdx = Val("" & mytable11.Fields("congela")) + 1
    xcongela = "" & sdx

denuevo13:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM crequisa where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='01' and serie='Q' and numero='" & xcongela & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        sdx = Val(xcongela) + 1
        xcongela = "" & sdx
        GoTo denuevo13

    End If

    'mytable11.Edit
    mytable11.Fields("congela") = xcongela
    mytable11.Update
    mytablex.AddNew
    mytablex.Fields("codigo") = Trim("" & mytable11.Fields("local"))
    mytablex.Fields("local") = Trim("" & mytable11.Fields("local"))
    mytablex.Fields("serie") = "01"
    mytablex.Fields("tipo") = "Q"
    mytablex.Fields("numero") = xcongela
    mytablex.Fields("fecha") = Format(dia, "dd/mm/yyyy")
    mytablex.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))
    mytablex.Fields("paridad") = Val(paridad)
    mytablex.Fields("dias") = 1
    mytablex.Fields("acu") = "Q"
    mytablex.Fields("estado") = "2"
    mytablex.Fields("bodega") = Trim("" & mytable11.Fields("bodega"))
    mytablex.Fields("caja") = "" & caja
    mytablex.Fields("nombre") = "" & busca_local_pedido(Trim("" & mytable11.Fields("local")))
    mytablex.Fields("tipoclie") = "V"
    mytablex.Fields("turno") = "" & turno
    mytablex.Fields("usuario") = "" & cajero
    mytablex.Fields("hora") = Format(Now, "hh:MM:SS")
    mytablex.Fields("total") = Val("" & txtotal)
    mytablex.Update
    mytablex.Close
    '---ahora grabano detalle
ak12:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM drequisa where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='01' and serie='Q' and numero='" & xcongela & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        mytablex.Delete
        GoTo ak12

    End If

    Set rs = Data2.Recordset.Clone
    Do

        If rs.EOF Then Exit Do
        mytablex.AddNew

        For i = 0 To rs.Fields.count - 1
            mytablex.Fields(i) = rs.Fields(i)
        Next i

        mytablex.Fields("local") = Trim("" & mytable11.Fields("local"))
        mytablex.Fields("serie") = "01"
        mytablex.Fields("tipo") = "Q"
        mytablex.Fields("numero") = "" & xcongela
        mytablex.Fields("vendedor") = ""
        mytablex.Fields("codigo") = Trim("" & mytable11.Fields("local"))
        mytablex.Fields("local") = Trim("" & mytable11.Fields("local"))
        mytablex.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))
        mytablex.Fields("bodega") = Trim("" & mytable11.Fields("bodega"))
        mytablex.Fields("bodegaf") = ""
        mytablex.Fields("acu") = "Q"
        mytablex.Fields("acu1") = ""
        mytablex.Fields("flage") = ""
        mytablex.Fields("tipoclie") = "V"
        mytablex.Fields("codigo") = ""
        mytablex.Fields("caja") = "" & caja
        mytablex.Fields("turno") = "" & turno
        mytablex.Fields("usuario") = "" & cajero
        mytablex.Fields("fecha") = Format(dia, "dd/mm/yyyy")
        mytablex.Fields("hora") = Format(Now, "hh:MM:SS")
        'mytablex.Fields("fechacrea") = Format(horaentrega, "hh:MM:SS")
        mytablex.Fields("fechacrea") = Format(Now, "dd/mm/yyyy")
    
        mytablex.Update
        rs.MoveNext
    Loop
    mytablex.Close

End Sub

Private Sub coclasifica_Click()

    If coclasifica <> "%" Then
        clasificacion = extra_loquesea(coclasifica)

    End If

End Sub

Private Sub codigo_KeyPress(KeyAscii As Integer)

    Dim found As Integer

    If KeyAscii <> 13 And KeyAscii <> 27 Then Exit Sub
    If KeyAscii = 27 Then
        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus
        Exit Sub

    End If

    found = sumar_detalle()

    If Len(codigo) > 0 Then
        found = busca_codigo_descuento("" & codigo)

        If found = 1 Then
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus
            Exit Sub

        End If

    End If

    nombre.SetFocus

End Sub

Private Sub Codigo_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H76 Then  'f7
        tnclie.DBPROV = "clientes"
        tnclie.fdlo893.Visible = True
        tnclie.Show 1

    End If

    If KeyCode = &H70 Then  'f1
        consulta_cliente1
        frmClientesRUC.Visible = False

    End If

End Sub

Sub slq_consultax()

    Dim buf As String

    buf = "select Nombre,Codigo,Direccion,Distrito,Fechanac from clientes  where nombre  like '%" & buffer & "%'"
    Data1.Connect = "foxpro 2.5;"
    Data1.DatabaseName = globaldir
    Data1.RecordSource = buf
    Data1.refresh

    If Data1.Recordset.EOF = True And Data1.Recordset.BOF = True Then
        Data1.Recordset.Close
        buffer = ""

    End If

    dbGrid1.columns(0).Width = 4000
    dbGrid1.columns(1).Width = 2000
    dbGrid1.SetFocus

End Sub

Sub ir_hasta_ultimo(rcconsulta As ADODB.Recordset)

    On Error GoTo cmd789111_err

    rcconsulta.MoveLast
    'dbGrid1.Col = 0
    'dbGrid1.Row = dbGrid1.VisibleRows - 1
    'dbGrid1.SetFocus
 
    Exit Sub
cmd789111_err:
    MsgBox "Aviso en ir ultimo " + error$, 48, "Aviso"
    Exit Sub

End Sub

Private Sub Command1_Click()

    Dim found As Integer

    found = sql_consulta(1)

End Sub

Private Sub Command10_Click()

    If Len(telefono) > 0 Or Len(nombre) > 0 Or Len(ddireccion) > 0 Or Len(fechanac) > 0 Or Len(codigo) > 0 Then
        MsgBox "Existen Campos", 48, "Aviso"
        Exit Sub

    End If

    Frame2.Visible = False
    'tiposervicio1 = "Autoservicio"
    'flag_servicio = "A"
    DBGrid2.SetFocus

End Sub

Private Sub Command11_Click()
    fechanac_KeyPress 13

End Sub

Private Sub Command12_Click()
    inicializa_deliveri
    telefono.SetFocus

End Sub

Private Sub Command13_Click()

    Dim found As Integer

    Dim sw    As Integer

    Dim sdx   As Double

    'inicio 01/06/2017  KENYO APARECE EN CONGELA NOMBRE DE CLIENTE PARA DESCONGELAR
    opcioncongela = 1
    'fin 01/06/2017  KENYO APARECE EN CONGELA NOMBRE DE CLIENTE PARA DESCONGELAR

    If MonthView1.Visible = True Then
        MonthView1.Visible = False

    End If

    If Len(pedido) = 0 Then  'si no es modificacion
        found = valida_total()

        If found = 0 Then
            MsgBox "Campos invalidos", 48, "Aviso"
            Exit Sub

        End If

    End If

    ndetraccion = ""
   
    'MsgBox exisdev
   
    ''''12/09/2017 kenyo Total Venta 0 Exonerado
    'If Val(txtotal) = 0 Then
    '  If exisdev <> -10 Then  'si existe devolucion
    '
    '      dbgrid2.SetFocus
    '      Exit Sub
    '   End If
    'End If
    ''''12/09/2017 kenyo Total Venta 0 Exonerado
   
    'If Val(tdetra) > 0 Then
    '   sdx = Val("" & mytable11.Fields("detraccion")) + 1
    '   ndetraccion = "" & sdx
    'End If
   
    ''    '27/08/2018 Producto delivery automatico
    ''    '''' 25/07/2018 Delivery y Para Llevar desde mozo
    ''    Dim rpta As String
    ''    rpta = "" & busca_clienteDeliveryXmesa(cmytablex.Fields("salon"), extra_loquesea(cmytablex.Fields(1)))
    ''     If Len(rpta) > 0 Then
    ''        dcodigo = rpta
    ''    End If
    ''    '''' 25/07/2018 Delivery y Para Llevar desde mozo
    ''    '27/08/2018 Producto delivery automatico
    
    If Len(nombre) > 0 Or Len(xnombre) > 0 Then
        'If local1.Visible = False Then  'si no es traslado locales
        'inicio 27/04/2017 kenyo
        
        If Frame7.Visible = True Then
            xruc = Trim(xruc.Text)
            xnombre = Trim(xnombre.Text)
            xdireccion = Trim(xdireccion.Text)
       
        Else
            xruc = Trim(codigo.Text)
            xnombre = Trim(nombre.Text)
            xdireccion = Trim(ydireccion.Text)
            correo = Trim(correo.Text)

        End If
   
        '''' 17/07/2018 Factura de Exportación
        'If busca_OpcionExportacion = "N" Then
        
        '24/08/2018 No guarda clientes para llevar
        If "" & xruc = "" Then
            xruc = "000000"

        End If
        
        '24/08/2018 No guarda clientes para llevar
        
        graba_cliente_tipo ("" & xruc) 'ojo graba con el correlativo

        '    End If
        '''' 17/07/2018 Factura de Exportación
        'End If
    End If

    If Len(pedido) > 0 Then
        xtipo = "P"
        xserie = "P"
        xnumero = "" & pedido

    End If

    cgusuario = gocabeza
    dgusuariog = godetalle

    If Len(flag_servicio) = 0 Then
        MsgBox "No existe servicio seleccionado ", 48, "Aviso"
        Exit Sub

    End If

    'If flag_servicio = "C" Or flag_servicio = "A" Or flag_servicio = "D" Then
   
    found = busca_numero(xtipo, xserie, xnumero) 'busca numero libre
   
    If found = -1 Then  'si es boleta o factura manual
        xnumero.SetFocus
        Exit Sub

    End If
   
    opcion1 = "0"
    'If local1.Visible = True Then
    '   opcion1 = "9999"
    'End If
     
    Frame7.Enabled = False
    'DBGrid2.Enabled = False
    DBGrid2.Enabled = False
    Command13.Enabled = False
 
    adiciona_deliveri xtipo, xserie, xnumero

    DBGrid2.Enabled = True
    Command13.Enabled = True
    Frame7.Enabled = True
    Framefp.Enabled = False
    'Command14_Click
   
    'inicio KENYO 27/04/2017 desabilitar cerrado automatio
    'Command6_Click
    'FIN KENYO 27/04/2017 desabilitar cerrado automatio

    limpia_general
    Me.frmClientesRUC.Visible = False

End Sub

Function notacreditonegativo(bxtipo As String, bxserie As String, bxnumero As String)

End Function

Private Sub Command14_Click()

    If MonthView1.Visible = True Then
        MonthView1.Visible = False
        fechae.SetFocus
        Exit Sub

    End If
   
    Frame7.Visible = False
    habilita_lab7 0
    Framefp.Enabled = True
    dbgrid10.Enabled = True

    If "" & mytable11.Fields("terminal") = "T" Then
        DBGrid2.Enabled = True
        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus
        Exit Sub

    End If

    If Framefp.Visible = False Then
        DBGrid2.Enabled = True
        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus
        Exit Sub

    End If

    dbgrid10.Visible = True
    dbgrid10.Enabled = True
    dbgrid10.SetFocus

End Sub

Private Sub Command15_Click()

    ''Dim found As Integer
    ''On Error GoTo cmd9432_err
    ''suma_controlespeso
    '''If Val(xpesoneto) = 0 Then Exit Sub
    ''Data2.Recordset.Edit
    ''Data2.Recordset.Fields("cantidad") = Val("" & xpesoneto)
    ''Data2.Recordset.Update
    ''found = sumar_detalle()
    ''Frame11.Visible = False
    ''
    ''Exit Sub
    ''cmd9432_err:
    ''Exit Sub
End Sub

Private Sub Command16_Click()

    On Error GoTo cmd903412_err

    mytablepeso.Delete
    suma_controlespeso
    Exit Sub
cmd903412_err:
    MsgBox "Seleccione un dato ", 48, "Aviso"
    Exit Sub

End Sub

Private Sub Command2_Click()
    Frame6.Visible = False
    habilita_lab7 0
    dbgrid10.Enabled = True
    dbgrid10.SetFocus

End Sub

Private Sub Command3_Click()

    tcampo5_KeyPress 13

End Sub

Private Sub Command4_Click()
    DBGrid4_KeyDown 13, 0
    hknumero.Caption = ""

End Sub

Private Sub Command6_Click()

    'INCIO 27/04/2017 KENYO HABILITAR CERRAR
    If Frame7.Visible = True Then Exit Sub
    losao94_Click

End Sub

Private Sub Command7_Click()

End Sub

Private Sub Command8_Click()
    'If Frame1.Visible = True Then
    '   Frame5.Visible = False
    '   dbGrid1.SetFocus
    '   Exit Sub
    'End If
 
    DBGrid4_KeyDown 27, 0
 
    'Frame5.Visible = False
    'DBGrid2.Col = 0
    'DBGrid2.Row = dbgrid2.visiblerows - 1
    'DBGrid2.SetFocus
End Sub

Private Sub Command9_Click()

    'Frame11.Visible = False
End Sub

Private Sub d892323_Click()

    Dim found As Double

    flag_clave1 = 0
    tconcla.X = "CUADRE"
    tconcla.Show 1

    If flag_clave1 <> 1 Then  'si es descongela
        Exit Sub

    End If

    found = suma_las_ventas()
    MsgBox "VENTAS ACUMULADAS ..." & Format(found, "0.00"), 48, "AVISO"
    cmdCobrar.Enabled = True
    cmdCobrar.Caption = "EFECTIVO"
    
    ''03/07/2017 KENYO Correcion Billetes Cuadre Rapido
    cmd50.Enabled = True
    cmd50.Caption = "50"
        
    cmd100.Enabled = True
    cmd100.Caption = "100"
      
    cmd200.Enabled = True
    cmd200.Caption = "200"
    ''03/07/2017 KENYO Correcion Billetes Cuadre Rapido
         
End Sub

Function suma_las_ventas() As Double

    Dim mysnapx As New ADODB.Recordset

    Dim buf     As String

    'MsgBox gocabeza
    buf = "select sum(total) as TOT from " & gocabeza & " where "
    buf = buf & "  fecha>='" & Format(dia, "YYYYMMDD") & "'"
    buf = buf & " and fecha<='" & Format(dia, "YYYYMMDD") & "' "

    'buf = buf & " fecha>=" & "DateValue('" & dia & "'" & ")"
    'buf = buf & " and fecha<=" & "DateValue('" & dia & "'" & ")"
    buf = buf & " and estado='2' "
    buf = buf & " and usuario='" & cajero & "'"
    buf = buf & " and caja='" & caja & "'"
    buf = buf & " and turno='" & turno & "'"
    'MsgBox buf

    mysnapx.Open buf, cn, adOpenStatic, adLockOptimistic

    If mysnapx.RecordCount > 0 Then
        'Set mysnapx = mydbxglo.CreateSnapshot(buf)
        suma_las_ventas = Val("" & mysnapx.Fields("TOT"))

    End If

    mysnapx.Close

End Function

Private Sub d8do82_Click()

    Dim sw As Integer

    flag_clave1 = 0
    tconcla.X = "CUADRE"
    tconcla.Show 1

    If flag_clave1 <> 1 Then  'si es descongela
        DBGrid2.SetFocus
        Exit Sub

    End If
    
    opcion1 = "4"
    opcion2 = "1"
    opcion3 = "2"
    tcuadrc1.fechai.Enabled = True
    tcuadrc1.fechaf.Enabled = True
    usuariopos = gusuario
    tcuadrc1.cajero = usuariopos
    tcuadrc1.caja = caja
    tcuadrc1.turno = turno
    tcuadrc1.horai = "01"
    tcuadrc1.horaf = "24"
    tcuadrc1.fechai = dia
    tcuadrc1.fechaf = dia
    tcuadrc1.Caption = "PRODUCTOS VS DOCUMENTOS"
    tcuadrc1.check3d1.Visible = True
    tcuadrc1.check3d2.Visible = True
    tcuadrc1.check3d3.Visible = True
    tcuadrc1.Show 1
    
End Sub

Function borrar_pedidoventa()

    On Error GoTo cmd989900_err

    cn.Execute ("delete from dpedidov where local='" & Trim(dbGrid1.columns("local")) & "' and tipo='" & Trim(dbGrid1.columns("tipo")) & "' and serie='" & Trim(dbGrid1.columns("serie")) & "' and numero='" & Trim(dbGrid1.columns("numero")) & "'")
    cn.Execute ("delete from cpedidov where local='" & Trim(dbGrid1.columns("local")) & "' and tipo='" & Trim(dbGrid1.columns("tipo")) & "' and serie='" & Trim(dbGrid1.columns("serie")) & "' and numero='" & Trim(dbGrid1.columns("numero")) & "'")

    Exit Function
cmd989900_err:
    MsgBox "Aviso en borrar pedidoventa " + error$, 48, "Aviso"
    Exit Function

End Function

Function ir_ultimo_registrox()

    On Error GoTo cmd7800_err

    Data2.Recordset.MoveLast
    ir_ultimo_registrox = 1
    Exit Function
cmd7800_err:
    Exit Function

End Function

Sub borrar_data1()

    On Error GoTo cmd672222_err

    Data1.Recordset.Delete
    Exit Sub
cmd672222_err:
    Exit Sub

End Sub

Function borra_data9()

    On Error GoTo cmd9000_err

    Data9.Recordset.MoveLast
    Data9.Recordset.Delete
    Data9.refresh
    borra_data9 = 1
    Exit Function
cmd9000_err:
    Exit Function

End Function

Private Sub DBGrid1_KeyPress(KeyAscii As Integer)

    Dim buf   As String

    Dim found As Integer

    If KeyAscii <> 13 And KeyAscii <> 27 Then
        If KeyAscii = 8 Then
            If Len(buffer) > 0 Then
                buf = Mid$(buffer, 1, Len(buffer) - 1)
                buffer = buf
                KeyAscii = 0
            Else
                KeyAscii = 0
                Exit Sub

            End If

        End If

        buf = Chr(KeyAscii)

        If Chr(KeyAscii) = "*" Then
            buf = ""
            buffer = buf

        End If

        If KeyAscii <> 13 Then
            buffer = buffer + buf

        End If

        buf = buffer
        found = sql_consulta(0)
         
    End If

End Sub

Private Sub dbgrid1_KeyUp(KeyCode As Integer, Shift As Integer)

    '-------------
    Dim buf   As String

    Dim buf2  As String

    Dim sw    As Integer

    Dim found As Integer

    On Error GoTo cmd918_err

    'MsgBox ""
    If opcion1 = "8" Then
        'MsgBox "" & dbGrid1.Columns(1)
        pone_precios "" & rcconsulta.Fields("producto")

    End If

    'If KeyCode <> 13 And KeyCode <> 27 Then
    '          If KeyCode = 32 Then
    '             GoTo sigue9
    '          End If
    '          If KeyCode >= 48 And KeyCode <= 57 Then
    '             GoTo sigue9
    '          End If
    '          If KeyCode >= 65 And KeyCode <= 90 Then
    '             GoTo sigue9
    '          End If
    '          If KeyCode >= 97 And KeyCode <= 122 Then
    '             GoTo sigue9
    '          End If
    '          If KeyCode = 8 Or Chr(KeyCode) = "*" Then
    '             GoTo sigue9
    '          End If
    '          Exit Sub
    'sigue9:
    '          If KeyCode = 8 Then
    '            If Len(buffer) > 0 Then
    '               buf = Mid$(buffer, 1, Len(buffer) - 1)
    '               buffer = buf
    '               KeyCode = 0
    '               Else
    '               KeyCode = 0
    '               Exit Sub
    '            End If
    '         End If
    '         buf = Chr(KeyCode)
    '         If Chr(KeyCode) = "*" Then
    '            buf = ""
    '            buffer = buf
    '         End If
    '         If KeyCode <> 13 Then
    '            buffer = buffer + buf
    '         End If
    '
    '         buf = buffer
    '         found = sql_consulta(0)
    '         If found = 0 Then
    '            found = sql_consulta(1)
    '         End If
    'Exit Sub
    'End If
    Exit Sub

cmd918_err:
    MsgBox "Aviso en dbgridKeyup " + error$, 48, "Aviso"
    Exit Sub

End Sub

Private Sub DBGrid10_KeyDown(KeyCode As Integer, Shift As Integer)

    Dim ind   As Integer

    Dim found As Integer

    On Error GoTo cmd8911_err

    If KeyCode = &H2E Then  'borrar linea
        found = borra_data9()

        If found = 0 Then
            dbgrid10.Enabled = True
            dbgrid10.SetFocus
            Exit Sub

        End If

        Exit Sub

    End If

    If KeyCode <> 13 And KeyCode <> 27 Then Exit Sub
    If KeyCode = 27 Then
        'losao94_Click
        Framefp.Visible = False
        habilita_lab7 1

        If flag_servicio = "C" Then
            inicialIzatodo

        End If

        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus
        Exit Sub

    End If

    suma_fpagov

    If Label45.Caption = "Vuelto" Or Val(stxtotals) = 0 Then
        'If MsgBox("Desea Grabar", 1, "Aviso") <> 1 Then Exit Sub
        'if len()
        xtipo = protipo

        If "" & mytable11.Fields("habilitanota") = "S" Then
            If Val(ttxtotals) <= Val("" & mytable11.Fields("siventa")) Then
                ''''12/09/2017 kenyo Total Venta 0 Exonerado
                'xtipo = "5"
                xtipo = ""
                ''''12/09/2017 kenyo Total Venta 0 Exonerado
                   
            End If

        End If

        'xruc = codigo
        'xnombre = nombre
        xvendedor = cproven
           
        Frame7.Visible = True
        habilita_lab7 1
        Framefp.Enabled = False

        If flag_servicio <> "A" And flag_servicio <> "C" And flag_servicio <> "D" Then
            xtipo = "5"

        End If

        xtipo.SetFocus
        Exit Sub

    End If

    saldoabo = ""
    acufp = "" & dbgrid10.columns(3)
    Frame6.Caption = "" & dbgrid10.columns(0)

    fpago = "" & dbgrid10.columns(1)

    '13/08/2018 Integración FE - Pizzeria
    ''' 16/07/2018 Clave en forma de pago
    'If fpago = "1" Then
    If (busca_ConfigFPago(fpago)) = True Then
        flag_clave1 = 0
        tconcla.X = "FORMAPAGO"
        tconcla.Show 1

        If flag_clave1 <> 1 Then
            Exit Sub

        End If

    End If

    'End If
    ''' 16/07/2018 Clave en forma de pago
    '13/08/2018 Integración FE - Pizzeria

    fpmoneda = "" & dbgrid10.columns(2)
    dbgrid10.Enabled = False
    Frame3.Visible = False
    RGPAGO = ""

    If fpmoneda = "S" Then

        'RGPAGO = ttxtotals
    End If

    If fpmoneda = "D" Then

        'RGPAGO = ttxtotald
    End If

    'If "" & dbgrid10.columns(3) = "A" Or "" & dbgrid10.columns(3) = "B" Or "" & dbgrid10.columns(3) = "E" Or "" & dbgrid10.columns(3) = "U" Then  'efectivo,dolares,euros
    '   macro_inserta_registro
    '   DBGrid9.Row = DBGrid9.VisibleRows - 1
    '   DBGrid9.Col = 2
    '   DBGrid9.SetFocus
    '   Exit Sub
    'End If
    If "" & dbgrid10.columns(3) = "A" Or "" & dbgrid10.columns(3) = "B" Or "" & dbgrid10.columns(3) = "E" Or "" & dbgrid10.columns(3) = "U" Then  'efectivo,dolares,euros
        Frame3.Visible = True
        macro_credito 5
        RGPAGO.SetFocus

        'tcampo1.SetFocus
    End If

    If "" & dbgrid10.columns(3) = "C" Then   'credito
        macro_credito 3
        RGPAGO.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "D" Then   'tarejta credito
        macro_credito 4
        tcampo1.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "F" Then   'TARJETA DEBITO
        macro_credito 5
        tcampo1.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "G" Then   'letra
        macro_credito 0
        tcampo1.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "H" Or "" & dbgrid10.columns(3) = "K" Then   'bancos
        macro_credito 2
        tcampo3.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "V" Then   'vales
        macro_credito 6
        tcampo1.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "I" Or "" & dbgrid10.columns(3) = "K" Then   'CRUCE CON ABONO EFECTIVO
        macro_credito 1
        tcampo1.Enabled = True
        tcampo1.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "J" Then   'vales
        macro_credito 8
        tcampo1.SetFocus

    End If

    Exit Sub
cmd8911_err:
    MsgBox error$, 48, "Aviso"
    Exit Sub

End Sub

Private Sub dbgrid13_AfterColUpdate(ByVal ColIndex As Integer)

    '''MsgBox ColIndex
    ''Select Case ColIndex
    ''Case 0
    '''dbgrid13.columns("producto") = Trim("" & DBGrid2.columns("producto"))
    ''Case 1
    ''Case 2
    ''dbgrid13.columns("pesoneto") = Val("" & dbgrid13.columns("pesobruto")) - Val("" & dbgrid13.columns("tara"))
    ''Case 3
    ''dbgrid13.columns("pesoneto") = Val("" & dbgrid13.columns("pesobruto")) - Val("" & dbgrid13.columns("tara"))
    ''Case 4
    ''dbgrid13.columns("pesoneto") = Val("" & dbgrid13.columns("pesobruto")) - Val("" & dbgrid13.columns("tara"))
    ''Case 5
    ''dbgrid13.columns("pesoneto") = Val("" & dbgrid13.columns("pesobruto")) - Val("" & dbgrid13.columns("tara"))
    ''End Select
    ''dbgrid13.columns("total") = Val("" & dbgrid13.columns("pesoneto")) * Val("" & dbgrid13.columns("precio"))
    ''dbgrid13.columns("producto") = Trim("" & DBGrid2.columns("producto"))
    '''dbgrid13.columns("precio") = Val("" & dbgrid2.columns("producto"))
    ''mytablepeso.Update
    ''suma_controlespeso
End Sub

Private Sub dbgrid13_BeforeColEdit(ByVal ColIndex As Integer, _
                                   ByVal KeyAscii As Integer, _
                                   Cancel As Integer)

    Select Case ColIndex

        Case 0

        Case 1

        Case 2

        Case 3

        Case 4

        Case 5

    End Select

End Sub

Private Sub dbgrid13_BeforeColUpdate(ByVal ColIndex As Integer, _
                                     OldValue As Variant, _
                                     Cancel As Integer)
    ''     Dim buf As Double
    ''     'MsgBox dbgrid2.columns("precio")
    ''     buf = Val("" & dbgrid13.columns(ColIndex))
    ''     'If Not IsNumeric(dbgrid13.columns(ColIndex)) Then
    ''        'MsgBox dbgrid13.columns(ColIndex)
    ''     '   MsgBox "Datos Numericos", 48, "Aviso"
    ''     '   Cancel = True
    ''     '   Exit Sub
    ''     'End If
    ''     dbgrid13.columns(ColIndex) = buf
    ''     dbgrid13.columns("producto") = Trim("" & DBGrid2.columns("producto"))
    ''     'dbgrid13.columns("precio") = Val("" & dbgrid2.columns("precio"))

End Sub

Private Sub DBGrid2_AfterColEdit(ByVal ColIndex As Integer)

    Dim found As Integer

    Select Case ColIndex

        Case 0

            If control_flujo = 1 Then
                found = sumar_detalle()
                DBGrid2.Col = 0
                DBGrid2.Row = DBGrid2.VisibleRows - 1
                DBGrid2.SetFocus
                control_flujo = 0

            End If

        Case 1
            'If Len("" & dbgrid2.columns("producto")) = 0 Then  'si ya existe no cambiar
            '   Cancel = True
            '   Exit Sub
            'End If
            
        Case 3

    End Select

End Sub
 
Private Sub dbgrid2_AfterColUpdate(ByVal ColIndex As Integer)

    Dim found As Integer

    Dim sdx   As Double

    Select Case ColIndex

        Case 0
            'found = busca_producto("" & DBGrid2.Columns(0), 0)
            'If found = 0 Then
            '   MsgBox "No existe producto", 48, "Aviso"
            '   Exit Sub
            'End If
            'If control_flujo = 1 Then
            '   MsgBox "Hola"
            'End If
            'MsgBox "Hola"
            'MsgBox "" & dbgrid2.Columns(0)
            'MsgBox "abc"
            found = busca_remate("" & DBGrid2.columns(0))

            If found = 1 Then
                DBGrid2.Col = 5
                ingreso_tallas "" & DBGrid2.columns("linea")
                Exit Sub

            End If

            '--------------------
            '--------------------
            If ver_si_puedo_dbgrid("" & DBGrid2.columns(0)) = 1 Then  'existe mas de un precio
                'MsgBox "abc"
                xproducto = "" & DBGrid2.columns(0)
                carga_dbgrid4 "" & DBGrid2.columns(0)
                swprecio = 1
               
                Exit Sub
               
            End If

            If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Len(Trim("" & DBGrid2.columns("linea"))) > 0 Then
                DBGrid2.Col = 3
                DBGrid2.SetFocus
                ingreso_tallas "" & DBGrid2.columns("linea")
                Exit Sub

            End If
            
            '' kenyo 02/11/2017 Configuración Productos Comentarios Obligatorios
            Dim mytablex As New ADODB.Recordset

            If mytablex.State = 1 Then mytablex.Close
            mytablex.Open "SELECT obligacomentario FROM producto where producto='" & DBGrid2.columns("producto") & "'", cn, adOpenDynamic, adLockOptimistic

            If mytablex.RecordCount > 0 Then
                If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And ("" & mytablex.Fields("obligacomentario")) = "S" Then
                    DBGrid2.Col = 0
                    DBGrid2.SetFocus
                    txobserv.Show 1

                End If

            End If

            mytablex.Close
            '' kenyo 02/11/2017 Configuración Productos Comentarios Obligatorios
            
            If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Trim("" & mytable11.Fields("obligavendedor")) = "S" Then
                DBGrid2.Col = 3
                DBGrid2.SetFocus
                carga_vendedorpp
                Exit Sub

            End If

            'If Len(dbgrid2.columns(0)) > 0 And Len(dbgrid2.columns(17)) > 0 Then
            'DBGrid2.Col = 3
            'ingreso_tallas "" & DBGrid2.Columns(17)
            'Exit Sub
            'End If
            '-------------------
            found = existe_fuel("" & DBGrid2.columns(0))

            If found = 1 Then
                'MsgBox ""
                DBGrid2.Col = 7
                DBGrid2.SetFocus
                Exit Sub

            End If
            
            'Combos Combinaciones 07/07/2018
            combinac = "N"

            Dim mytablezx As New ADODB.Recordset
        
            If Len(DBGrid2.columns(0)) = 0 Then
                Exit Sub

            End If

            If mytablezx.State = 1 Then mytablezx.Close
        
            mytablezx.Open "SELECT * FROM combina where producto='" & "" & DBGrid2.columns(0) & "'", cn, adOpenDynamic, adLockOptimistic

            If mytablezx.RecordCount > 0 Then
                combinac = "S"
                Do

                    If mytablezx.EOF Then Exit Do
                    DBGrid2.Col = 0
                    DBGrid2.SetFocus
                    DBGrid2.Row = DBGrid2.VisibleRows - 1
                    hknumero = mytablezx.Fields("cantidad")
                    busca_cod_producto mytablezx.Fields("productop"), 0
                    mytablezx.MoveNext
                Loop
                mytablezx.Close
                combinac = "N"

            End If

            'Combos Combinaciones 07/07/2018
            
            '-------------------
            found = sumar_detalle()

            If found = 0 Then
                'If "" & mytable11.Fields("noprecio") = "S" Then
                '   MsgBox "Error en Precio<=0", 48, "Aviso"
                DBGrid2.SetFocus
                Exit Sub

                'End If
            End If

            If swprecio = 1 Then
                DBGrid2.Col = 2
                DBGrid2.Row = DBGrid2.VisibleRows - 2
                'DBGrid2.SetFocus
                DBGrid4.SetFocus
                Exit Sub

            End If

            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus

        Case 1
            
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus

        Case 2
            'MsgBox "Hola"
            found = sumar_detalle()
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus

        Case 3
            'sdx = Val("" & DBGrid2.Columns("cantidad")) * Val("" & DBGrid2.Columns("precio"))
            'DBGrid2.Columns(9) = Val(Format(sdx, nrodecimal))
            'DBGrid2.Columns("total") = Val(Format(sdx, nrodecimal))
            'calcula_igv
            'ir_ultimo
            'MsgBox "Hola"
            found = sumar_detalle()
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus

        Case 5
            'sdx = Val("" & DBGrid2.Columns("cantidad")) * Val("" & DBGrid2.Columns("precio"))
            'DBGrid2.Columns(9) = Val(Format(sdx, nrodecimal))
            'DBGrid2.Columns("total") = Val(Format(sdx, nrodecimal))
            'calcula_igv
            found = sumar_detalle()
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus

        Case 6
            'sdx = Val("" & DBGrid2.Columns("cantidad")) * Val("" & DBGrid2.Columns("precio"))
            'DBGrid2.Columns(9) = Val(Format(sdx, nrodecimal))
            'DBGrid2.Columns("total") = Val(Format(sdx, nrodecimal))
            'calcula_igv
            found = sumar_detalle()
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus

        Case 7
            'If Val("" & DBGrid2.Columns("cantidad")) > 0 Then
            '   sdx = Val("" & DBGrid2.Columns("total")) / Val("" & DBGrid2.Columns("cantidad"))
            '   DBGrid2.Columns("precio") = Val(Format(sdx, nrodecimal))
            '   DBGrid2.Columns(9) = Val("" & DBGrid2.Columns("total"))
            '   calcula_igv
            found = sumar_detalle()
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus

            'End If
    End Select

    ''26/07/2017 kenyo hknumero
    hknumero = ""
    ''26/07/2017 kenyo hknumero

End Sub

Private Sub dbgrid2_BeforeColEdit(ByVal ColIndex As Integer, _
                                  ByVal KeyAscii As Integer, _
                                  Cancel As Integer)

    Dim found As Integer

    If ColIndex >= 14 Then
        Cancel = True
        Exit Sub

    End If

    Select Case ColIndex

        Case 2, 4, 8, 9, 10, 12, 11
            Cancel = True
            Exit Sub

        Case 0

            If Len("" & DBGrid2.columns(0)) > 0 Then  'si ya existe no cambiar
                Cancel = True
                Exit Sub

            End If
     
            'If opcion5 = 20 Then
            '   MsgBox "Hola"
            '   Cancel = True
            '   Exit Sub
            'End If
            'opcion5 = 0
     
        Case 2

            If Len("" & DBGrid2.columns(0)) = 0 Then  '
                Cancel = True
                Exit Sub

            End If

        Case 1

            If Len("" & DBGrid2.columns(0)) = 0 Then  '
                Cancel = True
                Exit Sub

            End If

        Case 3

            If Len("" & DBGrid2.columns(0)) = 0 Then  '
                Cancel = True
                Exit Sub

            End If

            'If Len("" & DBGrid2.Columns(17)) > 0 Then  'ojo no se puede poner si es talla
            '   Cancel = True
            '   Exit Sub
            'End If
        Case 5, 7, 13, 6

            If Len("" & DBGrid2.columns(0)) = 0 Then  '
                Cancel = True
                Exit Sub

            End If

            'MsgBox ""
     
    End Select

End Sub

Private Sub dbgrid2_BeforeColUpdate(ByVal ColIndex As Integer, _
                                    OldValue As Variant, _
                                    Cancel As Integer)

    Dim found  As Integer

    Dim sdx    As Double

    Dim xcampo As String

    Dim canti  As String

    Dim buf1   As String

    Dim buf    As String

    Dim bufy   As String

    Dim amount As String

    Dim xfound As String

    Dim xnbufx As Double

    Select Case ColIndex

            Dim mytablex As New ADODB.Recordset

        Case 0

            If Len(DBGrid2.columns(0)) = 0 Then
                'aqui vamos a valida si es el fin del pedido
                Cancel = True
                Exit Sub

            End If

            If Len(DBGrid2.columns(0)) > 15 Then
                'aqui vamos a valida si es el fin del pedido
                Cancel = True
                Exit Sub

            End If
     
            stkminimo = ""

            'MsgBox Label2
            If "" & mytable11.Fields("stkminimo") = "S" And Len(Trim(Label12)) = 0 Then
                mytablex.Open "SELECT * FROM producto where producto='" & "" & DBGrid2.columns(0) & "'", cn, adOpenDynamic, adLockOptimistic

                If mytablex.RecordCount > 0 Then
                    If familia_saldo("" & mytablex.Fields("familia")) = 0 Then
                        consulta_minimo "" & mytablex.Fields("producto"), "" & mytablex.Fields("minimo")

                    End If

                End If

                mytablex.Close

            End If
     
            If "" & mytable11.Fields("nosaldo") = "S" Then
                found = verifica_saldo_receta("" & DBGrid2.columns(0), 1)

                If found = 2 Then
                    MsgBox "Se detecto un saldo receta con saldo<=0 ", 48, "Aviso"
                    Exit Sub

                End If

                If familia_saldo("" & DBGrid2.columns("familia")) = 0 Then
                    If verifica_producto("" & DBGrid2.columns(0)) = 1 Then
                        If consulta_saldo("" & DBGrid2.columns(0), 1, 0) <= 0 Then
                            Cancel = True
                            DBGrid2.SetFocus
                            MsgBox "x.No existe saldo", 48, "Aviso"
                            Exit Sub

                        End If

                    End If

                End If

            End If

            canti = ""
            buf = UCase(DBGrid2.columns(0))  'se modifico en U. Union
            bufy = buf
            found = 0

            If "" & mytable11.Fields("flag") = "*" Then
                found = InStr(buf, "" & mytable11.Fields("flag"))

                If found > 1 Then  ' si es cantidad
                    xcampo = Mid$(buf, found + 1, Len(buf) - found)
                    canti = Mid$(buf, 1, found - 1)
                    buf1 = Val(canti)
                    buf = xcampo

                    If Len(buf) = 0 Then
                        Cancel = True
                        Exit Sub

                    End If

                    DBGrid2.columns(0) = buf

                End If

            End If

            'MsgBox buf
            'found = verifica_doble("" & DBGrid2.Columns(0))
            'If found = 1 Then
            '   Cancel = True
            '   MsgBox "Producto ya Seleccionado", 48, "Aviso"
            '   Exit Sub
            'End If
            '----validamos el saldo
         
            control_flujo = 0
            found = busca_producto(UCase("" & DBGrid2.columns(0)), 0, canti, 0)

            'found = busca_producto(buf, 0, canti)
            If found = 2 Then  'si es precio 0
                Cancel = True
                control_flujo = 1
                'MsgBox "No se pude realiza Operacion,continue..", 48, "Aviso"
                'DBGrid2.SetFocus
                Exit Sub

            End If

            If found = 0 Then
                Cancel = True
                'MsgBox "No existe producto", 48, "Aviso"
                'consulta_producto "" & DBGrid2.Columns(0)
                opcion5 = 1
                found = consulta_producto(bufy)

                If found = 1 Then
                    Cancel = True
                    opcion5 = 20
                    MsgBox "No existe producto", 48, "Aviso"
                    DBGrid2.SetFocus
                    'opcion5 = 20
                    'DBGrid2.Col = 0
                    'DBGrid2.Row = dbgrid2.visiblerows - 1
                    'DBGrid2.SetFocus
                    Exit Sub

                End If

                opcion5 = 0
                Exit Sub

            End If

            'carga_recetas
    
            buf = ""
            'If "" & mytable11.Fields("actbala") = "S" Then
            'If verifica_balanza("" & DBGrid2.Columns(0)) = "S" Then
        
            'ajk9:
            '       buf = puerto_balanza1()
            '       If Val(buf) = 0 Then
            '          If MsgBox("Balanza No leido,Continua Leyendo? ", 1, "Aviso") = 1 Then
            '             GoTo ajk9
            '             '------
            '             Else
            '
            '          End If
            '       End If
            '    End If
            '    End If
            '
            'If Val(buf) > 0 Then
            '----pro favor verficia
            'DBGrid2.Columns("cantidad") = Val(Mid$(Val(buf), 1, 5))
            'sdx = Val("" & DBGrid2.Columns("cantidad")) * Val("" & DBGrid2.Columns("precio"))
            'DBGrid2.Columns("total") = sdx
            'calcula_igv 0
            '-------------------
            'End If
            swprecio = 0
            Exit Sub

        Case 2

            If Len(DBGrid2.columns(0)) = 0 Then
                Cancel = True
                Exit Sub

            End If

            If Mid$("" & DBGrid2.columns(2), 1, 1) = "-" And Len("" & DBGrid2.columns(2)) > 1 Then
                'grabar_foto "" & Value
                Exit Sub

            End If

            found = valida_placa("" & DBGrid2.columns(17), Mid$("" & DBGrid2.columns(2), 1, 1))

            If found = 0 Then
                MsgBox "Placa invalida ", 48, "Aviso"
                Cancel = True
                Exit Sub

            End If

        Case 3

            If Len(DBGrid2.columns(0)) = 0 Then
                Cancel = True
                Exit Sub

            End If

            If Not IsNumeric("" & DBGrid2.columns("cantidad")) Then
                Cancel = True
                Exit Sub

            End If

            If Val(DBGrid2.columns("cantidad")) = 0 Then
                MsgBox "Cant=0", 48, "Aviso"
                Cancel = True
                Exit Sub

            End If
     
            If Val(DBGrid2.columns("cantidad")) < 0 Then  'devolucion
                flag_clave1 = 0
                tconcla.X = "N"
                tconcla.Show 1

                If flag_clave1 <> 1 Then  'si es descongela
                    Cancel = True
                    Exit Sub

                End If

                'MsgBox "Cant=0", 48, "Aviso"
                'Cancel = True
                'Exit Sub
            End If

            'MsgBox Val("" & DBGrid2.Columns("cantidad"))
     
            stkminimo = ""

            If "" & mytable11.Fields("stkminimo") = "S" And Len(Trim(Label12)) = 0 Then
                'If "" & mytable11.Fields("stkminimo") = "S" Then
                mytablex.Open "SELECT * FROM producto where producto='" & "" & DBGrid2.columns(0) & "'", cn, adOpenDynamic, adLockOptimistic

                If mytablex.RecordCount > 0 Then
                    If familia_saldo("" & mytablex.Fields("familia")) = 0 Then
                        consulta_minimo "" & mytablex.Fields("producto"), "" & mytablex.Fields("minimo")

                    End If

                End If

                mytablex.Close

            End If

            If "" & mytable11.Fields("nosaldo") = "S" Then
                found = verifica_saldo_receta("" & DBGrid2.columns(0), Val(DBGrid2.columns("cantidad")) * Val(DBGrid2.columns(4)))

                If found = 2 Then
                    MsgBox "Se detecto un saldo receta con saldo<=0 ", 48, "Aviso"
                    Exit Sub

                End If

                If familia_saldo("" & DBGrid2.columns("familia")) = 0 Then
                    If consulta_saldo("" & DBGrid2.columns(0), Val("" & DBGrid2.columns("cantidad")) * Val("" & DBGrid2.columns(4)), 1) <= 0 Then
                        Cancel = True
                        DBGrid2.SetFocus
                        MsgBox "No existe saldo Suficiente - ", 48, "Aviso"
                        Exit Sub

                    End If

                End If

            End If

            found = busca_unidad("" & DBGrid2.columns(0))

            If found = 1 Then
                amount = Format(Val("" & DBGrid2.columns("cantidad")), nrodecimal)

                If Val(Mid$(amount, Len(amount) - 1, 2)) > 0 Then
                    MsgBox "Solo Datos Exactos", 24, "LO SENTIMOS"
                    Cancel = True
                    Exit Sub

                End If

            End If

            'VERIFICAMOS SI ES CANTIDAD para poner que precio debe tener
            xnbufx = 0

            If "" & DBGrid2.columns("nroprecio") = "1" Then  'si me encuentro en el precio 1
                If Val("" & DBGrid2.columns("cantidad")) >= 1 Then
                    xnbufx = 0
                    found = verifica_ofertax("" & DBGrid2.columns(0), Val("" & DBGrid2.columns("cantidad")), xnbufx)

                    If found = 1 Then
                        DBGrid2.columns("precio") = xnbufx

                    End If

                End If

            End If

            'MsgBox "xx"
            sdx = Val("" & DBGrid2.columns("cantidad")) * Val("" & DBGrid2.columns("precio"))
            'MsgBox sdx
            DBGrid2.columns("total") = sdx
            calcula_igv 0

        Case 5

            If Len(DBGrid2.columns(0)) = 0 Then
                Cancel = True
                Exit Sub

            End If

            If Not IsNumeric(DBGrid2.columns("precio")) Then
                Cancel = True
                Exit Sub

            End If

            'MsgBox "hola"
            xfound = verifica_oferta("" & DBGrid2.columns(0))

            If xfound <> "S" Then   '
                If Val(DBGrid2.columns("precio")) <= 0 Then
                    If "" & mytable11.Fields("noprecio") = "S" Then
                        MsgBox "Precio <=0", 48, "Aviso"
                        Cancel = True
                        Exit Sub

                    End If

                End If

                'MsgBox "hello"
        
                ''''12/08/2017 kenyo Bloqueo de Cambio de Precio Teclado Virtual
                ''''12/08/2017 kenyo Bloqueo de Cambio de Precio Teclado Virtual
        
                If "" & mytable11.Fields("obligaprecio") = "S" Then
                    flag_clave1 = 0
                    tconcla.X = "S"
                    tconcla.Show 1

                    If flag_clave1 = 0 Then  'si es descongela
                        Cancel = True
                        Exit Sub

                    End If

                End If
        
                'MsgBox found
                found = valida_rango()

                If found = 0 Then
                    Cancel = True
                    Exit Sub

                End If

                'MsgBox "abc"
            End If

            sdx = Val("" & DBGrid2.columns("cantidad")) * Val("" & DBGrid2.columns("precio"))
            DBGrid2.columns("total") = sdx
            calcula_igv 0

        Case 6

            If Len(DBGrid2.columns(0)) = 0 Then
                Cancel = True
                Exit Sub

            End If

            flag_clave1 = 0
            tconcla.X = "DESCUENTO"
            tconcla.Show 1

            If flag_clave1 <> 1 Then  'si es descongela
                Cancel = True
                Exit Sub

            End If
     
            If Not IsNumeric(DBGrid2.columns("deslipo")) Then
                Cancel = True
                Exit Sub

            End If

            sdx = Val("" & DBGrid2.columns("cantidad")) * Val("" & DBGrid2.columns("precio"))
            DBGrid2.columns("total") = sdx
            calcula_igv 0

        Case 7

            If Len(DBGrid2.columns(0)) = 0 Then
                Cancel = True
                Exit Sub

            End If

            If Not IsNumeric(DBGrid2.columns("total")) Then
                Cancel = True
                Exit Sub

            End If

            If Val("" & DBGrid2.columns("cantidad")) = 0 Then
                Cancel = True
                Exit Sub

            End If

            'xfound = verifica_oferta("" & DBGrid2.Columns(0))
            'if xfound<>"S" then
            If Val(DBGrid2.columns("total")) <= 0 Then
                If "" & mytable11.Fields("noprecio") = "S" Then
                    MsgBox "Precio <=0", 48, "Aviso"
                    Cancel = True
                    Exit Sub

                End If

            End If

            found = existe_fuel("" & DBGrid2.columns(0))

            If found <> 1 Then
                flag_clave1 = 0
                tconcla.X = "S"
                tconcla.Show 1

                If flag_clave1 = 0 Then  'si es descongela
                    Cancel = True
                    Exit Sub

                End If

                sdx = Val("" & DBGrid2.columns("total")) / Val("" & DBGrid2.columns("cantidad"))
                DBGrid2.columns("precio") = sdx
                calcula_igv 0

            End If

            If found = 1 Then
                If Val("" & DBGrid2.columns("precio")) = 0 Then
                    Cancel = True
                    Exit Sub

                End If

                sdx = Val("" & DBGrid2.columns("total")) / Val("" & DBGrid2.columns("precio"))
                DBGrid2.columns("cantidad") = sdx
                calcula_igv 0

            End If

        Case 13

            If Len(DBGrid2.columns(0)) = 0 Then
                Cancel = True
                Exit Sub

            End If

            If Not IsNumeric(DBGrid2.columns("neto")) Then
                Cancel = True
                Exit Sub

            End If

            If Val("" & DBGrid2.columns("cantidad")) = 0 Then
                Cancel = True
                Exit Sub

            End If

            calcula_sinigv
            'calcula_igv 1

    End Select

End Sub

Private Sub DBGrid2_BeforeDelete(Cancel As Integer)

    'If MsgBox("¿Realmente desea eliminar el registro ", 1, "Confirmación de eliminación") <> 1 Then
    'Cancel = True
    'Exit Sub
    'End If
End Sub

Private Sub DBGrid2_ColEdit(ByVal ColIndex As Integer)

    Dim sdx As Double

    Select Case ColIndex

        Case 0

        Case 3
            
    End Select

End Sub

Private Sub DBGrid2_DblClick()

    Dim found As Integer

    On Error GoTo cmd90123_err

    Select Case DBGrid2.Col

        Case 2

            If Len(DBGrid2.columns(0)) > 0 And DBGrid2.Col = 2 Then
                xproducto = "" & DBGrid2.columns(0)
                carga_dbgrid4 "" & DBGrid2.columns(0)
                Exit Sub

            End If

        Case 3

            If Val("" & DBGrid2.columns("cantidad")) > 0 Then
                tkeyboar.FLAG = "CANTIDAD"
                tkeyboar.Show 1

            End If
       
            '15/08/2018 Cambiar Descripcion de producto venta de ventas
        Case 1

            If busca_CambiaDescripcionVentas(1) = "S" Then 'SI PERMITE CAMBIAR DESCRIPCION
                If Len("" & DBGrid2.columns("descripcio")) > 0 Then
                    tkeyboar.FLAG = "DESCRIPCION"
                    tkeyboar.producto = DBGrid2.columns("descripcio")
                    tkeyboar.Show 1
           
                    If busca_CambiaDescripcionVentas(2) = "S" Then
                        busca_cod_producto "" & productoCreado, 1

                    End If
           
                End If

            End If

            '15/08/2018 Cambiar Descripcion de producto venta de ventas
       
        Case 5

            If Val("" & DBGrid2.columns("cantidad")) > 0 Then
            
                ''''12/08/2017 kenyo Bloqueo de Cambio de Precio Teclado Virtual
                ''''12/08/2017 kenyo Bloqueo de Cambio de Precio Teclado Virtual
      
                If "" & mytable11.Fields("obligaprecio") = "S" Then
                    flag_clave1 = 0
                    tconcla.X = "CP"
                    tconcla.Show 1
                Else
                    tkeyboar.FLAG = "PRECIO"
                    tkeyboar.Show 1

                End If
          
            End If

    End Select

    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus
    Exit Sub
cmd90123_err:
    Exit Sub

End Sub

Private Sub dbgrid2_KeyDown(KeyCode As Integer, Shift As Integer)

    Dim found As Integer

    On Error GoTo cmd341231_err

    If KeyCode = &H71 Then  'f2 totales
        If xopciones(0).Enabled = False Then Exit Sub
        xopciones_Click 0
        Exit Sub

    End If

    If KeyCode = &H78 Then  'exonerado
        If xopciones(0).Enabled = False Then Exit Sub
        proceso_cierre_automatico "7"
        Exit Sub

    End If

    'If KeyCode = 46 Then
    'MsgBox (46)
    'End If

    If KeyCode = 13 Then

        'If Len(DBGrid2.Columns(0)) = 0 Then
        '   DBGrid2.Col = 0
        '   DBGrid2.Row = dbgrid2.visiblerows - 1
        '   DBGrid2.SetFocus
        '   Exit Sub
        'End If
        'MsgBox dbgrid2.columns(0)
        Select Case DBGrid2.Col

            Case 0

                If Len("" & DBGrid2.columns(0)) = 0 Then
                    If xopciones(0).Enabled = False Then Exit Sub
                    xopciones_Click 0
                    'If Label55.Enabled = False Then
                    '   Exit Sub
                    'End If
                    'Label55_Click
                    Exit Sub

                End If

                'If Len("" & DBGrid2.Columns(0)) > 0 Then
                '   DBGrid2.Col = 2
                'End If
            Case 3
                'If Val("" & DBGrid2.Columns("precio")) = 0 Then
                '   DBGrid2.Col = 5
                '   Exit Sub
                'End If
                found = sumar_detalle()
            
                KeyCode = 0
                DBGrid2.Col = 0
                DBGrid2.Row = DBGrid2.VisibleRows - 1
                DBGrid2.SetFocus

            Case 5
                'If Len("" & DBGrid2.Columns(4)) > 0 Then
                '   DBGrid2.Col = 6
                'End If
                found = sumar_detalle()
                KeyCode = 0
                DBGrid2.Col = 0
                DBGrid2.Row = DBGrid2.VisibleRows - 1
                DBGrid2.SetFocus

            Case 7
                found = sumar_detalle()
                KeyCode = 0
                DBGrid2.Col = 0
                DBGrid2.Row = DBGrid2.VisibleRows - 1
                DBGrid2.SetFocus

        End Select

    End If

    Exit Sub
cmd341231_err:
    Exit Sub

End Sub

Private Sub dbgrid2_KeyPress(KeyAscii As Integer)

    'If KeyAscii = 13 Then
    '   'DBGrid1_KeyDown 0, 0
    '   MsgBox "hOLA"'
    '
    'End If
End Sub

Private Sub DBGrid2_KeyUp(KeyCode As Integer, Shift As Integer)

    Dim found As Integer

    On Error GoTo cmd34_err

    carga_minimo "" & Data2.Recordset.Fields("producto")

    If opcion5 = 20 Then 'SI NO EXISTE PRODUCTOS
        'Data2.Refresh
        'found = sumar_detalle()
        'If Data2.Recordset.EOF Or Data2.Recordset.BOF Then
        '   Data2.Refresh
        '   'Exit Sub
        'End If
        found = ir_ultimo_registrox()

        If found = 0 Then
            opcion5 = 0
            Data2.refresh
            Exit Sub

        End If

        Data2.refresh
        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus 'found = sumar_detalle()
        'DBGrid2.SetFocus
        opcion5 = 0
        Exit Sub

    End If

    If KeyCode = 13 Then
        If Len(DBGrid2.columns(0)) = 0 Then
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus
            Exit Sub

        End If

    End If

    If KeyCode = &H72 Then  'f3
        codigo.SetFocus
        Exit Sub

    End If
 
    If KeyCode = &H70 Then  'f1  carga los demas precios
        If Len(DBGrid2.columns(0)) > 0 And DBGrid2.Col = 2 Then
            xproducto = "" & DBGrid2.columns(0)
            carga_dbgrid4 "" & DBGrid2.columns(0)
            Exit Sub

        End If

    End If

    If KeyCode = &H76 Then  'f7
        flag_clave1 = 0
        tconcla.X = "N"
        tconcla.Show 1

        If flag_clave1 <> 1 Then  'si es descongela
            DBGrid2.SetFocus
            Exit Sub

        End If

        xprodet.Show 1
        DBGrid2.SetFocus

    End If

    If KeyCode = 13 Then
        KeyCode = 0

    End If

    If KeyCode = &H2E Then  'borrar linea
        If DBGrid2.Row = -1 Then
            MsgBox "No hay ningún registro para eliminar", vbInformation
            Exit Sub

        End If

        If MsgBox("Se va a eliminar el registro : está seguro ", vbExclamation + vbYesNo, "Eliminar") = vbYes Then
            Data2.Recordset.Delete

            If Data2.Recordset.EOF = True And Data2.Recordset.BOF = True Then
                Exit Sub

            End If

            found = sumar_detalle()
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus
            Exit Sub

        End If

    End If

    If KeyCode = &H70 Then  'f1
        If Len(DBGrid2.columns(0)) = 0 Then
            found = consulta_producto("")

        End If

    End If

    If KeyCode = &H72 Then  'f3
        If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Len(Trim("" & DBGrid2.columns("linea"))) > 0 Then
            DBGrid2.Col = 3
            DBGrid2.SetFocus
            ingreso_tallas "" & DBGrid2.columns("linea")
            Exit Sub

        End If

        If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Trim("" & mytable11.Fields("obligavendedor")) = "S" Then
            DBGrid2.Col = 3
            DBGrid2.SetFocus
            carga_vendedorpp
            Exit Sub

        End If

    End If

    If KeyCode = &H77 Then  'f8 OBSERVACIONES
        If Len(DBGrid2.columns("PRODUCTO")) > 0 Then
            ingreso_locales

        End If

    End If

    If KeyCode = &H28 Then  'flecha abajo inserta una nueva
        Exit Sub

        If DBGrid2.Col = 0 Then
            ir_ultimo

            If Len(DBGrid2.columns(0)) > 0 And Len(DBGrid2.columns(1)) > 0 And Len(DBGrid2.columns(2)) > 0 And Len(DBGrid2.columns("cantidad")) > 0 And Len(DBGrid2.columns(4)) > 0 And Len(DBGrid2.columns("precio")) > 0 Then

                'Data2.Recordset.AddNew
                'Data2.Recordset.Update
            End If

            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus

        End If

    End If

    Exit Sub
cmd34_err:
    Exit Sub

End Sub

Private Sub DBGrid4_DblClick()
    DBGrid4_KeyDown 13, 0

End Sub

Private Sub DBGrid4_KeyDown(KeyCode As Integer, Shift As Integer)
    '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017
    DBGrid2.Enabled = True
    '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017

    Dim sdx      As Double

    Dim found    As Integer

    Dim xpreciox As Double

    Dim mytablex As New ADODB.Recordset

    If KeyCode = 27 Then
        If opcion3 = "1" Then
            Frame5.Visible = False
            dbGrid1.SetFocus
            Exit Sub

        End If

        If opcion1 = "8" Then
            Frame5.Visible = False
            Frame1.Enabled = True
            dbGrid1.Enabled = True

            If dbGrid1.Visible = True Then
                dbGrid1.Visible = True
                dbGrid1.Enabled = True
                dbGrid1.SetFocus

            End If

            If dbGrid1.Visible = False Then
                DBGrid2.Enabled = True
                DBGrid2.SetFocus

            End If

            Exit Sub

        End If

        Frame5.Visible = False
        hknumero.Caption = ""
        'Data2.Refresh
        found = sumar_detalle()
        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus
        'DBGrid2.SetFocus
        'Command8_Click
        Exit Sub

    End If

    If KeyCode = 13 Then
        If Len("" & DBGrid4.columns(1)) = 0 Or Len("" & DBGrid4.columns(0)) = 0 Then
            DBGrid4.SetFocus
      
            '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017
            DBGrid2.Enabled = False
            '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017
      
            Exit Sub

        End If

        'MsgBox opcion1
        'MsgBox opcion1
        stkminimo = ""
   
        '' kenyo 02/11/2017 Configuración Productos Comentarios Obligatorios
       
        'Dim mytablexAs New ADODB.Recordset
        If mytablex.State = 1 Then mytablex.Close
        mytablex.Open "SELECT obligacomentario FROM producto where producto='" & DBGrid2.columns("producto") & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And ("" & mytablex.Fields("obligacomentario")) = "S" Then
                DBGrid2.Col = 0
                DBGrid2.SetFocus
                txobserv.Show 1

            End If

        End If

        mytablex.Close
        '' kenyo 02/11/2017 Configuración Productos Comentarios Obligatorios
   
        If "" & mytable11.Fields("stkminimo") = "S" And Len(Trim(Label12)) = 0 Then
            'If "" & mytable11.Fields("stkminimo") = "S" Then
            mytablex.Open "SELECT * FROM producto where producto='" & "" & DBGrid2.columns(0) & "'", cn, adOpenDynamic, adLockOptimistic

            If mytablex.RecordCount > 0 Then
                If familia_saldo("" & mytablex.Fields("familia")) = 0 Then
                    consulta_minimo "" & mytablex.Fields("producto"), "" & mytablex.Fields("minimo")

                End If

            End If

            mytablex.Close

        End If

        If "" & mytable11.Fields("nosaldo") = "S" Then
            found = verifica_saldo_receta("" & DBGrid2.columns(0), Val(DBGrid4.columns(1)))

            If found = 2 Then
                MsgBox "Se detecto un saldo receta con saldo<=0 ", 48, "Aviso"
                Exit Sub

            End If

            If familia_saldo("" & DBGrid2.columns("familia")) = 0 Then
                If consulta_saldo("" & DBGrid2.columns(0), Val("" & DBGrid4.columns(1)), 1) <= 0 Then
                    MsgBox "No existe saldo", 48, "Aviso"
                    DBGrid4.SetFocus
                    Exit Sub

                End If

            End If

        End If

        If Frame1.Visible = True Then
            Frame5.Visible = False
            Frame1.Enabled = True
            dbGrid1.Enabled = True
            dbGrid1.SetFocus
            Exit Sub

        End If

        If opcion3 = "1" Then
            Frame5.Visible = False
            Frame1.Enabled = True
            dbGrid1.Enabled = True
            dbGrid1.SetFocus
            Exit Sub

        End If

        'If Val("" & DBGrid4.Columns(2)) <= 0 Then
        '   MsgBox "Precio<=0", 48, "Aviso"
        '   DBGrid4.SetFocus
        '   Exit Sub
        'End If
        '---------------validar precios-----------------------------
        xpreciox = 0
        xpreciox = Val("" & DBGrid4.columns(2))
        'If opcion1 = "8" Then
        'If Len("" & DBGrid4.Columns(0)) > 0 And Val("" & DBGrid4.Columns(1)) > 0 And Len("" & DBGrid4.Columns(2)) > 0 Then
        'Data2.Recordset.Edit
        'Data2.Recordset.Fields("unidad") = "" & DBGrid4.Columns(0)
        'Data2.Recordset.Fields("factor") = "" & DBGrid4.Columns(1)
        'Data2.Recordset.Fields("precio") = "" & DBGrid4.Columns("cantidad")
        'Data2.Recordset.Update
        'MsgBox DBGrid4.Row
        DBGrid2.columns("nroprecio") = "" & (DBGrid4.Row + 1)
        DBGrid2.columns(2) = "" & DBGrid4.columns(0)
        DBGrid2.columns(4) = Val("" & DBGrid4.columns(1))
   
        DBGrid2.columns("precio") = xpreciox
      
        '''06/08/2017 kenyo Testing Completo al Sistema
        'If xprecioDsctox > 0 Then dbgrid2.columns("precio") = xprecioDsctox 'precio de descuento por cliente
        '''06/08/2017 kenyo Testing Completo al Sistema
      
        sdx = Val("" & DBGrid2.columns("cantidad")) * Val("" & DBGrid2.columns("precio"))
        DBGrid2.columns("total") = sdx
        calcula_igv 0
        'found = sumar_detalle()
        Frame5.Visible = False

        'antes estaba para que se vaya al final
        If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Len(Trim("" & DBGrid2.columns("linea"))) > 0 Then
            DBGrid2.Col = 3
            DBGrid2.SetFocus
            ingreso_tallas "" & DBGrid2.columns("linea")
            Exit Sub

        End If

        If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Trim("" & mytable11.Fields("obligavendedor")) = "S" Then
            DBGrid2.Col = 3
            DBGrid2.SetFocus
            carga_vendedorpp
            Exit Sub

        End If
         
        'Combos Combinaciones 07/07/2018
        combinac = "N"

        Dim mytablezx As New ADODB.Recordset
          
        If Len(DBGrid2.columns("producto")) = 0 Then Exit Sub
           
        If mytablezx.State = 1 Then mytablezx.Close
        mytablezx.Open "SELECT * FROM combina where producto='" & "" & DBGrid2.columns("producto") & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablezx.RecordCount > 0 Then
            combinac = "S"
            Do

                If mytablezx.EOF Then Exit Do
                DBGrid2.Col = 0
                DBGrid2.SetFocus
                DBGrid2.Row = DBGrid2.VisibleRows - 1
                hknumero = mytablezx.Fields("cantidad")
            
                busca_cod_producto mytablezx.Fields("productop"), 0
                mytablezx.MoveNext
            Loop
            mytablezx.Close
            combinac = "N"

        End If

        'Combos Combinaciones 07/07/2018
         
        'DBGrid2.Col = 3
        'DBGrid2.SetFocus
        'ingreso_tallas "" & DBGrid2.Columns(17)
        'Else
        'que vaya a cantidad
        'DBGrid2.Col = 3
        'DBGrid2.SetFocus
        sumar_reforzar
        'cuando necesite que vaya a la siguiente linea
          
        found = sumar_detalle()
        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus
          
        ''''28/09/2017 kenyo Testing Zapateria
        hknumero.Caption = ""
        ''''28/09/2017 kenyo Testing Zapateria
          
        'End If
        'Command8_Click
        'End If
        'End If
    End If

End Sub

Private Sub DBGrid4_UnboundReadData(ByVal RowBuf As MSDBGrid.RowBuffer, _
                                    StartLocation As Variant, _
                                    ByVal ReadPriorRows As Boolean)

    Dim dR            As Integer

    Dim row_num       As Integer

    Dim R             As Integer

    Dim rows_returned As Integer

    If ReadPriorRows Then
        dR = -1
    Else
        dR = 1

    End If

    If IsNull(StartLocation) Then
        If ReadPriorRows Then
            row_num = RowBuf.RowCount - 1
            'row_num = 9
        Else
            row_num = 0

        End If

    Else
        row_num = CLng(StartLocation) + dR

    End If

    rows_returned = 0

    For R = 0 To RowBuf.RowCount - 1

        If row_num < 0 Or row_num > 9 Then Exit For
        RowBuf.Value(R, 0) = campo_precios(row_num).unidad
        RowBuf.Value(R, 1) = campo_precios(row_num).factor
        RowBuf.Value(R, 2) = campo_precios(row_num).precio
        RowBuf.Value(R, 3) = campo_precios(row_num).costo
        RowBuf.Value(R, 4) = campo_precios(row_num).margen
        RowBuf.Value(R, 5) = campo_precios(row_num).stock
        'RowBuf.Value(R, 6) = campo_precios(row_num).svirtual
        RowBuf.Bookmark(R) = row_num
        row_num = row_num + dR
        rows_returned = rows_returned + 1
    Next R

    RowBuf.RowCount = rows_returned

End Sub

Private Sub dbgrid6_KeyDown(KeyCode As Integer, Shift As Integer)

    On Error GoTo cmd896533_err

    If KeyCode = &H2E Then  'borrar linea
        If opcion1 = "15000" Then  'borrar pedido de venta
            cn.Execute ("delete from dpedidov where local='" & Trim(dbGrid1.columns("local")) & "' and tipo='" & Trim(dbGrid1.columns("tipo")) & "' and serie='" & Trim(dbGrid1.columns("serie")) & "' and numero='" & Trim(dbGrid1.columns("numero")) & "' and producto='" & dbgrid6.columns("producto") & "'")
            sumar_pedidoventa
            visualiza_detalle_factura "" & rcconsulta.Fields("tipo"), "" & rcconsulta.Fields("serie"), "" & rcconsulta.Fields("numero")

        End If

    End If

    Exit Sub
cmd896533_err:
    MsgBox "Aviso en dbgrid6_keyDown " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub sumar_pedidoventa()

    Dim mytablex As New ADODB.Recordset

    Dim buf      As String

    Dim sdx      As Double

    sdx = 0
    buf = "select * from dpedidov where local='" & "" & rcconsulta.Fields("local") & "' and tipo='" & "" & rcconsulta.Fields("tipo") & "' and serie='" & "" & rcconsulta.Fields("serie") & "' and numero='" & "" & rcconsulta.Fields("numero") & "'"
    mytablex.Open buf, cn, adOpenDynamic, adLockOptimistic
    Do

        If mytablex.EOF Then Exit Do
        sdx = sdx + Val("" & mytablex.Fields("total"))
        mytablex.MoveNext
    Loop
    rcconsulta.Fields("total") = Format(sdx, "0.00")
    rcconsulta.Update
    mytablex.Close

End Sub

Private Sub DBGrid6_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 27 Then Exit Sub
    dbgrid6.Visible = False
    dbGrid1.SetFocus

End Sub

Private Sub DBGrid9_AfterColUpdate(ByVal ColIndex As Integer)

    Select Case ColIndex

        Case 2
            suma_fpagov

            If Label45.Caption = "Vuelto" Or Val(stxtotals) <= 0 Then
                xtipo = protipo

                If "" & mytable11.Fields("habilitanota") = "S" Then
                    If Val(ttxtotals) <= Val("" & mytable11.Fields("siventa")) Then
                        xtipo = "5"

                    End If

                End If

                xruc = codigo
                xnombre = nombre
                xdireccion = ydireccion
                xvendedor = cproven
                  
                Framefp.Enabled = False
                Frame7.Visible = True
             
                habilita_lab7 1
                Framefp.Enabled = False

                If flag_servicio <> "A" And flag_servicio <> "C" And flag_servicio <> "D" Then
                    xtipo = "5"

                End If

                xtipo.SetFocus
                Exit Sub

            End If

            dbgrid10.Enabled = True
            dbgrid10.SetFocus

    End Select

End Sub

Private Sub DBGrid9_BeforeColEdit(ByVal ColIndex As Integer, _
                                  ByVal KeyAscii As Integer, _
                                  Cancel As Integer)

    Dim found1 As Double

    If ColIndex <> 2 Then
        Cancel = True
        Exit Sub

    End If

    Select Case ColIndex

        Case 2

            If Len("" & dbgrid9.columns(0)) = 0 Then
                Cancel = True
                Exit Sub

            End If

    End Select

End Sub

Private Sub DBGrid9_BeforeColUpdate(ByVal ColIndex As Integer, _
                                    OldValue As Variant, _
                                    Cancel As Integer)

    Dim found1 As Double

    Select Case ColIndex

        Case 2

            If Not IsNumeric("" & dbgrid9.columns(2)) Then
                Cancel = True
                Exit Sub

            End If

            'If "" & Data9.Recordset.Fields("acu") = "H" Then 'valida el deposito bancario
            '   If Val("" & DBGrid9.Columns(2)) > Val(stxtotals) Then
            '      MsgBox "Debe ingresar valor exacto", 48, "Aviso"
            '      Cancel = True
            '      Exit Sub
            '   End If
            '   found1 = valida_deposito("" & Data9.Recordset.Fields("codigo"), "" & Data9.Recordset.Fields("orden"), 0)
            '   If found1 < Val("" & DBGrid9.Columns(2)) Then
            '      MsgBox "No existe Saldo ", 48, "Aviso"
            '      Cancel = True
            '      Exit Sub
            '   End If
            'End If
            
            If verifica_fpago("" & dbgrid9.columns("fpago")) = "V" Then
                'MsgBox "" & Data9.Recordset.Fields("orden") & "" & Data9.Recordset.Fields("observa") & "" & Data9.Recordset.Fields("dias")
                'MsgBox codigo

                'found1 = suma_pedidos("" & codigo, "" & tcampo3, "" & tcampo4, "" & tcampo5)
                found1 = suma_pedidos("" & codigo, "" & Data9.Recordset.Fields("orden"), "" & Data9.Recordset.Fields("observa"), "" & Data9.Recordset.Fields("dias"))

                'MsgBox found1
                ', "" & Data9.Recordset.Fields("orden"), "" & Data9.Recordset.Fields("observa"), "" & Data9.Recordset.Fields("dias")
                If found1 <= 0 Then
                    MsgBox "Cantidad Mayor que el saldo del pedido ", 48, "Aviso"
                    Cancel = True
                    Exit Sub

                End If

                'MsgBox found1
                If found1 > 0 Then
                    If found1 < Val("" & dbgrid9.columns(2)) Then
                        MsgBox "Cantidad Mayor que el saldo del pedido ", 48, "Aviso"
                        Cancel = True
                        Exit Sub

                    End If

                End If

            End If
            
            If "" & Data9.Recordset.Fields("acu") = "I" Or "" & Data9.Recordset.Fields("acu") = "K" Then 'valida el deposito bancario
                If Val("" & dbgrid9.columns(2)) > Val(stxtotals) Then
                    MsgBox "Debe ingresar valor exacto", 48, "Aviso"
                    Cancel = True
                    Exit Sub

                End If

                found1 = busca_credito_adelanto1("" & Data9.Recordset.Fields("codigo"), "" & Data9.Recordset.Fields("acu"))

                If found1 <= 0 Then
                    MsgBox "No existe Saldo ", 48, "Aviso"
                    Cancel = True
                    Exit Sub

                End If

                If found1 < Val("" & dbgrid9.columns(2)) Then
                    MsgBox "Saldo actual es: " & found1 & " Debe Ingresar dicha cantidad ", 48, "Aviso"
                    Cancel = True
                    Exit Sub

                End If

            End If

            opcion2 = 0

            '---------- validamos a donde va
            'valida_ingresado
    End Select

End Sub

Private Sub DBGrid9_KeyDown(KeyCode As Integer, Shift As Integer)

    Dim found1 As Double

    On Error GoTo cmd7811_err

    If KeyCode = 27 Then
        Data9.Recordset.Delete
        dbgrid10.Enabled = True
        dbgrid10.SetFocus
        Exit Sub

    End If

    'MsgBox Shift
    If KeyCode = 13 Then

        Select Case dbgrid9.Col

            Case 2

                If Len("" & dbgrid9.columns(2)) > 0 Then Exit Sub
                If Val("" & dbgrid9.columns(2)) = 0 Then

                    'If "" & Data9.Recordset.Fields("acu") = "H" Then 'valida el deposito bancario
                    '   DBGrid9.SetFocus
                    '   Exit Sub
                    'End If
                    If verifica_fpago("" & dbgrid9.columns("fpago")) = "V" Then
                        found1 = suma_pedidos("" & Data9.Recordset.Fields("codigo"), "" & Data9.Recordset.Fields("orden"), "" & Data9.Recordset.Fields("observa"), "" & Data9.Recordset.Fields("dias"))

                        If found1 <= 0 Then
                            MsgBox "Cantidad Mayor que el saldo del pedido ", 48, "Aviso"
                            dbgrid9.SetFocus
                            Exit Sub

                        End If

                        If found1 > 0 Then
                            If found1 < Val(stxtotals) Then
                                MsgBox "Cantidad Mayor que el saldo del pedido ", 48, "Aviso"
                                dbgrid9.SetFocus
                                Exit Sub

                            End If

                        End If

                    End If

                    If "" & Data9.Recordset.Fields("moneda") = "S" Then
                        Data9.Recordset.Edit
                        Data9.Recordset.Fields("recibe") = Val(stxtotals)
                        Data9.Recordset.Update

                    End If

                    If "" & Data9.Recordset.Fields("moneda") = "D" Then
                        Data9.Recordset.Edit
                        Data9.Recordset.Fields("recibe") = Val(stxtotald)
                        Data9.Recordset.Update

                    End If

                    opcion2 = 0
                    'valida_ingresado
               
                    suma_fpagov
               
                    If Label45.Caption = "Vuelto" Or Val(stxtotals) <= 0 Then
                        xtipo = protipo
                        xvendedor = cproven
                            
                        xruc = codigo

                        If "" & mytable11.Fields("habilitanota") = "S" Then
                            If Val(ttxtotals) <= Val("" & mytable11.Fields("siventa")) Then
                                xtipo = "5"

                            End If

                        End If
                  
                        xnombre = nombre
                        xdireccion = ydireccion
                        Frame7.Visible = True
                        habilita_lab7 1
                        Framefp.Enabled = False

                        If flag_servicio <> "A" And flag_servicio <> "C" And flag_servicio <> "D" Then
                            xtipo = "5"

                        End If

                        xtipo.SetFocus
                        Exit Sub

                    End If

                End If

        End Select

    End If

    Exit Sub
cmd7811_err:
    Exit Sub

End Sub

Private Sub dcodigo_DblClick()
    tkeyboar.FLAG = "DCODIGO"
    tkeyboar.Show 1

End Sub

Private Sub dcodigo_KeyPress(KeyAscii As Integer)

    Dim found As Integer

    If KeyAscii <> 13 Then Exit Sub
    If Len(dcodigo) > 0 Then
        If Len(telefono) < 6 Then
            telefono.SetFocus
            Exit Sub

        End If

        found = busca_codigod()

    End If

    dnombre.SetFocus

End Sub

Private Sub dcodigo_KeyUp(KeyCode As Integer, Shift As Integer)

    Dim found As Integer

    If KeyCode = &H26 Then
        telefono.SetFocus
        Exit Sub

    End If

    If KeyCode = &H76 Then  'f7 creacion
        'para crear un cliente nuevo
        Exit Sub

    End If

    If KeyCode = &H70 Then  'f1
        consulta_cliente ""

    End If

End Sub

Private Sub dcrt6622_Click()
    '12/06/2017 kenyo oculta controles
    frmClientesRUC.Visible = False
    Picture2.Visible = False
    '12/06/2017 kenyo oculta controles

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    '-------------------------------------
    cgusuario = gocabeza
    dgusuariog = godetalle
    found = sumar_detalle()

    If Val(txtotal) > 0 Then
        MsgBox "No deben existir pedidos Pendientes", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    menu_carga_doc_anterior
    Exit Sub

End Sub

Sub menu_carga_doc_anterior()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    sw_consulta = 0
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""

    opcion1 = "1500"
    found = sql_consulta(1)

    'dbgrid1.SetFocus
End Sub

Private Sub dcupar1_Click()

    Dim sw    As Integer

    Dim found As Integer

    flag_clave1 = 0
    tconcla.X = "CUADRE"  'cuadre parcial
    tconcla.Show 1

    If flag_clave1 <> 1 Then  'si es descongela
        DBGrid2.SetFocus
        Exit Sub

    End If
 
    tcuadrc1.CmdImprimir.Visible = True
 
    opcion1 = "1"
    opcion2 = "1"
    opcion3 = "2"
    
    tcuadrc1.fechai.Enabled = True
    tcuadrc1.fechaf.Enabled = True

    usuariopos = gusuario
    tcuadrc1.cajero = "" & cajero
    tcuadrc1.caja = "" & caja
    tcuadrc1.turno = "" & turno
    tcuadrc1.fechai = "" & dia
    tcuadrc1.fechaf = "" & dia
    tcuadrc1.horai = "01"
    'tcuadrc1.todos = "S"
    tcuadrc1.horaf = "24"
    tcuadrc1.Caption = "CUADRE PARCIAL DEL DIA"
    'vIMPRIMIR = 1
    tcuadrc1.Show 1

End Sub

Private Sub dcvendedor_Click()

    If dcvendedor <> "%" Then
        Data2.Recordset.Edit
        dvendedor = extra_loquesea(dcvendedor)
        Data2.Recordset.Update
   
    End If

End Sub

Private Sub ddireccion_DblClick()
    tkeyboar.FLAG = "DDIRECCION"
    tkeyboar.Show 1

End Sub

Private Sub ddireccion_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then Exit Sub
    If Len(ddireccion) = 0 Then
        ddireccion.SetFocus
        Exit Sub

    End If

    referencia.SetFocus

End Sub

Private Sub ddireccion_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        dnombre.SetFocus
        Exit Sub

    End If

End Sub

Private Sub dfk992325_Click()

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub

    flag_clave1 = 0
    tconcla.X = "COPIA"  '
    tconcla.Show 1

    If flag_clave1 <> 1 Then  'si es descongela
        DBGrid2.SetFocus
        Exit Sub

    End If

    rrlocal11 = ""
    rrtipo = ""
    rrserie = ""
    rrnumero = ""
    mmenua.Caption = "COPIA"
    mmenua.Show 1

    'MsgBox rrlocal11 & "" & rrtipo & "" & rrserie & " " & rrnumero
    If Len(rrlocal11) = 0 Then Exit Sub
    If Len(rrtipo) = 0 Then Exit Sub
    If Len(rrnumero) = 0 Then Exit Sub
    found = valida_otros()

    If found = 0 Then
        MsgBox "No existe Documento ", 48, "Aviso"
        Exit Sub

    End If

    proceso_impresion11 rrtipo, rrserie, rrnumero, 1, "1"
    DBGrid2.SetFocus

    'proceso_impresioncopia1
End Sub

Private Sub dhyori83_Click()

    If "" & mytable11.Fields("terminal") = "T" Then
        MsgBox "No permitido en Pedido", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    '-------------------------------------
    cgusuario = gocabeza
    dgusuariog = godetalle
    menu_proforma
    Exit Sub

End Sub

Private Sub dj78232_Click()

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    '-------------------------------------

    cgusuario = gocabeza
    dgusuariog = godetalle
    found = sumar_detalle()

    If Val(txtotal) > 0 Then
        MsgBox "No deben existir pedidos Pendientes", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    menu_carga_pedidos
    Exit Sub

End Sub

Sub menu_carga_pedidos_abono()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""

    '''' KENYO
    'opcion1 = "15000A"
    opcion1 = "15000"
    '''FIN KENYO

    sw_consulta = 0
    found = sql_consulta(1)

End Sub

''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas
Sub menu_carga_pedidos_credito()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""

    opcion1 = "70000"

    sw_consulta = 0
    found = sql_consulta(1)

End Sub

''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas

Sub menu_carga_pedidos()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "15000"
    sw_consulta = 0
    found = sql_consulta(1)

End Sub

Sub menu_carga_cotizacion()

    Dim found As Integer

    sw_consulta = 0
    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "30000"
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Private Sub djk78232_Click()

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    flag_clave1 = 0
    tconcla.X = "S"
    tconcla.Show 1

    If flag_clave1 = 1 Then  'si es descongela
        modifica_pedido
        Exit Sub

    End If

    DBGrid2.SetFocus

End Sub

Sub modifica_pedido()

    Dim found As Integer

    If Val(txtotal) > 0 Then
        MsgBox "No deben existir Productos ", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    If Frame9.Visible = True Then Exit Sub
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "370"
    sw_consulta = 0
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Private Sub dki3432_Click()

    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    Frame2.Visible = True

    If Len(dnombre) > 0 And Len(telefono) > 0 And Len(codigo) > 0 Then
        ddireccion.SetFocus
        Exit Sub

    End If

    inicializa_deliveri

    telefono.SetFocus

End Sub

Private Sub dju523a_Click()
    '12/06/2017 kenyo oculta controles
    frmClientesRUC.Visible = False
    Picture2.Visible = False
    '12/06/2017 kenyo oculta controles
  
    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    If Frame2.Visible = True Then Exit Sub
    facmesa.Show 1
    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus

End Sub

Private Sub dk8923_Click()

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    '-------------------------------------
    cgusuario = gocabeza
    dgusuariog = godetalle
    found = sumar_detalle()

    If Val(txtotal) > 0 Then
        MsgBox "No deben existir pedidos Pendientes", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    menu_carga_cotizacion
    Exit Sub

End Sub

Private Sub dli892_Click()

    If Frame2.Visible = True Then Exit Sub
    If MsgBox("Desea Borrar??", 1, "Aviso") <> 1 Then Exit Sub
    borrar_todo
    sql_detalle
    tiposervicio1 = "Autoservicio"
    flag_servicio = "A"
    salon.Caption = ""
    mesa.Caption = ""
    mesero = ""
    cuenta_separa = ""

End Sub

Private Sub dnombre_DblClick()
    tkeyboar.FLAG = "DNOMBRE"
    tkeyboar.Show 1

End Sub

Private Sub dnombre_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then Exit Sub
    If Len(dnombre) = 0 Then
        dnombre.SetFocus
        Exit Sub

    End If

    ddireccion.SetFocus

End Sub

Private Sub dnombre_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        telefono.SetFocus
        Exit Sub

    End If

End Sub

Private Sub dphora_Click()
    horaentrega = Trim(dphora) & ":00:00"

End Sub

Private Sub EC_Button1_MouseUp(Button As Integer, _
                               Shift As Integer, _
                               X As Single, _
                               Y As Single)
    trgb.tipo = "PRODUCTO"
    trgb.Show 1
    inicia_color_producto
    Picture4.Visible = False

End Sub

Private Sub EC_Button2_MouseUp(Button As Integer, _
                               Shift As Integer, _
                               X As Single, _
                               Y As Single)
    'valida_camara
    trgb.tipo = "FAMILIA"
    trgb.Show 1
    inicia_color_familia
    Picture4.Visible = False

End Sub

Private Sub eju78se_Click()

    Dim sw As Integer
    
    flag_clave1 = 0
    tconcla.X = "CUADRE"
    tconcla.Show 1

    If flag_clave1 <> 1 Then  'si es descongela
        DBGrid2.SetFocus
        Exit Sub

    End If
    
    opcion1 = "20"
    opcion2 = "2"
    opcion3 = ""
    tcuadrc1.flagdiario = "1"
    tcuadrc1.fechai.Enabled = True
    tcuadrc1.fechaf.Enabled = True
    usuariopos = gusuario
    tcuadrc1.cajero = usuariopos
    tcuadrc1.caja = caja
    tcuadrc1.turno = turno
    tcuadrc1.horai = "01"
    tcuadrc1.horaf = "24"
    tcuadrc1.fechai = dia
    tcuadrc1.fechaf = dia
    'tcuadrc1.todos = "S"
    tcuadrc1.Caption = "DOCUMENTOS EMITIDOS PERIODICO"
    tcuadrc1.check3d1.Visible = True
    tcuadrc1.check3d2.Visible = True
    tcuadrc1.check3d3.Visible = True
    tcuadrc1.Show 1
    tcuadrc1.flagdiario = ""
    
End Sub

Private Sub fdk9235_Click()

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub

    flag_clave1 = 0
    tconcla.X = "ANULA"  '
    tconcla.Show 1

    If flag_clave1 <> 1 Then  'si es descongela
        DBGrid2.SetFocus
        Exit Sub

    End If

    rrlocal11 = ""
    rrtipo = ""
    rrserie = ""
    rrnumero = ""
    mmenua.Caption = "ANULA"
    mmenua.Show 1

    If Len(rrlocal11) = 0 Then Exit Sub
    If Len(rrtipo) = 0 Then Exit Sub
    If Len(rrnumero) = 0 Then Exit Sub
    found = valida_otros()

    If found = 0 Then
        MsgBox "No existe Documento ", 48, "Aviso"
        Exit Sub

    End If

    anularr

End Sub

Sub anularr()

    Dim found As Integer

    found = proceso_anular(rrtipo, rrserie, rrnumero)

    If found = 1 Then
        proceso_impresion11 rrtipo, rrserie, rrnumero, 0, ""

    End If

    DBGrid2.SetFocus

End Sub

Private Sub fechae_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then Exit Sub
    If Len(Trim(fechae)) = 0 Then
        fechae = Format(Now, "dd/mm/yyyy")

    End If

    If Len(Trim(fechae)) > 0 Then
        If Not IsDate(fechae) Then
            fechae = Format(Now, "dd/mm/yyyy")
            fechae.SetFocus
            Exit Sub

        End If

    End If

    If xserie.Enabled = True Then
        xserie.SetFocus

    End If

End Sub

Private Sub fechanac_DblClick()
    tkeyboar.FLAG = "FECHANAC"
    tkeyboar.Show 1

End Sub

Private Sub fechanac_KeyPress(KeyAscii As Integer)

    Dim found As Integer

    If KeyAscii <> 13 Then Exit Sub
    found = valida()

    If found = 0 Then
        Exit Sub

    End If

    saludo_cumpe
    tiposervicio1 = "DELIVERY"
    flag_servicio = "D"
    'CAMPO1 = telefono
    codigo = dcodigo
    nombre = dnombre
    salon.Caption = ""
    mesa.Caption = ""
    mesero = ""
    cuenta_separa = ""
    Frame2.Visible = False

    '27/08/2018 Producto delivery automatico
    fechasis_Click
    '27/08/2018 Producto delivery automatico

    DBGrid2.SetFocus

End Sub

Private Sub fechanac_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        referencia.SetFocus
        Exit Sub

    End If

End Sub

Private Sub fk88332_Click()
    flag_clave1 = 0
    tconcla.X = "MINIREPORTE"
    tconcla.Show 1

    If flag_clave1 <> 1 Then  'si es descongela
        DBGrid2.SetFocus
        Exit Sub

    End If

    tresegui.Show 1

End Sub

Private Sub Form_Activate()
    Me.Height = 11055: Me.Width = 15360
    '''''''''''cambios martes 13 dic 2016 ------------------------
    Frame1.Top = 0: Frame1.Left = 0
    Frame2.Top = 0: Frame2.Left = 0
    Framefp.Top = 0: Framefp.Left = 0

    '15/03/2018 Suma Totales Reporte Solo Totales y Servicio
    Frame5.Top = 15: Frame5.Left = 5950 'LISTA DE PRECIOS
    'Frame5.Width = 9308
    'Frame5.Height = 10300
    '15/03/2018 Suma Totales Reporte Solo Totales y Servicio

    Frame6.Top = 1920: Frame6.Left = 120
    Frame7.Top = 1920: Frame7.Left = 120
    Frame8.Top = 0: Frame8.Left = 3200
    Frame9.Top = 2670: Frame9.Left = 4600

    ''''21/09/2017 kenyo Mejora  cobranza de mesas
    'frmClientesRUC.Top = 15: frmClientesRUC.Left = 8550 ' VENTANA DE CLIENTES
    If Picture2.Visible = True Then 'picture2 es venta de mesas abierta
        frmClientesRUC.Top = 420: frmClientesRUC.Left = 0
        frmClientesRUC.Width = 8550: frmClientesRUC.Height = 4680
    Else
        frmClientesRUC.Top = 15: frmClientesRUC.Left = 8550
        frmClientesRUC.Width = 6825: frmClientesRUC.Height = 3810

    End If

    ''''21/09/2017 kenyo Mejora  cobranza de mesas

    'pantalla de mesas
    Picture2.Top = 30
    Picture2.Left = 8595
    Picture2.Width = 6850
    Picture2.Height = 10150

    fechae = Format(Now, "dd/mm/yyyy")
    horaentrega = Format(Now, "hh:mm:ss")

    '' 13/01/2018 Fecha de registro y cambio de congelados
    fechaicongela = Format(Now, "dd/mm/yyyy")
    '' 13/01/2018 Fecha de registro y cambio de congelados

    '''------------------------------------------------------------
    flagsubfamilia = ""
    ' CUANDO ES UNA SEPARACION SE DEBE TENER CONFIGURADO EL TIPO PEDIDO EN PARAMECA Y LA SERIE Y EL NUMERO

    Dim found As Integer

    inicia_color_comandos
    'label69.Caption = "Estado " & glomesa
    'xopcioness(3).Caption = "Cobrar " & glomesa
    'xopcioness(14).Caption = "Graba " & glomesa
    diasistema = dia
    found = leer_visorcaja("SISTEMA CALIPSO", "VERSION 5.1")
    tptovta.Caption = "" & mytable11.Fields("descripcio")
    consulta_comanda "" & mytable11.Fields("salon")
    found = busca_paridad()
    'If flag_carga <> "S" Then
    'MsgBox ""
    'found = busca_paridad()
    'sql_detalle
    cajero = "" & gusuario
    flag_carga = "S"
    'pedido.SetFocus
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1

    'DBGrid2.SetFocus
    'End If
    'uvueltos = "S/.:" & Format(Val("" & mytable11.Fields("uvueltos")), nrodecimal)
    'uvueltod = "US$:" & Format(Val("" & mytable11.Fields("uvueltod")), nrodecimal)
    If "" & mytable11.Fields("terminal") = "T" Then

        'MsgBox "Hola"
        'pedido.SetFocus
    End If

    If "" & mytable11.Fields("tpvauto") = "N" Then  'activa autoservicio

        'Label55.Enabled = False
        'Label57.Enabled = False
        'Label8.Enabled = False
        'Label63.Enabled = False
    End If

    If "" & mytable11.Fields("comanda") = "N" Then  'activa autoservicio

        'Label22.Enabled = False
    End If

    If "" & mytable11.Fields("grabacomanda") = "N" Then  'activa autoservicio

        'Label13.Enabled = False
    End If

    If "" & mytable11.Fields("delivery") = "N" Then  'activa autoservicio

        'Label23.Enabled = False
    End If

    If "" & mytable11.Fields("copiaventas") = "N" Then  'activa autoservicio

        'Label40.Enabled = False
    End If

    If "" & mytable11.Fields("anulaventas") = "N" Then  'activa autoservicio

        'Label49.Enabled = False
    End If

    If "" & mytable11.Fields("cierrecaja") = "N" Then  'activa autoservicio

        'Label58.Enabled = False
    End If

    If "" & mytable11.Fields("ingresodinero") = "N" Then  'activa autoservicio

        'Label65.Enabled = False
    End If

    If "" & mytable11.Fields("egresodinero") = "N" Then  'activa autoservicio

        'Label66.Enabled = False
    End If

    If "" & mytable11.Fields("descuento") = "N" Then  'activa autoservicio

        'Label64.Enabled = False
    End If

    xopciones(30).Enabled = True 'normal o consumo siempre activo

End Sub

Sub Carga_Familia()

    Dim mytablex As New ADODB.Recordset

    Dim i        As Integer

    For i = 0 To 14999
        mfamcod(i) = ""
        wfamcod(i) = ""
    Next i

    i = -1

    '22/06/2017 kenyo CORRECION orden familia y producto touch
    'mytablex.Open "select * from familia where vetouch='S' order by DESCRIPCIO,ORDEN ", cn, adOpenStatic, adLockOptimistic
    mytablex.Open "select * from familia where vetouch='S' order by ORDEN,DESCRIPCIO ", cn, adOpenStatic, adLockOptimistic

    '22/06/2017 kenyo CORRECION orden familia y producto touch

    Do

        If mytablex.EOF Then Exit Do
        i = i + 1
        'mfamcod(i) = "" & mytablex.Fields("familia")
        mfamcod(i) = "" & mytablex.Fields("descripcio")
        wfamcod(i) = "" & mytablex.Fields("familia")
        mytablex.MoveNext
    Loop
    mfamtop = i
    mytablex.Close
    mfampag = 0
    menu_familia "INI"

End Sub

Sub cargar_grafico1()

    On Error GoTo cmd7779_err

    'Image1.Picture = LoadPicture(globalpath & "\ico\cajaper.jpg")
    Exit Sub
cmd7779_err:
    'MsgBox "" & error$
    Exit Sub

End Sub

Sub menu_familia(buf As String)

    Dim i As Integer

    Dim j As Integer

    Select Case buf

        Case "INI"
            mfampag = 0

        Case "SIG"
            mfampag = mfampag + 15

            If mfampag > 102 Then
                mfampag = 0

            End If

        Case "ANT"
            mfampag = mfampag - 15

            If mfampag < 0 Then
                mfampag = 0

            End If

    End Select

    j = -1

    For i = mfampag To 15 + mfampag
        j = j + 1
        zFamilias(j).Caption = mfamcod(i)
        wwfamcod(j) = wfamcod(i)
    
        'Color por familia y producto  30/05/2018
        Dim I1       As Integer

        Dim I2       As Integer

        Dim I3       As Integer

        Dim mytablex As New ADODB.Recordset

        mytablex.Open "SELECT * FROM familia where  familia='" & "" & wfamcod(i) & "'", cn, adOpenKeyset, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            I1 = "" & mytablex.Fields("c")
            I2 = "" & mytablex.Fields("d")
            I3 = "" & mytablex.Fields("e")
            zFamilias(j).BackColor = RGB(I1, I2, I3)

        End If

        mytablex.Close
        'Color por familia y producto  30/05/2018
    
    Next i

End Sub

Sub sql_detalle()

    Dim buf   As String

    Dim found As Integer

    On Error GoTo cmd34_err

    'MsgBox dgusuario
    buf = "select * from " & dgusuario
    Data2.Connect = "foxpro 2.5;"
    Data2.DatabaseName = globaldir
    Data2.RecordSource = buf
    Data2.refresh
    DBGrid2.refresh
    found = sumar_detalle()
    'DBGrid2.Row = dbgrid2.visiblerows - 2
    'DBGrid2.Col = 0
    'DBGrid2.SetFocus
    Exit Sub
cmd34_err:
    MsgBox "Error en select " & error$, 48, "Aviso"
    Exit Sub

End Sub

Sub sql_detalle9()

    Dim buf   As String

    Dim found As Integer

    On Error GoTo cmd34_err

    'MsgBox dgusuario
    buf = "select * from " & dgusuario & " ORDER BY familia"
    Data2.Connect = "foxpro 2.5;"
    Data2.DatabaseName = globaldir
    Data2.RecordSource = buf
    Data2.refresh
    DBGrid2.refresh
    found = sumar_detalle()
    'DBGrid2.Row = dbgrid2.visiblerows - 2
    'DBGrid2.Col = 0
    'DBGrid2.SetFocus
    Exit Sub
cmd34_err:
    MsgBox "Error en select " & error$, 48, "Aviso"
    Exit Sub

End Sub

Private Sub Form_Load()

    Dim found As Integer

    Dim sdx   As Double

    Dim xx    As String

    Dim i     As Integer

    dphora.Clear

    For i = 0 To 24
        dphora.AddItem Format(i, "00")
    Next i

    nrodecimal = "0.00"

    If "" & mytable11.Fields("decimal") = "3" Then
        nrodecimal = "0.000"

    End If

    moneda = "" & mytable11.Fields("moneda")
    caja = "" & mytable11.Fields("caja")
   
    DBGrid2.columns("precio").NumberFormat = nrodecimal
    DBGrid2.columns("total").NumberFormat = nrodecimal
   
    inicia_color_familia
    inicia_color_producto
    inicia_color_comandos
    Carga_Familia
    carga_dcvendedor
    carga_clasificacion
    carga_color
   
    '''' 17/07/2018 Factura de Exportación
    inicia_TipoOperacion
    inicia_TipoIgv
   
    '15/08/2018 Cambiar Descripcion de producto venta de ventas
    If busca_CambiaDescripcionVentas(1) = "N" Then
        DBGrid2.columns(1).Locked = True

    End If
   
    '15/08/2018 Cambiar Descripcion de producto venta de ventas
   
    '''' 17/07/2018 Factura de Exportación
   
    '' 10/07/2018 Edicion Comanda
    tipocomanda = "" & busca_TipoComanda
    formatocomanda = "" & mytable11.Fields("formatocomanda")
    '' 10/07/2018 Edicion Comanda
   
    'carga_cobranza
    found = busca_paridad()
    xopciones(30).Enabled = True
   
    '---------------------ultimo lo cambie aqui
    'sql_detalle
    'borrar_data2
    'found = sumar_detalle()
    'DBGrid2.Col = 0
    'DBGrid2.Row = DBGrid2.VisibleRows - 1
    '------------------------------------
   
    'DBGrid2.SetFocus
    cajero = "" & gusuario
    flag_carga = "S"
    'sumar_detalle
    tiposervicio1 = "Autoservicio"
    salon.Caption = ""
    mesa.Caption = ""
    mesero = ""
    cuenta_separa = ""
    'borrar_todo
   
    cargar_tmcombina
    sql_detalle
    'MsgBox "abc"
    flag_servicio = "A"
    'sql_detalle
    xx = busca_parame1("", 2)

    If "" & mytable11.Fields("terminal") = "T" Then
        menju232.Visible = False
        'dlo2342.Visible = False
        'dek7834.Visible = False
        'inu781.Visible = False
        'djk7822.Visible = False
        cuj6721.Visible = False

        'pedido.Visible = True
    End If
      
    'ezVidCap1.Height = 1080
    'ezVidCap1.Top = 240
    'ezVidCap1.Left = -240
    'ezVidCap1.Width = 3960
      
    'ezVidCap1.Height = 1920
    'ezVidCap1.Top = 240
    'ezVidCap1.Left = 0
    'ezVidCap1.Width = 3840
    cargar_grafico1
    'consulta_comanda "" & mytable11.Fields("salon")
    carga_clase_sunat
    'carga_habitacion
    'carga_serviciomesa
    'MsgBox "abc"

    '''''LEONARDO 15-12-2016--
    'Dim i As Integer
    'inicio 09/02/2018 pll
    'For i = 0 To 13
    'znumber(i).Sound = App.path & "\Sonido\click.wav": znumber(i).PlaySound = InClick
    ' znumber(i).Sound = "C:\Windows\click.wav": znumber(i).PlaySound = InClick
    'Next
    'fin 09/02/2018 pll

    'cmdCobrar.Sound = App.path & "\Sonido\cash.wav": cmdCobrar.PlaySound = InClick
    'cmdCobrar.Sound = "C:\Windows\cash.wav": cmdCobrar.PlaySound = InClick

    '----- LEONARDO CODIGO PARA BUSQUEDA DE RUC POR CLIENTE ----------
    PicCaptcha.AutoRedraw = True
    PicCaptcha.AutoSize = True
    PicCaptcha.ScaleMode = 3
    CboDocumento.ListIndex = 0
    xopciones(30).Enabled = True

End Sub

Private Sub Form_Unload(Cancel As Integer)

    On Error GoTo cmd123_err

    'icerrar_puerto
    icerrar_puertosmscomm
    Data2.Recordset.Close
    Exit Sub
cmd123_err:
    Exit Sub

End Sub

Sub cerrar_puerto()

    'On Error GoTo cmd8912_err
    'MSComm1.PortOpen = False
    'Exit Sub
    'cmd8912_err:
    'Exit Sub
End Sub

Private Sub forma671_Click()

    Dim sw As Integer

    flag_clave1 = 0
    tconcla.X = "CUADRE"
    tconcla.Show 1

    If flag_clave1 <> 1 Then  'si es descongela
        DBGrid2.SetFocus
        Exit Sub

    End If
    
    opcion1 = "6"
    opcion2 = "1"
    opcion3 = "2"
    tcuadrc1.fechai.Enabled = True
    tcuadrc1.fechaf.Enabled = True
    usuariopos = gusuario
    tcuadrc1.cajero = usuariopos
    tcuadrc1.caja = caja
    tcuadrc1.turno = turno
    tcuadrc1.horai = "01"
    tcuadrc1.horaf = "24"
    tcuadrc1.fechai = dia
    tcuadrc1.fechaf = dia
    
    tcuadrc1.Caption = "FORMPAGO-DOCUMENTOS"
    tcuadrc1.check3d1.Visible = True
    tcuadrc1.check3d2.Visible = True
    tcuadrc1.check3d3.Visible = True
    tcuadrc1.Show 1

End Sub

Sub habilita_lab7(sw As Integer)

    Dim xsw

    If sw = 0 Then
        xsw = True

    End If

    If sw = 1 Then
        xsw = False

    End If

    Label70.Enabled = xsw
    Label71.Enabled = xsw
    Label72.Enabled = xsw
    Label73.Enabled = xsw

End Sub

Private Sub fotoimagen_Click()
    'frmain.Show 1
    'toparam.caja = "" & mytable11.Fields("caja")
    'toparam.Show 1
    inicia_color_comandos

End Sub

Private Sub gt666_Click()
    tload.Label12.Caption = "CIERRE"
    tload.Show 1

End Sub

Private Sub hknumero_Change()
    'If hknumero.Caption <> "" Then
    txtDineroEntregado.Text = Format(Val(hknumero.Caption), ".00")

    'End If

    If hknumero.Caption = "" Then
        txtDineroEntregado.Text = "0.00"

    End If

End Sub

Private Sub horaentrega_DblClick()
    tkeyboar.FLAG = "HORA"
    tkeyboar.Show 1

End Sub

Private Sub hundv1_Click()

    Dim sw As Integer

    flag_clave1 = 0
    tconcla.X = "CUADRE"
    tconcla.Show 1

    If flag_clave1 <> 1 Then  'si es descongela
        DBGrid2.SetFocus
        Exit Sub

    End If

    opcion1 = "3"
    opcion2 = "1"
    opcion3 = "2"
    tcuadrc1.fechai.Enabled = True
    tcuadrc1.fechaf.Enabled = True
    usuariopos = gusuario
    tcuadrc1.cajero = usuariopos
    tcuadrc1.caja = caja
    tcuadrc1.turno = turno
    tcuadrc1.horai = "01"
    tcuadrc1.horaf = "24"
    tcuadrc1.fechai = dia
    tcuadrc1.fechaf = dia
    tcuadrc1.Caption = "UNIDADES VENDIDAS"
    tcuadrc1.check3d1.Visible = True
    tcuadrc1.check3d2.Visible = True
    tcuadrc1.check3d3.Visible = True
    
    ''''13/09/2017 kenyo Mejor Reporte Ticket
    tcuadrc1.check3d1 = 1
    tcuadrc1.check3d2 = 0
    ''''13/09/2017 kenyo Mejor Reporte Ticket
    
    tcuadrc1.Show 1

End Sub

Private Sub Image10_Click()
    consulta_comanda "" & mytable11.Fields("salon")

End Sub

Private Sub Image11_Click()

    Dim buf  As String

    Dim buf1 As String

    If Len(Trim(codigo)) = 11 Then
        nombre = ""
        buf1 = ""
        buf = Trim(OTROPOS(Trim(codigo), buf1))

        If Len(buf) > 0 Then
            'MsgBox buf1
            nombre = buf
            ydireccion = buf1

        End If

    End If

End Sub

Private Sub Image2_Click()

    On Error Resume Next

    'If dbvarios.BOF = False Then
    cmytablex.MovePrevious 'movemos al registro anterior
    '   Exit Sub
    'End If

    'dbvarios.MovePrevious
    If Not cmytablex.EOF Then
        cmytablex.MoveFirst
        Exit Sub

    End If

End Sub

Private Sub Image4_Click()
    menu_producto "SIG"

End Sub

Private Sub Image5_Click()

    'If Trim(Label2.Caption) = "FAMILIA" Then
    If Trim(Label2.Caption) = "FAMILIA" Then
        menu_familia "SIG"
        Exit Sub

    End If

    menu_subfamilia "SIG"

End Sub

Private Sub Image6_Click()

    'If Trim(Label2.Caption) = "FAMILIA" Then
    If Trim(Label2.Caption) = "FAMILIA" Then
        menu_familia "ANT"
        Exit Sub

    End If

    menu_subfamilia "ANT"

End Sub

Private Sub Image9_Click()
    menu_producto "ANT"

End Sub

Private Sub juhyua_Click()
    cgusuario = "FACTURA"
    dgusuario = "_d" & gusuario
    fgusuario = "_f" & gusuario
    dgusuariog = "DETALLE"
    explorap.fechai = "01/" & Format(Month(Now), "00") & "/" & Format(Year(Now), "0000")
    explorap.fechaf = Format(Now, "dd/mm/yyyy")
    explorap.fechai = Format(Now, "dd/mm/yyyy")
    explorap.Caption = "Documentos Guia Remision Compra"
    explorap.tipoclie = "P"
    explorap.acu = "S"
    explorap.Show 1

End Sub

Private Sub kcobra_Click(Index As Integer)
    'If Index = 11 Then
    '          RGPAGO = ""
    '          Exit Sub
    'End If
    'RGPAGO = RGPAGO & kcobra(Index).Caption

End Sub

Private Sub Label12_Click()

    'kumabo9_Click
End Sub

Sub sin_meseros()

    Dim found As Integer

    On Error GoTo cmd1289121_err

    'nmesero = usuariog
    'mesero = usuariog
    'grabar_comandax
    Exit Sub
cmd1289121_err:
    MsgBox "Seleccione un dato ", 48, "Aviso"
    Exit Sub

End Sub

Sub borra_congela()

    If Frame2.Visible = True Then Exit Sub
    'If MsgBox("Desea Borrar ??", 1, "Aviso") <> 1 Then Exit Sub
    borrar_todo
    sql_detalle
    tiposervicio1 = "Autoservicio"
    flag_servicio = "A"
    salon.Caption = ""
    mesa.Caption = ""
    mesero = ""
    cuenta_separa = ""

End Sub

Private Sub lkcop992_Click()

End Sub

Private Sub Label13_Click()
    consulta_xvendedor

End Sub

Private Sub Label14_Click()

    If MonthView1.Visible = True Then
        MonthView1.Visible = False
        fechae.SetFocus
        Exit Sub

    End If

    If MonthView1.Visible = False Then
        'MsgBox "dd"
        MonthView1.Value = CDate(Format(Now, "dd/mm/yyyy"))
        MonthView1.Visible = True
        fechae.SetFocus
        Exit Sub

    End If

End Sub

Private Sub Label15_Click()
    ' 25/07/2018 Delivery y Para Llevar desde mozo
    'consulta_comanda "04"
    consulta_comanda "LL"

    ' 25/07/2018 Delivery y Para Llevar desde mozo
End Sub

Private Sub Label2_Click()
    Label2.Caption = "FAMILIA"
    Carga_Familia

End Sub

Private Sub Label22_Click()

    On Error GoTo cmd88812_err

    If borrar_pedido_ot(Trim("" & rcconsulta.Fields("local")), Trim("" & rcconsulta.Fields("tipo")), Trim("" & rcconsulta.Fields("serie")), Trim("" & rcconsulta.Fields("numero"))) = 0 Then
        MsgBox "No se pudo borrar el pedido ", 48, "Aviso"
        Exit Sub

    End If

    Exit Sub
cmd88812_err:
    MsgBox "Seleccione un dato ", 48, "Aviso"
    Exit Sub

End Sub

Private Sub Label24_Click()
    'If local1.Visible <> True Then  'si no es traslado
    consulta_xtipo
    'End If

End Sub

Private Sub dbgrid1_KeyDown(KeyCode As Integer, Shift As Integer)

        Dim found    As Integer

        Dim xbuf     As String

        Dim buf      As String

        Dim mytablex As New ADODB.Recordset

        Dim xtemp    As Variant

        Dim anumero  As String

        Dim atipo    As String

        Dim aserie   As String

        Dim sdx      As Double

        Dim canti    As String

        DBGrid2.Enabled = True

        If KeyCode = 27 Then
            losao94_Click
            Exit Sub

        End If

        'MsgBox opcion1
        'If KeyCode = 0 Then Exit Sub
        'MsgBox opcion1

        If KeyCode = &H2E Then  'borrar linea
            If opcion1 = "1900" Then 'borrar cproform
                If MsgBox("Desea Borrar Proforma " & rcconsulta.Fields("numero"), 1, "Aviso") <> 1 Then
                    dbGrid1.SetFocus
                    Exit Sub

                End If

                protipo = "" & rcconsulta.Fields("tipo")
                proserie = "" & rcconsulta.Fields("serie")
                pronumero = "" & rcconsulta.Fields("numero")
                found = borrar_proformas()
                protipo = ""
                proserie = ""
                pronumero = ""
                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus
                Exit Sub

            End If

            If opcion1 = "15000" Then 'borrar cproform
                If MsgBox("Desea Borrar Pedido " & rcconsulta.Fields("numero"), 1, "Aviso") <> 1 Then
                    dbGrid1.SetFocus
                    Exit Sub

                End If

                protipo = "" & rcconsulta.Fields("tipo")
                proserie = "" & rcconsulta.Fields("serie")
                pronumero = "" & rcconsulta.Fields("numero")
                found = borrar_pedidoventa()
                protipo = ""
                proserie = ""
                pronumero = ""
                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus
                Exit Sub

            End If

            Exit Sub

        End If

        If KeyCode = &H71 Then  'f2  Verifica delivery
            'MsgBox opcion1
            proceso_15000
            Exit Sub

        End If

        If KeyCode = &H70 Then  'f1  visualizar el detalle

            'MsgBox opcion1
            If opcion1 = "8" Then  'si esta en productos
                If Len("" & rcconsulta.Fields("producto")) > 0 Then
                    xproducto = "" & rcconsulta.Fields("producto")
                    carga_dbgrid4 "" & rcconsulta.Fields("producto")
          
                    Exit Sub

                End If

            End If

            'MsgBox opcion1
     
            '' 22/12/2017 Detalle de productos en copia,anulacion de ventas, pedidos y cotizaciones
            ' Carga detalle de cotizacion
            If opcion1 = "30000" Then
                If Len("" & rcconsulta.Fields("tipo")) > 0 Then
                    visualiza_detalle_factura "" & rcconsulta.Fields("tipo"), "" & rcconsulta.Fields("serie"), "" & rcconsulta.Fields("numero")
                    Exit Sub

                End If

            End If

            '' 22/12/2017 Detalle de productos en copia,anulacion de ventas, pedidos y cotizaciones
   
            If opcion1 = "15000" Or opcion1 = "1500" Or opcion1 = "15" Or opcion1 = "100" Or opcion1 = "1900" Then
                If Len("" & rcconsulta.Fields("tipo")) > 0 Then
                    visualiza_detalle_factura "" & rcconsulta.Fields("tipo"), "" & rcconsulta.Fields("serie"), "" & rcconsulta.Fields("numero")
                    Exit Sub

                End If

            End If
   
            Exit Sub

        End If

        If KeyCode = 13 Then

            '''27/07/2017 kenyo Testing Completo al Sistema
            If rcconsulta.RecordCount = 0 Then
                Exit Sub

            End If

            '''27/07/2017 kenyo Testing Completo al Sistema

            If opcion1 = "8" Then
                If Trim("" & rcconsulta.Fields("estado")) = "N" Then
                    MsgBox "Producto No activo ", 48, "Aviso"
                    dbGrid1.SetFocus
                    Exit Sub

                End If

                stkminimo = ""

                If "" & mytable11.Fields("stkminimo") = "S" And Len(Trim(Label12)) = 0 Then
                    mytablex.Open "SELECT * FROM producto where producto='" & "" & rcconsulta.Fields(1) & "'", cn, adOpenDynamic, adLockOptimistic

                    If mytablex.RecordCount > 0 Then
                        If familia_saldo("" & mytablex.Fields("familia")) = 0 Then
                            consulta_minimo "" & mytablex.Fields("producto"), "" & mytablex.Fields("minimo")

                        End If

                    End If

                    mytablex.Close

                End If

                If "" & mytable11.Fields("nosaldo") = "S" Then
                    found = 0

                    If found = 2 Then
                        MsgBox "Se detecto un saldo receta con saldo<=0 ", 48, "Aviso"
                        Exit Sub

                    End If

                    If familia_saldo("" & DBGrid2.columns("familia")) = 0 Then
                        If consulta_saldo("" & rcconsulta.Fields(1), 1, 0) <= 0 Then
                            MsgBox "No existe saldo", 48, "Aviso"
                            dbGrid1.SetFocus
                            Exit Sub

                        End If

                    End If

                End If
       
                If Val(rcconsulta.Fields("precio")) <= 0 Then
                    If "" & mytable11.Fields("noprecio") = "S" Then
                        MsgBox "Precio<=0", 48, "Aviso"
                        dbGrid1.SetFocus
                        Exit Sub

                    End If

                End If

                If Len("" & DBGrid2.columns(0)) = 0 And Len("" & rcconsulta.Fields(1)) > 0 Then
                    canti = ""
                    '            If verifica_balanza("" & rcconsulta.Fields(1)) = "S" Then
                    'ajk922:
                    '              buf = puerto_balanza1()
                    '                If Val(buf) <= 0 Then
                    '                    If MsgBox("Balanza No leido,Continua Leyendo? ", 1, "Aviso") = 1 Then
                    '                        GoTo ajk922
                    '                    End If
                    '                    losao94_Click
                    '                    Exit Sub
                    '                End If
                    '                canti = Format(Val(buf), "0.000")
                    '            End If
                    'AQUI TIENES QUE REVISAR JOHNNY
                    '-----------------------------------
                    'MsgBox ""
                    DBGrid2.refresh
                    ir_ultimo_registrox
           
250                 DBGrid2.Col = 0
252                 DBGrid2.Row = DBGrid2.VisibleRows - 1
254                 DBGrid2.SetFocus
      
256                 DBGrid2.columns(0) = "" & rcconsulta.Fields(1)
258                 xbuf = "" & rcconsulta.Fields(1)
                    'MsgBox xbuf
260                 found = busca_producto("" & DBGrid2.columns(0), 0, canti, 0)

262                 If found = 0 Then
264                     dbGrid1.SetFocus
                        Exit Sub

                    End If

266                 If found = 2 Then
268                     dbGrid1.SetFocus
                        'MsgBox "hOLA"
                        Exit Sub

                    End If

                    '------------------------------------------------
270                 Frame1.Visible = False
272                 Frame1.Enabled = False
          
                    'aqui ponemos si tiene mas de un precio
          
                    If ver_si_puedo_dbgrid(xbuf) = 1 Then  'existe mas de un precio
                        ' DBGrid2.Col = 0
                        'DBGrid2.Row = DBGrid2.VisibleRows - 2
                        ' xproducto = "" & dbGrid1.columns(1)
                        '               carga_dbgrid4 "" & dbGrid1.columns(1)
         
276                     DBGrid2.Row = DBGrid2.VisibleRows - 2
278                     DBGrid2.Col = 3
280                     xproducto = xbuf
282                     carga_dbgrid4 xbuf
284                     swprecio = 1
                        Exit Sub

                    End If
              
286                 If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Len(Trim("" & DBGrid2.columns("linea"))) > 0 Then
288                     DBGrid2.Col = 3
290                     DBGrid2.SetFocus
292                     ingreso_tallas "" & DBGrid2.columns("linea")
                        Exit Sub

                    End If

294                 If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Trim("" & mytable11.Fields("obligavendedor")) = "S" Then
296                     DBGrid2.Col = 3
298                     DBGrid2.SetFocus
300                     carga_vendedorpp
                        Exit Sub

                    End If
     
                    '' kenyo 02/11/2017 Configuración Productos Comentarios Obligatorios

                    If mytablex.State = 1 Then mytablex.Close
            
                    mytablex.Open "SELECT obligacomentario FROM producto where producto='" & DBGrid2.columns("producto") & "'", cn, adOpenDynamic, adLockOptimistic

                    If mytablex.RecordCount > 0 Then
                        If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And ("" & mytablex.Fields("obligacomentario")) = "S" Then
                            DBGrid2.Col = 1
                            DBGrid2.SetFocus
                            txobserv.Show 1

                        End If

                    End If

                    mytablex.Close
                    '' kenyo 02/11/2017 Configuración Productos Comentarios Obligatorios
      
                    'Combos Combinaciones 07/07/2018
                    combinac = "N"

                    Dim mytablezx As New ADODB.Recordset
        
                    If Len(DBGrid2.columns(0)) = 0 Then
                        Exit Sub

                    End If

                    If mytablezx.State = 1 Then mytablezx.Close
        
                    mytablezx.Open "SELECT * FROM combina where producto='" & "" & DBGrid2.columns(0) & "'", cn, adOpenDynamic, adLockOptimistic

                    If mytablezx.RecordCount > 0 Then
                        combinac = "S"
                        Do

                            If mytablezx.EOF Then Exit Do
                            DBGrid2.Col = 0
                            DBGrid2.SetFocus
                            DBGrid2.Row = DBGrid2.VisibleRows - 1
                            hknumero = mytablezx.Fields("cantidad")
                            busca_cod_producto mytablezx.Fields("productop"), 0
                            mytablezx.MoveNext
                        Loop
                        mytablezx.Close
                        combinac = "N"

                    End If

                    'Combos Combinaciones 07/07/2018
     
                    'verificar si tiene talla
302                 found = sumar_detalle()
304                 DBGrid2.Row = DBGrid2.VisibleRows - 1
306                 DBGrid2.SetFocus
                    ''26/07/2017 kenyo hknumero
                    hknumero.Caption = ""
                    ''26/07/2017 kenyo hknumero
          
                    Exit Sub

                End If
          
            End If

            If opcion1 = "10" Then  'modifica
                xtipo = "" & rcconsulta.Fields("tipo")
                xserie = "" & rcconsulta.Fields("serie")
                xnumero = "" & rcconsulta.Fields("numero")
                telefono = "" & rcconsulta.Fields("telefono")
                codigo = "" & rcconsulta.Fields("codigo")
                nombre = "" & rcconsulta.Fields("nombre")
                found = busca_codigod()
                modifica_detalle

                If "" & rcconsulta.Fields("servicio") = "A" Then
                    tiposervicio = "Autoservicio"

                End If

                If "" & rcconsulta.Fields("servicio") = "D" Then
                    tiposervicio = "DELIVERY"

                End If

                xestado = "Modifica"
                Data2.refresh
                Frame1.Visible = False
                Frame1.Enabled = False

            End If

            If opcion1 = "0" Then
                telefono = "" & rcconsulta.Fields("telefono")
                dcodigo = "" & rcconsulta.Fields("codigo")
                dnombre = "" & rcconsulta.Fields("nombre")
                found = busca_codigod()
                Frame1.Visible = False
                Frame1.Enabled = False
                dcodigo.SetFocus
                dcodigo_KeyPress 13

            End If

            If opcion1 = "1" Then
                If Len(Trim("" & rcconsulta.Fields("codigo"))) = 0 Then
                    Exit Sub

                End If

                telefono = Trim("" & rcconsulta.Fields("telefono"))
                dcodigo = Trim("" & rcconsulta.Fields("codigo"))
                dnombre = Trim("" & rcconsulta.Fields("nombre"))
                ddireccion = Trim("" & rcconsulta.Fields("direccion"))
                fechanac = Trim("" & rcconsulta.Fields("fechanac"))
                referencia = Trim("" & rcconsulta.Fields("referencia"))
                clasificacion = Trim("" & rcconsulta.Fields("clasifica"))
                saludo_cumpe
                Frame1.Visible = False
                Frame1.Enabled = False
                dnombre.SetFocus

                'dcodigo_KeyPress 13
            End If

            If opcion1 = "1750" Then
                dcodigo = "" & rcconsulta.Fields("codigo")
                dnombre = "" & rcconsulta.Fields("nombre")
                ddireccion = "" & rcconsulta.Fields("direccion")
                fechanac = "" & rcconsulta.Fields("fechanac")
                telefono = "" & rcconsulta.Fields("telefono")
                saludo_cumpe
                Frame1.Visible = False
                Frame1.Enabled = False
                dcodigo.SetFocus
                dcodigo_KeyPress 13

            End If

            If opcion1 = "23" Then
                tcampo1 = "" & rcconsulta.Fields("codigo")
                Frame1.Visible = False
                Frame1.Enabled = False
                tcampo1.SetFocus
                tcampo1_KeyPress 13

            End If

            If opcion1 = "200" Then
                ''''28/09/2017 kenyo Mejora Reportes Forma de pago y Creditos Finanzas
                tcampo5 = "" & rcconsulta.Fields("banco")
                Frame1.Visible = False
                Frame1.Enabled = False
                tcampo5.SetFocus
                ''''28/09/2017 kenyo Mejora Reportes Forma de pago y Creditos Finanzas
               
            End If

            If opcion1 = "12" Then
                frmClientesRUC.Visible = True
            
                codigo = "" & rcconsulta.Fields("codigo")
                nombre = "" & rcconsulta.Fields("nombre")
                Frame1.Visible = False
                Frame1.Enabled = False
                codigo.SetFocus
                codigo_KeyPress 13

            End If

            If opcion1 = "2003" Then
                tcampo3 = "" & rcconsulta.Fields("tipo")
                tcampo4 = "" & rcconsulta.Fields("serie")
                tcampo5 = "" & rcconsulta.Fields("numero")
                totpedido = "" & suma_pedidos("" & rcconsulta.Fields("codigo"), "" & rcconsulta.Fields("tipo"), "" & rcconsulta.Fields("serie"), "" & rcconsulta.Fields("numero"))
                Frame1.Visible = False
                Frame1.Enabled = False
                tcampo3.SetFocus
                tcampo3_KeyPress 13

            End If

            If opcion1 = "19000" Then
                flag_servicio = Trim("" & rcconsulta.Fields("servicio"))
                Frame1.Visible = False
                Frame1.Enabled = False
                '--------------cobrar --------------------------------
                Label36.Caption = "Codigo"
                cobra_servicio
                palabra_bienvenida1
                Exit Sub

            End If
   
            If opcion1 = "300" Then 'bodega de traslado
                xruc = "" & rcconsulta.Fields("codigo")
                xnombre = "" & rcconsulta.Fields("nombre")
                Frame1.Visible = False
                Frame1.Enabled = False
                xruc.SetFocus
                xruc_KeyPress 13

            End If
   
            If opcion1 = "31" Then
                ''08/07/2017 KENYO Correccion delivery
                cmdCobrar.Enabled = True
                ''08/07/2017 KENYO Correccion delivery
             
                xvendedor = "" & rcconsulta.Fields("codigo")
                
                '12/06/2017 kenyo selecciona vendedor
                vendedor = "" & rcconsulta.Fields("codigo")
                ' xvendedor = "" & rcconsulta.Fields("codigo")
                '12/06/2017 kenyo selecciona vendedor
                
                'inicio 21/04/2017 pll
                If xvendedor <> "" Then
                    Frame1.Visible = False
                    Frame1.Enabled = False
                Else
                    MsgBox "Seleciona un vendedor", 48, "Aviso"
                    Frame1.Visible = True
                    Frame1.Enabled = True

                End If
              
                If Frame7.Visible = False Then
                    cproven = xvendedor
                    DBGrid2.SetFocus
                Else
                    xruc.SetFocus

                End If
                
                'inicio 21/04/2017 pll
                'xvendedor.SetFocus
                'xvendedor_KeyPress 13
                'dbgrid6
                'inicio 21/04/2017 pll
                
            End If

            If opcion1 = "30" Then
                If xtipo = "2" Or xtipo = "4" Then
                    xruc = Trim("" & rcconsulta.Fields("codigo"))
                Else
                    xruc = Trim("" & rcconsulta.Fields("codigo"))

                End If

                codigo = Trim("" & rcconsulta.Fields("codigo"))
                xnombre = Trim("" & rcconsulta.Fields("nombre"))
                nombre = Trim("" & rcconsulta.Fields("nombre"))
                xdireccion = Trim("" & rcconsulta.Fields("direccion"))
                Frame1.Visible = False
                Frame1.Enabled = False
                xdireccion_KeyPress 13

            End If

            If opcion1 = "99" Then
                tcampo1 = "" & rcconsulta.Fields("codigo")
                tcampo2 = "" & rcconsulta.Fields("nombre")
                Frame1.Visible = False
                Frame1.Enabled = False
                tcampo1.SetFocus
                tcampo1_KeyPress 13

            End If

            If opcion1 = "2800" Then
                If Val("" & rcconsulta.Fields("saldo")) < Val(stxtotals) Then
                    MsgBox "Debe ingresar valor exacto", 48, "Aviso"
                    dbGrid1.SetFocus
                    Exit Sub

                End If

                tcampo1 = "" & rcconsulta.Fields("codigo")
                tcampo2 = "" & rcconsulta.Fields("nombre")
                tcampo3 = "" & rcconsulta.Fields("numero")
                tcampo4 = "" & rcconsulta.Fields("tipo")
                tcampo5 = "" & rcconsulta.Fields("serie")
                tcampo6 = "" & rcconsulta.Fields("local")
                saldoabo = "" & rcconsulta.Fields("saldo")
                Frame1.Visible = False
                Frame1.Enabled = False
                tcampo3.SetFocus

            End If

            If opcion1 = "29" Then
                xtipo = "" & rcconsulta.Fields(1)
                Frame1.Visible = False
                Frame1.Enabled = False
                xtipo.SetFocus
                xtipo_keyPress 13

            End If

            If opcion1 = "13" Then  'copia documento
                If MsgBox("Desea Sacar Copia del Documento", 1, "Aviso") <> 1 Then Exit Sub
                proceso_impresioncopia
                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus

            End If

            If opcion1 = "1500" Then  'carga documento anterior
                If MsgBox("Desea Cargar Detalle Documento ", 1, "Aviso") <> 1 Then Exit Sub
                found = proceso_carga_doc_ant("" & rcconsulta.Fields("local"), "" & rcconsulta.Fields("tipo"), "" & rcconsulta.Fields("serie"), "" & rcconsulta.Fields("numero"))

                If found = 0 Then
                    MsgBox "Error de carga", 48, "Aviso"
                    Exit Sub

                End If

                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus

            End If
        
            If opcion1 = "15000" Then  'carga pedidos de venta anteriores para cancelar
                If MsgBox("Desea Cargar Detalle Documento ", 1, "Aviso") <> 1 Then Exit Sub
                petipo = "" & rcconsulta.Fields("tipo")
                peserie = "" & rcconsulta.Fields("serie")
                penumero = "" & rcconsulta.Fields("numero")
                acuenta = "" & rcconsulta.Fields("acuenta")
                codigo = "" & rcconsulta.Fields("codigo")
                nombre = "" & rcconsulta.Fields("nombre")
               
                '''15/09/2017 KENYO Carga Vendedor de la orden de trabajo OT
                xvendedor = "" & rcconsulta.Fields("vendedor")
                vendedor = "" & rcconsulta.Fields("vendedor")
                cproven = "" & rcconsulta.Fields("vendedor")
                '''15/09/2017 KENYO Carga Vendedor de la orden de trabajo OT
               
                'cproven = "" & rcconsulta.Fields("vendedor")
                found = proceso_carga_Pedido("" & rcconsulta.Fields("local"), "" & rcconsulta.Fields("tipo"), "" & rcconsulta.Fields("serie"), "" & rcconsulta.Fields("numero"))

                If found = 0 Then
                    MsgBox "Error de carga", 48, "Aviso"
                    Exit Sub

                End If

                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus
            
                If opciontablet = "S" Then
                    Frame2.Visible = True ' DELIVERY
                    dcodigo = codigo
                    Label9_Click

                End If
     
            End If
   
            ''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas
            If opcion1 = "70000" Then  'carga cobro credito
 
                If dbgrid6.Visible = True Then Exit Sub
                If Framefp.Visible = True Then Exit Sub
                If Frame7.Visible = True Then Exit Sub
                If Frame6.Visible = True Then Exit Sub
         
                found = copiar_recibos()

                If found = 0 Then
                    MsgBox "Error al copiar archivo temporal", 24, "Aviso"
                    Exit Sub

                End If

                fgusuario = "_l" & gusuario
                found = copiar_tmpfpagoR()

                If found = 0 Then
                    MsgBox "No se puede copiar temporal tmpfpagor", 48, "Aviso"
                    Exit Sub

                End If
        
                fgusuario = "_r" & gusuario
                trecaja.pagocash.Visible = True
                trecaja.xcuentaco = "cuentac"
                trecaja.XCUENTACO1 = "cuentacd"
                trecaja.tipoclie = "C"
                trecaja.Combo2.Enabled = True
        
                trecaja.Caption = "INGRESO DINERO"
                trecaja.afecta = "C"
                trecaja.pagocash.Value = 1
            
                trecaja.tipoclie = Trim("" & rcconsulta.Fields("tipoclie"))
                trecaja.codigo = Trim("" & rcconsulta.Fields("codigo"))
                trecaja.nombre = Trim("" & rcconsulta.Fields("nombre"))
                trecaja.moneda = "S"
                trecaja.local1 = Trim("" & rcconsulta.Fields("local"))
                trecaja.tipod = Trim("" & rcconsulta.Fields("tipo"))
                trecaja.seried = Trim("" & rcconsulta.Fields("serie"))
                trecaja.numerod = Trim("" & rcconsulta.Fields("numero"))
                trecaja.cargar.Visible = True
                
                trecaja.local1 = "" & mytable11.Fields("local")
                trecaja.serie = "" & mytable11.Fields("serieri")
                trecaja.acu = "W"
                trecaja.cajero = cajero
                trecaja.caja = caja
                trecaja.turno = turno
                trecaja.fecha = dia
                trecaja.dia = dia
                trecaja.fecha.Enabled = False
                trecaja.ch89343.Visible = True
                trecaja.d7823.Visible = True
            
                '16/03/2018 No sale error en Ingreso/Egreso desde Menu
                AbreGaveta = "S"
                '16/03/2018 No sale error en Ingreso/Egreso desde Menu
            
                trecaja.tipo = "RI"
                trecaja.Show 1
                'trecaja.cargar_Click
                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus
            
            End If

            ''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas
   
            If opcion1 = "15000B" Then  'carga pedidos de venta anteriores para cancelar
                MsgBox "Presione F2 para generar la entrega..", 48, "Aviso"
                DBGrid2.SetFocus
                Exit Sub

                If MsgBox("Desea Cargar Detalle OT ", 1, "Aviso") <> 1 Then Exit Sub
                grtipo = "" & rcconsulta.Fields("tipo")
                grserie = "" & rcconsulta.Fields("serie")
                grnumero = "" & rcconsulta.Fields("numero")
                'acuenta = "" & rcconsulta.Fields("acuenta")
                codigo = "" & rcconsulta.Fields("codigo")
                nombre = "" & rcconsulta.Fields("nombre")
                'cproven = "" & rcconsulta.Fields("vendedor")
                found = proceso_carga_Pedido("" & rcconsulta.Fields("local"), "" & rcconsulta.Fields("tipo"), "" & rcconsulta.Fields("serie"), "" & rcconsulta.Fields("numero"))

                If found = 0 Then
                    MsgBox "Error de carga", 48, "Aviso"
                    Exit Sub

                End If

                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus

            End If
   
            If opcion1 = "15000A" Then  'carga pedidos de venta para abonar
                If MsgBox("Desea Cargar Detalle Documento ", 1, "Aviso") <> 1 Then Exit Sub
                axclocal = "" & rcconsulta.Fields("local")
                axctipo = "" & rcconsulta.Fields("tipo")
                axcserie = "" & rcconsulta.Fields("serie")
                axcnumero = "" & rcconsulta.Fields("numero")
                axctotal = "" & (Val("" & rcconsulta.Fields("total")) - Val("" & rcconsulta.Fields("acuenta")))
                Label12 = axclocal & " " & axctipo & " " & axcserie & " " & axcnumero & " Saldo=" & "" & (Val("" & rcconsulta.Fields("total")) - Val("" & rcconsulta.Fields("acuenta")))
                'acuenta = "" & rcconsulta.Fields("acuenta")
                codigo = "" & rcconsulta.Fields("codigo")
                nombre = "" & rcconsulta.Fields("nombre")
                abono_orden
           
                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus

            End If
   
            If opcion1 = "15000Z" Then  'carga pedidos de venta para abonar
                If MsgBox("Desea Cargar Detalle Documento ", 1, "Aviso") <> 1 Then Exit Sub
                axclocal = "" & mytable11.Fields("local")
                axctipo = "RE" '& rcconsulta.Fields("tipo")
                axcserie = "001" '& rcconsulta.Fields("serie")
                axcnumero = "" & rcconsulta.Fields("reserva")
                axctotal = "" & (Val("" & rcconsulta.Fields("saldo")))
                Label12 = axclocal & " " & axctipo & " " & axcserie & " " & axcnumero & " Saldo=" & "" & Val("" & rcconsulta.Fields("saldo"))
                'acuenta = "" & rcconsulta.Fields("acuenta")
                codigo = "" & rcconsulta.Fields("codigo")
                nombre = "" & rcconsulta.Fields("nombre")
                abono_reserva
                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus

            End If
   
            If opcion1 = "15000Y" Then  'carga pedidos de venta para abonar
                If MsgBox("Desea Cargar Detalle Documento ", 1, "Aviso") <> 1 Then Exit Sub
                axclocal = "" & mytable11.Fields("local")
                axctipo = "CK" '& rcconsulta.Fields("tipo")
                axcserie = "001" '& rcconsulta.Fields("serie")
                axcnumero = "" & rcconsulta.Fields("checkin")
                axctotal = "" & (Val("" & rcconsulta.Fields("saldo")))
                Label12 = axclocal & " " & axctipo & " " & axcserie & " " & axcnumero & " Saldo=" & "" & Val("" & rcconsulta.Fields("saldo"))
                'acuenta = "" & rcconsulta.Fields("acuenta")
                codigo = "" & rcconsulta.Fields("codigo")
                nombre = "" & rcconsulta.Fields("nombre")
                abono_checkin
                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus

            End If
   
            If opcion1 = "30000" Then  'carga cotizaciones
                If MsgBox("Desea Cargar Detalle Documento ", 1, "Aviso") <> 1 Then Exit Sub
                petipo = "" & rcconsulta.Fields("tipo")
                peserie = "" & rcconsulta.Fields("serie")
                penumero = "" & rcconsulta.Fields("numero")
                codigo = "" & rcconsulta.Fields("codigo")
                nombre = "" & rcconsulta.Fields("nombre")
                cproven = "" & rcconsulta.Fields("vendedor")
                found = proceso_carga_cotizacion("" & rcconsulta.Fields("local"), "" & rcconsulta.Fields("tipo"), "" & rcconsulta.Fields("serie"), "" & rcconsulta.Fields("numero"))

                If found = 0 Then
                    MsgBox "Error de carga", 48, "Aviso"
                    Exit Sub

                End If

                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus

            End If

            If opcion1 = "1900" Then  'cargar proformas
                If MsgBox("Desea Cargar Proforma ", 1, "Aviso") <> 1 Then Exit Sub
                found = proceso_proforma("" & rcconsulta.Fields("local"), "" & rcconsulta.Fields("tipo"), "" & rcconsulta.Fields("serie"), "" & rcconsulta.Fields("numero"))

                If found = 0 Then
                    MsgBox "Error de carga", 48, "Aviso"
                    dbGrid1.SetFocus
                    Exit Sub

                End If
        
                cproven = "" & rcconsulta.Fields("vendedor")
                codigo = "" & rcconsulta.Fields("codigo")
                nombre = "" & rcconsulta.Fields("nombre")
                protipo = "" & rcconsulta.Fields("tipo")
                proserie = "" & rcconsulta.Fields("serie")
                pronumero = "" & rcconsulta.Fields("numero")
                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus

            End If

            If opcion1 = "14" Then  'BORRAR
                If MsgBox("Desea Borrar del Documento", 1, "Aviso") <> 1 Then Exit Sub
                PROCESO_BORRAR_DOCUMENTO "" & rcconsulta.Fields("local"), "" & rcconsulta.Fields("tipo"), "" & rcconsulta.Fields("serie"), "" & rcconsulta.Fields("numero")
                Frame1.Visible = False
                DBGrid2.SetFocus

            End If

            If opcion1 = "150" Then 'descongelar
                found = menu_descongela("" & rcconsulta.Fields(1))
                MsgBox "Presione enter para continuar...", 48, "Aviso"

                If found = 1 Then
             
                    '' 13/01/2018 Fecha de registro y cambio de congelados
                    fechaicongela = "" & rcconsulta.Fields("fechae")
                    '' 13/01/2018 Fecha de registro y cambio de congelados

                    borrar_descongela1 "" & rcconsulta.Fields(1)
                    borrar_descongela "" & rcconsulta.Fields(1)
   
                    sql_detalle
                    found = sumar_detalle()
                    losao94_Click

                End If

            End If

            If opcion1 = "370" Then 'cargar reposicion para modificar
                found = menu_repone("" & rcconsulta.Fields("numero"))
                MsgBox "Presione enter para continuar...", 48, "Aviso"

                If found = 1 Then
                    borrar_repone "" & rcconsulta.Fields("numero")
                    borrar_reponexx
                    sql_detalle
                    found = sumar_detalle()
                    losao94_Click

                End If

            End If

            If opcion1 = "750" Then  'deliveri no xxx
                If "" & rcconsulta.Fields("flag_deli") = "S" Then
                    flag_clave1 = 0
                    tconcla.X = "N"
                    tconcla.Show 1

                    If flag_clave1 <> 1 Then  'si es descongela
                        DBGrid2.SetFocus
                        Exit Sub

                    End If

                    Exit Sub

                End If

                If "" & rcconsulta.Fields("flag_deli") = "" Then
                    Exit Sub

                End If

                Exit Sub

            End If
   
            If opcion1 = "15" Then  'copia documento
                If MsgBox("Desea Sacar Copia del Documento", 1, "Aviso") <> 1 Then
                    dbGrid1.SetFocus
                    Exit Sub

                End If

                atipo = "" & rcconsulta.Fields("tipo")
                aserie = "" & rcconsulta.Fields("serie")
                anumero = "" & rcconsulta.Fields("numero")
    
                proceso_impresion11 atipo, aserie, anumero, 1, "1"
            
                '28/08/2018 impresión de copia de delivery
                If ("" & rcconsulta.Fields("S")) = "D" Then
                    codigo = "" & rcconsulta.Fields("codigo")
                    found = imprime_adicional(atipo, aserie, anumero, 0, "")
                    codigo = ""

                End If
                
                If busca_tipoSalon(extra_loquesea("" & rcconsulta.Fields("salon"))) = "D" Then
                    codigo = "" & rcconsulta.Fields("codigo")
                    found = imprime_adicional(atipo, aserie, anumero, 0, "")
                    codigo = ""

                End If

                '28/08/2018 impresión de copia de delivery
            
                Frame1.Visible = False
                Frame1.Enabled = False
                DBGrid2.SetFocus
                Exit Sub

            End If

            If opcion1 = "100" Then  'anula documento
                If "" & rcconsulta.Fields("e") = "1" Then
                    MsgBox "Documento Anulado ", 48, "Aviso"
                    dbGrid1.SetFocus
                    Exit Sub

                End If

                If MsgBox("Desea Anular Documento " + "" & rcconsulta.Fields("numero"), 1, "Aviso") <> 1 Then
                    dbGrid1.SetFocus
                    Exit Sub

                End If

                atipo = "" & rcconsulta.Fields("tipo")
                aserie = "" & rcconsulta.Fields("serie")
                anumero = "" & rcconsulta.Fields("numero")
                found = proceso_anular(atipo, aserie, anumero)

                If found = 1 Then
                    proceso_impresion11 atipo, aserie, anumero, 0, ""

                    If Trim("" & mytable11.Fields("hod")) = "S" And Trim(rcconsulta.Fields("tipo")) <> "C" Then 'enviar orden de despacho
                        found = orden_despacho_n("" & mytable11.Fields("local"), atipo, aserie, anumero, "***ANULADO***", 0)

                        'orden13012015 "" & mytable11.Fields("local"), atipo, aserie, anumero
                    End If

                    Frame1.Visible = False
                    Frame1.Enabled = False
                    DBGrid2.SetFocus
                    Exit Sub

                End If

                dbGrid1.SetFocus

            End If

            Exit Sub

        End If

        'KeyCode = 0

End Sub

Private Sub Label36_Click()

    Dim found As Integer

    Dim buf   As String

    Dim buf1  As String

    buf1 = ""

    If Len(Trim(xruc)) = 0 Then
        'If local1.Visible <> True Then
        consulta_xruc
        'End If
        '  If local1.Visible = True Then
        '   consulta_xruc2
        'End If
        Exit Sub

    End If

    If Len(Trim(xruc)) = 11 Then
        xnombre = ""
        buf = Trim(OTROPOS(Trim(xruc), buf1))

        If Len(buf) > 0 Then
            xnombre = buf
            xdireccion = buf1
            xnombre.SetFocus

        End If

    End If

End Sub

Private Sub Label38_Click()

End Sub

''' 29/01/2018 Comisiones por producto por trabajador.
Function busca_comisiones(xproducto As String, xvendedor As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close

    mytablex.Open "SELECT * FROM vendedorcomision where  producto='" & xproducto & "' and codigo='" & xvendedor & "' ", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        busca_comisiones = mytablex.Fields("comision")
    Else
        busca_comisiones = 0

    End If

    mytablex.Close

End Function

''' 29/01/2018 Comisiones por producto por trabajador.
  
Private Sub Label53_Click()

    Dim found As Integer

    On Error GoTo cmd56123_err

    If Frame8.Caption = "VENDEDOR" Then
        Frame8.Visible = False
        DBGrid2.columns("vendedor") = Trim("" & dbvarios.Fields("codigo"))
        hknumero.Caption = "" 'kenyo pone cantidad vacia en una despues de selccionar el trabajador
   
        ''' 29/01/2018 Comisiones por producto por trabajador.
        DBGrid2.columns("comision") = busca_comisiones(Trim("" & DBGrid2.columns("producto")), Trim("" & dbvarios.Fields("codigo")))
        ''' 29/01/2018 Comisiones por producto por trabajador.
   
        found = sumar_detalle()
        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus
   
        Exit Sub

    End If

    If Len(Trim(salon.Caption)) > 0 Then 'si ha seleccionado mesa
        mesero = Trim("" & dbvarios.Fields("codigo"))
        graba_sistema_comanda
        GoTo comanda_1
        Exit Sub

    End If

    tcomanda.mesero = dbvarios.Fields("codigo")
    tcomanda.nmesero = dbvarios.Fields("nombre")
    flag_comanda = 0
    tcomanda.Show 1
comanda_1:

    If flag_comanda = "1" Then
        'MsgBox "paso"
   
        flag_servicio = "C"
   
        ''11/07/2017 kenyo multicomandas
  
        If mytable11.Fields("multicomanda") = "S" Then
            nroimpresion = 0
            found = orden_despacho(0)
 
            nroimpresion = 1
            found = orden_despacho(1)

            nroimpresion = 2
            found = orden_despacho(2)
   
            nroimpresion = 3
            found = orden_despacho(3)
   
        Else
   
            nroimpresion = 0
            found = orden_despacho(0)
   
        End If
   
        ''11/07/2017 kenyo multicomandas
     
        '     PUERTOD2 = "F"
        '       If Len(Trim(PUERTOD2)) > 0 Then
        '            found = orden_despacho(2)
        '            PUERTOD2 = ""
        '        End If

        ' found = orden_despacho(1)  '13012015
        'orden13012015
        'ordencomanda17022015
        borrar_todo
        sql_detalle
        tiposervicio1 = "Autoservicio"
        flag_servicio = "A"
        Frame8.Visible = False

    End If

    consulta_comanda "" & mytable11.Fields("salon")
    Exit Sub
cmd56123_err:
    MsgBox "Seleccione un Salon Y Mesa ", 48, "Aviso"
    Exit Sub

End Sub

Private Sub Label54_Click()
    Frame8.Visible = False

End Sub

Sub proceso_cobross()

    Dim found As Integer

    If Frame2.Visible = True Then Exit Sub
    local1 = ""
    'local1.Visible = False
    found = sumar_detalle()

    If found = 0 Then
        MsgBox "debe de Existir un Precio=0", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    If Val(txtotal) = 0 Then
        If exisdev <> -10 Then  'si existe devolucion
            If Val(ntcant) = 0 Then
                DBGrid2.SetFocus
                Exit Sub

            End If
      
        End If

    End If

    If mytable11.Fields("terminal") = "T" Or (ot = "S" And Len(petipo) = 0) Then 'pedidos o a cuenta ha dado
        'MsgBox "Hola"
        'xruc = codigo
        'xnombre = nombre
        Frame7.Visible = True
        habilita_lab7 1
        Framefp.Enabled = False

        If ot = "S" Then
            'MsgBox "ABC"
            xtipo = "" & mytable11.Fields("tipope")

        End If

        If flag_servicio <> "A" And flag_servicio <> "C" And flag_servicio <> "D" Then
            xtipo = "5"

        End If

        xtipo.SetFocus
        Exit Sub

    End If

    'If Val(acuenta) > 0 Then  'si existo a cuenta entonces debe ser vendido asi
    '   MsgBox "Utilizar icono "
    'End If
    If flag_servicio = "A" Then  'venta rapida

    End If

    If flag_servicio = "D" Then  'validar el deliveri si ingreso datos

    End If

    If flag_servicio = "C" Then  'venta mesas

    End If

    Label36.Caption = "Codigo"
    found = proceso_cobros()
    opcion2 = 0
    ttxtotals = Format(Val(rtxtotal), nrodecimal)
    ttxtotald = Format(Val(rtxtotald), nrodecimal)
    stxtotals = Format(Val(rtxtotal), nrodecimal)
    stxtotald = Format(Val(rtxtotald), nrodecimal)
    found = leer_visorcaja(dicmoneda & stxtotals, "US$  " & stxtotald)

    habilita_lab7 0
    Framefp.Visible = True
    Framefp.Enabled = True

    carga_tiposdoc "%"
    'MsgBox "Hola"
    dbgrid10.Enabled = True
    dbgrid10.SetFocus
    DBGrid10_KeyDown 13, 0
    palabra_bienvenida1

End Sub

Private Sub Label60_Click()
    consulta_comanda "01"

End Sub

Private Sub Label61_Click()
    consulta_comanda "02"

End Sub

Private Sub Image1_Click()

    If cmytablex.EOF = False Then
        cmytablex.MoveNext 'movemos al siguiente registro

    End If

    If Not cmytablex.BOF Then
        cmytablex.MoveLast
        Exit Sub

    End If

End Sub

Private Sub Label67_Click()
    ' 25/07/2018 Delivery y Para Llevar desde mozo
    'consulta_comanda "03"
    consulta_comanda "DE"

    ' 25/07/2018 Delivery y Para Llevar desde mozo
End Sub

Private Sub Label70_Click()

    On Error GoTo cmdp97811_err

    DBGrid10_KeyDown 13, 0
    Exit Sub

    If dbgrid10.Enabled = True Then
        seleccionamos_fpago
        Exit Sub

    End If

    Exit Sub

    'MsgBox Shift
    Select Case dbgrid9.Col

        Case 2

            If Len("" & dbgrid9.columns(2)) > 0 Then Exit Sub
            If Val("" & dbgrid9.columns(2)) = 0 Then
                If "" & Data9.Recordset.Fields("moneda") = "S" Then
                    Data9.Recordset.Edit
                    Data9.Recordset.Fields("recibe") = Val(stxtotals)
                    Data9.Recordset.Update

                End If

                If "" & Data9.Recordset.Fields("moneda") = "D" Then
                    Data9.Recordset.Edit
                    Data9.Recordset.Fields("recibe") = Val(stxtotald)
                    Data9.Recordset.Update

                End If

                opcion2 = 0
                'valida_ingresado
                suma_fpagov
               
                If Label45.Caption = "Vuelto" Or Val(stxtotals) <= 0 Then
                    xtipo = protipo
                    xvendedor = cproven
                                 
                    xruc = codigo

                    If "" & mytable11.Fields("habilitanota") = "S" Then
                        If Val(ttxtotals) <= Val("" & mytable11.Fields("siventa")) Then
                            xtipo = "5"

                        End If

                    End If
                  
                    xnombre = nombre
                    xdireccion = ydireccion
                    Frame7.Visible = True
                    habilita_lab7 1
                    Framefp.Enabled = False

                    If flag_servicio <> "A" And flag_servicio <> "C" And flag_servicio <> "D" Then
                        xtipo = "5"

                    End If

                    xtipo.SetFocus
                    Exit Sub

                End If

            End If

    End Select

    Exit Sub
cmdp97811_err:
    Exit Sub

End Sub

Sub seleccionamos_fpago()

    On Error GoTo cmdk8911_err

    suma_fpagov

    If Label45.Caption = "Vuelto" Or Val(stxtotals) = 0 Then
        'If MsgBox("Desea Grabar", 1, "Aviso") <> 1 Then Exit Sub
        'if len()
        xtipo = protipo

        If "" & mytable11.Fields("habilitanota") = "S" Then
            If Val(ttxtotals) <= Val("" & mytable11.Fields("siventa")) Then
                xtipo = "5"

            End If

        End If
                  
        xruc = codigo
        xnombre = nombre
        ' xdireccion = direccion
        xvendedor = cproven
        Frame7.Visible = True
        habilita_lab7 1
        Framefp.Enabled = False

        If flag_servicio <> "A" And flag_servicio <> "C" And flag_servicio <> "D" Then
            xtipo = "5"

        End If

        xtipo.SetFocus
        Exit Sub

    End If

    saldoabo = ""
    acufp = "" & dbgrid10.columns(3)
    Frame6.Caption = "" & dbgrid10.columns(0)
    fpago = "" & dbgrid10.columns(1)
    fpmoneda = "" & dbgrid10.columns(2)
    dbgrid10.Enabled = False

    If "" & dbgrid10.columns(3) = "A" Or "" & dbgrid10.columns(3) = "B" Or "" & dbgrid10.columns(3) = "E" Or "" & dbgrid10.columns(3) = "U" Then  'efectivo,dolares,euros
        macro_inserta_registro
        dbgrid9.Row = dbgrid9.VisibleRows - 1
        dbgrid9.Col = 2
        dbgrid9.SetFocus
        Exit Sub

    End If

    If "" & dbgrid10.columns(3) = "C" Then   'credito
        macro_credito 3
        tcampo1.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "D" Then   'tarejta credito
        macro_credito 4
        tcampo1.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "F" Then   'TARJETA DEBITO
        macro_credito 5
        tcampo1.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "G" Then   'letra
        macro_credito 0
        tcampo1.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "H" Or "" & dbgrid10.columns(3) = "K" Then   'bancos
        macro_credito 2
        tcampo3.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "V" Then   'vales
        macro_credito 6
        tcampo1.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "J" Then   'ORDEN TRABAJO
        macro_credito 8
        tcampo1.SetFocus

    End If

    If "" & dbgrid10.columns(3) = "I" Or "" & dbgrid10.columns(3) = "K" Then   'CRUCE CON ABONO EFECTIVO
        macro_credito 1
        tcampo1.Enabled = True
        tcampo1.SetFocus

    End If

    Exit Sub
cmdk8911_err:
    MsgBox error$, 48, "Aviso"
    Exit Sub

End Sub

Private Sub Label71_Click()

    Dim found As Integer

    found = borra_data9()

    If found = 0 Then
        dbgrid10.Enabled = True
        dbgrid10.SetFocus
        Exit Sub

    End If

    suma_fpagov
    dbgrid10.Enabled = True
    dbgrid10.SetFocus

    Exit Sub

End Sub

Private Sub Label72_Click()

    On Error GoTo cmd9001_err

    mytablefpago.MoveNext 'movemos al siguiente registro

    If mytablefpago.EOF Or mytablefpago.BOF Then
        mytablefpago.MoveLast
        Exit Sub

    End If

    Exit Sub
cmd9001_err:
    Exit Sub

End Sub

Private Sub Label73_Click()

    On Error GoTo cmd9002_err

    mytablefpago.MovePrevious 'movemos al siguiente registro

    If mytablefpago.EOF Or mytablefpago.BOF Then
        mytablefpago.MoveFirst
        Exit Sub

    End If

    Exit Sub
cmd9002_err:
    Exit Sub

End Sub

Private Sub lio82_Click()
    cgusuario = "FACTURA"
    dgusuario = "_d" & gusuario
    fgusuario = "_f" & gusuario
    dgusuariog = "DETALLE"
    explorap.fechai = "01/" & Format(Month(Now), "00") & "/" & Format(Year(Now), "0000")
    explorap.fechaf = Format(Now, "dd/mm/yyyy")
    explorap.fechai = Format(Now, "dd/mm/yyyy")
    explorap.Caption = "Documentos Guia Remision Ventas"
    explorap.tipoclie = "C"
    explorap.acu = "T"
    explorap.Show 1

End Sub

'inicio 18/04/2017 pll para salir
Private Sub salirVentas_Click()

    If MsgBox("Desea Salir", 1, "Aviso") <> 1 Then Exit Sub
    tptovta.Hide
    Unload tptovta

End Sub

'fin 18/04/2017 pll para salir

Private Sub losao94_Click()

    Dim found As Integer

    'If Frame3.Visible = True Then
    '   Frame3.Visible = False
    '   dbgrid2.Col = 0
    '   dbgrid2.Row = dbgrid2.visiblerows - 1
    '   dbgrid2.SetFocus
    '   Exit Sub
    'End If
    If Frame5.Visible = True Then
        If Frame1.Visible = True Then
            Frame5.Visible = False
            dbGrid1.SetFocus
            Exit Sub

        End If

        Command8_Click
        Exit Sub

    End If

    If dbgrid6.Visible = True Then
        dbgrid6.Visible = False
        dbGrid1.SetFocus
        Exit Sub

    End If

    If Frame6.Visible = True Then
        If opcion1 = "99" Then
            If Frame1.Visible = True Then
                Frame1.Visible = False
                Frame1.Enabled = False
                tcampo1.SetFocus
                Exit Sub

            End If

        End If

        If opcion1 = "2800" Or opcion1 = "2003" Then
            If Frame1.Visible = True Then
                Frame1.Visible = False
                Frame1.Enabled = False
                tcampo3.SetFocus
                Exit Sub

            End If

        End If
   
        ''''28/09/2017 kenyo Mejora Reportes Forma de pago y Creditos Finanzas
        If opcion1 = "200" Then
            If Frame1.Visible = True Then
                Frame1.Visible = False
                Frame1.Enabled = False
                tcampo5.SetFocus
                Exit Sub

            End If

        End If

        ''''28/09/2017 kenyo Mejora Reportes Forma de pago y Creditos Finanzas
   
        habilita_lab7 1
        Frame6.Visible = False
        'dbgrid10.SetFocus
        Exit Sub

    End If

    If Frame7.Visible = True Then
        If opcion1 = "30" Or opcion1 = "300" Then
            If Frame1.Visible = True Then
                Frame1.Visible = False
                Frame1.Enabled = False
                xruc.SetFocus
                Exit Sub

            End If

        End If

        If opcion1 = "31" Then
            If Frame1.Visible = True Then
                Frame1.Visible = False
                Frame1.Enabled = False
                xvendedor.SetFocus
                Exit Sub

            End If

        End If
   
        If opcion1 = "29" Then
            If Frame1.Visible = True Then
                Frame1.Visible = False
                Frame1.Enabled = False
                xtipo.SetFocus
                Exit Sub

            End If

        End If

        If opcion1 = "8" Then
            Frame7.Visible = False
            habilita_lab7 0
            DBGrid2.Enabled = True
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus
            Exit Sub

        End If

        Frame7.Visible = False
        habilita_lab7 0
   
        If "" & mytable11.Fields("terminal") = "T" Or opcion1 = "9999" Then
            DBGrid2.Enabled = True
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus
            Exit Sub

        End If

        If Framefp.Visible = True Then
            habilita_lab7 0
            Framefp.Enabled = True
            dbgrid10.Enabled = True
            dbgrid10.SetFocus
            Exit Sub

        End If
   
        If opcion1 = "1000" Then
            Frame7.Visible = False
            habilita_lab7 0
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus
            Exit Sub

        End If

        Exit Sub

    End If

    If Frame6.Visible = True Then
        Frame6.Visible = False
        habilita_lab7 0
        dbgrid10.Enabled = True
        dbgrid10.SetFocus
        Exit Sub

    End If

    If opcion1 = "19000" Then
        If Frame1.Visible = True Then
            Frame1.Visible = False
            Frame1.Enabled = False
            'xvendedor.SetFocus
            Exit Sub

        End If

    End If

    If opcion1 = "31" Then
        If Frame1.Visible = True Then
            Frame1.Visible = False
            Frame1.Enabled = False

            If Frame7.Visible = True Then
                xvendedor.SetFocus

            End If

            Exit Sub

        End If

    End If

    If opcion1 = "23" Then
        If Frame1.Visible = True Then
            Frame1.Visible = False
            Frame1.Enabled = False
            tcampo1.SetFocus
            Exit Sub

        End If

    End If

    If opcion1 = "29" Then
        If Frame1.Visible = True Then
            Frame1.Visible = False
            Frame1.Enabled = False
            xtipo.SetFocus
            Exit Sub

        End If

    End If

    If opcion1 = "30" Then
        If Frame1.Visible = True Then
            Frame1.Visible = False
            Frame1.Enabled = False
            xruc.SetFocus
            Exit Sub

        End If

    End If

    If opcion1 = "8" Then
        If Frame1.Visible = True Then
            Frame1.Visible = False
            Frame1.Enabled = False
            found = ir_ultimo_registrox()

            If found = 0 Then
                Data2.refresh

            End If

            DBGrid2.Enabled = True
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus
            Exit Sub

        End If

    End If

    If opcion1 = "0" Then
        If Frame1.Visible = True Then
            Frame1.Visible = False
            Frame1.Enabled = False
            DBGrid2.Enabled = True
            telefono.SetFocus
            Exit Sub

        End If

    End If

    If opcion1 = "750" Or opcion1 = "13" Or opcion1 = "10" Or opcion1 = "14" Or opcion1 = "15" Or opcion1 = "100" Or opcion1 = "150" Or opcion1 = "370" Or opcion1 = "1500" Or opcion1 = "1900" Or opcion1 = "15000" Or opcion1 = "15000A" Or opcion1 = "15000A" Or opcion1 = "15000B" Or opcion1 = "30000" Then
        If Frame1.Visible = True Then
            Frame1.Visible = False
            Frame1.Enabled = False
            DBGrid2.Enabled = True
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus
            Exit Sub

        End If

    End If

    If opcion1 = "1" Then
        If Frame1.Visible = True Then
            Frame1.Visible = False
            Frame1.Enabled = False
            DBGrid2.Enabled = True

            If Len(telefono) < 6 Then
                telefono.SetFocus
                Exit Sub

            End If

            dcodigo.SetFocus
            Exit Sub

        End If

    End If

    If opcion1 = "1750" Then
        If Frame1.Visible = True Then
            Frame1.Visible = False
            Frame1.Enabled = False
            DBGrid2.Enabled = True
            telefono.SetFocus
            Exit Sub

        End If

    End If

    If opcion1 = "12" Then
        If Frame1.Visible = True Then
            Frame1.Visible = False
            Frame1.Enabled = False
            DBGrid2.Enabled = True
            frmClientesRUC.Visible = True
            codigo.SetFocus
            Exit Sub

        End If

    End If

    If Frame2.Visible = True Then
        If Len(telefono) > 0 Or Len(ddireccion) > 0 Or Len(fechanac) > 0 Or Len(codigo) > 0 Then
            MsgBox "Existen Campos", 48, "Aviso"
            telefono.SetFocus
            Exit Sub

        End If

        Frame2.Visible = False
        DBGrid2.Enabled = True
        Command10_Click
        Exit Sub

    End If

    If Framefp.Visible = True Then
        habilita_lab7 1
        Framefp.Visible = False

        If flag_servicio = "C" Then
            inicialIzatodo

        End If

        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus
        Exit Sub

    End If

    If Frame1.Visible = True Then
        Frame1.Visible = False
        Frame1.Enabled = False
        DBGrid2.Enabled = True
        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus
        Exit Sub

    End If

    ' If Framefp.Visible = False And dbgrid2.Col = 0 Then
    '   Exit Sub
    'End If

    If MsgBox("Desea Salir", 1, "Aviso") <> 1 Then Exit Sub
    'menucaja.vendedor = ""
    'menucaja.nombre = ""
    'menucaja.clave = ""
    'MsgBox ""
    'cerrar_data2
    'cerrar_archivo

    tptovta.Hide
    Unload tptovta

End Sub

Private Sub mesa_Click()

    'buscar sunat DoEvents emergencia
    ''''If Picture2.Visible = True Then
    ''''    Picture2.Visible = False
    ''''    Exit Sub
    ''''End If
    ''''If Picture2.Visible = False Then
    ''''    Picture2.Visible = True
    ''''    Exit Sub
    ''''End If
    Dim Ruta As String

    Ruta = App.path & "\tessdata\"
    Shell (Ruta & "ConsultaSunat.exe"), vbNormalFocus

End Sub

Private Sub mesero_Click()
    dj78232_Click

    'tdremoto.Show 1
End Sub

Private Sub MonthView1_DateClick(ByVal DateClicked As Date)
    fechae = Format(MonthView1.Value, "dd/mm/yyyy")
    MonthView1.Visible = False
    fechae.SetFocus

End Sub

'Private Sub MSComm1_OnComm()
'Select Case MSComm1.CommEvent
'    Case comEvReceive ' Received RThreshold # of chars.
'     InBuff = InBuff + MSComm1.Input
'End Select
'End Sub
Private Sub nombre_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then Exit Sub
    '   DBGrid2.Col = 0
    '   DBGrid2.Row = DBGrid2.VisibleRows - 1
    '   DBGrid2.SetFocus
   
    ydireccion.SetFocus

End Sub

Private Sub nombre_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        codigo.SetFocus
        Exit Sub

    End If

End Sub

Private Sub nbxtipo_Click(Index As Integer)

    'leonardo: 1=BOL, 2=FAC
    ' LEONARDO: AGREGAR 1="BOL" 2="FAC"
    'If Trim(nbxtipo(0).Caption) = "Bol" Then xtipo = 1
    'If Trim(nbxtipo(1).Caption) = "Fac" Then xtipo = 2
    'if Left(Trim(nbxtipo(Index).Caption), 1) = ""
    Select Case nbxtipo(Index).Caption

        Case "Bol": xtipo.Text = 1

        Case "Fac": xtipo.Text = 2

    End Select

    '   For i = 0 To 1
    '        if nbxtipo(Index).Caption
    '   Next
   
    'xtipo = Left(Trim(nbxtipo(Index).Caption), 1)
    If Trim(Len(xtipo.Text)) = 0 Then
        xtipo.SetFocus
        Exit Sub

    End If

    xtipo_keyPress 13

End Sub

Private Sub vendedor_Click()
    '12/06/2017 kenyo selecciona vendedor
    consulta_xvendedor

    '12/06/2017 kenyo selecciona vendedor
End Sub

Private Sub xcongelax_DblClick()
    tkeyboar.FLAG = "CONGELA"
    tkeyboar.Show 1

End Sub

Private Sub xtipo_keyPress(KeyAscii As Integer)

    Dim found As Integer

    If KeyAscii <> 13 And KeyAscii <> 27 Then Exit Sub
    If KeyAscii = 27 Then
        Frame7.Visible = False
        habilita_lab7 0

        If Framefp.Visible = False Then
            DBGrid2.Col = 0
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            DBGrid2.SetFocus
            Exit Sub

        End If

        habilita_lab7 0
        Framefp.Enabled = True
        dbgrid10.Enabled = True
        dbgrid10.SetFocus
        Exit Sub

    End If

    'aqui es donde vamos a poner si modificacion pedido
    If flag_servicio <> "A" And flag_servicio <> "C" And flag_servicio <> "D" Then
        xtipo = "5" 'VENTA INTERNA

    End If

    If Len(pedido) > 0 Then
        If xtipo <> "P" Then
            xtipo = "P"
            xtipo.SetFocus
            Exit Sub

        End If

        xserie = "P"
        xvendedor.SetFocus
        Exit Sub

    End If

    '---si es a cuenta ---
    'If ot = "S" And Len(petipo) = 0 Then
    '   If xtipo <> "" & mytable11.Fields("tipope") Then
    '      MsgBox "Tipo documento admitido,solamente,Pedidos", 48, "Aviso"
    '      xtipo = "" & mytable11.Fields("tipope")
    '      xtipo.SetFocus
    '      Exit Sub
    '   End If
    'End If
    'ojo aqui voy a validar si es traslado de un local a otros
    If local1 = "PEDIDO" Then 'pedido merca almacen
        If xtipo <> "Q" Then
            xtipo = "Q" 'CONSUMO: CUANDO EL CLIENTE NO QUIERE QUE MUESTRE EL DETALLE
            xtipo.SetFocus
            Exit Sub

        End If

        found = busca_xtipo("" & xtipo, 0)

        If found = 0 Then
            xtipo = ""
            MsgBox "No existe Tipo Documento", 48, "Aviso"
            xtipo.SetFocus
            Exit Sub

        End If

        xvendedor.SetFocus
        Exit Sub

    End If

    If Len(xtipo) = 0 Then
        xtipo = "" & mytable11.Fields("tipodefa")

        If "" & mytable11.Fields("habilitanota") = "S" Then
            If Val(ttxtotals) <= Val("" & mytable11.Fields("siventa")) Then
                xtipo = "5"

            End If

        End If

        xtipo.SetFocus
        Exit Sub

    End If

    found = valida_tipo_pago("" & xtipo)

    If found = 0 Then
        MsgBox "No permitido ", 48, "Aviso"
        xtipo.SetFocus
        Exit Sub

    End If

    found = busca_xtipo("" & xtipo, 0)

    If found = 0 Then
        xtipo = ""
        MsgBox "No existe Tipo Documento", 48, "Aviso"
        xtipo.SetFocus
        Exit Sub

    End If

    'inicio 20/04/2017 pll
    'xruc = codigo
    'fin 20/04/2017 pll

    If xtipo = "1" Or xtipo = "3" Or xtipo = "5" Then
        Label36 = "Codigo"

    End If

    If xtipo = "2" Or xtipo = "4" Then
        Label36.Caption = dicruc

        If Len(codigo) < 11 Then
            xruc = ""

        End If

    End If

    sentido.Enabled = False

    'inicio 21/'4/2017 pll para la parametrizacion de caja vendedor y cliente

    If "" & mytable11.Fields("vendedor") = "S" Then

        'inicio 24/04/2017 pll
        If frmClientesRUC.Visible = True Then
            frmClientesRUC.Visible = False

        End If

        'fin 24/04/2017 pll
        'Inicio 21/04/2017 pll
        'AQUI SI PARAMETRIZARLO ES OBLIGATORIO para el vendedor PLL
        'xvendedor.SetFocus
        If xvendedor = "" Then
            MsgBox "Falta Ingresar Datos del vendedor", 48, "Aviso"
            consulta_xvendedor
            Exit Sub

        End If

        'Inicio 21/04/2017 pll
    End If

    'INICIO PLL
    If flag_servicio = "D" Then  'validar el deliveri si ingreso datos

        'inicio 24/04/2017 pll para el devlivey
        'xvendedor.SetFocus
        If xvendedor = "" Then

            'inicio 24/04/2017 pll XXX
            If frmClientesRUC.Visible = True Then
                frmClientesRUC.Visible = False

            End If

            'fin 24/04/2017 pll
   
            If Trim("" & mytable11.Fields("obligavdelivery")) = "S" Or Trim("" & mytable11.Fields("obligavdelivery")) = "" Then
   
                MsgBox "Falta Ingresar Datos del vendedorD Delivery", 48, "Aviso"
     
                consulta_xvendedor
                Exit Sub

            End If

        End If

        'fin 24/04/2017 pll para el devlivey
        'Exit Sub
   
    End If

    If acu = "I" Then  'si es pedido ORDEN TRABAJO
        If Len(xvendedor) = 0 Then
            xvendedor.SetFocus
            Exit Sub

        End If

        If Len(xruc) = 0 Then
            xruc.SetFocus
            Exit Sub

        End If

        If Len(xnombre) = 0 Then
            xnombre.SetFocus
            Exit Sub

        End If

        Exit Sub

    End If

    '001  FM  LUZ
    '006  FM
    '001  BM
    If "" & acu <> "A" And "" & acu <> "B" And "" & acu <> "D" Then 'si es diferente de factura
        If "" & mytable11.Fields("cliente") <> "S" Then
            'inicio 25/04/2017 pll Para grabar sunat cliente
            'If frmClientesRUC.Visible = True Then
            '          xruc = codigo
            '          xnombre = nombre
            '          xdireccion = ydireccion
            '          correo = correo
            ' found = graba_cliente_tipo("" & xruc)
     
            'fin 22/04/2017 pll Para grabar sunat cliente
      
            Command13_Click 'ACA BOTON GUARDAR
            ' End If
            'Exit Sub
            'inicio 21/04/2017 pll parametrizacion de caja con cliente ruc
        Else

            If xruc = "" And nombre = "" Then

                'MsgBox "Falta Ingresar Datos Presiona Ruc Cliente para completar", 48, "Aviso"
                If mytable11.Fields("cliente") = "S" Then
                    If Frame7.Visible = False Then
                        frmClientesRUC.Visible = True

                        ''''21/09/2017 kenyo Mejora  cobranza de mesas
                        If Picture2.Visible = True Then 'picture2 es venta de mesas abierta
                            frmClientesRUC.Top = 420: frmClientesRUC.Left = 0
                            frmClientesRUC.Width = 8550: frmClientesRUC.Height = 4680
                        Else
                            frmClientesRUC.Top = 15: frmClientesRUC.Left = 8550
                            frmClientesRUC.Width = 6825: frmClientesRUC.Height = 3810

                        End If
           
                        ''''21/09/2017 kenyo Mejora  cobranza de mesas
                        codigo.SetFocus

                    End If

                End If

                'found = graba_cliente_tipo("" & xruc)
                ' Command13_Click 'ACA BOTON GUARDAR
            Else

                If mytable11.Fields("cliente") = "S" Then
                    '        xruc = codigo
                    '        xnombre = nombre
                    '        xdireccion = ydireccion
                    '        correo = correo
                    '  graba_cliente_tipo ("" & xruc)
                    Command13_Click 'ACA BOTON GUARDAR

                End If

            End If

            'fin 21/04/2017 pll
        End If

    End If

    If "" & acu = "B" Or "" & acu = "D" Then 'si es diferente de factura
        If Len(xruc) = 11 Then
            Command13_Click 'INICIO 22/11/2017 AQUI ENTRA PARA EL credito
            Exit Sub

        End If

    End If

    'inicio 21/04/2017 pll 'en el caso que la parametrizacion sea obligada con el ruc del cliente
    'inicio cambio 27/04/2017 kenyo
    If Frame7.Visible = True Then
        xruc.SetFocus

    End If

    'fin cambio 27/04/2017 kenyo
    'fin  21/04/2017 pll

End Sub

Private Sub pado8911_Click()

    Dim sw As Integer

    flag_clave1 = 0
    tconcla.X = "CUADRE"
    tconcla.Show 1

    If flag_clave1 <> 1 Then  'si es descongela
        DBGrid2.SetFocus
        Exit Sub

    End If

    opcion1 = "2"
    opcion2 = "1"
    opcion3 = "2"
    tcuadrc1.fechai.Enabled = True
    tcuadrc1.fechaf.Enabled = True
    usuariopos = gusuario
    tcuadrc1.cajero = usuariopos
    tcuadrc1.caja = caja
    tcuadrc1.turno = turno
    tcuadrc1.horai = "01"
    tcuadrc1.horaf = "24"
    tcuadrc1.fechai = dia
    tcuadrc1.fechaf = dia
    tcuadrc1.Caption = "DOCUMENTOS EMITIDOS"
    tcuadrc1.check3d1.Visible = True
    tcuadrc1.check3d2.Visible = True
    tcuadrc1.check3d3.Visible = True
    tcuadrc1.Show 1

End Sub

Function verifica_ticket_ingreso(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM ppocket where  pedido='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        verifica_ticket_ingreso = 1

    End If

    mytablex.Close

End Function

Function carga_ticket_ingreso()

    Dim found As Integer

    found = proceso_proforma("" & mytable11.Fields("local"), "P", "P", "" & pedido)
    carga_ticket_ingreso = found

End Function

Private Sub referencia_DblClick()
    tkeyboar.FLAG = "DREFERENCIA"
    tkeyboar.Show 1

End Sub

Private Sub referencia_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then Exit Sub
    fechanac.SetFocus

End Sub

Private Sub referencia_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        ddireccion.SetFocus
        Exit Sub

    End If

End Sub

Private Sub saldo_KeyPress(KeyAscii As Integer)

End Sub

Private Sub RGPAGO_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 And KeyAscii <> 27 Then Exit Sub
    If KeyAscii = 27 Then
        Command2_Click
        Exit Sub

    End If

    Command3_Click

End Sub

Private Sub rtxtotal_Click()

    'If picBotones.Height = 7770 Then
    '    picBotones.Height = 4900
    'End If
    'If picBotones.Height = 4900 Then
    '    picBotones.Height = 7770
    'End If
End Sub

Private Sub salon_Click()

    'dni reniec emergencia
    'tmesasta.Show 1
    'consulta_comanda "" & mytable11.Fields("salon")
    Dim Ruta As String

    Ruta = App.path & "\tessdata\"
    Shell (Ruta & "ConsultaReniec.exe"), vbNormalFocus

End Sub

Private Sub sentido_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then
        sentido.SetFocus
        Exit Sub

    End If

    If Len(xtipo) = 0 Then
        xtipo.SetFocus
        Exit Sub

    End If

    If sentido <> "S" And sentido <> "B" Then
        sentido = ""
        Exit Sub

    End If

    If "" & mytable11.Fields("vendedor") = "S" Then
        xvendedor.SetFocus
        Exit Sub

    End If

    If xtipo = "7" Then
        xruc.SetFocus
        Exit Sub

    End If

    If "" & mytable11.Fields("cliente") <> "S" And acu <> "A" And acu <> "B" And acu <> "D" Then
        Command13_Click
        Exit Sub

    End If

    xruc.SetFocus

End Sub

Private Sub sentido_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        xtipo.SetFocus

    End If

End Sub

Private Sub table6_DblClick()
    Label53_Click

End Sub

Private Sub table6_KeyDown(KeyCode As Integer, Shift As Integer)

    If KeyCode = 13 Then
        Label53_Click

    End If

End Sub

Private Sub tcampo1_DblClick()

    If Val(RGPAGO) = 0 Then
        RGPAGO.SetFocus
        Exit Sub

    End If

    tkeyboar.FLAG = "TCAMPO1"
    tkeyboar.Show 1

End Sub

Private Sub tcampo1_KeyPress(KeyAscii As Integer)

    Dim found  As Integer

    Dim found1 As Double

    'If Val(RGPAGO) = 0 Then
    '   RGPAGO.SetFocus
    '   Exit Sub
    'End If

    If KeyAscii <> 13 And KeyAscii <> 27 Then Exit Sub
    If KeyAscii = 27 Then
        Frame6.Visible = False
        habilita_lab7 0
        dbgrid10.Enabled = True
        dbgrid10.SetFocus
        Exit Sub

    End If

    If Frame6.Caption = "CREDITO" Or "" & dbgrid10.columns("tipo") = "I" Or "" & dbgrid10.columns("tipo") = "H" Or "" & dbgrid10.columns("tipo") = "K" Or "" & dbgrid10.columns("tipo") = "V" Then

        'If Len(tcampo1) = 0 Then
        '   tcampo1.SetFocus
        '   Exit Sub
        'End If
    End If

    found = 0

    If Len(tcampo1) > 0 Then
        found = busca_codigocl("" & tcampo1, 0)

    End If

    If "" & dbgrid10.columns("tipo") = "C" Then  'si es credito
        If "" & mytable11.Fields("obligacredito") = "S" Then
            found = credito_habilitado("" & tcampo1)

            If found = 0 Then
                MsgBox "Credito no permitido ", 48, "Aviso"
                tcampo1 = ""
                tcampo2 = ""
                tcampo1.SetFocus
                Exit Sub

            End If

        End If

    End If

    If "" & dbgrid10.columns("tipo") = "C" And found = 1 Then '
        saldoabo = ""
        found = busca_credito_credito("" & dbgrid10.columns("tipo"), "" & tcampo1)  'actualiza su saldo actual

        If "" & mytable11.Fields("obligacredito") = "S" Then
            If saldo_clientes(tcampo1, Val(RGPAGO)) <= 0 Then
                MsgBox "No existe saldo", 48, "Aviso"
                tcampo1.SetFocus
                Exit Sub

            End If

        End If
     
        'If found = 0 Then
        '   MsgBox "No existe Cliente o No tiene saldo ", 48, "Aviso"
        '   tcampo1.SetFocus
        '   Exit Sub
        'End If
        tcampo5.SetFocus
        Exit Sub

    End If

    If ("" & dbgrid10.columns("tipo") = "I" Or "" & dbgrid10.columns("tipo") = "K" Or "" & dbgrid10.columns("tipo") = "C") And found = 1 Then '
        saldoabo = ""
        found = busca_credito_adelanto("" & dbgrid10.columns("tipo"), "" & tcampo1)

        If found = 1 And Val(saldoabo) <= 0 Then
            MsgBox "No existe saldo", 48, "Aviso"
            tcampo1.SetFocus
            Exit Sub

        End If

        If found = 0 Then
            MsgBox "No existe Cliente o No tiene saldo ", 48, "Aviso"
            tcampo1.SetFocus
            Exit Sub

        End If

        tcampo5.SetFocus
        Exit Sub

    End If

    tcampo2.SetFocus

End Sub

Private Sub tcampo1_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H70 Then  'f1
        consulta_xruc1

    End If

    'If KeyCode = &H26 Then
    '   tcampo3.SetFocus
    '   Exit Sub
    'End If

End Sub

Private Sub tcampo2_DblClick()
    tkeyboar.FLAG = "TCAMPO2"
    tkeyboar.Show 1

End Sub

Private Sub tcampo2_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then Exit Sub
    'If Len(tcampo2) = 0 Then
    '   tcampo2.SetFocus
    '   Exit Sub
    'End If
    tcampo3.SetFocus

End Sub

Private Sub tcampo2_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        tcampo1.SetFocus
        Exit Sub

    End If

End Sub

Private Sub tcampo3_DblClick()
    tkeyboar.FLAG = "TCAMPO3"
    tkeyboar.Show 1

End Sub

Private Sub tcampo3_KeyPress(KeyAscii As Integer)

    Dim found1 As Double

    Dim found  As Integer

    If KeyAscii <> 13 And KeyAscii <> 27 Then Exit Sub
    If KeyAscii = 27 Then
        Frame6.Visible = False
        habilita_lab7 0
        dbgrid10.Enabled = True
        dbgrid10.SetFocus
        Exit Sub

    End If

    saldoabo = ""

    'If "" & dbgrid10.Columns("tipo") = "V" Then
    '   If Len(tcampo1) = 0 Then
    '      tcampo1.SetFocus
    '      Exit Sub
    '   End If
    '   If Len(tcampo2) = 0 Then
    '      tcampo2.SetFocus
    '      Exit Sub
    '   End If
    '   tcampo5.SetFocus
    '   Exit Sub
    'End If
    If "" & dbgrid10.columns("tipo") = "I" Or "" & dbgrid10.columns("tipo") = "K" Then  'valida el deposito bancario
        tcampo1.SetFocus
        Exit Sub

    End If

    If "" & dbgrid10.columns("tipo") = "D" Or "" & dbgrid10.columns("tipo") = "F" Then 'debito o credito
        If Len(tcampo3) < 4 Then
            tcampo3.SetFocus
            Exit Sub

        End If

    End If

    If "" & dbgrid10.columns("tipo") = "V" Then   'vale
        If Len(Trim(tcampo3)) = 0 Then
            MsgBox "Ingrese Dato ", 48, "Aviso"
            tcampo3.SetFocus
            Exit Sub

        End If

        found = valida_orden(Trim("" & tcampo3))

        If found = 1 Then
            MsgBox "Ya Existe Numero", 48, "Aviso"
            Exit Sub

        End If

    End If

    'If "" & dbgrid10.Columns("tipo") = "H" Then 'valida el deposito bancario
    '   If Len(tcampo3) = 0 Then
    '      tcampo3.SetFocus
    '      Exit Sub
    '   End If
    '   found1 = valida_deposito("" & tcampo1, "" & tcampo3, 1)
    '   If found1 <= 0 Then
    '      MsgBox "No existe Saldo ", 48, "Aviso"
    '      tcampo1.SetFocus
    '      Exit Sub
    '   End If
    '   saldoabo = Format(found1, nrodecimal)
    'End If
    tcampo4.SetFocus

End Sub

Private Sub tcampo3_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        tcampo2.SetFocus
        Exit Sub

    End If

    If KeyCode = &H70 Then  'f1
        If Frame6.Caption = "CHEQUE" Then  'consulta cheques
            consulta_banco '200

        End If

        If acufp = "V" Then   'si es vale
            consulta_vales  '2800

        End If

        If acufp = "I" Or acufp = "K" Then  'si es cruce de pago adelantado cruza
            consulta_credito  '2800

        End If

    End If

End Sub

Private Sub tcampo4_DblClick()
    tkeyboar.FLAG = "TCAMPO4"
    tkeyboar.Show 1

End Sub

Private Sub tcampo4_KeyPress(KeyAscii As Integer)

    Dim found As Integer

    If KeyAscii <> 13 Then Exit Sub
    If "" & dbgrid10.columns("tipo") = "D" Or "" & dbgrid10.columns("tipo") = "F" Then 'debito o credito

        'If Len(tcampo4) = 0 Then
        '   tcampo4.SetFocus
        '   Exit Sub
        'End If
    End If

    If "" & dbgrid10.columns("tipo") = "V" Or "" & dbgrid10.columns("tipo") = "C" Then  'debito o credito
        tcampo5.SetFocus
        Exit Sub

    End If

    If Len(tcampo4) > 0 Then
        found = busca_banco("" & tcampo4)

        If found = 0 Then
            MsgBox "Ingrese Entidad ", 48, "Aviso"
            tcampo4 = ""
            tcampo4.SetFocus
            Exit Sub

        End If

    End If

    tcampo5.SetFocus

End Sub

Private Sub tcampo4_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        tcampo3.SetFocus
        Exit Sub

    End If

    'inicio 10/02/2018 pll
    If KeyCode = &H70 Then  'f1
        consulta_banco

    End If

    'fin 10/02/2018 pll

End Sub

Private Sub tcampo5_DblClick()
    tkeyboar.FLAG = "TCAMPO5"
    tkeyboar.Show 1

End Sub

Private Sub tcampo5_KeyPress(KeyAscii As Integer)

    Dim sdx    As Double

    Dim found  As Integer

    Dim found1 As Double

    On Error GoTo cmd8_err

    If KeyAscii <> 13 Then Exit Sub
    'If Val(tcampo5) <= 0 Then
    '   tcampo5 = "1"
    'End If
    'If Len(tcampo1) = 0 Then
    '   tcampo1.SetFocus
    '   Exit Sub
    'End If
    'If Len(tcampo2) = 0 Then
    '   tcampo2.SetFocus
    '   Exit Sub
    'End If

    If Val(RGPAGO) = 0 Then
        If fpmoneda = "S" Then
            RGPAGO = stxtotals

        End If

        If fpmoneda = "D" Then
            RGPAGO = stxtotald

        End If

    End If

    saldoabo = ""

    If "" & dbgrid10.columns("tipo") = "D" Or "" & dbgrid10.columns("tipo") = "F" Then 'debito o credito
        If "" & dbgrid10.columns("tipo") = "D" Then 'credito
            If Len(tcampo3) = 0 Then
                tcampo3.SetFocus
                Exit Sub

            End If

            ''''28/09/2017 kenyo Mejora Reportes Forma de pago y Creditos Finanzas (Observa)
            If Len(tcampo3) < 4 Then
                tcampo3.SetFocus
                Exit Sub

            End If

            ''''28/09/2017 kenyo Mejora Reportes Forma de pago y Creditos Finanzas (Observa)

            'If Len(tcampo1) = 0 Then
            '   tcampo1.SetFocus
            '   Exit Sub
            'End If
            'If Len(tcampo2) = 0 Then
            '   tcampo2.SetFocus
            '   Exit Sub
            'End If
        End If

        If "" & dbgrid10.columns("tipo") = "V" Then 'vale
            If Len(tcampo1) = 0 Then
                tcampo1.SetFocus
                Exit Sub

            End If

            If Len(tcampo2) = 0 Then
                tcampo2.SetFocus
                Exit Sub

            End If

            If Len(tcampo3) = 0 Then
                tcampo3.SetFocus
                Exit Sub

            End If

            If Len(tcampo4) = 0 Then
                tcampo4.SetFocus
                Exit Sub

            End If

            If Len(tcampo5) = 0 Then
                tcampo5.SetFocus
                Exit Sub

            End If

        End If

        If "" & dbgrid10.columns("tipo") = "F" Then 'debito
            If Len(tcampo3) = 0 Then
                tcampo3.SetFocus
                Exit Sub

            End If

        End If

    End If

    If "" & dbgrid10.columns("tipo") = "C" Or "" & dbgrid10.columns("tipo") = "G" Then 'c,g
        If "" & mytable11.Fields("obligacredito") = "S" Then
            found = credito_habilitado("" & tcampo1)

            If found = 0 Then
                MsgBox "Credito no permitido ", 48, "Aviso"
                tcampo1 = ""
                tcampo2 = ""
                tcampo1.SetFocus
                Exit Sub

            End If

        End If

        If Len(tcampo1) = 0 Then
            tcampo1.SetFocus
            Exit Sub

        End If

        If Len(tcampo2) = 0 Then
            tcampo2.SetFocus
            Exit Sub

        End If

    End If

    If ("" & dbgrid10.columns("tipo") = "C") And found = 1 Then    '
        If Len(tcampo1) = 0 Then
            tcampo1.SetFocus
            Exit Sub

        End If

        saldoabo = ""
        found = busca_credito_credito("" & dbgrid10.columns("tipo"), "" & tcampo1)
   
        'If Val(limite_credito) <= Val(saldoabo) Then
        '   MsgBox "No existe saldo", 48, "Aviso"
        '   tcampo1.SetFocus
        '   Exit Sub
        'End If
        'If found = 0 Then
        '   MsgBox "No existe Cliente o No tiene saldo ", 48, "Aviso"
        '   tcampo1.SetFocus
        '   Exit Sub
        'End If
    End If

    'If "" & dbgrid10.Columns("tipo") = "H" Then 'valida el deposito bancario
    '   If Len(tcampo1) = 0 Then
    '      tcampo1.SetFocus
    '      Exit Sub
    '   End If
    '   If Len(tcampo3) = 0 Then
    '      tcampo3.SetFocus
    '      Exit Sub
    '   End If
    '    found = busca_codigocl("" & tcampo1, 0)
    '   If found = 0 Then
    '      MsgBox "No existe codigo ", 48, "Aviso"
    '      tcampo1.SetFocus
    '      Exit Sub
    '   End If
    '   found1 = valida_deposito("" & tcampo1, "" & tcampo3, 0)
    '   If found1 <= 0 Then
    '      MsgBox "No existe Saldo ", 48, "Aviso"
    '      tcampo1.SetFocus
    '      Exit Sub
    '   End If
    '   saldoabo = Format(found1, nrodecimal)
    'End If
    If ("" & dbgrid10.columns("tipo") = "I" Or "" & dbgrid10.columns("tipo") = "K") And found = 1 Then    '
        If Len(tcampo1) = 0 Then
            tcampo1.SetFocus
            Exit Sub

        End If

        saldoabo = ""
        found = busca_credito_adelanto("" & dbgrid10.columns("tipo"), "" & tcampo1)

        If found = 1 And Val(saldoabo) <= 0 Then
            MsgBox "No existe saldo", 48, "Aviso"
            tcampo1.SetFocus
            Exit Sub

        End If

        If found = 0 Then
            MsgBox "No existe Cliente o No tiene saldo ", 48, "Aviso"
            tcampo1.SetFocus
            Exit Sub

        End If

    End If

    '16/06/2017 kenyo correcion ya sle codigo de cliente cuando cobramos con visa
    ' inicio kenyo 25/04/2017

    'If tcampo2 = "" Then
    '  tcampo2 = nombre
    ' Else
    '  nombre = tcampo2
    'End If

    If tcampo2 = "" Then
        tcampo2 = nombre
    Else
        nombre = tcampo2
        codigo = tcampo1

    End If

    ' inicio kenyo 25/04/2017
    '16/06/2017 kenyo correcion ya sle codigo de cliente cuando cobramos con visa

    If Val(RGPAGO) = 0 Then
        RGPAGO.SetFocus
        Exit Sub

    End If

    Data9.Recordset.AddNew
    Data9.Recordset.Fields("descripcio") = "" & dbgrid10.columns(0)
    Data9.Recordset.Fields("fpago") = "" & dbgrid10.columns(1)
    Data9.Recordset.Fields("moneda") = "" & dbgrid10.columns(2)
    Data9.Recordset.Fields("codigo") = tcampo1
    Data9.Recordset.Fields("nombre") = tcampo2
    Data9.Recordset.Fields("orden") = tcampo3

    ''''28/09/2017 kenyo Mejora Reportes Forma de pago y Creditos Finanzas (Observa)
    '''06/08/2017  kenyo Testing Completo al Sistema
    'Data9.Recordset.Fields("observa") = tcampo4
    'Data9.Recordset.Fields("dias") = tcampo5
    Data9.Recordset.Fields("observa") = tcampo5
    Data9.Recordset.Fields("dias") = tcampo4

    If Val(tcampo4) > 0 Then

        ' fechae = DateAdd(fechae, tcampo4)
        If Data9.Recordset.Fields("fpago") = "3" Then
            fechae = DateAdd("d", tcampo4, fechae)

        End If

    End If
 
    '''06/08/2017  kenyo Testing Completo al Sistema
    ''''28/09/2017 kenyo Mejora Reportes Forma de pago y Creditos Finanzas (Observa)

    'Data9.Recordset.Fields("recibe") = tcampo5
    Data9.Recordset.Fields("recibe") = Val(RGPAGO)
    Data9.Recordset.Fields("acu") = "" & dbgrid10.columns("tipo")
    Data9.Recordset.Update

    If Len(tcampo1) > 0 And Len(tcampo2) > 0 Then
        found = graba_cliente_credito1("" & tcampo1)

    End If

    suma_fpagov
    Frame6.Visible = False
    habilita_lab7 0
    found = leer_visorcaja(dicmoneda & stxtotals, "US$  " & stxtotald)
    dbgrid9.Row = dbgrid9.VisibleRows - 1
    dbgrid9.Col = 2
    dbgrid9.SetFocus

    '-----aqui verifica si va a cobrar el otro ------
    If Label45.Caption = "Vuelto" Or Val(stxtotals) <= 0 Then
        xtipo = protipo

        If "" & mytable11.Fields("habilitanota") = "S" Then
            If Val(ttxtotals) <= Val("" & mytable11.Fields("siventa")) Then
                xtipo = "5"

            End If

        End If

        xruc = codigo
        xnombre = nombre
        xdireccion = ydireccion
        xvendedor = cproven
              
        Framefp.Enabled = False
        Frame7.Visible = True
        habilita_lab7 1
        Framefp.Enabled = False

        If flag_servicio <> "A" And flag_servicio <> "C" And flag_servicio <> "D" Then
            xtipo = "5"

        End If

        xtipo.SetFocus
        Exit Sub

    End If
         
    dbgrid10.Enabled = True
    dbgrid10.SetFocus
    Exit Sub
    '-----------
    Frame6.Visible = False
    habilita_lab7 0
    dbgrid9.Row = dbgrid9.VisibleRows - 1
    dbgrid9.Col = 2
    dbgrid9.SetFocus
    Exit Sub
cmd8_err:
    Exit Sub

End Sub

Function valida_deposito(buf0 As String, buf As String, sw As Integer) As Double

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM chequemo where  transaccio='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        valida_deposito = Val("" & mytablex.Fields("saldo"))

        If sw = 1 Then
            tcampo1 = "" & mytablex.Fields("codigo")

        End If

    End If

    mytablex.Close

End Function

Sub graba_deposito(mytabley As ADODB.Recordset)

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    Dim nrecibe  As Double

    On Error GoTo cmd7812_err

    'ojo nrecibe siempres es igual o menor
    nrecibe = Val("" & mytabley.Fields("recibe"))

    If nrecibe = 0 Then Exit Sub

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM chequemo where  codigo='" & Trim("" & mytabley.Fields("codigo")) & "' and transaccio='" & Trim("" & mytabley.Fields("orden")) & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        'mytablex.Edit
        mytablex.Fields("abono") = Val("" & mytablex.Fields("abono")) + nrecibe
        sdx = Val("" & mytablex.Fields("neto")) - Val("" & mytablex.Fields("abono"))
        mytablex.Fields("saldo") = sdx
        mytablex.Update

    End If

    mytablex.Close
    Exit Sub
cmd7812_err:
    MsgBox "Error en graba deposito " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub desgraba_deposito(mytabley As ADODB.Recordset)

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    Dim nrecibe  As Double

    On Error GoTo cmd17812_err

    nrecibe = Val("" & mytabley.Fields("recibe"))

    If nrecibe = 0 Then Exit Sub

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM chequemo where  codigo='" & Trim("" & mytabley.Fields("codigo")) & "' and transaccio='" & Trim("" & mytabley.Fields("orden")) & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        'mytablex.Edit
        mytablex.Fields("abono") = Val("" & mytablex.Fields("abono")) - nrecibe
        sdx = Val("" & mytablex.Fields("neto")) - Val("" & mytablex.Fields("abono"))
        mytablex.Fields("saldo") = sdx
        mytablex.Update

    End If

    mytablex.Close
    Exit Sub
cmd17812_err:
    MsgBox "Error en graba deposito " + error$, 48, "Aviso"
    Exit Sub

End Sub

Private Sub tcampo5_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        tcampo4.SetFocus
        Exit Sub

    End If

    '''28/09/2017 kenyo Mejora Reportes Forma de pago y Creditos Finanzas (Observa)
    If KeyCode = &H70 And descripcio4 = "Entidad" Then 'f1
        consulta_banco

    End If

    '''28/09/2017 kenyo Mejora Reportes Forma de pago y Creditos Finanzas (Observa)

End Sub

Private Sub telefono_DblClick()
    tkeyboar.FLAG = "TELEFONO"
    tkeyboar.Show 1

End Sub

Private Sub telefono_KeyPress(KeyAscii As Integer)

    Dim mytablex As New ADODB.Recordset

    Dim found    As Integer

    Dim buf      As String

    If KeyAscii <> 13 Then Exit Sub
    If Len(telefono) < 7 Then
        telefono.SetFocus
        Exit Sub

    End If

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM deliveri where telefono like '" & telefono & "%'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount = 0 Then
      
        '24/08/2018  Delivery por mesa
        'dcodigo.SetFocus
        dnombre.SetFocus
        '24/08/2018  Delivery por mesa

        Exit Sub

    End If

    found = consulta_cliente("" & telefono)
    Exit Sub

End Sub

Function busca_deliveri()

End Function

Sub inicializa_data_deliveri()
    clasificacion = ""
    dcodigo = ""
    dnombre = ""
    ddireccion = ""
    referencia = ""
    fechanac = ""
    'dotipo = ""
    'doserie = ""
    'donumero = ""
    'dototal = ""
    'dofpago = ""
    'dofecha = ""

End Sub

Sub consulta_banco()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Descripcio"
    Combo1.ListIndex = 0

    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "200"
    sw_consulta = 0
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Sub consulta_vales()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Numero"
    Combo1.ListIndex = 0

    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "2003"
    sw_consulta = 0
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Sub consulta_credito()

    Dim found As Integer
   
    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0

    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "2800"
    sw_consulta = 0
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Function consulta_servicios(buf As String)

    Dim found As Integer

    Dim buf1  As String

    buf1 = ""
    'If Len(buf) > 0 Then
    '   buf1 = " where telefono='" & buf & "'"
    'End If
    Combo1.Clear
    Combo1.AddItem "Descripcio"
    Combo1.AddItem "servicio"
    Combo1.ListIndex = 0
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    'If Len(buf) > 0 Then
    '   buffer = buf
    'End If
    opcion1 = "19000"
    sw_consulta = 0
    found = sql_consulta(1)
    consulta_servicios = 0

End Function

Sub consulta_xvendedor()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "31"
    sw_consulta = 0
    found = sql_consulta(1)

    'dbGrid1.SetFocus
End Sub

Sub consulta_xruc()

    Dim vr

    Dim found As Integer
   
    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.AddItem "Codigo"
    Combo1.ListIndex = 0

    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "30"
    sw_consulta = 0
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Sub consulta_xruc2()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0

    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "300"
    sw_consulta = 0
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Sub consulta_xruc1()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0

    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "99"
    sw_consulta = 0
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Sub consulta_xtipo()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Descripcio"
    Combo1.ListIndex = 0

    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "29"
    sw_consulta = 0
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Sub consulta_cliente1()

    Dim found As Integer

    Frame1.Visible = True
    Frame1.Enabled = True
    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    buffer = ""
    opcion1 = "12"
    sw_consulta = 0
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Sub consulta_clientefp()

    Dim found As Integer

    Frame1.Visible = True
    Frame1.Enabled = True
    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    buffer = ""
    opcion1 = "23"
    sw_consulta = 0
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Function busca_codigod()

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM clientes where  codigo='" & dcodigo & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        clasificacion = "" & mytablex.Fields("clasifica")
        dnombre = "" & mytablex.Fields("nombre")
        ddireccion = "" & mytablex.Fields("direccion")
        fechanac = "" & mytablex.Fields("fechanac")
        referencia = "" & mytablex.Fields("observa")
        saludo_cumpe

        'dotipo = "" & mytablex.Fields("dotipo")
        'doserie = "" & mytablex.Fields("doserie")
        'donumero = "" & mytablex.Fields("donumero")
        'ruc = "" & mytablex.Fields("codigo1")
    End If

    '------------------------------------- ------------
    mytablex.Close

End Function

Function busca_cupo()

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM clientes where  codigo='" & dcodigo & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe

    End If

    '------------------------------------- ------------
    mytablex.Close

End Function

Function busca_codigocl(buf As String, sw As Integer)

    Dim mytablex As New ADODB.Recordset

    Dim buf1     As String

    limite_credito = ""

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM clientes where  codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        limite_credito = "" & mytablex.Fields("credito")

        If sw = 0 Then
            codigo = "" & mytablex.Fields("codigo")
            nombre = "" & mytablex.Fields("nombre")
            tcampo2 = "" & mytablex.Fields("nombre")
            'inicio 20/04/2017 pll
            'xdireccion = "" & mytablex.Fields("direccion")
            ydireccion = "" & mytablex.Fields("direccion")

            'fin 20/04/2017 pll
        End If

        If sw = 1 Then
            xruc = "" & mytablex.Fields("codigo")

            If Len(xnombre) = 0 Then
                xnombre = "" & mytablex.Fields("nombre")

            End If

            If Len(xdireccion) = 0 Then
                xdireccion = "" & mytablex.Fields("direccion")

            End If

        End If

        If dbgrid10.Visible = True Then
            If dbgrid10.columns("tipo") = "V" Then 'si en fpago es vale
                totpedido = "" '& suma_pedidos("" & Data9.Recordset.Fields("codigo"), "" & Data9.Recordset.Fields("orden"), "" & Data9.Recordset.Fields("observa"), "" & Data9.Recordset.Fields("dias"))

            End If

        End If

        busca_codigocl = 1

    End If

    mytablex.Close

End Function

Function busca_localx(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM bodega where  codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        xnombre = "" & mytablex.Fields("nombre")
        xdireccion = "" & mytablex.Fields("direccion")
        'xdistrito = "" & mytablex.Fields("distrito")
        busca_localx = 1

    End If

    mytablex.Close

End Function

Function busca_local_pedido(buf As String) As String

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM tlocal where  codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        busca_local_pedido = "" & mytablex.Fields("nombre")

    End If

    mytablex.Close

End Function

Function busca_telefono(buf As String)

    Dim mytablex As New ADODB.Recordset

    Dim indx     As Integer

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM clientes where  codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        pone_datos_1 mytablex
        busca_telefono = 1

    End If

    mytablex.Close
 
End Function

Sub pone_datos_1(mytablex As ADODB.Recordset)
    clasificacion = "" & mytablex.Fields("clasifica")
    dcodigo = "" & mytablex.Fields("codigo")
    dcodigo = "" & mytablex.Fields("codigo")
    dnombre = "" & mytablex.Fields("nombre")
    ddireccion = "" & mytablex.Fields("direccion")
    fechanac = "" & mytablex.Fields("fechanac")
    referencia = "" & mytablex.Fields("observa")
    saludo_cumpe

    'dotipo = "" & mytablex.Fields("dotipo")
    'doserie = "" & mytablex.Fields("doserie")
    'donumero = "" & mytablex.Fields("donumero")
    'ruc = "" & mytablex.Fields("codigo1")

End Sub

Function contador_telefonos(buf As String)

    Dim mytablex As New ADODB.Recordset

    Dim indx     As Integer

    indx = 0

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM telefono where  telefono='" & telefono & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        Do

            If mytablex.EOF Then Exit Do
            indx = indx + 1
            buf = "" & mytablex.Fields("codigo")
            mytablex.MoveNext
        Loop

    End If

    mytablex.Close

    contador_telefonos = indx

End Function

Function valida()

    Dim sdx      As Double

    Dim mytablex As New ADODB.Recordset

    Dim mytabley As New ADODB.Recordset

    If Len(telefono) < 6 Then
        telefono.SetFocus
        Exit Function

    End If

    If Len(dnombre) = 0 Then
        dnombre.SetFocus
        Exit Function

    End If

    If Len(ddireccion) = 0 Then
        ddireccion.SetFocus
        Exit Function

    End If

    If Len(fechanac) > 0 Then
        If valida_fecha(fechanac) = 0 Then
            fechanac = ""
            fechanac.SetFocus
            Exit Function

        End If

    End If

    'crea el cliente y valida la existencia del cliente
    If Len(dcodigo) = 0 Then
        busca_correlativo 0

    End If

    If mytabley.State = 1 Then mytabley.Close
      
    mytabley.Open "SELECT * FROM clientes where codigo='" & dcodigo & "'", cn, adOpenDynamic, adLockOptimistic

    If mytabley.RecordCount > 0 Then
        mytabley.Fields("nombre") = dnombre
        mytabley.Fields("direccion") = ddireccion
        mytabley.Fields("observa") = referencia
        mytabley.Fields("telefono") = telefono
        mytabley.Fields("clasifica") = Trim(clasificacion)

        If IsDate(fechanac) Then
            mytabley.Fields("fechanac") = fechanac

        End If

        mytabley.Update
    Else
        mytabley.AddNew
        mytabley.Fields("codigo") = dcodigo
        mytabley.Fields("tipo") = "O"
        mytabley.Fields("nombre") = dnombre
        mytabley.Fields("moneda") = "" & mytable11.Fields("moneda")
        mytabley.Fields("direccion") = ddireccion
        mytabley.Fields("observa") = referencia
        mytabley.Fields("telefono") = telefono

        If IsDate(fechanac) Then
            mytabley.Fields("fechanac") = fechanac

        End If

        mytabley.Fields("clasifica") = Trim(clasificacion)
        mytabley.Update
        busca_correlativo 1

    End If

    mytabley.Close
    mytablex.Open "SELECT * FROM deliveri where codigo='" & dcodigo & "' and telefono='" & telefono & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then
        mytablex.AddNew
        mytablex.Fields("telefono") = telefono
        mytablex.Fields("codigo") = dcodigo
        mytablex.Fields("nombre") = dnombre
        mytablex.Fields("direccion") = ddireccion
        mytablex.Fields("referencia") = referencia
        mytablex.Update
    Else
        'mytablex.Fields("telefono") = telefono
        'mytablex.Fields("codigo") = dcodigo
        mytablex.Fields("nombre") = dnombre
        mytablex.Fields("direccion") = ddireccion
        mytablex.Fields("referencia") = referencia
        mytablex.Update

    End If

    mytablex.Close
    valida = 1

End Function

Function verifica_doble(buf As String)

    Dim mytabley As Table

    Set mytabley = mydbxglo.OpenTable(dgusuario)
    mytabley.Index = "producto"
    mytabley.Seek "=", buf

    If Not mytabley.NoMatch Then
        verifica_doble = 1

    End If

    mytabley.Close
 
End Function

Function busca_equiva(buf As String) As Integer

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM productb where barras='" & buf & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        buf = "" & mytablex.Fields("producto")
        busca_equiva = 1
        mytablex.Close
        Exit Function

    End If

    mytablex.Close
   
    mytablex.Open "SELECT * FROM producto where barras='" & buf & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        buf = "" & mytablex.Fields("producto")
        busca_equiva = 1

    End If

    mytablex.Close

End Function

Sub calcula_igv(sw As Integer)

    Dim X           As Double

    Dim Y           As Double

    Dim tdscto      As Double

    Dim tdscto1     As Double

    Dim found       As Integer

    Dim xtivap      As Double

    Dim xtisc       As Double

    Dim xdetra      As Double

    Dim xpercepcion As Double

    Dim ypercepcion As Double
 
    On Error GoTo cmd4567_err

    xpercepcion = selecciona_percepcion("" & codigo, "" & clasesunat)

    DBGrid2.columns("percepcion") = xpercepcion

    If busca_tipoprecio() = "N" Then
        DBGrid2.columns("neto") = Val("" & DBGrid2.columns("cantidad")) * Val("" & DBGrid2.columns("precio"))
        DBGrid2.columns("descuento") = Val("" & DBGrid2.columns("neto")) * Val("" & DBGrid2.columns("deslipo")) / 100       'calcular descuento
        DBGrid2.columns("subtotal") = Val("" & DBGrid2.columns("neto")) - Val("" & DBGrid2.columns("descuento")) 'cobrar
        DBGrid2.columns("impuesto") = redondeo1("" & (Val("" & DBGrid2.columns("subtotal")) * Val("" & DBGrid2.columns("igv")) / 100), nrodecimal)   'calcular descuento
        DBGrid2.columns("total") = Val("" & DBGrid2.columns("subtotal")) + Val("" & DBGrid2.columns("impuesto")) 'cobrar
        DBGrid2.columns("tpercepcio") = redondeo1("" & (Val("" & DBGrid2.columns("total")) * Val("" & DBGrid2.columns("percepcion")) / 100), nrodecimal)     'calcular descuento
        DBGrid2.columns("total") = Val("" & DBGrid2.columns("total")) + Val("" & DBGrid2.columns("tpercepcio")) 'cobrar

        'If xopcionesS(17).Caption = "Sin Servicio" Then
        'DBGrid2.columns("servicioco") = 0
        'DBGrid2.columns("serviciopo") = 0
        'End If
        DBGrid2.columns("servicioco") = redondeo1("" & (Val("" & DBGrid2.columns("subtotal")) * Val("" & DBGrid2.columns("serviciopo")) / 100), nrodecimal)      'calcular descuento
        DBGrid2.columns("total") = Val("" & DBGrid2.columns("total")) + Val("" & DBGrid2.columns("servicioco")) 'cobrar
    Else
        DBGrid2.columns("neto") = Val("" & DBGrid2.columns("cantidad")) * Val("" & DBGrid2.columns("precio"))
        DBGrid2.columns("descuento") = Val("" & DBGrid2.columns("neto")) * Val("" & DBGrid2.columns("deslipo")) / 100       'calcular descuento
        DBGrid2.columns("total") = Val("" & DBGrid2.columns("neto")) - Val("" & DBGrid2.columns("descuento")) 'cobrar
        DBGrid2.columns("subtotal") = redondeo1("" & (Val("" & DBGrid2.columns("total")) / (1 + Val("" & DBGrid2.columns("igv")) / 100)), nrodecimal) 'calcular descuento
        DBGrid2.columns("impuesto") = Val("" & DBGrid2.columns("total")) - Val("" & DBGrid2.columns("subtotal")) 'cobrar

        DBGrid2.columns("tpercepcio") = redondeo1("" & (Val("" & DBGrid2.columns("total")) * Val("" & DBGrid2.columns("percepcion")) / 100), nrodecimal)   'calcular descuento
        DBGrid2.columns("total") = Val("" & DBGrid2.columns("total")) + Val("" & DBGrid2.columns("tpercepcio")) 'cobrar
        'If xopcionesS(17).Caption = "Sin Servicio" Then
        'DBGrid2.columns("servicioco") = 0
        'DBGrid2.columns("serviciopo") = 0
        'End If
        DBGrid2.columns("servicioco") = redondeo1("" & (Val("" & DBGrid2.columns("subtotal")) * Val("" & DBGrid2.columns("serviciopo")) / 100), nrodecimal)      'calcular descuento
        DBGrid2.columns("total") = Val("" & DBGrid2.columns("total")) + Val("" & DBGrid2.columns("servicioco")) 'cobrar

    End If

    '-------------------------------------------------------------
    'dbgrid2.columns("total") = Val("" & dbgrid2.columns("cantidad")) * Val("" & dbgrid2.columns("precio"))
    'dbgrid2.columns("descuento") = Val("" & dbgrid2.columns("total")) * Val("" & dbgrid2.columns("deslipo")) / 100       'calcular descuento
    'dbgrid2.columns("total") = Val("" & dbgrid2.columns("total")) - Val("" & dbgrid2.columns("descuento")) 'cobrar
    'dbgrid2.columns("neto") = Val("" & dbgrid2.columns("total")) / (1 + Val("" & dbgrid2.columns("serviciopo")) / 100)
    'MsgBox DBGrid2.columns("neto")
    'dbgrid2.columns("servicioco") = Val("" & dbgrid2.columns("total")) - Val("" & dbgrid2.columns("neto")) '
    'dbgrid2.columns("subtotal") = Val("" & dbgrid2.columns("neto")) / (1 + Val("" & dbgrid2.columns("igv")) / 100)
    'dbgrid2.columns("impuesto") = Val("" & dbgrid2.columns("neto")) - Val("" & dbgrid2.columns("subtotal")) '
    'If Val("" & Data2.Recordset("igv")) = 0 Then
    '   Data2.Recordset("tax") = Val("" & Data2.Recordset("total"))
    '   Data2.Recordset("impuesto") = 0
    'End If
    'dbgrid2.columns("percepcion") = 0
    'dbgrid2.columns("tpercepcio") = 0
    'If "" & dbgrid2.columns("l1") = "S" Then
    '   dbgrid2.columns("percepcion") = xpercepcion
    '   ypercepcion = xpercepcion * Val("" & dbgrid2.columns("neto")) / 100
    '   dbgrid2.columns("tpercepcio") = ypercepcion
    '   dbgrid2.columns("total") = Val("" & dbgrid2.columns("total")) + Val("" & dbgrid2.columns("tpercepcio"))
    'End If
    'dbgrid2.columns("tivap") = Val("" & dbgrid2.columns("neto")) * Val("" & dbgrid2.columns("ivap")) / 100

    'DBGrid2.columns("neto") = Val("" & DBGrid2.columns("cantidad")) * Val("" & DBGrid2.columns("precio"))
    'tdscto = Val("" & DBGrid2.columns("neto")) * Val("" & DBGrid2.columns("deslipo")) / 100       'calcular descuento
    'DBGrid2.columns("descuento") = tdscto  'total descuento
    'DBGrid2.columns("total") = Val("" & DBGrid2.columns("neto")) - Val("" & DBGrid2.columns("descuento")) 'cobrar
    'xtivap = Val("" & DBGrid2.columns("total")) * Val("" & DBGrid2.columns("ivap")) / 100
    'DBGrid2.columns("tivap") = xtivap

    'Y = 1 + Val("" & DBGrid2.columns("igv")) / 100 + Val("" & DBGrid2.columns("serviciopo")) / 100 + Val("" & DBGrid2.columns("isc")) / 100
    'X = Val("" & DBGrid2.columns("total")) / Y
    'DBGrid2.columns("subtotal") = X
    'DBGrid2.columns("servicioco") = X * Val("" & DBGrid2.columns("serviciopo")) / 100
    'DBGrid2.columns("impuesto") = X * Val("" & DBGrid2.columns("igv")) / 100
    'If Val("" & DBGrid2.columns("igv")) = 0 Then
    '   DBGrid2.columns("tax") = Val("" & DBGrid2.columns("total"))
    '   DBGrid2.columns("impuesto") = 0
    'End If
    Exit Sub
cmd4567_err:
    MsgBox "Error en Calcula Igv " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub calcula_sinigv()

    Dim sdx   As Double

    Dim sdx1  As Double

    Dim sdx2  As Double

    Dim found As Integer

    'debe sumar el igv
    'DBGrid2.Columns("neto") = Val("" & DBGrid2.Columns("cantidad")) * Val("" & DBGrid2.Columns("precio"))
    If Val("" & DBGrid2.columns("cantidad")) > 0 And Val("" & DBGrid2.columns("neto")) > 0 Then
        sdx = Val("" & DBGrid2.columns("neto")) * Val("" & DBGrid2.columns("deslipo")) / 100 'descuento
        DBGrid2.columns("descuento") = sdx  'descuento
        DBGrid2.columns("subtotal") = Val("" & DBGrid2.columns("neto")) - Val("" & DBGrid2.columns("descuento")) 'subtotal
        sdx = Val("" & DBGrid2.columns("subtotal")) * Val("" & DBGrid2.columns("igv")) / 100
        DBGrid2.columns("impuesto") = sdx 'igv
        DBGrid2.columns("total") = Val("" & DBGrid2.columns("subtotal")) + sdx 'neto
        sdx = Val("" & DBGrid2.columns("total")) / Val(DBGrid2.columns("cantidad"))
        DBGrid2.columns("precio") = sdx

    End If

End Sub

Function consulta_producto(buf As String)

    Dim found As Integer

    Dim xbuf  As String

    xbuf = ""

    If Len(buf) > 0 Then
        xbuf = buf '" AND descripcio like '" & buf & "%'"

    End If

    Combo1.Clear
    Combo1.AddItem "producto.Descripcio"
    Combo1.AddItem "producto.Producto"
    Combo1.AddItem "producto.Familia"
    Combo1.AddItem "producto.Marca"
    Combo1.ListIndex = 0
    Frame1.Enabled = True
    Frame1.Visible = True

    buffer = xbuf
    opcion1 = "8"
    DBGrid2.Enabled = False
    sw_consulta = 0
    found = sql_consulta(1)

    'dbGrid1.SetFocus
End Function

Function consulta_inicial(buf As String)

    Dim buf1      As String

    Dim queprecio As String

    Combo1.Clear
    Combo1.AddItem "Producto.Descripcio"
    Combo1.ListIndex = 0

    queprecio = "precioS.pventa1 as Precio "

    If Len(buf) > 0 Then
        buf1 = "select Producto.Descripcio,Producto.producto,Producto.Marca,precios.Unidad1 as Und1,precios.Factor1 as F," & queprecio & " ,Producto.Monedav as M,Producto.Familia,Producto.Subfamilia,Producto.seccion from producto  left join precios on producto.producto=precios.producto  where precios.local='" & "" & mytable11.Fields("listap") & "' and producto.descripcio like '" & buf & "%'"

    End If

    If Len(buf) = 0 Then
        buf1 = "select Producto.Descripcio,Producto.producto,Producto.Marca,precios.Unidad1 as Und1,precios.Factor1 as F," & queprecio & " ,Producto.Monedav as M,Producto.Familia,Producto.Subfamilia,Producto.seccion from producto  left join precios on producto.producto=precios.producto  where precios.local='" & "" & mytable11.Fields("listap") & "'"

    End If
   
    If rcconsulta.State = 1 Then rcconsulta.Close
    rcconsulta.Open buf1, cn, adOpenStatic, adLockOptimistic

    If rcconsulta.EOF = True And rcconsulta.BOF = True Then
        rcconsulta.Close
        buffer.SetFocus
        Exit Function

    End If
   
    Set dbGrid1.DataSource = rcconsulta
    dbGrid1.columns(0).Width = 5000
    dbGrid1.columns(1).Width = 1300
    dbGrid1.columns(2).Width = 1000
    dbGrid1.columns("cantidad").Width = 900
    dbGrid1.columns(4).Width = 500
    dbGrid1.columns("precio").Width = 800
    dbGrid1.columns("deslipo").Width = 500
    dbGrid1.columns("total").Width = 1000
    dbGrid1.columns("isc").Width = 1500
    dbGrid1.columns(9).Width = 1500
    'End If
    consulta_inicial = 1

End Function

Sub cerrar_data2()

    On Error GoTo cmd4_err

    Data2.Recordset.Close
    Exit Sub
cmd4_err:
    Exit Sub

End Sub

Sub carga_dbgrid4(uproducto As String)

    '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017
    DBGrid2.Enabled = False
    '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017

    Dim i         As Integer

    Dim xfoto     As String

    Dim mytablex  As New ADODB.Recordset

    Dim mytabley  As New ADODB.Recordset

    Dim sw        As Integer

    Dim xbodega   As String

    Dim xsaldo    As Double

    Dim xbuf      As String

    Dim xcosto    As Double

    Dim xmargen   As Double

    Dim xcostou   As Double

    Dim xfactor   As Double

    Dim xsvirtual As Double

    Dim xxr       As String

    Dim xxi       As String

    Dim xpreciox  As Double

    Dim dmoneda   As String

    On Error GoTo cmd89111_err

    xcostou = 0

    For i = 0 To 9
        campo_precios(i).unidad = ""
        campo_precios(i).factor = ""
        campo_precios(i).precio = ""
        campo_precios(i).costo = ""
        campo_precios(i).margen = ""
        campo_precios(i).stock = ""
        'campo_precios(i).svirtual = ""
    Next i

    'MsgBox uproducto
    xfactor = 1
    xbodega = "" & mytable11.Fields("bodega")
    xsaldo = 0
    xcosto = 0
    xsvirtual = 0
    sw = 0

    If mytabley.State = 1 Then mytabley.Close
    mytabley.Open "SELECT * FROM almacen where local='" & "" & mytable11.Fields("local") & "' and producto='" & uproducto & "' and bodega='" & xbodega & "'", cn, adOpenStatic, adLockOptimistic

    If mytabley.RecordCount > 0 Then
        xsaldo = Val("" & mytabley.Fields("saldo"))

        ' xsvirtual = Val("" & mytabley.Fields("saldo")) - Val("" & mytabley.Fields("svirtual"))
    End If

    mytabley.Close
    'MsgBox "x"
    '---buscamos los datos de productos
    dmoneda = "S"
    xfoto = ""
    descorto = ""

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM producto where  producto='" & uproducto & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        xcostou = 0

        If "" & mytable11.Fields("vecocaja") = "S" Then
            xcostou = Val("" & mytablex.Fields("costou"))

        End If

        xfactor = Val("" & mytablex.Fields("factor"))
        descorto = "" & mytablex.Fields("presenta")
        dmoneda = "" & mytablex.Fields("monedav")
           
        '' 30/11/2017 Mostrar imagen de producto en detalle del mismo (F1)
        'xfoto = "" & mytablex.Fields("fotonombre")
        xfoto = "" & mytablex.Fields("imagen")
        pone_fotonombre mytablex
        '' 30/11/2017 Mostrar imagen de producto en detalle del mismo (F1)

    End If

    mytablex.Close
      
    '' 30/11/2017 Mostrar imagen de producto en detalle del mismo (F1)
    '  carga_foto xfoto
    '' 30/11/2017 Mostrar imagen de producto en detalle del mismo (F
      
    If Val(paridad) <= 0 Then
        paridad = "1"

    End If

    'MsgBox "abc"
    If mytablex.State = 1 Then mytablex.Close
      
    '29/05/2017
    Dim xTabla As String

    xTabla = "PRECIOS"
    xprecioDsctox = 0
     
    If Len(Trim(codigo.Text)) <> 0 Then

        Dim mytablexy As New ADODB.Recordset

        mytablexy.Open "SELECT * FROM PRECIO1 where CODIGO = '" & Trim(codigo.Text) & "' and producto='" & uproducto & "'", cn, adOpenKeyset, adLockReadOnly

        If mytablexy.RecordCount > 0 Then
            xprecioDsctox = mytablexy.Fields("pventa1")

        End If

    End If
      
    If xprecioDsctox > 0 Then xTabla = "precio1" 'TABLA DE LOS PRODUCTOS CON DESCUENTO POR CLIENTE
     
    If mytabley.State = 1 Then mytabley.Close
    If xTabla = "PRECIOS" Then
        mytablex.Open "SELECT * FROM " & xTabla & " where producto='" & uproducto & "' and local='" & "" & mytable11.Fields("listap") & "'", cn, adOpenStatic, adLockOptimistic
    Else
        mytablex.Open "SELECT * FROM " & xTabla & " where  CODIGO = '" & Trim(codigo.Text) & "' and producto='" & uproducto & "' and local='" & "" & mytable11.Fields("listap") & "'", cn, adOpenStatic, adLockOptimistic

    End If

    '--- KENYO 29/05/2017----------
      
    '   mytablex.Open "SELECT * FROM precios where  producto='" & uproducto & "' and local='" & "" & mytable11.Fields("listap") & "'", cn, adOpenStatic, adLockOptimistic
      
    If mytablex.RecordCount > 0 Then
        xcosto = 0
        xpreciox = 0
         
        If Val("" & mytablex.Fields("factor1")) > 0 Then
            If "" & mytable11.Fields("moneda") = "S" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa1"))

                If dmoneda = "D" Then
                    xpreciox = Val("" & mytablex.Fields("pventa1")) * Val(paridad)

                End If

            End If

            If "" & mytable11.Fields("moneda") = "D" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa1"))

                If dmoneda = "S" Then
                    xpreciox = Val("" & mytablex.Fields("pventa1")) / Val(paridad)

                End If

            End If

            'MsgBox "abc"
            '------------------------------------------------------------
            
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            'xcosto = xcostou / xfactor
            xcosto = xcostou
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            
            xcosto = xcosto * Val("" & mytablex.Fields("factor1"))
            campo_precios(0).unidad = "" & mytablex.Fields("unidad1")
            campo_precios(0).factor = "" & Val("" & mytablex.Fields("factor1"))
            campo_precios(0).precio = "" & xpreciox
            campo_precios(0).costo = "" & xcosto
            'campo_precios(0).svirtual = "" & xsvirtual
            xbuf = calcula_saldo(xsaldo, Val("" & mytablex.Fields("factor1")))
            campo_precios(0).stock = "" & xbuf
            xmargen = 0

            If xcosto > 0 Then
                xmargen = ((xpreciox - xcosto) * 100) / xcosto

            End If

            campo_precios(0).margen = "" & xmargen

        End If

        '---------
        'MsgBox "abc"
        xcosto = 0
   
        If Val("" & mytablex.Fields("factor2")) > 0 Then
            If "" & mytable11.Fields("moneda") = "S" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa2"))

                If dmoneda = "D" Then
                    xpreciox = Val("" & mytablex.Fields("pventa2")) * Val(paridad)

                End If

            End If

            If "" & mytable11.Fields("moneda") = "D" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa2"))

                If dmoneda = "S" Then
                    xpreciox = Val("" & mytablex.Fields("pventa2")) / Val(paridad)

                End If

            End If
   
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            'xcosto = xcostou / xfactor
            xcosto = xcostou
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            
            xcosto = xcosto * Val("" & mytablex.Fields("factor2"))
            campo_precios(1).unidad = "" & mytablex.Fields("unidad2")
            campo_precios(1).factor = "" & Val("" & mytablex.Fields("factor2"))
            campo_precios(1).precio = "" & xpreciox
            xbuf = calcula_saldo(xsaldo, Val("" & mytablex.Fields("factor2")))
            campo_precios(1).stock = "" & xbuf
            ' campo_precios(1).svirtual = "" & calcula_saldo(xsvirtual, Val("" & mytablex.Fields("factor2")))
            campo_precios(1).costo = "" & xcosto
            xmargen = 0

            If xcosto > 0 Then
                xmargen = ((xpreciox - xcosto) * 100) / xcosto

            End If

            campo_precios(1).margen = "" & xmargen

        End If

        xcosto = 0
   
        If Val("" & mytablex.Fields("factor3")) > 0 Then
            If "" & mytable11.Fields("moneda") = "S" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa3"))

                If dmoneda = "D" Then
                    xpreciox = Val("" & mytablex.Fields("pventa3")) * Val(paridad)

                End If

            End If

            If "" & mytable11.Fields("moneda") = "D" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa3"))

                If dmoneda = "S" Then
                    xpreciox = Val("" & mytablex.Fields("pventa3")) / Val(paridad)

                End If

            End If

            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            'xcosto = xcostou / xfactor
            xcosto = xcostou
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
   
            xcosto = xcosto * Val("" & mytablex.Fields("factor3"))
            campo_precios(2).unidad = "" & mytablex.Fields("unidad3")
            campo_precios(2).factor = "" & Val("" & mytablex.Fields("factor3"))
            campo_precios(2).precio = "" & xpreciox
            xbuf = calcula_saldo(xsaldo, Val("" & mytablex.Fields("factor3")))
            campo_precios(2).stock = "" & xbuf
            '    campo_precios(2).svirtual = "" & calcula_saldo(xsvirtual, Val("" & mytablex.Fields("factor3")))
            campo_precios(2).costo = "" & xcosto
            xmargen = 0

            If xcosto > 0 Then
                xmargen = ((xpreciox - xcosto) * 100) / xcosto
                campo_precios(2).margen = "" & xmargen

            End If

            campo_precios(2).margen = "" & xmargen

        End If

        xcosto = 0
   
        If Val("" & mytablex.Fields("factor4")) > 0 Then
            If "" & mytable11.Fields("moneda") = "S" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa4"))

                If dmoneda = "D" Then
                    xpreciox = Val("" & mytablex.Fields("pventa4")) * Val(paridad)

                End If

            End If

            If "" & mytable11.Fields("moneda") = "D" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa4"))

                If dmoneda = "S" Then
                    xpreciox = Val("" & mytablex.Fields("pventa4")) / Val(paridad)

                End If

            End If

            'MsgBox "abc"
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            'xcosto = xcostou / xfactor
            xcosto = xcostou
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
   
            xcosto = xcosto * Val("" & mytablex.Fields("factor4"))
            campo_precios(3).unidad = "" & mytablex.Fields("unidad4")
            campo_precios(3).factor = "" & Val("" & mytablex.Fields("factor4"))
            campo_precios(3).precio = "" & xpreciox
            xbuf = calcula_saldo(xsaldo, Val("" & mytablex.Fields("factor4")))
            campo_precios(3).stock = "" & xbuf
            '   campo_precios(3).svirtual = "" & calcula_saldo(xsvirtual, Val("" & mytablex.Fields("factor4")))
            campo_precios(3).costo = "" & xcosto
            xmargen = 0

            If xcosto > 0 Then
                xmargen = ((xpreciox - xcosto) * 100) / xcosto

            End If

            campo_precios(3).margen = "" & xmargen

        End If

        xcosto = 0
    
        If Val("" & mytablex.Fields("factor5")) > 0 Then
            If "" & mytable11.Fields("moneda") = "S" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa5"))

                If dmoneda = "D" Then
                    xpreciox = Val("" & mytablex.Fields("pventa5")) * Val(paridad)

                End If

            End If

            If "" & mytable11.Fields("moneda") = "D" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa5"))

                If dmoneda = "S" Then
                    xpreciox = Val("" & mytablex.Fields("pventa5")) / Val(paridad)

                End If

            End If
   
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            'xcosto = xcostou / xfactor
            xcosto = xcostou
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
   
            xcosto = xcosto * Val("" & mytablex.Fields("factor5"))
            campo_precios(4).unidad = "" & mytablex.Fields("unidad5")
            campo_precios(4).factor = "" & Val("" & mytablex.Fields("factor5"))
            campo_precios(4).precio = "" & xpreciox
            xbuf = calcula_saldo(xsaldo, Val("" & mytablex.Fields("factor5")))
            ' campo_precios(4).svirtual = "" & calcula_saldo(xsvirtual, Val("" & mytablex.Fields("factor5")))
            campo_precios(4).stock = "" & xbuf
            campo_precios(4).costo = "" & xcosto
            xmargen = 0

            If xcosto > 0 Then
                xmargen = ((xpreciox - xcosto) * 100) / xcosto

            End If

            campo_precios(4).margen = "" & xmargen

        End If

        xcosto = 0
   
        If Val("" & mytablex.Fields("factor6")) > 0 Then
            If "" & mytable11.Fields("moneda") = "S" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa6"))

                If dmoneda = "D" Then
                    xpreciox = Val("" & mytablex.Fields("pventa6")) * Val(paridad)

                End If

            End If

            If "" & mytable11.Fields("moneda") = "D" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa6"))

                If dmoneda = "S" Then
                    xpreciox = Val("" & mytablex.Fields("pventa6")) / Val(paridad)

                End If

            End If

            'MsgBox "abcD"
   
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            'xcosto = xcostou / xfactor
            xcosto = xcostou
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
   
            xcosto = xcosto * Val("" & mytablex.Fields("factor6"))
            campo_precios(5).unidad = "" & mytablex.Fields("unidad6")
            campo_precios(5).factor = "" & Val("" & mytablex.Fields("factor6"))
            campo_precios(5).precio = "" & xpreciox
            xbuf = calcula_saldo(xsaldo, Val("" & mytablex.Fields("factor6")))
            campo_precios(5).stock = "" & xbuf
            '  campo_precios(5).svirtual = "" & calcula_saldo(xsvirtual, Val("" & mytablex.Fields("factor6")))
            campo_precios(5).costo = "" & xcosto
            xmargen = 0

            If xcosto > 0 Then
                xmargen = ((xpreciox - xcosto) * 100) / xcosto

            End If

            campo_precios(5).margen = "" & xmargen
   
            'SOLO PARA MAXIMO SE PONE PRECIO=0
            'If caja <> "08" Then
            '   campo_precios("precio").precio = 0
            'End If
        End If

        'MsgBox "xx"
        xcosto = 0
   
        If Val("" & mytablex.Fields("factor7")) > 0 Then
            If "" & mytable11.Fields("moneda") = "S" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa7"))

                If dmoneda = "D" Then
                    xpreciox = Val("" & mytablex.Fields("pventa7")) * Val(paridad)

                End If

            End If

            If "" & mytable11.Fields("moneda") = "D" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa7"))

                If dmoneda = "S" Then
                    xpreciox = Val("" & mytablex.Fields("pventa7")) / Val(paridad)

                End If

            End If

            'MsgBox "abcde"
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            'xcosto = xcostou / xfactor
            xcosto = xcostou
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            xcosto = xcosto * Val("" & mytablex.Fields("factor7"))
   
            campo_precios(6).unidad = "" & mytablex.Fields("unidad7")
            campo_precios(6).factor = "" & Val("" & mytablex.Fields("factor7"))
            campo_precios(6).precio = "" & xpreciox
            xbuf = calcula_saldo(xsaldo, Val("" & mytablex.Fields("factor7")))
            campo_precios(6).stock = "" & xbuf
            '    campo_precios(6).svirtual = "" & calcula_saldo(xsvirtual, Val("" & mytablex.Fields("factor7")))
            campo_precios(6).costo = "" & xcosto
            xmargen = 0

            If xcosto > 0 Then
                xmargen = ((xpreciox - xcosto) * 100) / xcosto
         
            End If

            campo_precios(6).margen = "" & xmargen

        End If

        xcosto = 0
   
        If Val("" & mytablex.Fields("factor8")) > 0 Then
            If "" & mytable11.Fields("moneda") = "S" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa8"))

                If dmoneda = "D" Then
                    xpreciox = Val("" & mytablex.Fields("pventa8")) * Val(paridad)

                End If

            End If

            If "" & mytable11.Fields("moneda") = "D" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa8"))

                If dmoneda = "S" Then
                    xpreciox = Val("" & mytablex.Fields("pventa8")) / Val(paridad)

                End If

            End If

            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            'xcosto = xcostou / xfactor
            xcosto = xcostou
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
   
            xcosto = xcosto * Val("" & mytablex.Fields("factor8"))
   
            campo_precios(7).unidad = "" & mytablex.Fields("unidad8")
            campo_precios(7).factor = "" & Val("" & mytablex.Fields("factor8"))
            campo_precios(7).precio = "" & xpreciox
            xbuf = calcula_saldo(xsaldo, Val("" & mytablex.Fields("factor8")))
            campo_precios(7).stock = "" & xbuf
            'campo_precios(7).svirtual = "" & calcula_saldo(xsvirtual, Val("" & mytablex.Fields("factor8")))
            campo_precios(7).costo = "" & xcosto
            xmargen = 0

            If xcosto > 0 Then
                xmargen = ((xpreciox - xcosto) * 100) / xcosto

            End If

            campo_precios(7).margen = "" & xmargen

        End If

        xcosto = 0
   
        If Val("" & mytablex.Fields("factor9")) > 0 Then
            If "" & mytable11.Fields("moneda") = "S" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa9"))

                If dmoneda = "D" Then
                    xpreciox = Val("" & mytablex.Fields("pventa9")) * Val(paridad)

                End If

            End If

            If "" & mytable11.Fields("moneda") = "D" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa9"))

                If dmoneda = "S" Then
                    xpreciox = Val("" & mytablex.Fields("pventa9")) / Val(paridad)

                End If

            End If

            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            'xcosto = xcostou / xfactor
            xcosto = xcostou
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
   
            xcosto = xcosto * Val("" & mytablex.Fields("factor9"))
            campo_precios(8).unidad = "" & mytablex.Fields("unidad9")
            campo_precios(8).factor = "" & Val("" & mytablex.Fields("factor9"))
            campo_precios(8).precio = "" & xpreciox
            xbuf = calcula_saldo(xsaldo, Val("" & mytablex.Fields("factor9")))
            campo_precios(8).stock = "" & xbuf
            'campo_precios(8).svirtual = "" & calcula_saldo(xsvirtual, Val("" & mytablex.Fields("factor9")))
            campo_precios(8).costo = "" & xcosto
            xmargen = 0

            If xcosto > 0 Then
                xmargen = ((xpreciox - xcosto) * 100) / xcosto

            End If

            campo_precios(8).margen = "" & xmargen

        End If

        xcosto = 0
   
        If Val("" & mytablex.Fields("factor10")) > 0 Then
            If "" & mytable11.Fields("moneda") = "S" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa10"))

                If dmoneda = "D" Then
                    xpreciox = Val("" & mytablex.Fields("pventa10")) * Val(paridad)

                End If

            End If

            If "" & mytable11.Fields("moneda") = "D" Then 'si es soles
                xpreciox = Val("" & mytablex.Fields("pventa10"))

                If dmoneda = "S" Then
                    xpreciox = Val("" & mytablex.Fields("pventa10")) / Val(paridad)

                End If

            End If
   
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
            'xcosto = xcostou / xfactor
            xcosto = xcostou
            ''' 26/12/2017 Correción de Stock en Linea de costos de productos
   
            xcosto = xcosto * Val("" & mytablex.Fields("factor10"))
            campo_precios(9).unidad = "" & mytablex.Fields("unidad10")
            campo_precios(9).factor = "" & Val("" & mytablex.Fields("factor10"))
            campo_precios(9).precio = "" & xpreciox
            xbuf = calcula_saldo(xsaldo, Val("" & mytablex.Fields("factor10")))
            campo_precios(9).stock = "" & xbuf
            ' campo_precios(9).svirtual = "" & calcula_saldo(xsvirtual, Val("" & mytablex.Fields("factor10")))
            campo_precios(9).costo = "" & xcosto
            xmargen = 0

            If xcosto > 0 Then
                xmargen = ((xpreciox - xcosto) * 100) / xcosto

            End If

            campo_precios(9).margen = "" & xmargen

        End If

        'MsgBox "xx"
        sql_saldo_locales uproducto
        'margenes
        sw = 1

    End If

    'mytablex.Close
    'mytablez.Close
    DBGrid4.refresh

    '----ahora deb cargar tambien la foto del producto...
    Frame1.Enabled = False
    Frame5.Visible = True
    Frame5.Enabled = True
    DBGrid4.SetFocus
    Exit Sub
cmd89111_err:
    MsgBox "Error en carga dbgrid4 " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub ir_ultimo()

    Dim found As Integer

    On Error GoTo cmd50_err

    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus
    Exit Sub
cmd50_err:
    MsgBox "Error en Ir-ultimo " + error$, 48, "Aviso"
    Data2.refresh
    DBGrid2.SetFocus
    Exit Sub

End Sub

Sub ir_primero()

    On Error GoTo cmd51_err

    Data2.Recordset.MoveFirst
    Exit Sub
cmd51_err:
    Exit Sub

End Sub

Function busca_linea(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM linea where  linea='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        busca_linea = 1
        tingtalla.nlinea = "" & mytablex.Fields("descripcio")
        'KENYO
  
        ' tingtalla.Producto = dg
   
        If mytablex.Fields("t1") <> "" Then
            tingtalla.nt1 = "" & mytablex.Fields("t1")
        Else
            tingtalla.nt1 = "-"

        End If
    
        If mytablex.Fields("t2") <> "" Then
            tingtalla.nt2 = "" & mytablex.Fields("t2")
        Else
            tingtalla.nt2 = "-"

        End If
    
        If mytablex.Fields("t3") <> "" Then
            tingtalla.nt3 = "" & mytablex.Fields("t3")
        Else
            tingtalla.nt3 = "-"

        End If
    
        If mytablex.Fields("t4") <> "" Then
            tingtalla.nt4 = "" & mytablex.Fields("t4")
        Else
            tingtalla.nt4 = "-"

        End If
    
        If mytablex.Fields("t5") <> "" Then
            tingtalla.nt5 = "" & mytablex.Fields("t5")
        Else
            tingtalla.nt5 = "-"

        End If
    
        If mytablex.Fields("t6") <> "" Then
            tingtalla.nt6 = "" & mytablex.Fields("t6")
        Else
            tingtalla.nt6 = "-"

        End If
    
        If mytablex.Fields("t7") <> "" Then
            tingtalla.nt7 = "" & mytablex.Fields("t7")
        Else
            tingtalla.nt7 = "-"

        End If
    
        If mytablex.Fields("t8") <> "" Then
            tingtalla.nt8 = "" & mytablex.Fields("t8")
        Else
            tingtalla.nt8 = "-"

        End If
    
        If mytablex.Fields("t9") <> "" Then
            tingtalla.nt9 = "" & mytablex.Fields("t9")
        Else
            tingtalla.nt9 = "-"

        End If
    
        If mytablex.Fields("t10") <> "" Then
            tingtalla.nt10 = "" & mytablex.Fields("t10")
        Else
            tingtalla.nt10 = "-"

        End If
    
        If mytablex.Fields("t11") <> "" Then
            tingtalla.nt11 = "" & mytablex.Fields("t11")
        Else
            tingtalla.nt11 = "-"

        End If
    
        If mytablex.Fields("t12") <> "" Then
            tingtalla.nt12 = "" & mytablex.Fields("t12")
        Else
            tingtalla.nt12 = "-"

        End If
    
        If mytablex.Fields("t13") <> "" Then
            tingtalla.nt13 = "" & mytablex.Fields("t13")
        Else
            tingtalla.nt13 = "-"

        End If
    
        If mytablex.Fields("t14") <> "" Then
            tingtalla.nt14 = "" & mytablex.Fields("t14")
        Else
            tingtalla.nt14 = "-"

        End If
    
        If mytablex.Fields("t15") <> "" Then
            tingtalla.nt15 = "" & mytablex.Fields("t15")
        Else
            tingtalla.nt15 = "-"

        End If
        
        If mytablex.Fields("t16") <> "" Then
            tingtalla.nt16 = "" & mytablex.Fields("t16")
        Else
            tingtalla.nt16 = "-"

        End If
 
        'KENYO
   
    End If

    '------------------------------------- ------------
    mytablex.Close

End Function

Sub ingreso_tallas(buf As String)

    Dim found As Integer

    found = busca_linea(buf)

    If found = 0 Then Exit Sub
    pone_tallas buf

    tingtalla.Show 1
    menu_fin_tallas

End Sub

Sub pone_tallas(buf As String)

    tingtalla.linea = buf

    '''16/08/2017  Cambios Zapateria
    'tingtalla.producto = VAL("" & dbgrid2.columns("producto"))
    tingtalla.producto = ("" & DBGrid2.columns("producto"))
    '''16/08/2017  Cambios Zapateria

    tingtalla.descripcion = DBGrid2.columns("Descripcio")

    On Error GoTo cmd451_err

    '''16/08/2017  Cambios Zapateria
    'tingtalla.sql_saldo_locales Trim(Val("" & dbgrid2.columns("producto")))
    tingtalla.sql_saldo_locales Trim(("" & DBGrid2.columns("producto")))
    '''16/08/2017  Cambios Zapateria

    Exit Sub
cmd451_err:
    MsgBox "Seleccione un Producto", 48, "Aviso"
    Exit Sub

    'sql_saldo_locales Trim(Producto)

    'fin

    tingtalla.t1 = "" & DBGrid2.columns(18)
    tingtalla.t2 = "" & DBGrid2.columns(19)
    tingtalla.t3 = "" & DBGrid2.columns(20)
    tingtalla.t4 = "" & DBGrid2.columns(21)
    tingtalla.t5 = "" & DBGrid2.columns(22)
    tingtalla.t6 = "" & DBGrid2.columns(23)
    tingtalla.t7 = "" & DBGrid2.columns(24)
    tingtalla.t8 = "" & DBGrid2.columns(25)
    tingtalla.t9 = "" & DBGrid2.columns(26)
    tingtalla.t10 = "" & DBGrid2.columns(27)
    tingtalla.t11 = "" & DBGrid2.columns(28)
    tingtalla.t12 = "" & DBGrid2.columns(29)
    tingtalla.t13 = "" & DBGrid2.columns(30)
    tingtalla.t14 = "" & DBGrid2.columns(31)
    tingtalla.t15 = "" & DBGrid2.columns(32)
    tingtalla.t16 = "" & DBGrid2.columns(33)

End Sub

Sub ingreso_locales()

    On Error GoTo cmd11200_err

    xxpone_locales
    txobserv.Show 1
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus
    Exit Sub
cmd11200_err:
    Exit Sub

    'If acu = "R" Then 'si no es orden de compra
    '   l1.Enabled = False
    '   l2.Enabled = False
    '   l3.Enabled = False
    '   l4.Enabled = False
    'End If
    'l1.SetFocus
End Sub

Sub xxpone_locales()

    Dim found As Integer

    txobserv.observa1 = "" & DBGrid2.columns("observa1")
    txobserv.observa2 = "" & DBGrid2.columns("observa2")
    txobserv.observa3 = "" & DBGrid2.columns("observa3")
    txobserv.observa4 = "" & DBGrid2.columns("observa4")

End Sub

Sub cerrar_data1()

    On Error GoTo cmd17_err

    Data1.Recordset.Close
    Exit Sub
cmd17_err:
    Exit Sub

End Sub

Sub graba_temporald(mytablex As ADODB.Recordset, _
                    sw As Integer, _
                    canti As String, _
                    mytabley As ADODB.Recordset, _
                    xsw As Integer)

    Dim fechadi  As String

    Dim deslipox As Double

    Dim found    As Integer

    Dim xxca     As String

    Dim sdx      As Double

    Dim dsdx     As Double

    Dim xpreciox As Double

    Dim mytables As New ADODB.Recordset

    Dim mytablez As New ADODB.Recordset

    xxca = "1"
    'If Val(canti) > 0 Then
    '   xxca = "" & canti
    'End If

    If canti <> "" Then
        xxca = "" & canti

    End If

    'MsgBox xxca
    xpreciox = 0
    deslipox = 0
    dsdx = 0

    If Val(paridad) <= 0 Then
        paridad = "1"

    End If

    If "" & mytable11.Fields("moneda") = "S" Then 'si es soles
 
        'KENYO
        '' CAMBIO PRECIO DE VENTA AL POR MAYOR
        ' If canti >= Val("" & mytabley.Fields("minimo11")) And canti <= Val("" & mytabley.Fields("maximo11")) Then
        ' xpreciox = Val("" & mytabley.Fields("pventa11"))
        ' Else
        xpreciox = Val("" & mytabley.Fields("pventa1"))
        'xpreciox = Val("" & mytabley.Fields("pventa1"))
       
        'Combos Combinaciones 07/07/2018
       
        If combinac = "S" Then
            xpreciox = 0

        End If

        'Combos Combinaciones 07/07/2018
       
        ' End If
   
        If "" & mytablex.Fields("monedav") = "D" Then
            xpreciox = Val("" & mytabley.Fields("pventa1")) * Val(paridad)

        End If

    End If

    If "" & mytable11.Fields("moneda") = "D" Then 'si es soles
        xpreciox = Val("" & mytabley.Fields("pventa1"))

        If "" & mytablex.Fields("monedav") = "S" Then
            xpreciox = Val("" & mytabley.Fields("pventa1")) / Val(paridad)

        End If

    End If

    'If xopcionesS(17).Caption = "Sin Servicio" Then
    'xpreciox = xpreciox - xpreciox * Val("" & mytablex.Fields("serviciomesa")) / 100
    'End If

    '----verificamos si el cliente tiene descuento---
    dsdx = 0

    If Len(codigo) > 0 And "" & mytablex.Fields("remate") <> "S" Then
        If mytablez.State = 1 Then mytablez.Close
        mytablez.Open "SELECT * FROM clientes where codigo='" & codigo & "'", cn, adOpenStatic, adLockOptimistic

        If mytablez.RecordCount > 0 Then
            dsdx = xpreciox * Val("" & mytablez.Fields("descuento")) / 100

        End If

        xpreciox = xpreciox - dsdx

    End If

    'ver si esta en un rango de descuento------------
    If Len("" & mytabley.Fields("fechaid")) = 10 And Len("" & mytabley.Fields("fechafd")) = 10 Then
        If IsDate("" & mytabley.Fields("fechaid")) And IsDate("" & mytabley.Fields("fechafd")) And CVDate("" & mytabley.Fields("fechafd")) >= CVDate("" & mytabley.Fields("fechaid")) And Val("" & mytabley.Fields("dscto")) > 0 Then
            fechadi = Format(Now, "dd/mm/yyyy")

            If CVDate(fechadi) >= CVDate("" & mytabley.Fields("fechaid")) And CVDate(fechadi) <= CVDate("" & mytabley.Fields("fechafd")) Then
                deslipox = Val("" & mytabley.Fields("dscto"))

            End If

        End If

    End If

    'si son cantidades que sucede y esta en el rango verificar si tiene grabado precio
    'If "" & DBGrid2.Columns(2) = "" & mytabley.Fields("unidad1") Then  'si es la misma unidad
    '
    '   If Val("" & DBGrid2.Columns("cantidad")) >= a And Val("" & DBGrid2.Columns("cantidad")) <= a Then
    '   End If
    'End If
    'If "" & mytablex.Fields("excludscto") = "S" Then
    '   Data1.Recordset.Fields("deslipo") = 0
    'End If
    '------------------------------------------------
    'MsgBox xpreciox
    DBGrid2.refresh
    DBGrid2.columns("zona") = "" & mytablex.Fields("seccion")
    DBGrid2.columns("nroprecio") = "1"
    DBGrid2.columns(52) = Format(Now, "hh:mm:ss")
    DBGrid2.columns(56) = "" & mytablex.Fields("categoria")
    DBGrid2.columns("producto") = "" & mytablex.Fields("producto")
    DBGrid2.columns(38) = "" '& mytablex.Fields("proveedor1")
    DBGrid2.columns(44) = ""
    DBGrid2.columns(14) = ""
    DBGrid2.columns(15) = ""
    DBGrid2.columns("ccosto") = Trim("" & mytablex.Fields("seccion"))
    DBGrid2.columns(16) = ""  '& mytablex.Fields("vendedor")

    ' 10/07/2018 Edicion Comanda
    '' 10/07/2018 Tamaño grande cabecera comanda
    'DBGrid2.columns("descripcio") = Trim("" & mytablex.Fields("descripcio"))
    'DBGrid2.columns("descripcio") = Trim("" & mytablex.Fields("descorto"))
    If busca_OpcionNombre = "DC" Then
        DBGrid2.columns("descripcio") = Trim("" & mytablex.Fields("Descorto"))
    ElseIf busca_OpcionNombre = "CO" Then
        DBGrid2.columns("descripcio") = Trim("" & mytablex.Fields("producto"))
    Else
        DBGrid2.columns("descripcio") = Trim("" & mytablex.Fields("descripcio"))

    End If

    '' 10/07/2018 Tamaño grande cabecera comanda
    ' 10/07/2018 Edicion Comanda

    'MsgBox xxca
    'DBGrid2.columns("cantidad") = Format(xxca, "0.000") 'Val(xxca) 'Val(Format(Val(xxca), "0.000")) 'cantidad

    DBGrid2.columns("cantidad") = Format(xxca, "0.000") 'Val(xxca) 'Val(Format(Val(xxca), "0.000")) 'cantidad

    'DBGrid2.Columns("descuento") = Val("" & mytablex.Fields("isc"))

    DBGrid2.columns(2) = "" & mytabley.Fields("unidad1")  'ojo se cambio por placa
    DBGrid2.columns(4) = Val("" & mytabley.Fields("factor1"))
    DBGrid2.columns("precio") = xpreciox
    DBGrid2.columns("total") = xpreciox

    If "" & mytable11.Fields("hdetraccio") <> "S" Then
        DBGrid2.columns(54) = 0

    End If

    DBGrid2.columns("subtotal") = xpreciox
    'DBGrid2.Columns("neto") = Val("" & mytablex.Fields("tax"))
    'DBGrid2.Columns(2) = "" & mytabley.Fields("unidad1")
    DBGrid2.columns("COMISION") = Val("" & mytablex.Fields("comision"))
    DBGrid2.columns(4) = Val("" & mytabley.Fields("factor1"))
    DBGrid2.columns("precio") = xpreciox
    DBGrid2.columns("total") = xpreciox
    DBGrid2.columns("subtotal") = xpreciox

    'DBGrid2.Columns("deslipo") = 0
    DBGrid2.columns("deslipo") = deslipox
    DBGrid2.columns(9) = 0
    DBGrid2.columns("isc") = Val("" & mytablex.Fields("isc"))
    DBGrid2.columns("impuesto") = 0

    DBGrid2.columns("igv") = Val("" & mytablex.Fields("igv"))

    '''' 17/07/2018 Factura de Exportación
    my_tipoigv = extra_loquesea(CboTipoIgv)

    If my_tipoigv = "40" Then
        DBGrid2.columns("igv") = 0

    End If

    '''' 17/07/2018 Factura de Exportación

    DBGrid2.columns(17) = "" & mytablex.Fields("linea")
    DBGrid2.columns("serviciopo") = Val("" & mytablex.Fields("serviciomesa"))

    DBGrid2.columns("descuento") = 0
    DBGrid2.columns("neto") = 0

    'If "" & mytablex.Fields("recetaprn") <> "S" Then
    '   dbgrid2.columns("dua") = "R"
    'End If

    'If xsw = 1 Then   'si es el precio que eligio grifos ojos..
    If xpreciox > 0 Then
        If "" & mytablex.Fields("fuel") = "S" And Val(xxca) > 1 And xsw <> 1 Then
            DBGrid2.columns("total") = Val(xxca)
            DBGrid2.columns("cantidad") = Val(xxca) / xpreciox

        End If

        If xsw = 1 Then
            DBGrid2.columns("total") = Val(xxca)
            DBGrid2.columns("cantidad") = Val(xxca) / xpreciox

        End If

    End If

    sdx = 0
    DBGrid2.columns("l1") = Trim("" & mytablex.Fields("percepcion"))

    carga_minimo "" & mytablex.Fields("producto")
    'End If
    mytables.Open "SELECT * FROM DUENO where  local='" & "" & mytable11.Fields("local") & "' and producto='" & "" & mytablex.Fields("producto") & "' ", cn, adOpenKeyset, adLockOptimistic

    If mytables.RecordCount > 0 Then  'si existe
        DBGrid2.columns(48) = Trim("" & mytables.Fields("codigo"))  'ojo si no es por local

    End If

    mytables.Close

    '---------pone a quien pertenece --------------------
    'DBGrid2.Columns(34) = "" & mytablex.Fields("c11")
    'DBGrid2.Columns(35) = "" & mytablex.Fields("c12")
    'DBGrid2.Columns(36) = "" & mytablex.Fields("c13")
    'DBGrid2.Columns(37) = "" & mytablex.Fields("c14")
    '-----------------------------
    'le pone las familias+subfamil+seccion+marca
    DBGrid2.columns(45) = "" & mytablex.Fields("Familia")
    DBGrid2.columns(46) = "" & mytablex.Fields("subFamilia")
    DBGrid2.columns(47) = "" & mytablex.Fields("marca")
    DBGrid2.columns("total") = Val(DBGrid2.columns("cantidad")) * Val(DBGrid2.columns("precio"))
    DBGrid2.columns("ivap") = Val("" & mytablex.Fields("ivap"))
    calcula_igv 0
    found = leer_visorcaja("" & DBGrid2.columns("descripcio"), dicmoneda & DBGrid2.columns("Total"))

End Sub

'' 15/12/2017 Redondeo impuesto
'
'Function sumar_detalle()
'On Error GoTo cmd35_err
'Dim found As Integer
'Dim sdx As Double
'Dim fila As Integer
'Dim xtotal As Double
'Dim xdescuento As Double
'Dim xneto As Double
'Dim ximpuesto As Double
'Dim xsubtotal As Double
'Dim xgravado As Double
'Dim xc1 As Double
'Dim xc2 As Double
'Dim xc3 As Double
'Dim xc4 As Double
'Dim xc5 As Double
'Dim xc6 As Double
'Dim xc7 As Double
'Dim xc8 As Double
'Dim xc9 As Double
'
'Dim difre As Double
'Dim sw As Integer
'Dim xredo As Double
'Dim sdx1 As Double
''Dim xacuenta As Double
'Dim vr
'Dim stx As Double
'Dim xntcant As Double
'Dim xfilax As Integer
'Dim xivap As Double
'Dim xisc As Double
'Dim xdetra As Double
'Dim xpeaje As Double
'Dim xpercepcion As Double
'Dim xserviciocobro As Double
'Dim xtxpercepcion As Double
'xpeaje = 0
'xserviciocobro = 0
'xdetra = 0
'xntcant = 0
'xredo = 0
'sdx1 = 0
'xc1 = 0
'xc2 = 0
'xc3 = 0
'xc4 = 0
'xc5 = 0
'xc6 = 0
'xc7 = 0
'xc8 = 0
'xc9 = 0
'xivap = 0
'xisc = 0
'xpercepcion = 0
'xredo = 0
'xgravado = 0
'xtotal = 0
'xdescuento = 0
'xneto = 0
'ximpuesto = 0
'xsubtotal = 0
'xtxpercepcion = 0
''MsgBox "abc"
''------------------------
''dbrecords = Data2.Recordset.RecordCount
''For fila = 0 To dbgrid2.visiblerows - 1
'
'sw = 1
'exisdev = 0
'
''''Ordena lista de productos despues de congelar
''If opcioncongela = "2" Then
''    dbgrid2.Col = 0
''    dbgrid2.Row = dbgrid2.VisibleRows - 1
''    dbgrid2.SetFocus
''    opcioncongela = "2"
''Else
''    ''25/10/2017 Agregar fecha en Excel de Excel Impresión total y seleccionado
''    found = ir_primero1()
''    ''25/10/2017 Agregar fecha en Excel de Excel Impresión total y seleccionado
''    If found = 0 Then
''       GoTo avex
''    End If
''End If
'''Ordena lista de productos despues de congelar
'
'found = ir_primero1()
'If found = 0 Then
'   GoTo avex
'End If
'
'
'
''MsgBox "abc"
'xpercepcion = selecciona_percepcion("" & codigo, "" & clasesunat)
''MsgBox "abc"
''Data2.Refresh
''Data2.Enabled = False
'Do
'If Data2.Recordset.EOF Then Exit Do
''MsgBox Val("" & Data2.Recordset.Fields("cantidad"))
'If Val("" & Data2.Recordset.Fields("cantidad")) < 0 Then
'   exisdev = -10
'End If
''MsgBox "abc"
'Data2.Recordset.Edit
'resuma_precios xpercepcion
''MsgBox "abcd"
'Data2.Recordset.Update
''MsgBox "abc"
'If Val("" & Data2.Recordset.Fields("igv")) = 0 Then
'   xgravado = xgravado + Val("" & Data2.Recordset.Fields("total"))
'End If
'xpeaje = xpeaje + Val("" & Data2.Recordset.Fields("xneto"))
'xserviciocobro = xserviciocobro + Val("" & Data2.Recordset.Fields("servicioco"))
'xdetra = xdetra + Val("" & Data2.Recordset.Fields("tdetra"))
'xisc = xisc + Val("" & Data2.Recordset.Fields("tisc"))
'xivap = xivap + Val("" & Data2.Recordset.Fields("tivap"))
'xntcant = xntcant + Val("" & Data2.Recordset.Fields("cantidad")) * Val("" & Data2.Recordset.Fields("factor")) 'suma bruto
'xtotal = xtotal + Val("" & Data2.Recordset.Fields("total"))
'xdescuento = xdescuento + Val("" & Data2.Recordset.Fields("descuento"))
'xneto = xneto + Val("" & Data2.Recordset.Fields("neto"))
'ximpuesto = ximpuesto + Val("" & Data2.Recordset.Fields("impuesto"))
'xsubtotal = xsubtotal + Val("" & Data2.Recordset.Fields("subtotal"))
'xtxpercepcion = xtxpercepcion + Val("" & Data2.Recordset.Fields("tpercepcio"))
'Data2.Recordset.MoveNext
'Loop
'avex:
''Data2.Enabled = True
''MsgBox "ABC"
'txpercepcion = Format(xtxpercepcion, nrodecimal)
'serviciocobro = redondeo1("" & xserviciocobro, nrodecimal)
'tpeaje = Format(xpeaje, nrodecimal)
'tdetra = Format(xdetra, nrodecimal)
'gravado = Format(xgravado, nrodecimal)
'ntcant = Format(xntcant, nrodecimal)
''MsgBox xtotal
''xtotal = xtotal + xtxpercepcion
'txtotal = Format(xtotal, nrodecimal)
'txtotlare = 0
'If "" & mytable11.Fields("redondeo") = "S" Then
''MsgBox "abcddd"
''MsgBox redondeo2(txtotal)
'   txtotlare = Val(redondeo2(txtotal, "" & nrodecimal)) - Val(txtotal)
'   'MsgBox "cdf"
'   txtotal = Val(redondeo2(txtotal, "" & nrodecimal))
'   'MsgBox txtotal
'End If
'tisc = Val(Format(xisc, nrodecimal))
'tivap = Val(Format(xivap, nrodecimal))
''MsgBox acuenta
'stx = Val(txtotal) ' - Val(acuenta)
'
'
''''19/08/2017  Venta Todo Dolares ventana principal de ventas
'    'rtxtotal = Format(stx, nrodecimal)
'
'If moneda = "S" Then
'rtxtotal = Format(stx, nrodecimal)
'
'End If
'
'
'If moneda = "D" Then
'stx = Val(txtotal) * paridad
'rtxtotal = Format(stx, nrodecimal)
'
'End If
'
'
''''19/08/2017  Venta Todo Dolares ventana principal de ventas
'
''MsgBox rtxtotal
''txtotal = Format(xtotal, nrodecimal)
'txdescuento = Format(xdescuento, nrodecimal)
'txneto = Format(xneto, nrodecimal)
''tximpuesto = Format(ximpuesto, "0.000")
''MsgBox ximpuesto
'tximpuesto = "" & Redondear1(ximpuesto, 2)  'redondeo3("" & ximpuesto, nrodecimal)
''MsgBox tximpuesto
'txsubtotal = Format(xsubtotal, nrodecimal)
''calculando en dolares
'If Val(paridad) = 0 Then
'   paridad = "1"
'End If
'
'
''''19/08/2017  Venta Todo Dolares ventana principal de ventas
'        sdx = Val(txtotal) / Val(paridad)
'        txtotald = Format(sdx, nrodecimal)
'
'        sdx = Val(rtxtotal) / Val(paridad)
'        rtxtotald = Format(sdx, nrodecimal)
'
''If moneda = "S" Then
''sdx = Val(txtotal) / Val(paridad)
''txtotald = Format(sdx, nrodecimal)
''
''sdx = Val(rtxtotal) / Val(paridad)
''rtxtotald = Format(sdx, nrodecimal)
''End If
''
''
''If moneda = "D" Then
''sdx = Val(txtotal) / Val(paridad)
''txtotald = Format(sdx, nrodecimal)
''
''sdx = Val(rtxtotal) / Val(paridad)
''rtxtotald = Format(sdx, nrodecimal)
''End If
'
'
'
''''19/08/2017  Venta Todo Dolares ventana principal de ventas
'
'
'
'
'c1 = Format(xc1, nrodecimal)
'c2 = Format(xc2, nrodecimal)
'c3 = Format(xc3, nrodecimal)
'c4 = Format(xc4, nrodecimal)
'c5 = Format(xc5, nrodecimal)
'c6 = Format(xc6, nrodecimal)
'c7 = Format(xc7, nrodecimal)
'c8 = Format(xc8, nrodecimal)
'c9 = Format(xc9, nrodecimal)
''ahora con el
'sumar_detalle = sw
'Exit Function
'cmd35_err:
'MsgBox "Error en sumar_detalle " & error$, 24, "Aviso"
'Exit Function
'End Function
        
Function sumar_detalle()

    On Error GoTo cmd35_err
 
    Dim found      As Integer

    Dim sdx        As Double

    Dim fila       As Integer

    Dim xtotal     As Double

    Dim xdescuento As Double

    Dim xneto      As Double

    Dim ximpuesto  As Double

    Dim xsubtotal  As Double

    Dim xgravado   As Double

    Dim xc1        As Double

    Dim xc2        As Double

    Dim xc3        As Double

    Dim xc4        As Double

    Dim xc5        As Double

    Dim xc6        As Double

    Dim xc7        As Double

    Dim xc8        As Double

    Dim xc9        As Double

    Dim difre      As Double

    Dim sw         As Integer

    Dim xredo      As Double

    Dim sdx1       As Double

    Dim vr

    Dim stx            As Double

    Dim xntcant        As Double

    Dim xfilax         As Integer

    Dim xivap          As Double

    Dim xisc           As Double

    Dim xdetra         As Double

    Dim xpeaje         As Double

    Dim xpercepcion    As Double

    Dim xserviciocobro As Double

    Dim xtxpercepcion  As Double

    xpeaje = 0
    xserviciocobro = 0
    xdetra = 0
    xntcant = 0
    xredo = 0
    sdx1 = 0
    xc1 = 0
    xc2 = 0
    xc3 = 0
    xc4 = 0
    xc5 = 0
    xc6 = 0
    xc7 = 0
    xc8 = 0
    xc9 = 0
    xivap = 0
    xisc = 0
    xpercepcion = 0
    xredo = 0
    xgravado = 0
    xtotal = 0
    xdescuento = 0
    xneto = 0
    ximpuesto = 0
    xsubtotal = 0
    xtxpercepcion = 0

    sw = 1
    exisdev = 0

    found = ir_primero1()

    If found = 0 Then
        GoTo avex

    End If

    xpercepcion = selecciona_percepcion("" & codigo, "" & clasesunat)
    Do

        If Data2.Recordset.EOF Then Exit Do
        If Val("" & Data2.Recordset.Fields("cantidad")) < 0 Then
            exisdev = -10

        End If

        Data2.Recordset.Edit
        resuma_precios xpercepcion
        Data2.Recordset.Update

        If Val("" & Data2.Recordset.Fields("igv")) = 0 Then
            xgravado = xgravado + Val("" & Data2.Recordset.Fields("total"))

        End If

        xpeaje = xpeaje + Val("" & Data2.Recordset.Fields("xneto"))
        xserviciocobro = xserviciocobro + Val("" & Data2.Recordset.Fields("servicioco"))
        xdetra = xdetra + Val("" & Data2.Recordset.Fields("tdetra"))
        xisc = xisc + Val("" & Data2.Recordset.Fields("tisc"))
        xivap = xivap + Val("" & Data2.Recordset.Fields("tivap"))
        xntcant = xntcant + Val("" & Data2.Recordset.Fields("cantidad")) * Val("" & Data2.Recordset.Fields("factor")) 'suma bruto
        xtotal = xtotal + Val("" & Data2.Recordset.Fields("total"))
        xdescuento = xdescuento + Val("" & Data2.Recordset.Fields("descuento"))
        xneto = xneto + Val("" & Data2.Recordset.Fields("neto"))
        'inicio 01/12/2017 pll
        'ximpuesto = ximpuesto + Val("" & Data2.Recordset.Fields("impuesto"))
        'xsubtotal = xsubtotal + Val("" & Data2.Recordset.Fields("subtotal"))
        ximpuesto = Round(ximpuesto + Val("" & Data2.Recordset.Fields("impuesto")), 2)

        '07/08/2018 Testing decimales 'se quito redondeo
        'xsubtotal = Round(xsubtotal + Val("" & Data2.Recordset.Fields("subtotal")), 2)
        xsubtotal = xsubtotal + Val("" & Data2.Recordset.Fields("subtotal"))

        '07/08/2018 Testing decimales 'se quito redondeo

        'fin 01/12/2017 pll
        xtxpercepcion = xtxpercepcion + Val("" & Data2.Recordset.Fields("tpercepcio"))
        Data2.Recordset.MoveNext
    Loop
avex:

    txpercepcion = Format(xtxpercepcion, "0.00000")
    serviciocobro = redondeo1("" & xserviciocobro, "0.00000")
    tpeaje = Format(xpeaje, "0.00000")
    tdetra = Format(xdetra, "0.00000")
    gravado = Format(xgravado, "0.00000")
    ntcant = Format(xntcant, nrodecimal)
    txtotal = Format(xtotal, nrodecimal)
    txtotlare = 0

    If "" & mytable11.Fields("redondeo") = "S" Then
        txtotlare = Val(redondeo2(txtotal, "" & nrodecimal)) - Val(txtotal)
        txtotal = Val(redondeo2(txtotal, "" & nrodecimal))

    End If

    'inicio 10/02/2018 pll
    'tisc = Val(Format(xisc, "0.00000"))
    'tivap = Val(Format(xivap, "0.00000"))
    tisc = Val(Format(xisc, nrodecimal))
    tivap = Val(Format(xivap, nrodecimal))
    'fin 10/02/2018 pll
    stx = Val(txtotal)

    '''19/08/2017  Venta Todo Dolares ventana principal de ventas
    If moneda = "S" Then
        rtxtotal = Format(stx, nrodecimal)

    End If
        
    If moneda = "D" Then
        stx = Val(txtotal) * paridad
        rtxtotal = Format(stx, nrodecimal)

    End If

    '''19/08/2017  Venta Todo Dolares ventana principal de ventas

    txdescuento = Format(xdescuento, "0.00000")
    txneto = Format(xneto, "0.00000")

    tximpuesto = "" & Format(ximpuesto, "0.00000")
    txsubtotal = Format(xsubtotal, "0.00000")

    If Val(paridad) = 0 Then
        paridad = "1"

    End If

    '''19/08/2017  Venta Todo Dolares ventana principal de ventas
    sdx = Val(txtotal) / Val(paridad)
    txtotald = Format(sdx, nrodecimal)
        
    sdx = Val(rtxtotal) / Val(paridad)
    rtxtotald = Format(sdx, nrodecimal)
    '''19/08/2017  Venta Todo Dolares ventana principal de ventas

    c1 = Format(xc1, nrodecimal)
    c2 = Format(xc2, nrodecimal)
    c3 = Format(xc3, nrodecimal)
    c4 = Format(xc4, nrodecimal)
    c5 = Format(xc5, nrodecimal)
    c6 = Format(xc6, nrodecimal)
    c7 = Format(xc7, nrodecimal)
    c8 = Format(xc8, nrodecimal)
    c9 = Format(xc9, nrodecimal)

    sumar_detalle = sw
    Exit Function
cmd35_err:
    MsgBox "Error en sumar_detalle " & error$, 24, "Aviso"
    Exit Function

End Function

'' 15/12/2017 Redondeo impuesto
        
Function ir_primero1()

    On Error GoTo cmd771222_err

    '
    Data2.refresh
    'Data2.Recordset.MoveLast
    ir_primero1 = 1
    Exit Function
cmd771222_err:
    'MsgBox "aviso en ir Primero " + error$, 48, "Aviso"
    Exit Function

End Function

Private Sub telefono_KeyUp(KeyCode As Integer, Shift As Integer)

    Dim found As Integer

    If KeyCode = &H70 Then  'f1
        found = consulta_cliente("")

    End If

End Sub

Private Sub Timer1_Timer()
    fechasis = Format(Now, "dd/mm/yyyy")
    horasis = Format(Now, "HH:MM:SS")

End Sub

Private Sub tmrcomm_Timer()

End Sub

Private Sub txtotal_Click()

    Dim found As Integer

    found = sumar_detalle()

End Sub

Sub borrar_todo()

    On Error GoTo cmd356_err

    'If MsgBox("Desea Borrar Todo", 1, "Aviso") <> 1 Then Exit Sub
    ir_primero
    Do

        If Data2.Recordset.EOF Then Exit Do
        Data2.Recordset.Delete
        Data2.refresh
    Loop
    inicialIzatodo

    DBGrid2.SetFocus
    Exit Sub
cmd356_err:
    MsgBox "Aviso en borrar_todo " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub inicialIzatodo()

    Dim found As Integer

    Dim sdx   As Double

    'xopcioness(21).Enabled = True
    xrepite = ""
    globalmesero = ""
    dphora.ListIndex = 0
    borra_controlpeso
    'acurabuffer.Caption = ""
    MonthView1.Visible = False
    Label9.Visible = False
    Label22.Visible = False
    horaentrega = Format(Now, "hh:mm:ss")
    clavecongela = ""
    correo = ""
    grtipo = ""
    grserie = ""
    grnumero = ""

    '27/08/2018 Producto delivery automatico
    fechasis.Enabled = True
    '27/08/2018 Producto delivery automatico

    ydireccion = ""
    Label12 = ""
    axctipo = ""
    axclocal = ""
    axcnumero = ""
    axcserie = ""
    axctotal = ""
    ot = ""
    destopo = 0
    InBuff = ""
    fechae = "" & Format(Now, "dd/mm/yyyy")
    'ot.BackColor = &HE0E0E0
    'xopcioness(17).Caption = "Servicio"
    txpercepcion = ""
    serviciocobro = ""
    clasesunat.ListIndex = 0
    found = leer_visorcaja("SISTEMA CALIPSO", "CASH REGISTER")
    limite_credito = ""
    felizc = ""
    stkminimo = ""
    octipo = ""
    ocserie = ""
    ocnumero = ""
    clasificacion = ""
    icerrar_puertosmscomm
    cerrar_puertosmscomm
    'fotoimagen = LoadPicture()
    totpedido = ""
    'Label59.Caption = "NORMAL"
    cuenta_separa = ""
    salon.Caption = ""
    mesa.Caption = ""
    mesero = ""
    comanda = ""
    cuenta_separa = ""
    consulta_comanda "" & mytable11.Fields("salon")

    DBGrid2.Enabled = True
    Command13.Enabled = True
    ndetraccion = ""
    flage = ""
    sentido.Enabled = False
    sentido = ""
    'If "" & mytable11.Fields("sentido") = "C" Then
    '   sentido = ""
    '   sentido.Enabled = True
    '   Else
    '   sentido = "" & mytable11.Fields("sentido")
    'End If
    vHabitacion = ""
    hknumero = ""
    tpeaje = ""
    tdetra = ""
    rrlocal11 = ""
    rrtipo = ""
    rrserie = ""
    rrnumero = ""
    trdescuento = ""
    saldo = ""
    tcampo6 = ""
    crucefa.Clear
    saldoabo = ""
    valordescuento = 0
    tipodescuento = ""
    tivap = 0
    tisc = 0
    local1 = ""
    acuenta = ""
    petipo = ""
    peserie = ""
    penumero = ""

    '16/06/2017 kenyo NOTA DE CREDITO
    nctipo = ""
    ncserie = ""
    ncnumero = ""
    '16/06/2017 kenyo NOTA DE CREDITO

    ''''21/09/2017 kenyo Mejora  cobranza de mesas
    Picture2.Visible = False
    ''''21/09/2017 kenyo Mejora  cobranza de mesas

    '28/08/2018 impresión de copia de delivery
    ' 25/07/2018 Delivery y Para Llevar desde mozo
    '24/08/2018  Delivery por mesa
    V_EstadoMesa = "C"
    ' 25/07/2018 Delivery y Para Llevar desde mozo
    '24/08/2018  Delivery por mesa
    '28/08/2018 impresión de copia de delivery

    txtotald = nrodecimal
    txtotal = nrodecimal
    rtxtotald = ""
    rtxtotal = ""
    cprotipo = ""
    cproven = ""
    cprocod = ""
    pedido = ""
    protipo = ""
    proserie = ""
    pronumero = ""
    'local1.Visible = False
    c1 = ""
    c2 = ""
    c3 = ""
    c4 = ""
    c5 = ""
    c6 = ""
    c7 = ""
    c8 = ""
    c9 = ""

    tcampo1 = ""
    tcampo2 = ""
    tcampo3 = ""
    tcampo4 = ""
    tcampo5 = ""
    tcampo6 = ""
    xtipo = ""
    xnumero = ""
    xserie = ""
    xvendedor = ""
    xruc = ""
    xnombre = ""
    xdireccion = ""
    xdistrito = ""
    nvendedorx = ""
    ntipox = ""
    gravado = ""
    'dotipo = ""
    '   doserie = ""
    '   donumero = ""
    '   dototal = ""
    '   dofpago = ""
    '   dofecha = ""
    clasificacion = ""
    xestado = ""
    'monto = ""
    xruc = ""
    dcodigo = ""
    telefono = ""
    dnombre = ""
    ddireccion = ""
    referencia = ""
    fechanac = ""
    xnumero = ""
    codigo = ""
    nombre = ""
    tiposervicio1 = "Autoservicio"
    flag_servicio = "A"
    'tiposervicio = "Autoservicio"
    borrar_campos
    'sdx = Val("" & mytable11.Fields("numero")) + 1
    'xnumero = "" & sdx
    ntcant = ""
    txtotlare = 0

    txtotal = nrodecimal
    txdescuento = ""
    txneto = ""
    tximpuesto = ""
    txsubtotal = ""
    txtotald = nrodecimal
    'txtotals = nrodecimal
    'CAMPO1 = ""
    'CAMPO2 = ""
    'campo3 = ""

    '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017
    If Frame5.Visible = True Then
        DBGrid4_KeyDown 27, 0

    End If

    '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017

    '' 13/01/2018 Fecha de registro y cambio de congelados
    fechaicongela = Format(Now, "dd/mm/yyyy")
    '' 13/01/2018 Fecha de registro y cambio de congelados

    '''' 17/07/2018 Factura de Exportación
    inicia_TipoOperacion
    inicia_TipoIgv
    '''' 17/07/2018 Factura de Exportación

    '12/06/2017 kenyo selecciona vendedor
    vendedor.Caption = "VEND."
    '12/06/2017 kenyo selecciona vendedor
                
    cargar_tmcombina
    sql_detalle
    found = sumar_detalle()
    'uvueltos = "S/.:" & Format(Val("" & mytable11.Fields("uvueltos")), nrodecimal)
    'uvueltod = "US$:" & Format(Val("" & mytable11.Fields("uvueltod")), nrodecimal)

    'uvueltos = "" & mytable11.Fields("uvueltos")
    'uvueltod = "" & mytable11.Fields("uvueltod")
    DBGrid2.Enabled = True
    DBGrid2.SetFocus

End Sub

Function cargar_tmcombina()

    borratmpcombina
    cn.Execute ("select * into _c" & gusuario & " from combina ")
    cn.Execute ("delete from  " & "_c" & gusuario)

End Function

Sub borratmpcombina()

    On Error GoTo cmdn78_err

    cn.Execute ("drop table _c" & gusuario)
    Exit Sub
cmdn78_err:
    Exit Sub

End Sub

Sub borrar_campos()

    On Error GoTo cmd212_err

inicio1:
    Data2.Recordset.MoveFirst
    Data2.Recordset.Delete
    GoTo inicio1
    Exit Sub
    borra_controlpeso
cmd212_err:
    Exit Sub

End Sub

Sub proceso_impresion11(bxtipo As String, _
                        bxserie As String, _
                        bxnumero As String, _
                        sw As Integer, _
                        ascopia As String)

    ''IMPRESION- IMPRESORA
    Dim found    As Integer

    Dim archivot As String

    On Error GoTo cmd6_err:

    cerrar_archivo

    If sw = 0 Then   'si es posible
        If Trim("" & mytable11.Fields("gavetasw")) <> "N" Then
            found = abre_puerto("" & mytable11.Fields("capuerto"), Val("" & mytable11.Fields("catipo")), "" & mytable11.Fields("gavetacola"))

        End If

    End If
    
    'verificamos si es puerto LPT para no hacer formato impresion
    found = control_impresion(bxtipo, bxserie, bxnumero, 10)

    If found = 10 Then
        Exit Sub

    End If

    'MsgBox sw
    
    factura_formatox "" & mytable11.Fields("local"), "" & bxtipo, "" & bxserie, "" & bxnumero, ascopia, sw
    'msgbox gusuario
    cerrar_archivo
    FileName = globaldir & "\temporal\" & gusuario & ".txt"
    'MsgBox sw
    found = control_impresion(bxtipo, bxserie, bxnumero, sw)
    
    'genver.File = globaldir & "\temporal\" & gusuario & ".txt"
    'genver.Show 1
    Exit Sub
cmd6_err:
    MsgBox "Mensaje, Error al iniciar Impresion " & error$, 48, "Aviso"
    Exit Sub

End Sub

Function formateab(buf As String, _
                   longitud As Integer, _
                   sw As Integer, _
                   sw1 As Integer) As String

    Dim xbuf As String

    Dim buf1 As String

    Dim sdx  As Integer

    On Error GoTo cmd203_err

    'Open filename For Append As #1
    buf1 = buf
    sdx = longitud - Len(buf)

    If sdx > 0 Then
        If sw1 = 0 Then
            buf1 = buf & Space$(sdx)

        End If

        If sw1 = 1 Then
            buf1 = Space$(sdx) & buf

        End If

    End If

    formateab = Mid$(buf1, 1, longitud)
    Exit Function
cmd203_err:
    MsgBox "Mensaje, Error en formateab " & error$
    Exit Function

End Function

Function imprime_adifac(batipo As String, _
                        baserie As String, _
                        banumero As String, _
                        sw As Integer, _
                        xxpuerto As String)

    Dim mytablex  As New ADODB.Recordset

    Dim found     As Integer

    Dim buf       As String

    Dim X         As Double

    Dim sFile     As String

    Dim cfilename As String

    On Error GoTo cmd67112_err

    Dim xmcanal

    Exit Function
    '---------------------------------
    mytablex.Open "SELECT * FROM " & godetalle & " where  local='" & "" & mytable11.Fields("local") & "' and tipo='" & batipo & "' and serie='" & baserie & "' and numero='" & banumero & "'", cn, adOpenKeyset, adLockOptimistic

    If mytablex.RecordCount = 0 Then  'si existe
        mytablex.Close
        Exit Function

    End If

    xmcanal = FreeFile
    X = 0
    Open globaldir & "\temporal\" & gusuario & "TX" For Output As #xmcanal
    Print #xmcanal, "      DOCUMENTO (" + batipo + " " + banumero & ")"
    Print #xmcanal, "-------------------------------"
    Print #xmcanal, "NOMBREPRODUCTO       CANTIDAD "
   
    Do

        If mytablex.EOF Then Exit Do
        buf = formateab(Mid$("" & mytablex.Fields("descripcio"), 1, 25), 25, 0, 0)
        buf = buf & formateab(Mid$("" & mytablex.Fields("cantidad"), 1, 25), 7, 2, 0)
        X = X + Val("" & mytablex.Fields("cantidad"))
        Print #xmcanal, buf
        mytablex.MoveNext
    Loop
   
    mytablex.Close
    Print #xmcanal, "-------------------------------"
    Print #xmcanal, "Unidades       :" + Format(X, "000")
    Close #xmcanal
    sFile = globaldir & "\temporal\" & gusuario & "tx"

    If sw = 0 Then  'cola
        found = Imprime_archivojj(sFile, 0, "" & mytable11.Fields("tamanoletra"), "" & mytable11.Fields("nombrefont"), "" & mytable11.Fields("BOLD"), "" & mytable11.Fields("letrainterna"))

    End If

    If sw = 1 Then  'impresion directa
        FileName = sFile
        found = star_sp342(xxpuerto, 0)
        found = corte_papel(xxpuerto, 0)

    End If

    Exit Function
cmd67112_err:
    MsgBox "Aviso en imprime adicional " + error$, 48, "Aviso"
    Close #xmcanal
    Exit Function

End Function

Function orden_despacho_n(bxlocal As String, _
                          bxtipo As String, _
                          bxserie As String, _
                          bxnumero As String, _
                          buf1 As String, _
                          nroimp As Integer)

    Dim xdato    As String

    Dim buf      As String

    Dim bufx     As String

    Dim Puerto   As String

    Dim puertos  As String

    Dim puertod  As String

    Dim found    As Integer

    Dim mytablef As New ADODB.Recordset

    Dim i        As Integer

    Dim j        As Integer

    Dim X        As Integer

    Dim xbuf0    As String

    Dim xbuf1    As String

    Dim xbuf2    As String

    Dim sw       As Integer

    Dim cola     As String

    Dim oldprinter

    'Dim mydbf As Database
    'On Error GoTo cmd78901_err '' leito
    'impresora por default atachado
    'If MsgBox("Desea Imprimir Orden Despacho ", 1, "Aviso") <> 1 Then Exit Function
    List1.Clear
    suma1 = 0
    Puerto = ""
    puertod = ""
    puertos = "OD" '& mytable11.Fields("odpuerto")
    Puerto = puertos
    cerrar_archivo
    'MsgBox godetalle
    FileName = caja & Puerto
    found = borra_nombre(FileName)
    'ojo es la orden de despacho
    'MsgBox "...Presione enter para continuar la orden Despacho " & bxtipo & " " & bxnumero, 48, "Aviso"
    
    mytablef.Open "SELECT * FROM " & godetalle & " where  local='" & bxlocal & "' and tipo='" & bxtipo & "' and serie='" & bxserie & "' and numero='" & bxnumero & "'", cn, adOpenKeyset, adLockOptimistic

    If mytablef.RecordCount = 0 Then  'si existe
        mytablef.Close
        Exit Function

    End If
   
    '-----------ORDEN DE DESPACHO---------------------------------------------
    List1.Clear
    '---OJO VERIFICAR ESTO------------------
    ncanal = FreeFile
    Do

        If mytablef.EOF Then Exit Do
        If "" & mytablef.Fields("dua") = "R" Then GoTo ksiguiente111

        'MsgBox "" & mytablef.Fields("producto")
        If Len("" & mytablef.Fields("producto")) > 0 And (Val("" & mytablef.Fields("cantidad")) > 0 Or Val("" & mytablef.Fields("cantidad")) < 0) Then
            found = busca_familia_orden("" & mytablef.Fields("producto"), Puerto, puertod, cola, nroimp)

            'MsgBox puerto & " " & puertod & " " & cola
            If found = 0 Then   'si no existe debe tomar el defaul de la impresora
                Puerto = puertos

            End If

            'MsgBox puerto
            If Len(Puerto) = 0 Then
                Puerto = "LPT"

            End If

            'MsgBox found
            '--------------------------------------
            sw = 0
            FileName = Trim(caja & Puerto)
            found = existearchivo("" & FileName)

            If found = 1 Then  'verificar si no existe en la lista
                sw = 0

                For i = 0 To List1.ListCount - 1
                    j = InStr(List1.List(i), "|")
                    xbuf0 = Mid$(List1.List(i), 1, j - 1)

                    If xbuf0 = FileName Then
                        sw = 1

                    End If

                Next i

                If sw = 0 Then  'no existe en la lista
                    found = borra_nombre(FileName)
                    found = 0

                End If

            End If

            cerrar_archivo
            Open FileName For Append As #ncanal

            'MsgBox found
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            If V_EstadoMesa <> "D" Then
                If found = 0 Then
                    List1.AddItem FileName & "|" & puertod & "|" & cola & "|" 'adiciona en la lista
                    cabecera_orden_despacho "" & mytablef.Fields("vendedor"), buf1, bxnumero, "" & xnombre

                End If

            End If

            ' 25/07/2018 Delivery y Para Llevar desde mozo
            If V_EstadoMesa <> "D" Then
                imprime_detalle_orden1 mytablef

            End If

            ' 25/07/2018 Delivery y Para Llevar desde mozo
            Close #ncanal

        End If

ksiguiente111:
        mytablef.MoveNext
    Loop
    cerrar_archivo

    '-------------se adiciono para agilidad--------------------------------
    For i = 0 To List1.ListCount - 1
        'j = InStr(list1.List(i), "|")
        xdato = List1.List(i)
        'MsgBox xdato
        extrae_puertos xdato, xbuf0, xbuf1, xbuf2
        'xbuf0 = Mid$(list1.List(i), 1, j - 1)
        'xbuf1 = Mid$(list1.List(i), j + 1, Len(list1.List(i)) - (j))
        'xbuf2 = Mid$(list1.List(i), j + 1, Len(list1.List(i)) - (j))
        FileName = xbuf0

        If existearchivo(xbuf0) = 1 Then
            ncanal = FreeFile
            Open FileName For Append As #ncanal

            For X = 1 To 5
                Print #ncanal, ""
            Next X

            Print #ncanal, ""
            Close #ncanal

        End If

    Next i

    'MsgBox List1.ListCount
    For i = 0 To List1.ListCount - 1
        xdato = List1.List(i)
        'MsgBox xdato
        extrae_puertos xdato, xbuf0, xbuf1, xbuf2
        FileName = xbuf0

        'MsgBox xdato & " " & xbuf0 & " " & xbuf1 & " " & xbuf2
        If existearchivo(xbuf0) = 1 Then
            If xbuf2 = "S" Then
                'MsgBox xbuf1
                oldprinter = Printer.DeviceName
                selecciona_impresoras (Trim(xbuf1))
                'delivery 09/08/2017
                found = Imprime_archivojj(xbuf0, 0, "" & mytable11.Fields("tamanorden"), "" & mytable11.Fields("nombrefont"), "" & mytable11.Fields("BOLD"), "" & mytable11.Fields("letrainterna"))
                selecciona_impresoras (Trim(oldprinter))
                'found = orden_oprn(xbuf1, "" & mytable11.Fields("tipoleta"), "" & mytable11.Fields("tamano"), "" & mytable11.Fields("negrita"))
            Else
      
                ncanal = FreeFile
                Open FileName For Append As #ncanal

                For X = 1 To 2
                    Print #ncanal, ""
                Next X

                Print #ncanal, ""
                Close #ncanal
      
                ' ' 03/08/2018 Solucion Error Borrar Comanda
                'found = star_sp342(Trim(xbuf1), 0)
                'found = corte_papel(Trim(xbuf1), 1)
                If Trim((xbuf1)) <> "%" Then
                    found = star_sp342(Trim(xbuf1), 0)
                    found = corte_papel(Trim(xbuf1), 1)

                End If

                ' ' 03/08/2018 Solucion Error Borrar Comanda
      
                'found = star_sp342(xxpuerto, 0)
                'found = star_sp342(xbuf1, ticketera_cajon)
            End If

            cerrar_archivo
            found = borra_nombre(xbuf0)

        End If

    Next i

    cerrar_archivo
    mytablef.Close
    Exit Function

    '' leito
    ''Exit Function
    ''cmd78901_err:
    ''   MsgBox "MENSAJE, ERROR EN ORDEN DESPACHO " & error$, 24, "AVISO"
    ''   Exit Function
End Function

Function imprime_adicional(batipo As String, _
                           baserie As String, _
                           banumero As String, _
                           sw As Integer, _
                           xxpuerto As String)

    Dim mytablex      As New ADODB.Recordset

    Dim ax1cambio     As String

    Dim ax1telefono   As String

    Dim ax1nombre     As String

    Dim ax1direccio   As String

    Dim ax1referencia As String

    Dim ax1pago       As String

    Dim ax1total      As String

    Dim ax1vuelto     As String

    Dim found         As Integer

    Dim cfilename     As String

    Dim sFile         As String

    Dim i             As Integer

    Dim buf           As String

    Dim ax1codigo     As String

    On Error GoTo cmd6711_err

    Dim xmcanal

    ax1codigo = ""
    ax1cambio = ""
    ax1telefono = ""
    ax1nombre = ""
    ax1direccio = ""
    ax1referencia = ""
    ax1pago = ""
    ax1total = ""
    ax1vuelto = ""
    ax1cambio = "2.78"

    If V_EstadoMesa = "D" Then
        codigo = busca_CLienteXMesa("" & cmytablex.Fields("salon"), extra_loquesea(cmytablex.Fields(1)))

    End If

    'MsgBox codigo
    '---------------------------------
    mytablex.Open "SELECT * FROM deliveri where  codigo='" & codigo & "'", cn, adOpenKeyset, adLockOptimistic

    If mytablex.RecordCount = 0 Then  'si existe
        mytablex.Close
        Exit Function

    End If

    ax1telefono = "" & mytablex.Fields("telefono")
    ax1nombre = "" & mytablex.Fields("nombre")
      
    ax1direccio = "" & mytablex.Fields("direccion")
    ax1referencia = "" & mytablex.Fields("referencia")
    ax1codigo = "" & mytablex.Fields("codigo")
    mytablex.Close

    xmcanal = FreeFile
    Open globaldir & "\temporal\" & gusuario & "TX" For Output As #xmcanal
    Print #xmcanal, "              DELIVERY              "
    Print #xmcanal, "===================================="
    Print #xmcanal, "Fecha:" + Format(Now, "dd/mm/yyyy")
    Print #xmcanal, "Hora :" + Format(Now, "HH:MM:SS")
    Print #xmcanal, "Telef:" + ax1telefono
    Print #xmcanal, "Clien:" + ax1nombre
    Print #xmcanal, "Direc:" + ax1direccio
    Print #xmcanal, "Refer:" + ax1referencia
    Print #xmcanal, "------------------------------------"
    Print #xmcanal, "T/C  :" + ax1cambio
    buf = imprime_tipodoc("" & batipo)
    Print #xmcanal, "T.Doc:" + buf
    Print #xmcanal, "Numer:" + baserie + " " + banumero
    buf = imprime_clasifica_cliente(ax1codigo)
    found = formateaa(buf, 30, 2, 0)

    mytablex.Open "SELECT * FROM " & gofpago & " where  local='" & "" & mytable11.Fields("local") & "' and tipo='" & batipo & "' and serie='" & baserie & "' and numero='" & banumero & "'", cn, adOpenKeyset, adLockOptimistic

    If mytablex.RecordCount = 0 Then  'si existe
        mytablex.Close
        Exit Function

    End If

    Do

        If mytablex.EOF Then Exit Do
        Print #xmcanal, "pago :" + mytablex.Fields("descripcio")
        Print #xmcanal, "Total:" + Format(Val("" & mytablex.Fields("recibe")), "0.00")
        Print #xmcanal, "Vuelt:" + Format(Val("" & mytablex.Fields("saldos")), "0.00")
        Print #xmcanal, "------------------------------------"
        mytablex.MoveNext
    Loop
   
    mytablex.Close

    'tipo de documento
    mytablex.Open "select * from " & godetalle & " where local='" & "" & mytable11.Fields("local") & "' and tipo='" & "" & batipo & "' and serie='" & "" & baserie & "' and numero='" & "" & banumero & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        buf = "" & mytablex.Fields("tipo")

    End If

    mytablex.Close
    '------------ PRODUCTOS
    mytablex.Open "select * from " & godetalle & " where local='" & "" & mytable11.Fields("local") & "' and tipo='" & "" & batipo & "' and serie='" & "" & baserie & "' and numero='" & "" & banumero & "' ", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        Do

            If mytablex.EOF Then Exit Do
            If "" & mytablex.Fields("dua") <> "R" Then
                buf = "" & mytablex.Fields("cantidad")
                found = formateaa(buf, 6, 0, 0)
                found = formateaa("", 1, 0, 0)
          
                ' 10/07/2018 Edicion Comanda
                'If formatocomanda = "G" Then
                buf = "*" & Mid$("" & mytablex.Fields("DESCRIPCIO"), 1, 37)
                found = formateaa(buf, 31, 2, 0)

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 30 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 31, 37)
                    found = formateaa(buf, 37, 2, 0)

                End If

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 67 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 68, 37)
                    found = formateaa(buf, 37, 2, 0)

                End If

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 104 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 105, 37)
                    found = formateaa(buf, 37, 2, 0)

                End If

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 120 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 121, 37)
                    found = formateaa(buf, 37, 2, 0)

                End If

                'End If
                                    
                'If formatocomanda = "D" Then
                '    buf = Mid$("" & mytablex.Fields("descripcio"), 1, 22)
                '    found = formateaa(buf, 22, 2, 0)
                '
                '     If Len(Mid$("" & mytablex.Fields("descripcio"), 23, 22)) > 0 Then
                '        buf = Mid$("" & mytablex.Fields("descripcio"), 23, 22)
                '        found = formateaa(buf, 22, 2, 0)
                '    End If
                '
                '     If Len(Mid$("" & mytablex.Fields("descripcio"), 45, 22)) > 0 Then
                '        buf = Mid$("" & mytablex.Fields("descripcio"), 45, 22)
                '        found = formateaa(buf, 22, 2, 0)
                '    End If
                '
                '     If Len(Mid$("" & mytablex.Fields("descripcio"), 68, 22)) > 0 Then
                '         buf = Mid$("" & mytablex.Fields("descripcio"), 68, 22)
                '        found = formateaa(buf, 22, 2, 0)
                '    End If
                'End If
                ' 10/07/2018 Edicion Comanda
                
                '----------------------
                If Len("" & mytablex.Fields("observa1")) > 0 Then
                    buf = "*" & mytablex.Fields("observa1")
                    found = formateaa(buf, 28, 2, 0)
  
                End If

                If Len("" & mytablex.Fields("observa2")) > 0 Then
                    buf = "*" & mytablex.Fields("observa2")
                    found = formateaa(buf, 28, 2, 0)

                End If

                If Len("" & mytablex.Fields("observa3")) > 0 Then
                    buf = "*" & mytablex.Fields("observa3")
                    found = formateaa(buf, 28, 2, 0)

                End If
    
                '----------------------
            End If

            mytablex.MoveNext
        Loop

    End If

    mytablex.Close

    For i = 1 To 7
        Print #xmcanal, ""
    Next i

    Close #xmcanal
    sFile = globaldir & "\temporal\" & gusuario & "TX"

    If sw = 0 Then
        found = Imprime_archivojj(sFile, 0, "" & mytable11.Fields("tamanoletra"), "" & mytable11.Fields("nombrefont"), "" & mytable11.Fields("BOLD"), "" & mytable11.Fields("letrainterna"))

    End If

    If sw = 1 Then
        FileName = sFile
        found = star_sp342(xxpuerto, 0)
        found = corte_papel(xxpuerto, Val("" & mytable11.Fields("catipo")))

    End If

    Exit Function
cmd6711_err:
    MsgBox "Aviso en imprime adicional " + error$, 48, "Aviso"
    Close #xmcanal
    Exit Function

End Function

'24/08/2018  Delivery por mesa
Function imprime_adicionalXMesa(batipo As String, _
                                baserie As String, _
                                banumero As String, _
                                sw As Integer, _
                                xxpuerto As String)

    Dim mytablex      As New ADODB.Recordset

    Dim ax1cambio     As String

    Dim ax1telefono   As String

    Dim ax1nombre     As String

    Dim ax1direccio   As String

    Dim ax1referencia As String

    Dim ax1pago       As String

    Dim ax1total      As String

    Dim ax1vuelto     As String

    Dim found         As Integer

    Dim cfilename     As String

    Dim sFile         As String

    Dim i             As Integer

    Dim buf           As String

    Dim ax1codigo     As String

    On Error GoTo cmd6711_err

    Dim xmcanal

    ax1codigo = ""
    ax1cambio = ""
    ax1telefono = ""
    ax1nombre = ""
    ax1direccio = ""
    ax1referencia = ""
    ax1pago = ""
    ax1total = ""
    ax1vuelto = ""
    ax1cambio = "2.78"

    ' If V_EstadoMesa = "D" Then
    '    codigo = busca_CLienteXMesa("" & cmytablex.Fields("salon"), extra_loquesea(cmytablex.Fields(1)))
    'End If

    mytablex.Open "SELECT * FROM mesa where salon='" & cmytablex.Fields("salon") & "' and mesa='" & extra_loquesea(cmytablex.Fields(1)) & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then  'si existe
        mytablex.Close
        Exit Function

    End If

    ax1telefono = "" & mytablex.Fields("telefono")
    ax1nombre = "" & mytablex.Fields("dnombre")
      
    ax1direccio = "" & mytablex.Fields("ddireccion")
    ax1referencia = "" & mytablex.Fields("referencia")
    ax1codigo = "" & mytablex.Fields("codigo")
    mytablex.Close

    xmcanal = FreeFile
    Open globaldir & "\temporal\" & gusuario & "TX" For Output As #xmcanal
    Print #xmcanal, "              DELIVERY              "
    Print #xmcanal, "===================================="
    Print #xmcanal, "Fecha:" + Format(Now, "dd/mm/yyyy")
    Print #xmcanal, "Hora :" + Format(Now, "HH:MM:SS")
    Print #xmcanal, "Telef:" + ax1telefono
    Print #xmcanal, "Clien:" + ax1nombre
    Print #xmcanal, "Direc:" + ax1direccio
    Print #xmcanal, "Refer:" + ax1referencia
    Print #xmcanal, "------------------------------------"
    Print #xmcanal, "T/C  :" + ax1cambio
    buf = imprime_tipodoc("" & batipo)
    Print #xmcanal, "T.Doc:" + buf
    Print #xmcanal, "Numer:" + baserie + " " + banumero
    buf = imprime_clasifica_cliente(ax1codigo)
    found = formateaa(buf, 30, 2, 0)

    mytablex.Open "SELECT * FROM " & gofpago & " where  local='" & "" & mytable11.Fields("local") & "' and tipo='" & batipo & "' and serie='" & baserie & "' and numero='" & banumero & "'", cn, adOpenKeyset, adLockOptimistic

    If mytablex.RecordCount = 0 Then  'si existe
        mytablex.Close
        Exit Function

    End If

    Do

        If mytablex.EOF Then Exit Do
        Print #xmcanal, "pago :" + mytablex.Fields("descripcio")
        Print #xmcanal, "Total:" + Format(Val("" & mytablex.Fields("recibe")), "0.00")
        Print #xmcanal, "Vuelt:" + Format(Val("" & mytablex.Fields("saldos")), "0.00")
        Print #xmcanal, "------------------------------------"
        mytablex.MoveNext
    Loop
   
    mytablex.Close

    'tipo de documento
    mytablex.Open "select * from " & godetalle & " where local='" & "" & mytable11.Fields("local") & "' and tipo='" & "" & batipo & "' and serie='" & "" & baserie & "' and numero='" & "" & banumero & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        buf = "" & mytablex.Fields("tipo")

    End If

    mytablex.Close
    '------------ PRODUCTOS
    mytablex.Open "select * from " & godetalle & " where local='" & "" & mytable11.Fields("local") & "' and tipo='" & "" & batipo & "' and serie='" & "" & baserie & "' and numero='" & "" & banumero & "' ", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        Do

            If mytablex.EOF Then Exit Do
            If "" & mytablex.Fields("dua") <> "R" Then
                buf = "" & mytablex.Fields("cantidad")
                found = formateaa(buf, 6, 0, 0)
                found = formateaa("", 1, 0, 0)

                buf = "*" & Mid$("" & mytablex.Fields("DESCRIPCIO"), 1, 37)
                found = formateaa(buf, 31, 2, 0)

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 30 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 31, 37)
                    found = formateaa(buf, 37, 2, 0)

                End If

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 67 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 68, 37)
                    found = formateaa(buf, 37, 2, 0)

                End If

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 104 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 105, 37)
                    found = formateaa(buf, 37, 2, 0)

                End If

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 120 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 121, 37)
                    found = formateaa(buf, 37, 2, 0)

                End If

                '----------------------
                If Len("" & mytablex.Fields("observa1")) > 0 Then
                    buf = "*" & mytablex.Fields("observa1")
                    found = formateaa(buf, 28, 2, 0)
  
                End If

                If Len("" & mytablex.Fields("observa2")) > 0 Then
                    buf = "*" & mytablex.Fields("observa2")
                    found = formateaa(buf, 28, 2, 0)

                End If

                If Len("" & mytablex.Fields("observa3")) > 0 Then
                    buf = "*" & mytablex.Fields("observa3")
                    found = formateaa(buf, 28, 2, 0)

                End If
    
                '----------------------
            End If

            mytablex.MoveNext
        Loop

    End If

    mytablex.Close

    For i = 1 To 7
        Print #xmcanal, ""
    Next i

    Close #xmcanal
    sFile = globaldir & "\temporal\" & gusuario & "TX"

    If sw = 0 Then
        found = Imprime_archivojj(sFile, 0, "" & mytable11.Fields("tamanoletra"), "" & mytable11.Fields("nombrefont"), "" & mytable11.Fields("BOLD"), "" & mytable11.Fields("letrainterna"))

    End If

    If sw = 1 Then
        FileName = sFile
        found = star_sp342(xxpuerto, 0)
        found = corte_papel(xxpuerto, Val("" & mytable11.Fields("catipo")))

    End If

    Exit Function
cmd6711_err:
    MsgBox "Aviso en imprime adicional " + error$, 48, "Aviso"
    Close #xmcanal
    Exit Function

End Function

'24/08/2018  Delivery por mesa

Function control_impresion(bxtipo As String, _
                           bxserie As String, _
                           bxnumero As String, _
                           psw As Integer)

    Dim found      As Integer

    Dim sFile      As String

    Dim mytablex   As New ADODB.Recordset

    Dim sw         As String

    Dim xcolax     As String

    Dim xxpuerto   As String

    Dim oldprinter As String

    On Error GoTo cmd67111_err

    sw = ""
    xcolax = ""
    xxpuerto = "X_"

    'MsgBox bxtipo
    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM tipo where  tipo='" & bxtipo & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe

        'MsgBox "" & mytablex.Fields("tipodoc")
        Select Case "" & mytablex.Fields("tipodoc")

            Case "A"
                xxpuerto = "" & mytable11.Fields("puertobm")
                sw = "" & mytable11.Fields("ibm")
                xcolax = "" & mytable11.Fields("cbm")

            Case "B"
                xxpuerto = "" & mytable11.Fields("puertofm")
                sw = "" & mytable11.Fields("ifm")
                xcolax = "" & mytable11.Fields("cfm")

            Case "C"
                xxpuerto = "" & mytable11.Fields("puertotb")
                sw = "" & mytable11.Fields("itb")
                xcolax = "" & mytable11.Fields("ctb")

            Case "D"
                xxpuerto = "" & mytable11.Fields("puertotf")
                sw = "" & mytable11.Fields("itf")
                xcolax = "" & mytable11.Fields("ctf")

            Case "G"
                xxpuerto = "" & mytable11.Fields("puertonv")
                sw = "" & mytable11.Fields("inv")
                xcolax = "" & mytable11.Fields("cnv")

            Case "H"
                xxpuerto = "" & mytable11.Fields("puertope")
                sw = "" & mytable11.Fields("ipe")
                xcolax = "" & mytable11.Fields("cpe")

            Case "I"
                'MsgBox "HOLA"
                'xxpuerto = "" & mytable11.Fields("puertoot")
                'sw = "" & mytable11.Fields("iot")
                'xcolax = "" & mytable11.Fields("cot")
                xxpuerto = "" & mytable11.Fields("puertope")
                sw = "" & mytable11.Fields("ipe")
                xcolax = "" & mytable11.Fields("cpro")

                'MsgBox xcolax
            Case "1"
                xxpuerto = "" & mytable11.Fields("puertoexo")
                sw = "" & mytable11.Fields("iexo")
                xcolax = "" & mytable11.Fields("cexo")

                'NC
            Case "E"
                xxpuerto = "" & mytable11.Fields("puertoNC")
                sw = "" & mytable11.Fields("iNC")
                xcolax = "" & mytable11.Fields("cNC")

        End Select

    End If

    mytablex.Close

    'MsgBox xxpuerto
    If psw = 10 Then  'solo es para ver si es LPT
        control_impresion = 11

        If xxpuerto = "LPT" Then
            control_impresion = 10

        End If

        Exit Function

    End If

    'MsgBox "abc"
    'found = abre_puerto("" & mytable11.Fields("capuerto"), Val("" & mytable11.Fields("catipo")))
    'ahora validamos los parametros de impresion
    If psw = 2 Then  'si  es orden de despacho
        If xcolax = "S" Then
            'oldprinter = Printer.DeviceName
            'Set Printer = Printers(xxpuerto)
            sFile = globaldir & "\temporal\" & gusuario & ".txt"
            found = Imprime_archivojj(sFile, 0, "" & mytable11.Fields("tamanoletra"), "" & mytable11.Fields("nombrefont"), "" & mytable11.Fields("BOLD"), "" & mytable11.Fields("letrainterna"))
            '----------------------------------
   
            'Set Printer = Printers(oldprinter)
        End If

        'MsgBox xcolax
        If xcolax <> "S" Then
            found = star_sp342(xxpuerto, 0)
            found = corte_papel(xxpuerto, Val("" & mytable11.Fields("catipo")))

        End If

        control_impresion = found
        Exit Function

    End If

    'MsgBox "abc"

    If sw = "S" Then
        If MsgBox("Desea Imprimir", 1 + 256, "Aviso") <> 1 Then
            control_impresion = 1
            Exit Function

        End If

    End If

    If xcolax = "S" Then
        oldprinter = Printer.DeviceName
        'MsgBox xxpuerto
        selecciona_impresoras (xxpuerto)
        sFile = globaldir & "\temporal\" & gusuario & ".txt"
   
        found = Imprime_archivojj(sFile, 0, "" & mytable11.Fields("tamanoletra"), "" & mytable11.Fields("nombrefont"), "" & mytable11.Fields("BOLD"), "" & mytable11.Fields("letrainterna"))
                  
        If bxtipo = "2" Then
            found = imprime_adifac(bxtipo, bxserie, bxnumero, 0, "")

        End If
                  
        ' 25/07/2018 Delivery y Para Llevar desde mozo
        '
        '        If flag_servicio = "D" Or V_EstadoMesa = "D" Then
        '            found = imprime_adicional(bxtipo, bxserie, bxnumero, 0, "")
        '        End If
        
        '24/08/2018  Delivery por mesa
        If flag_servicio = "D" And V_EstadoMesa <> "D" Then
            found = imprime_adicional(bxtipo, bxserie, bxnumero, 0, "")

        End If

        If V_EstadoMesa = "D" Then
            found = imprime_adicionalXMesa(bxtipo, bxserie, bxnumero, 0, "")

        End If
  
        '24/08/2018  Delivery por mesa
        ' 25/07/2018 Delivery y Para Llevar desde mozo

        '''' 25/07/2018 Delivery y Para Llevar desde mozo
        ' Mesas Nombre 21/05/2018
        If Picture2.Visible = True Then
            '24/08/2018  Delivery por mesa
            'cn.Execute ("update MESA set CODIGO='' where mesa='" & extra_loquesea(table2.columns(1)) & "' and salon='" & table2.columns(0) & "'")
            cn.Execute ("update MESA set CODIGO='',dnombre='',telefono='',ddireccion='',referencia='' where mesa='" & extra_loquesea(table2.columns(1)) & "' and salon='" & table2.columns(0) & "'")

            '24/08/2018  Delivery por mesa

        End If

        ' Mesas Nombre 21/05/2018
        '''' 25/07/2018 Delivery y Para Llevar desde mozo

        selecciona_impresoras (oldprinter)

    End If

    If xcolax <> "S" Then
        found = star_sp342(xxpuerto, 0)
        found = corte_papel(xxpuerto, Val("" & mytable11.Fields("catipo")))

        If bxtipo = "2" Then
            found = imprime_adifac(bxtipo, bxserie, bxnumero, 1, xxpuerto)

        End If
                  
        If flag_servicio = "D" Then
            found = imprime_adicional(bxtipo, bxserie, bxnumero, 1, xxpuerto)

        End If
   
    End If

    control_impresion = found
    Exit Function
cmd67111_err:
    MsgBox "Aviso en control impresion " + error$, 48, "Aviso"
    Exit Function

End Function

Sub proceso_impresioncopia()

    Dim found    As Integer

    Dim archivot As String

    On Error GoTo cmd7_err:

    cerrar_archivo
    factura_formatox "" & mytable11.Fields("local"), "" & rcconsulta.Fields("tipo"), "" & rcconsulta.Fields("serie"), "" & rcconsulta.Fields("numero"), "1", 0
    cerrar_archivo
    genver.file = globaldir & "\temporal\" & gusuario & ".txt"
    genver.Show 1
    Exit Sub
cmd7_err:
    MsgBox "Mensaje, Error al iniciar Impresion " & error$
    Exit Sub

End Sub

Sub proceso_impresioncopia1()

    Dim found    As Integer

    Dim archivot As String

    On Error GoTo cmd17_err:

    cerrar_archivo
    factura_formatox rrlocal11, rrtipo, rrserie, rrnumero, "1", 0
    cerrar_archivo
    genver.file = globaldir & "\temporal\" & gusuario & ".txt"
    genver.Show 1
    rrlocal11 = ""
    rrtipo = ""
    rrserie = ""
    rrnumero = ""
    MsgBox "Proceso Realizado con exito", 48, "Aviso"
    Exit Sub
cmd17_err:
    MsgBox "Mensaje, Error al iniciar Impresion " & error$
    Exit Sub

End Sub

Sub factura_formatox(bxlocal As String, _
                     bxtipo As String, _
                     bxserie As String, _
                     bxnumero As String, _
                     ascopia As String, _
                     psw As Integer)

    Dim vacu            As String

    Dim mytablex        As New ADODB.Recordset

    Dim mytabley        As New ADODB.Recordset

    Dim mytablez        As New ADODB.Recordset

    Dim found           As Integer

    Dim nro_lineas      As Integer

    Dim contando        As Integer

    Dim faltante        As Integer

    Dim i               As Integer

    Dim archivo_formato As String

    On Error GoTo cmd450009_err

    vacu = ""
    'MsgBox "QU"
    nro_lineas = busca_tipo_lineas(bxtipo)
    'MsgBox ""
    'If nro_lineas <= 0 Then
    '   nro_lineas = 10
    'End If
    'MsgBox ""
    contando = 0
    'IMPRESION - IMPRESORA
    FileName = globaldir & "\temporal\" & gusuario & ".txt"
    found = borra_nombre("" & FileName)
       
    If psw = 2 Then 'si es de orden
        archivo_formato = "orden"
    Else
        archivo_formato = busca_archivo_formato(bxtipo)

        If Len(archivo_formato) = 0 Then
            MsgBox "No existe archivo formato ", 48, "Aviso"
            Exit Sub

        End If

    End If

    'cabeza
    'proceso_formatos(archivo_formato , mydbx , mytablex , ubicacioni , ubicacionf , basedatos , indice , tipo , numero , ascopia , contando )
    'MsgBox gocabeza
    mytablex.Open "SELECT * FROM " & gocabeza & "   where  local='" & bxlocal & "' and tipo='" & bxtipo & "' and serie='" & bxserie & "' and numero='" & bxnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then 'si existe
        mytablex.Close
        Exit Sub

    End If

    'MsgBox ""
    'inicio 30/05/2017 pll posiblemente abajo aqui hace la estructura
    found = proceso_formatos(archivo_formato, mytablex, "{", "}", gocabeza, "TFACTURA", bxlocal, bxtipo, bxserie, bxnumero, ascopia, 0)
    vacu = "" & mytablex.Fields("acu")
    'MsgBox ""
    '
    'detalle
    flag_contando = 0

    If "" & mytablex.Fields("observa") = "CONSUMO" Then
        Open FileName For Append As #1
        found = formateaa("1  POR CONSUMO            " & Format(Val("" & mytablex.Fields("total")), "0.00"), 30, 2, 0)
        'found = formateaa("1    POR CONSUMO            ", 30, 2, 0)
        ' found = formateaa("1    COMBUSTIBLE            ", 30, 2, 0)
        contando = contando + 1
        flag_contando = contando + 1
        Close #1

    End If

    If "" & mytablex.Fields("observa") <> "CONSUMO" Then
        mytabley.Open "SELECT * FROM " & godetalle & "   where  local='" & bxlocal & "' and tipo='" & bxtipo & "' and serie='" & bxserie & "' and numero='" & bxnumero & "'", cn, adOpenDynamic, adLockOptimistic

        If mytabley.RecordCount > 0 Then 'si existe
            Do

                If mytabley.EOF Then Exit Do
                If "" & mytabley.Fields("dua") <> "R" Then
                    flag_contando = contando + 1
                    'inicio 30/05/2017 pll para la parametrizacion nombre consistencvia cliente ticketera
                    'found = proceso_formatos(archivo_formato, mytabley, "/", "\", godetalle, "TDETALLE", bxlocal, bxtipo, bxserie, bxnumero, ascopia, contando)
                    found = proceso_formatos(archivo_formato, mytabley, "/", "\", godetalle, "TDETALLE", bxlocal, bxtipo, bxserie, bxnumero, ascopia, contando)
                    'fin 30/05/2017 pll para la parametrizacion nombre consistencvia cliente ticketera
                   
                    contando = contando + 1

                End If

                mytabley.MoveNext
            Loop

        End If

        mytabley.Close

    End If
        
    '
    If nro_lineas > 0 Then

        'If bxtipo <> "1" And bxtipo <> "2" And bxtipo <> "5" And bxtipo <> "7" Then
        If contando < nro_lineas Then

            For i = contando To nro_lineas
                Open FileName For Append As #1
                found = formateaa("", 1, 2, 0)
                Close #1
            Next i

        End If

    End If

    '----- SUBTOTAL
       
    'inicio 30/05/2017 pll para la parametrizacion nombre consistencvia cliente ticketera
    found = proceso_formatos(archivo_formato, mytablex, "$", "?", gocabeza, "TFACTURA", bxlocal, bxtipo, bxserie, bxnumero, ascopia, 0)
    'fin 30/05/2017 pll para la parametrizacion nombre consistencvia cliente ticketera
                
    mytablez.Open "SELECT * FROM " & gofpago & "   where  local='" & bxlocal & "' and tipo='" & bxtipo & "' and serie='" & bxserie & "' and numero='" & bxnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablez.RecordCount > 0 Then 'si existe
        Do

            If mytablez.EOF Then Exit Do
            'inicio 30/05/2017 pll para la parametrizacion nombre consistencvia cliente ticketera
            'found = proceso_formatos(archivo_formato, mytablez, "<", ">", gofpago, "fpagov", bxlocal, bxtipo, bxserie, bxnumero, ascopia, 0)
            found = proceso_formatos(archivo_formato, mytablez, "<", ">", gofpago, "fpagov", bxlocal, bxtipo, bxserie, bxnumero, ascopia, 0)
            'fin 30/05/2017 pll para la parametrizacion nombre consistencvia cliente ticketera
            mytablez.MoveNext
        Loop

    End If
        
    'inicio 30/05/2017 pll para la parametrizacion nombre consistencvia cliente ticketera
    found = proceso_formatos(archivo_formato, mytablex, "^", "&", gocabeza, "TFACTURA", bxlocal, bxtipo, bxserie, bxnumero, ascopia, 0)
    'fin 30/05/2017 pll para la parametrizacion nombre consistencvia cliente ticketera
        
    mytablex.Close
    'mytabley.Close
    mytablez.Close
        
    Exit Sub
cmd450009_err:
    MsgBox "Aviso Proceso en Compilando " & error$, 24, "Aviso"
    'mytablex.Close
    '
    Exit Sub

End Sub

Function busca_archivo_formato(bxtipo As String) As String

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM tipo where  tipo='" & bxtipo & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe

        Select Case "" & mytablex.Fields("tipodoc")

            Case "Z" 'si es traslado
                busca_archivo_formato = "" & mytablex.Fields("archivo")

            Case "A"
                busca_archivo_formato = "" & mytable11.Fields("archivobm")

            Case "B"
                busca_archivo_formato = "" & mytable11.Fields("archivofm")

            Case "C"
                busca_archivo_formato = "" & mytable11.Fields("archivotb")

            Case "1"
                busca_archivo_formato = "" & mytable11.Fields("archivoexo")

            Case "D"
                busca_archivo_formato = "" & mytable11.Fields("archivotf")

            Case "G"
                busca_archivo_formato = "" & mytable11.Fields("archivonv")

            Case "H"  'cotizacion
                busca_archivo_formato = "" & mytable11.Fields("archivope")

            Case "I"  'pedido
                'busca_archivo_formato = "" & mytable11.Fields("archivoot")
                busca_archivo_formato = "" & mytable11.Fields("archivope")

            Case "1"
                busca_archivo_formato = "" & mytable11.Fields("archivonv")

            Case "E" 'NC
                busca_archivo_formato = "" & mytable11.Fields("archivonc")

        End Select

    End If

    mytablex.Close
 
End Function

Function busca_parame1(buf As String, sw As Integer) As String

    Dim sdx      As Double

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM parame where  codigo='01'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        If sw = 2 Then
     
        End If

        If sw = 0 Then
            sdx = Val("" & mytablex.Fields("clientes")) + 1
            busca_parame1 = "" & sdx

        End If

        If sw = 1 Then
            'mytablex.Edit
            mytablex.Fields("clientes") = buf
            mytablex.Update

        End If

    End If

    mytablex.Close

End Function

Sub modifica_detalle()

    Dim i        As Integer

    Dim mytablex As New ADODB.Recordset

    borrar_campos

    mytablex.Open "SELECT * FROM " & dgusuariog & "   where  local='" & "" & mytable11.Fields("local") & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then 'si existe
        mytablex.Close
        Exit Sub

    End If

    Do

        If mytablex.EOF Then Exit Do
   
        Data2.Recordset.AddNew

        For i = 0 To mytablex.Fields.count - 1
            Data2.Recordset.Fields(i) = mytablex.Fields(i)
        Next i

        Data2.Recordset.Update
   
        mytablex.MoveNext
    Loop
    mytablex.Close

End Sub

Sub inicializa_deliveri()

    'aqui me quede kenyo delivery tablet
    If opciontablet = "S" Then

        ' dcodigo = codigo.Text
        'Label9_Click
        'MsgBox ("es tablet")

    Else
        clasificacion = ""
        dcodigo = ""
        telefono = ""
        dnombre = ""
        ddireccion = ""
        referencia = ""
        fechanac = ""
        codigo = ""
        nombre = ""
        felizc = ""
        'dotipo = ""
        '   doserie = ""
        '   donumero = ""
        '   dototal = ""
        '   dofpago = ""
        '   dofecha = ""

    End If

End Sub

Function busca_paridad()

    Dim found    As Integer

    Dim mytablex As New ADODB.Recordset

    paridad = "1"
    paridadfp = "1"

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM parame where codigo='01' ", cn, adOpenStatic, adLockOptimistic

    If mytablex.EOF = True Or mytablex.BOF = True Then
        mytablex.Close
        Exit Function

    End If

    flagsubfamilia = "" & mytablex.Fields("subfamilia")

    'Color por familia y producto  30/05/2018
    flagcolorfamprod = "" & mytablex.Fields("colorproductofamilia")
    'Color por familia y producto  30/05/2018

    paridad = "" & mytablex.Fields("parivta")
    paridadfp = "" & mytablex.Fields("parivta")

    If Val(paridad) = 0 Then
        paridad = "1"

    End If

    If Val(paridadfp) = 0 Then
        paridadfp = "1"

    End If

    busca_paridad = 1
    mytablex.Close
 
End Function

Sub ir_finalx()

    On Error GoTo cmd13_err

    Data1.Recordset.MoveLast
    Exit Sub
cmd13_err:
    Exit Sub

End Sub

Sub PROCESO_BORRAR_DOCUMENTO(buf0 As String, _
                             buf As String, _
                             buf1 As String, _
                             buf2 As String)

    Dim mytablex As New ADODB.Recordset

    'MsgBox "dfd"
amk1:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM cpedidov where  local='" & buf0 & "' and tipo='" & buf & "' and serie='" & buf1 & "' and numero='" & buf2 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        mytablex.Delete
        GoTo amk1

    End If

ak12:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM dpedidov where  local='" & buf0 & "' and tipo='" & buf & "' and serie='" & buf1 & "' and numero='" & buf2 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        mytablex.Delete
        GoTo ak12

    End If

    mytablex.Close

End Sub

Function busca_clientesrpt(buf As String, sw As Integer) As String

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM clientes where  codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        busca_clientesrpt = "" & mytablex.Fields("nombre")

    End If

    mytablex.Close
 
End Function

Function busca_acu() As String

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM tipo where tipo='" & xtipo & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.EOF = True Or mytablex.BOF = True Then
        mytablex.Close
        Exit Function

    End If

    busca_acu = "" & mytablex.Fields("tipodoc")
    mytablex.Close

End Function

Function busca_fpagorpt(buf As String, sw As Integer) As String

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM fpago where  fpago='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        If sw = 0 Then
            busca_fpagorpt = "" & mytablex.Fields("descripcio")

        End If

        If sw = 1 Then
            busca_fpagorpt = "" & mytablex.Fields("moneda")

        End If

    End If

    mytablex.Close

End Function

Sub sql_ver_pedido()
    'Dim buf As String
    'On Error GoTo cmd37_err
    'If Len(dotipo) = 0 Then Exit Sub
    'If Len(doserie) = 0 Then Exit Sub
    'If Len(donumero) = 0 Then Exit Sub
    'buf = "select * from dpedidov where local='" & "" & mytable11.Fields("local") & "' and tipo='" & dotipo & "' and serie='" & doserie & "' and numero='" & donumero & "'"
    '               Data3.Connect = "foxpro 2.5;"
    '               Data3.DatabaseName = globaldir
    '               Data3.RecordSource = buf
    '               Data3.Refresh'
    '
    'Exit Sub
    'cmd37_err:
    'MsgBox "Error en select " & error$, 48, "Aviso"
    'Exit Sub

End Sub

Sub grabar_dato_pedido(buf As String, buf1 As String, buf2 As String, buf3 As String)

    On Error GoTo cmd1203_err

    Dim mytablex As New ADODB.Recordset

    If Len(buf) > 0 And Len(buf1) > 0 And Len(buf2) > 0 And Len(buf3) > 0 Then
        If mytablex.State = 1 Then mytablex.Close
        mytablex.Open "SELECT * FROM clientes where  codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then 'si existe
            'mytablex.Edit
            mytablex.Fields("dotipo") = buf1
            mytablex.Fields("doserie") = buf2
            mytablex.Fields("donumero") = buf3
            mytablex.Update

        End If

        mytablex.Close

    End If

    Exit Sub
cmd1203_err:
    MsgBox "Aviso en grabar_dato_pedido " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub sumar_al_grabar()

    Dim found As Integer

    On Error GoTo cmd59_err

    Data2.Recordset.MoveFirst
    found = sumar_detalle()
    Exit Sub
cmd59_err:
    Exit Sub

End Sub

Function busca_numero(bxtipo As String, bxserie As String, bxnumero As String)

    Dim buf      As String

    Dim sdx      As Double

    Dim mytablex As New ADODB.Recordset

    If Len(pedido) > 0 Then
        Exit Function

    End If

    buf = busca_tipo_acu(bxtipo)
ahj1:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM " & gocabeza & " where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & bxtipo & "' and serie='" & bxserie & "' and numero='" & bxnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        If buf = "A" Or buf = "B" Then
            MsgBox "Numero ya Existe ", 48, "Aviso"
            busca_numero = -1
            mytablex.Close
            Exit Function

        End If

        sdx = Val(xnumero) + 1
        xnumero = "" & sdx
        bxnumero = xnumero
        GoTo ahj1

    End If

    mytablex.Close

End Function

Function busca_numero_pedido()

    Dim sdx      As Double

    Dim mytablex As New ADODB.Recordset

ahj1:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM " & gocabeza & " where  local='" & Trim("" & mytable11.Fields("local")) & " and tipo='" & xptipo & "' and serie='" & xpserie & "' and numero='" & xpnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        sdx = Val(xpnumero) + 1
        xpnumero = "" & sdx
        GoTo ahj1

    End If

    mytablex.Close
 
End Function

Function proceso_cobros()
    borra_pagos
    sql_formapago
    sql_pagos

End Function

Sub sql_formapago()

    Dim buf As String

    buf = "select * from fpago "

    If flag_servicio <> "A" And flag_servicio <> "C" And flag_servicio <> "D" Then
        buf = "select * from fpago where fpago='6'"

    End If

    If mytablefpago.State = 1 Then mytablefpago.Close
    mytablefpago.Open buf, cn, adOpenDynamic, adLockOptimistic
    Set dbgrid10.DataSource = mytablefpago

    If mytablefpago.RecordCount > 0 Then
        mytablefpago.MoveFirst

    End If

    'Data10.Connect = "foxpro 2.5;"
    'Data10.DatabaseName = globaldir
    'Data10.RecordSource = "select * from fpago where bco='S' or bco=NULL "
    'Data10.Refresh
               
End Sub

Sub sql_pagos()

    Data9.Connect = "foxpro 2.5;"
    Data9.DatabaseName = globaldat
    Data9.RecordSource = "select * from  " & fpusuario
    Data9.refresh

End Sub

Sub borra_pagos()

    On Error GoTo cmd8912_err

    mydbxglo.Execute "DELETE FROM " & fpusuario
    Data9.refresh
    Label45.Caption = "Falta"
    stxtotals = ttxtotals
    stxtotald = ttxtotald
    Exit Sub
cmd8912_err:
    MsgBox "Error en borra_pagos " + error$, 48, "Aviso"
    Exit Sub
    
End Sub

Sub cerrar_data9()

    'On Error GoTo cmd3_err
    'Data9.Recordset.Close
    'Exit Sub
    'cmd3_err:
    'Exit Sub
End Sub

Sub macro_inserta_registro()
    'ultimo_fpago
    Data9.Recordset.AddNew
    Data9.Recordset.Fields("descripcio") = "" & dbgrid10.columns(0)
    Data9.Recordset.Fields("fpago") = "" & dbgrid10.columns(1)
    Data9.Recordset.Fields("moneda") = "" & dbgrid10.columns(2)
    Data9.Recordset.Fields("acu") = "" & dbgrid10.columns("tipo")
    Data9.Recordset.Update
    'Data9.Recordset.MoveNext
    Data9.refresh

End Sub

Sub ultimo_fpago()

    On Error GoTo cmd780_err

    Data9.Recordset.MoveLast
    Exit Sub
cmd780_err:
    Exit Sub

End Sub

Sub ir_ultimo_macro()

    On Error GoTo cmd78_err

    Data9.Recordset.MoveFirst
    Exit Sub
cmd78_err:
    Exit Sub

End Sub

Function macro_credito(sw As Integer)

    Frame6.Visible = True
    habilita_lab7 1
    descripcio1.Visible = True
    descripcio2.Visible = True
    descripcio3.Visible = True
    descripcio4.Visible = True
    descripcio5.Visible = True
    descripcio6.Visible = False
    tcampo1.MaxLength = 11
    tcampo2.MaxLength = 60
    tcampo3.MaxLength = 15
    tcampo4.MaxLength = 30
   
    ''''28/09/2017 kenyo Mejora Reportes Forma de pago y Creditos Finanzas (Observa)
    'tcampo5.MaxLength = 11
    
    '24/04/2018 Reporte Formas de Pago Mejorado
    'tcampo5.MaxLength = 3
    tcampo5.MaxLength = 20
    '24/04/2018 Reporte Formas de Pago Mejorado
   
    tcampo6.MaxLength = 2
    tcampo1 = "" & codigo
    tcampo2 = "" & nombre
    tcampo3 = ""
    tcampo4 = ""
    tcampo5 = ""
    tcampo6 = ""
    tcampo1.Visible = True
    tcampo2.Visible = True
    tcampo3.Visible = True
    tcampo4.Visible = True
    tcampo5.Visible = True
    tcampo6.Visible = False
   
    tcampo1.Enabled = True
    tcampo2.Enabled = True
    tcampo3.Enabled = True
    tcampo4.Enabled = True
    tcampo5.Enabled = True
    tcampo6.Enabled = False
   
    descripcio1 = "Codigo"
    descripcio2 = "Nombre"
    descripcio3 = "NroTarjeta"
    descripcio4 = "Observacion"
    descripcio5 = "NroDias"
    descripcio6 = ""

    If sw = 4 Then  'tarjeta credito
        descripcio1 = "Codigo"
        descripcio2 = "Nombre"
        descripcio3 = "NroTarjeta"
        descripcio4 = "Entidad"
        descripcio5 = "Propina"
        tcampo3.MaxLength = 4

    End If

    If sw = 3 Or sw = 6 Then 'credito
        descripcio1 = "Codigo"
        descripcio2 = "Nombre"
        descripcio3 = "NroAprob"
        descripcio4 = "Observacion"
        descripcio5 = "NroDias"

    End If

    If sw = 8 Then 'orden trabajo
        descripcio1 = "Codigo"
        descripcio2 = "Nombre"
        descripcio3 = "Observa"
        descripcio4 = ""
        descripcio5 = ""
        descripcio6 = ""

        'descripcio3 = "Tipo"
        'descripcio4 = "Numero"
        'descripcio5 = "NroDias"
    End If

    If sw = 5 Then  'tarjeta Debito
        descripcio1 = "Codigo"
        descripcio2 = "Nombre"
        descripcio3 = "NroTarjeta"
        descripcio4 = "Entidad"
        descripcio5 = "Propina"
        tcampo3.MaxLength = 4

    End If

    If sw = 1 Then  'SI ES PAGO ADELANTADO
        descripcio1 = "Codigo"
        descripcio2 = "Nombre"
        descripcio3 = ""
        descripcio4 = ""
        descripcio5 = ""
        descripcio6 = ""

        'tcampo1.Enabled = False
        'tcampo2.Enabled = False
        'tcampo4.Enabled = False
        'tcampo5.Enabled = False
        'tcampo6.Enabled = False
    End If

    If sw = 2 Then
        descripcio3 = "Nro.Op.Banco"

    End If
   
End Function

Sub suma_fpagov()

    Dim sdxs As Double

    Dim sdxd As Double

    Dim sdx  As Double

    Dim sdx1 As Double

    On Error GoTo cmd7812_err

    Label45.Caption = "Falta"
    sdxs = Val(ttxtotals)  'saldoa
    stxtotals = Format(sdxs, nrodecimal)
    'Data9.Recordset.MoveFirst
    Data9.refresh
    Do

        If Data9.Recordset.EOF Then Exit Do
        If Len("" & Data9.Recordset.Fields("FPAGO")) > 0 Then
            Data9.Recordset.Edit
            sdx = Val("" & Data9.Recordset.Fields("recibe"))

            If "" & Data9.Recordset.Fields("moneda") = "D" Then
                sdx = sdx * Val(paridadfp) 'Val("" & Data9.Recordset.Fields("cambio"))
                sdx = Val(Format(sdx, nrodecimal))
                Data9.Recordset.Fields("cambio") = sdx

            End If

            If sdx >= sdxs Then
                sdx1 = -sdx + sdxs
                sdx1 = Val(Format(sdx1, nrodecimal))
                Data9.Recordset.Fields("total") = sdxs
                Data9.Recordset.Fields("saldos") = sdx1
                stxtotals = Format(sdx1, nrodecimal)
                sdxs = 0
                GoTo conmuta

            End If

            If sdxs > sdx Then
                sdx1 = sdxs - sdx
                sdx1 = Val(Format(sdx1, nrodecimal))
                Data9.Recordset.Fields("total") = sdx
                Data9.Recordset.Fields("saldos") = 0
                stxtotals = Format(sdx1, nrodecimal)
                sdxs = sdx1

            End If

            If "" & Data9.Recordset.Fields("acu") = "C" Then

                'codigo = tcampo1
                'nombre = tcampo2
            End If

conmuta:
            Data9.Recordset.Update

        End If

        Data9.Recordset.MoveNext
    Loop
    stxtotald = Format(0, nrodecimal)

    'inicio 19/04/2017 pll para el vuelto
    'fin 19/04/2017 pll para el vuelto

    '24/06/2017 kenyo CORRECCION vuelto dolares
    If Val(paridadfp) > 0 Then
        If Framefp.Visible = True Then
            sdx = Val(stxtotals) / Val(paridadfp)
            stxtotald = Format(sdx, nrodecimal)

        End If
     
    End If
   
    If Framefp.Visible = True Then
        If stxtotals <= 0 Then
            Label45.Caption = "Vuelto"
            dbgrid10.Enabled = True
            dbgrid10.SetFocus

        End If

    End If

    '24/06/2017 kenyo CORRECCION vuelto dolares
  
    Exit Sub

cmd7812_err:
    MsgBox "Error en " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub valida_ingresado()

    Dim sdx      As Double

    Dim xsoles   As Double

    Dim xdolares As Double

    Dim xfaltas  As Double

    Dim xfaltad  As Double

    Dim xvueltos As Double

    Dim xvueltod As Double

    Dim sdx1     As Double

    Dim sdx2     As Double

    Dim sdx3     As Double

    xsoles = 0
    xdolares = 0
    xfaltas = 0
    xfaltad = 0
    xvueltos = 0
    xvueltod = 0
    sdx3 = 0

    If "" & dbgrid9.columns(1) = "S" Then
        xsoles = Val("" & dbgrid9.columns(2))
        xdolares = Val(Val("" & dbgrid9.columns(2))) / Val(paridadfp)
        sdx3 = xdolares

    End If

    If "" & dbgrid9.columns(1) = "D" Then
        xdolares = Val("" & dbgrid9.columns(2))
        xsoles = Val("" & dbgrid9.columns(2)) * Val(paridadfp)
        sdx3 = xsoles

    End If

    Data9.Recordset.Edit
    Data9.Recordset.Fields("cambio") = sdx3
    Data9.Recordset.Fields("recibes") = xsoles
    Data9.Recordset.Fields("recibed") = xdolares
    'sdx1 = Val(stxtotals) - xsoles
    'sdx2 = Val(stxtotald) - xdolares
    'Data9.Recordset.Fields("saldos") = sdx1
    'Data9.Recordset.Fields("saldod") = sdx2
    Data9.Recordset.Update

    'suma_fpagov
End Sub

Private Sub xcongela_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 And KeyAscii <> 27 Then Exit Sub
    If KeyAscii = 27 Then
        cmdCancelar_Click
        Exit Sub

    End If

End Sub

Private Sub turno_Click()
    tdremoto.Show 1

End Sub

Private Sub VistaButton1_Click()

    Dim buf  As String

    Dim buf1 As String

    If Len(Trim(codigo)) = 11 Then
        nombre = ""
        buf1 = ""
        buf = Trim(OTROPOS(Trim(codigo), buf1))

        If Len(buf) > 0 Then
            'MsgBox buf1
            nombre = buf
            ydireccion = buf1

        End If

    End If

End Sub

Private Sub txtDineroEntregado_Change()

    If Val(txtDineroEntregado.Text) = 0 Then
        txtVuelto.Text = "0.00"
    Else
        txtVuelto.Text = Format(Val(txtDineroEntregado.Text) - Val(rtxtotal.Caption), "0.00")

    End If

    '
    If Picture2.Visible = True Then
        If Val(txtDineroEntregado.Text) = 0 Then
            txtVuelto.Text = "0.00"
        Else
 
            '24/08/2018  Delivery por mesa
            If cmytablex.RecordCount = 0 Then Exit Sub
            '24/08/2018  Delivery por mesa

            txtVuelto.Text = Format(Val(txtDineroEntregado.Text) - cmytablex.Fields("total"), "0.00")

        End If

    End If

End Sub

Private Sub xcongelax_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 And KeyAscii <> 27 Then Exit Sub
    If KeyAscii = 27 Then
        cmdCancelar_Click
        Exit Sub

    End If

    cmdGrabar_Click

End Sub

Private Sub xdireccion_DblClick()
    tkeyboar.FLAG = "DIRECCION"
    tkeyboar.Show 1

End Sub

Private Sub xdireccion_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then Exit Sub
    xdistrito.SetFocus

End Sub

Private Sub xdireccion_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        xnombre.SetFocus
        Exit Sub

    End If

End Sub

Private Sub xdistrito_DblClick()
    tkeyboar.FLAG = "GLOSA"
    tkeyboar.Show 1

End Sub

Private Sub xdistrito_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then Exit Sub
    If xserie.Enabled = False Then  'ver si es ticket
        Command13_Click
        Exit Sub

    End If

    fechae.SetFocus

    'xserie.SetFocus
End Sub

Private Sub xdistrito_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        xdireccion.SetFocus
        Exit Sub

    End If

End Sub

Private Sub xnombre_DblClick()
    tkeyboar.FLAG = "NOMBRE"
    tkeyboar.Show 1

End Sub

Private Sub xnombre_KeyPress(KeyAscii As Integer)

    Dim found As Integer

    If KeyAscii <> 13 Then Exit Sub
    xdireccion.SetFocus

End Sub

Private Sub xnombre_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        xruc.SetFocus
        Exit Sub

    End If

    If KeyCode = &H70 Then  'f1
        'If local1.Visible <> True Then
        consulta_xruc

        'End If
        '  If local1.Visible = True Then
        '   consulta_xruc2
        'End If
    End If

End Sub

Private Sub xnumero_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then Exit Sub
    Command13_Click

End Sub

Private Sub xnumero_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        xserie.SetFocus
        Exit Sub

    End If

End Sub

Private Sub xopciones_Click(Index As Integer)
    'iResultadoSound = mciExecute("Play " & App.path & "\Sonido\producto.wav")
    'iResultadoSound = mciExecute("Play " & "C:\Windows\producto.wav")

    '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017
    If Frame5.Visible = True And Index <> 6 Then Exit Sub
    '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017

    If Index <> 26 Then ' 27 ES CLIENTES
        frmClientesRUC.Visible = False

    End If

    Dim found As Integer

    Dim buf   As String

    xrepite = "REPITE"
    ot = ""

    If Index = 27 Then ' control de tara
        If Picture4.Visible = True Then
            Picture4.Visible = False
            Exit Sub

        End If

        If Picture4.Visible = False Then
            Picture4.Visible = True
            Picture4.Top = 6210
            Picture4.Left = 3815
            Exit Sub

        End If

    End If

    If Index = 34 Then ' Delivery Tablet
        ''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas
        'opciontablet = "S"
        'menu_abonoot
        'Picture4.Visible = False
        'Exit Sub
        
        menu_abonocredito
        Picture4.Visible = False
        Exit Sub
        ''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas

    End If

    If Index = 33 Then
        menu_cargaot
        Picture4.Visible = False

    End If

    If Index = 32 Then  'obono ot
        stockvirtual = "S"
        menu_abonoot
        Picture4.Visible = False
        Exit Sub

    End If

    If Index = 29 Then
        '    trgb.tipo = "PRODUCTO"
        '    trgb.Show 1
        '    inicia_color_producto

        Exit Sub

    End If

    If Index = 28 Then  '
        'inicio 21/04/2017 pll
        Picture4.Visible = False
        'fin 21/04/2017 pll
        tingper.Show 1

    End If

    If Index = 27 Then
        'tcheckin.Show
        'AHORA ES OTROS

    End If

    If Index = 31 Then  'ORDEN TRABAJO graba
        ot = "S"

        If Len(Trim("" & mytable11.Fields("tipope"))) = 0 Then
            MsgBox "No definido orden de trabajo ", 48, "Mensaje"
            DBGrid2.SetFocus
            Exit Sub

        End If

        flag_servicio = "A"
        salon.Caption = ""
        mesa.Caption = ""
        mesero = ""
        cuenta_separa = ""
        orden_trabajos
        Picture4.Visible = False

    End If
   
    If Index = 35 Then  'COTIS
        ot = "S"

        If Len(Trim("" & mytable11.Fields("tipope"))) = 0 Then
            MsgBox "No definido orden de trabajo ", 48, "Mensaje"
            DBGrid2.SetFocus
            Exit Sub

        End If

        flag_servicio = "A"
        salon.Caption = ""
        mesa.Caption = ""
        mesero = ""
        cuenta_separa = ""
        orden_trabajos
        Picture4.Visible = False

    End If
   
    If Index = 23 Then 'CORTESI ANTES HOTEL
        ''treevho.Show 1
        Picture4.Visible = False

        If Picture2.Visible = False Then
      
            If Len(Trim(axcnumero)) > 0 Then
                If Val(axctotal) < Val(rtxtotal) Then
                    MsgBox "Total a Cuenta no debe ser mayor que saldo ", 48, "Aviso"
                    Exit Sub

                End If

            End If

            proceso_cierre_automatico "7"
            Exit Sub
   
        Else
   
            'On Error GoTo cm89222_err
            If cmytablex.RecordCount = 0 Then Exit Sub
            If Me.Picture2.Visible = False Then Exit Sub
            'xopcioness_Click (16)
            buf = "Salon " & cmytablex.Fields("salon") '& Chr$("impuesto") & Chr$("neto")
    
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            'buf = buf & glomesa & " " & cmytablex.Fields(1)
            buf = buf & glomesa & " " & extra_loquesea(cmytablex.Fields(1))
            ' 25/07/2018 Delivery y Para Llevar desde mozo
    
            If MsgBox("Desea Cobrar " & buf, 1, "Cobrar Comanda ") <> 1 Then Exit Sub
            found = carga_comanda(0)

            If found = 0 Then
                MsgBox "No se Puede Cobrar,No existen Comandas ", 48, "Aviso"
                Exit Sub

            End If
 
            salon.Caption = "" & cmytablex.Fields("salon")
    
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            ' mesa.Caption = "" & cmytablex.Fields(1)
            mesa.Caption = "" & extra_loquesea(cmytablex.Fields(1))
            ' 25/07/2018 Delivery y Para Llevar desde mozo
    
            'cproven = cmytablex.Fields("vendedor")
    
            flag_servicio = "C"
            'Label55_Click
            proceso_cierre_automatico "7"
            Exit Sub

        End If
     
    End If

    If Index = 22 Then 'VISA

        If Picture2.Visible = False Then
      
            If Len(Trim(axcnumero)) > 0 Then
                If Val(axctotal) < Val(rtxtotal) Then
                    MsgBox "Total a Cuenta no debe ser mayor que saldo ", 48, "Aviso"
                    Exit Sub

                End If

            End If

            proceso_cierre_automatico "4"
            Exit Sub
   
        Else
   
            'On Error GoTo cm89222_err
            If cmytablex.RecordCount = 0 Then Exit Sub
            If Me.Picture2.Visible = False Then Exit Sub
            'xopcioness_Click (16)
            buf = "Salon " & cmytablex.Fields("salon") '& Chr$("impuesto") & Chr$("neto")
    
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            'buf = buf & glomesa & " " & cmytablex.Fields(1)
            buf = buf & glomesa & " " & extra_loquesea(cmytablex.Fields(1))
            ' 25/07/2018 Delivery y Para Llevar desde mozo
    
            If MsgBox("Desea Cobrar " & buf, 1, "Cobrar Comanda ") <> 1 Then Exit Sub
            found = carga_comanda(0)

            If found = 0 Then
                MsgBox "No se Puede Cobrar,No existen Comandas ", 48, "Aviso"
                Exit Sub

            End If

            salon.Caption = "" & cmytablex.Fields("salon")
    
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            'mesa.Caption = "" & cmytablex.Fields(1)
            mesa.Caption = "" & extra_loquesea(cmytablex.Fields(1))
            ' 25/07/2018 Delivery y Para Llevar desde mozo
    
            'cproven = cmytablex.Fields("vendedor")
    
            flag_servicio = "C"
            'Label55_Click
            proceso_cierre_automatico "4"
            Exit Sub

        End If
 
    End If

    If Index = 24 Then 'CREDITO CLIENTES
        If Picture2.Visible = False Then
            If Len(Trim(axcnumero)) > 0 Then
                If Val(axctotal) < Val(rtxtotal) Then
                    MsgBox "Total a Cuenta no debe ser mayor que saldo ", 48, "Aviso"
                    Exit Sub

                End If

            End If

            proceso_cierre_automatico "3"
            Exit Sub
   
        Else
   
            'On Error GoTo cm89222_err
            If cmytablex.RecordCount = 0 Then Exit Sub
            If Me.Picture2.Visible = False Then Exit Sub
            'xopcioness_Click (16)
            buf = "Salon " & cmytablex.Fields("salon") '& Chr$("impuesto") & Chr$("neto")
        
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            '  buf = buf & glomesa & " " & cmytablex.Fields(1)
            buf = buf & glomesa & " " & extra_loquesea(cmytablex.Fields(1))
            ' 25/07/2018 Delivery y Para Llevar desde mozo
         
            If MsgBox("Desea Cobrar " & buf, 1, "Cobrar Comanda ") <> 1 Then Exit Sub
            found = carga_comanda(0)

            If found = 0 Then
                MsgBox "No se Puede Cobrar,No existen Comandas ", 48, "Aviso"
                Exit Sub

            End If

            salon.Caption = "" & cmytablex.Fields("salon")
        
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            'mesa.Caption = "" & cmytablex.Fields(1)
            mesa.Caption = "" & extra_loquesea(cmytablex.Fields(1))
         
            ' 25/07/2018 Delivery y Para Llevar desde mozo
        
            'cproven = cmytablex.Fields("vendedor")
    
            flag_servicio = "C"
            'Label55_Click
            proceso_cierre_automatico "3"
            Exit Sub

        End If

    End If

    If Index = 25 Then 'Cobranza de Dolares
        '' 02/12/2017 Modulo Delivery Proyecto Principal
        ' SE CAMBIO DOLARES POR VER DELIVERY

        '   If Len(Trim(axcnumero)) > 0 Then
        '      If Val(axctotal) < Val(rtxtotal) Then
        '        MsgBox "Total a Cuenta no debe ser mayor que saldo ", 48, "Aviso"
        '        Exit Sub
        '      End If
        '   End If
        '
        '
        '   If Val(hknumero) >= Val(rtxtotald) And Val(hknumero) > 0 Then
        '        proceso_cierre_dolar
        '   Else
        '        MsgBox "Ingrese un valor valido ", 48, "Aviso"
        '        Exit Sub
        '   End If
        FrmDelivery.Show 1
        '' 02/12/2017 Modulo Delivery Proyecto Principal
    
    End If
 
    If Index = 20 Then 'cierre caja Z

        Dim sw As Integer

        flag_clave1 = 0
        tconcla.X = "CIERRE"
        tconcla.Show 1

        If flag_clave1 = 0 Then
            'Label27_Click
            Exit Sub

        End If
    
        opcion1 = "5"
        opcion2 = "1"
        opcion3 = "2"
        tcuadrc1.fechai.Enabled = True
        tcuadrc1.fechaf.Enabled = True
        usuariopos = gusuario
        tcuadrc1.cajero = "%" 'usuariopos
        tcuadrc1.caja = caja
        tcuadrc1.turno = "%" 'turno
        tcuadrc1.horai = "01"
        tcuadrc1.horaf = "24"
        tcuadrc1.fechai = dia
        tcuadrc1.fechaf = dia
    
        ''01/07/2017 Kenyo Correcion cierre correlativo al realizar copia de cierre de caja
        tcuadrc1.opcioncierres = "S"
        ''01/07/2017 Kenyo Correcion cierre correlativo al realizar copia de cierre de caja
    
        tcuadrc1.Caption = "CIERRE DEL DIA"
        tcuadrc1.check3d1.Visible = True
        tcuadrc1.check3d2.Visible = True
        tcuadrc1.check3d3.Visible = True
        vIMPRIMIR = 1
        tcuadrc1.Show 1

        'Call Enviar_Pulsacion(tcuadrc1.Command1.hwnd)
    End If

    If Index = 26 Then

        If frmClientesRUC.Visible = True Then
            frmClientesRUC.Visible = False
            'Inicio 19/04/2017 pll
            '         xruc = Trim(codigo.Text)
            '         xnombre = Trim(nombre.Text)
            '         xdireccion = Trim(ydireccion.Text)
            '         correo = Trim(correo.Text)
            'Fin 19/04/2017 pll
       
            ' Exit Sub
            'inicio 24/04/2017 pll
        Else
            '

            ''''21/09/2017 kenyo Mejora  cobranza de mesas
            frmClientesRUC.Visible = True
            frmClientesRUC.Width = 6825: frmClientesRUC.Height = 3810
            frmClientesRUC.Top = 420: frmClientesRUC.Left = 8550
            codigo.SetFocus
            ''''21/09/2017 kenyo Mejora  cobranza de mesas
    
            'fin 24/04/2017 pll
        End If
   
    End If

    If Index = 19 Then 'egreso
        If dbgrid6.Visible = True Then Exit Sub
        If Framefp.Visible = True Then Exit Sub
        If Frame7.Visible = True Then Exit Sub
        If Frame6.Visible = True Then Exit Sub
        If Frame1.Visible = True Then Exit Sub
   
        gofpago = "fpagov"
        found = copiar_recibos()

        If found = 0 Then
            MsgBox "Error al copiar archivo temporal", 24, "Aviso"
            Exit Sub

        End If

        fgusuario = "_l" & gusuario
        found = copiar_tmpfpagoR()

        If found = 0 Then
            MsgBox "No se puede copiar temporal tmpfpagor", 48, "Aviso"
            Exit Sub

        End If

        'found = copiar_recibos()
        'If found = 0 Then
        '   MsgBox "Error al copiar archivo temporal", 24, "Aviso"
        '   End
        '   Exit Sub
        'End If
        'explreci.afecta = "P"  'proveedor
        'explreci.acu = "V"

        fgusuario = "_r" & gusuario
        trecaja.xcuentaco = "cuentap"
        trecaja.pagocash.Visible = True
        trecaja.pagocash.Value = 1
        trecaja.XCUENTACO1 = "cuentapd"
        trecaja.tipoclie = "P"
        trecaja.Combo2.Enabled = True
    
        trecaja.Caption = "EGRESO DINERO"
        trecaja.local1 = "" & mytable11.Fields("local")
        trecaja.serie = "" & mytable11.Fields("seriere")
        'trecaja.local1.Enabled = False
        'trecaja.afecta.Enabled = True
        trecaja.afecta = "P"
        trecaja.acu = "V"
        trecaja.cajero = cajero
        trecaja.caja = caja
        trecaja.turno = turno
        trecaja.fecha = dia
        trecaja.dia = dia
        trecaja.ch89343.Visible = True
        trecaja.d7823.Visible = True
    
        '16/03/2018 No sale error en Ingreso/Egreso desde Menu
        AbreGaveta = "S"
        '16/03/2018 No sale error en Ingreso/Egreso desde Menu
    
        trecaja.fecha.Enabled = False
        trecaja.tipo = "RE"
        trecaja.Show 1

    End If

    If Index = 18 Then 'ingreso
        If dbgrid6.Visible = True Then Exit Sub
        If Framefp.Visible = True Then Exit Sub
        If Frame7.Visible = True Then Exit Sub
        If Frame6.Visible = True Then Exit Sub
        If Frame1.Visible = True Then Exit Sub
        'gofpago = "fpagov"
        'found = copiar_recibos()
        'If found = 0 Then
        '   MsgBox "Error al copiar archivo temporal", 24, "Aviso"
        '   End
        '   Exit Sub
        'End If

        found = copiar_recibos()

        If found = 0 Then
            MsgBox "Error al copiar archivo temporal", 24, "Aviso"
            Exit Sub

        End If

        fgusuario = "_l" & gusuario
        found = copiar_tmpfpagoR()

        If found = 0 Then
            MsgBox "No se puede copiar temporal tmpfpagor", 48, "Aviso"
            Exit Sub

        End If

        fgusuario = "_r" & gusuario
        trecaja.pagocash.Visible = True
        trecaja.xcuentaco = "cuentac"
        trecaja.XCUENTACO1 = "cuentacd"
        trecaja.tipoclie = "C"
        trecaja.Combo2.Enabled = True

        trecaja.Caption = "INGRESO DINERO"
        trecaja.afecta = "C"
        trecaja.pagocash.Value = 1
    
        trecaja.local1 = "" & mytable11.Fields("local")
        trecaja.serie = "" & mytable11.Fields("serieri")
        trecaja.acu = "W"
        trecaja.cajero = cajero
        trecaja.caja = caja
        trecaja.turno = turno
        trecaja.fecha = dia
        trecaja.dia = dia
        trecaja.fecha.Enabled = False
        trecaja.ch89343.Visible = True
        trecaja.d7823.Visible = True
                
        '16/03/2018 No sale error en Ingreso/Egreso desde Menu
        AbreGaveta = "S"
        '16/03/2018 No sale error en Ingreso/Egreso desde Menu
            
        trecaja.tipo = "RI"
        trecaja.Show 1

    End If

    If Index = 17 Then

        'KENYO FORMA DE PAGO MASTERCARD
        'AHORA ES MASTERCARD
        If Picture2.Visible = False Then
      
            If Len(Trim(axcnumero)) > 0 Then
                If Val(axctotal) < Val(rtxtotal) Then
                    MsgBox "Total a Cuenta no debe ser mayor que saldo ", 48, "Aviso"
                    Exit Sub

                End If

            End If

            proceso_cierre_automatico "5"
            Exit Sub
   
        Else
   
            'On Error GoTo cm89222_err
            If cmytablex.RecordCount = 0 Then Exit Sub
            If Me.Picture2.Visible = False Then Exit Sub
            'xopcioness_Click (16)
            buf = "Salon " & cmytablex.Fields("salon") '& Chr$("impuesto") & Chr$("neto")
    
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            'buf = buf & glomesa & " " & cmytablex.Fields(1)
            buf = buf & glomesa & " " & extra_loquesea(cmytablex.Fields(1))
            ' 25/07/2018 Delivery y Para Llevar desde mozo
    
            If MsgBox("Desea Cobrar " & buf, 1, "Cobrar Comanda ") <> 1 Then Exit Sub
            found = carga_comanda(0)

            If found = 0 Then
                MsgBox "No se Puede Cobrar,No existen Comandas ", 48, "Aviso"
                Exit Sub

            End If

            salon.Caption = "" & cmytablex.Fields("salon")
        
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            ' mesa.Caption = "" & cmytablex.Fields(1)
            mesa.Caption = "" & extra_loquesea(cmytablex.Fields(1))
            ' 25/07/2018 Delivery y Para Llevar desde mozo
    
            'cproven = cmytablex.Fields("vendedor")
    
            flag_servicio = "C"
            'Label55_Click
            proceso_cierre_automatico "5"
            Exit Sub

        End If
 
    End If

    If Index = 16 Then  'combinaciones
        'On Error GoTo cmd_6111err
        '   If Len(dbgrid2.columns(0)) > 0 Then
        '      'cargar_tmcombina
        '      tcombina.producto = Trim("" & dbgrid2.columns(0))
        '      tcombina.Show 1
        '   End If
        'Exit Sub
        'cmd_6111err:
        'Exit Sub
        'tmesasta.Show 1
        'consulta_comanda "" & mytable11.Fields("salon")
        'reemplaza a combinaciones

        ''''21/09/2017 kenyo Mejora  cobranza de mesas
        frmClientesRUC.Top = 420: frmClientesRUC.Left = 0
        frmClientesRUC.Width = 8550: frmClientesRUC.Height = 4680
        frmClientesRUC.Visible = True
        'codigo.SetFocus
        ''''21/09/2017 kenyo Mejora  cobranza de mesas
  
        If Picture2.Visible = True Then
            '24/08/2018  Delivery por mesa
            nombre = ""
            codigo = ""
            '24/08/2018  Delivery por mesa
        
            Picture2.Visible = False
            ''''21/09/2017 kenyo Mejora  cobranza de mesas
            frmClientesRUC.Visible = False
            ''''21/09/2017 kenyo Mejora  cobranza de mesas
        
            Exit Sub

        End If

        If Picture2.Visible = False Then
            Picture2.Visible = True
            consulta_comanda "" & mytable11.Fields("salon")
            '''04/08/2017 kenyo. Cobra Mesa Con Enter
            table2.SetFocus
            '''04/08/2017 kenyo. Cobra Mesa Con Enter
            Exit Sub

        End If

    End If

    If Index = 15 Then ' comentario

        On Error GoTo cmd_611err

        If Len(DBGrid2.columns("producto")) > 0 Then
            ingreso_locales

        End If

        Exit Sub
cmd_611err:
        Exit Sub

    End If

    If Index = 14 Then  'graba comandas

        On Error GoTo cmd56123_err

        found = sumar_detalle()
        'MsgBox found

        '''25/10/2017 Permitir grabar comandas con total 0
        ' If Val(txtotal) = 0 Then
        '       MsgBox "Seleccione productos ", 48, "Aviso"
        '       dbgrid2.SetFocus
        '       Exit Sub
        ' End If
        '''25/10/2017 Permitir grabar comandas con total 0
      
        If found = 0 Then
            MsgBox "debe de Existir un Precio=0", 48, "Aviso"
            DBGrid2.SetFocus
            Exit Sub

        End If

        If xopciones(0).Enabled = True Then  'si es autoservicio activado esta en la caja
            If "" & mytable11.Fields("pmesero") = "N" Then
                sin_meseros
                Exit Sub

            End If
   
            If dbvarios.State = 1 Then dbvarios.Close
            dbvarios.Open "select Nombre,Codigo from vendedor   where local='" & "" & mytable11.Fields("local") & "' order by nombre ", cn, adOpenStatic, adLockOptimistic

            If dbvarios.RecordCount = 0 Then
                MsgBox "No existe Vendedor asignado al local ", 48, "Aviso"
                dbvarios.Close
                Exit Sub

            End If

            Set table6.DataSource = dbvarios
            Frame8.Caption = "Personal"
            Frame8.Visible = True
            table6.SetFocus
            Exit Sub

        End If

        flag_clave1 = 0

        If Trim("" & mytable11.Fields("obligaclavemesa")) = "S" Or Trim("" & mytable11.Fields("obligaclavemesa")) = "" Then
            tconcla.X = "COMANDA"  '
            tconcla.Show 1

            If flag_clave1 <> 1 Then  'si es descongela
                Exit Sub

            End If

        Else

        End If

        '-------------SI ES COMANDA-----------------
        flag_comanda = 0

        If Len(Trim(salon.Caption)) > 0 Then 'si ha seleccionado mesa
            mesero = Trim(globalmesero)
            graba_sistema_comanda
            GoTo comanda_2
            Exit Sub

        End If

        flag_comanda = 0

        'MsgBox flag_comanda
        'graba comanda kenyo
        If Trim("" & mytable11.Fields("obligaclavemesa")) = "S" Or Trim("" & mytable11.Fields("obligaclavemesa")) = "" Then
        Else

            tcomanda.mesero = gusuario
            tcomanda.nmesero = ngusuario

        End If

        tcomanda.Show 1
comanda_2:

        If flag_comanda = "1" Then
            'MsgBox "paso"
            'MsgBox salon.Caption
            flag_servicio = "C"
   
            If mytable11.Fields("multicomanda") = "S" Then
                nroimpresion = 0
                found = orden_despacho(0)
 
                nroimpresion = 1
                found = orden_despacho(1)

                nroimpresion = 2
                found = orden_despacho(2)
   
                nroimpresion = 3
                found = orden_despacho(3)
            Else
   
                nroimpresion = 0
                found = orden_despacho(0)
   
            End If
   
            ''11/07/2017 kenyo multicomandas
   
            'ordencomanda17022015
            borrar_todo
            sql_detalle
            tiposervicio1 = "Autoservicio"
            flag_servicio = "A"
            Frame8.Visible = False

        End If

        consulta_comanda "" & mytable11.Fields("salon")
        Exit Sub
cmd56123_err:
        'MsgBox "Seleccione un Salon Y Mesa ", 48, "Aviso"
        Exit Sub

    End If

    If Index = 13 Then  'congela
    
        ''02/11/2017 Ordena lista de productos despues de congelar
        'If Val(txtotal) = 0 Then
        'If dbgrid2.Row = 0 Then
        '     MsgBox "No existen Productos Ingresados", 48, "Aviso"
        '     dbgrid2.SetFocus
        '     Exit Sub
        'End If
        ''02/11/2017 Ordena lista de productos despues de congelar
        If Val(txtotal) = 0 Then
            MsgBox "No existen Productos Ingresados", 48, "Aviso"
            DBGrid2.SetFocus
            Exit Sub

        End If

        If Framefp.Visible = True Then Exit Sub
        If Frame7.Visible = True Then Exit Sub
        If Frame6.Visible = True Then Exit Sub
        If Frame1.Visible = True Then Exit Sub

        If Frame9.Visible = True Then
            xcongelax.SetFocus
            Exit Sub

        End If

        Frame9.Visible = True

        'inicio 01/06/2017  KENYO APARECE EN CONGELA NOMBRE DE CLIENTE PARA DESCONGELAR
        'xcongelax = ""  ' asi estaba antes

        If opcioncongela = "2" Then

        Else
            xcongelax = ""

        End If

        'fin 01/06/2017  KENYO APARECE EN CONGELA NOMBRE DE CLIENTE PARA DESCONGELAR

        clavecongela = ""
        xcongelax.SetFocus

    End If

    If Index = 12 Then  'congela
        'inicio 01/06/2017  KENYO APARECE EN CONGELA NOMBRE DE CLIENTE PARA DESCONGELAR
        opcioncongela = 2
        'fin 01/06/2017  KENYO APARECE EN CONGELA NOMBRE DE CLIENTE PARA DESCONGELAR

        If Val(txtotal) > 0 Then
            MsgBox "No deben existir Productos ", 48, "Aviso"
            DBGrid2.SetFocus
            Exit Sub

        End If

        If Framefp.Visible = True Then Exit Sub
        If Frame7.Visible = True Then Exit Sub
        If Frame6.Visible = True Then Exit Sub
        If Frame1.Visible = True Then Exit Sub
        If Frame9.Visible = True Then Exit Sub
        Frame1.Visible = True
        Frame1.Enabled = True
    
        ''03/07/2017 KENYO Correcion Busqueda Congela
        Combo1.Clear
        Combo1.AddItem "Nombre"
        Combo1.ListIndex = 0
        ''03/07/2017 KENYO Correcion Busqueda Congela
    
        buffer = ""
        opcion1 = "150"
        sw_consulta = 0
        found = sql_consulta(1)
        dbGrid1.Enabled = True

        'dbGrid1.SetFocus
    End If

    If Index = 11 Then  'abre gaveta
        If dbgrid6.Visible = True Then Exit Sub
        If Framefp.Visible = True Then Exit Sub
        If Frame7.Visible = True Then Exit Sub
        If Frame6.Visible = True Then Exit Sub
        If Frame1.Visible = True Then Exit Sub
    
        flag_clave1 = 0
        tconcla.X = "APERTURA"
        tconcla.Show 1

        If flag_clave1 <> 1 Then  'si es abre cajon
            DBGrid2.SetFocus
            Exit Sub

        End If

        If "" & mytable11.Fields("terminal") = "T" Then
            MsgBox "No permitido en Pedido", 48, "Aviso"
            DBGrid2.SetFocus
            Exit Sub

        End If

        found = abre_puerto("" & mytable11.Fields("capuerto"), Val("" & mytable11.Fields("catipo")), "" & mytable11.Fields("gavetacola"))

    End If

    If Index = 10 Then  'borra linea

        On Error GoTo cmd7888_err

        If DBGrid2.Row = -1 Then
            MsgBox "No hay ningún registro para eliminar", vbInformation
            Exit Sub

        End If

        'If MsgBox("Se va a eliminar el registro : está seguro ", _
        '   vbExclamation + vbYesNo, "Eliminar") = vbYes Then
        Data2.Recordset.Delete

        If Data2.Recordset.EOF = True And Data2.Recordset.BOF = True Then
            Exit Sub

        End If

        found = sumar_detalle()
       
        If Val(txtDineroEntregado.Text) = 0 Then
            txtVuelto.Text = "0.00"
        Else
            txtVuelto.Text = Format(Val(txtDineroEntregado.Text) - Val(rtxtotal.Caption), "0.00")

        End If

        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus
        Exit Sub
        'End If
        Exit Sub
cmd7888_err:
        MsgBox "SELECCIONE ÍTEM..." + error$, 48, "Aviso"
        Exit Sub

    End If

    If Index = 9 Then  'anula venta
        If dbgrid6.Visible = True Then Exit Sub
        If Framefp.Visible = True Then Exit Sub
        If Frame7.Visible = True Then Exit Sub
        If Frame6.Visible = True Then Exit Sub
        If Frame1.Visible = True Then Exit Sub
    
        flag_clave1 = 0
        tconcla.X = "ANULA"  '
        tconcla.Show 1

        If flag_clave1 <> 1 Then  'si es descongela
            DBGrid2.SetFocus
            Exit Sub

        End If
    
        cgusuario = gocabeza
        dgusuariog = godetalle
        menu_anula1

    End If

    If Index = 8 Then 'copia ventas
        If dbgrid6.Visible = True Then Exit Sub
        If Framefp.Visible = True Then Exit Sub
        If Frame7.Visible = True Then Exit Sub
        If Frame6.Visible = True Then Exit Sub
        If Frame1.Visible = True Then Exit Sub

        '-------------------------------------
        If "" & mytable11.Fields("clavecopia") = "S" Then
            flag_clave1 = 0
            tconcla.X = "COPIA"  '
            tconcla.Show 1

            If flag_clave1 <> 1 Then  'si es descongela
                DBGrid2.SetFocus
                Exit Sub

            End If

        End If

        cgusuario = gocabeza
        dgusuariog = godetalle
        menu_copia
        Exit Sub

    End If

    If Index = 7 Then 'cuadre parcial
        dcupar1_Click

    End If

    If Index = 6 Then 'limpia pedido
        If Frame2.Visible = True Then Exit Sub
        If MsgBox("Desea Borrar ??", 1, "Aviso") <> 1 Then Exit Sub
        borrar_todo
        sql_detalle
        tiposervicio1 = "Autoservicio"
        flag_servicio = "A"
        salon.Caption = ""
        mesa.Caption = ""
        mesero = ""
        cuenta_separa = ""
        xcongelax = ""

    End If

    If Index = 5 Then 'descuento pedido actual
        If dbgrid6.Visible = True Then Exit Sub
        If Framefp.Visible = True Then Exit Sub
        If Frame7.Visible = True Then Exit Sub
        If Frame6.Visible = True Then Exit Sub
        If Frame1.Visible = True Then Exit Sub
        '-------------------------------------
    
        flag_clave1 = 0
        tconcla.X = "DESCUENTO"
        tconcla.Show 1

        If flag_clave1 <> 1 Then  'si es descongela
            DBGrid2.SetFocus
            Exit Sub

        End If

        Trecarg.total = txtotal
        Trecarg.Show 1
        grabar_descto

    End If

    If Index = 4 Then 'delivery
        If Len(telefono) = 0 Then Exit Sub
        If Len(dnombre) = 0 Then Exit Sub
        salon.Caption = ""
        mesa.Caption = ""
        mesero = ""
        cuenta_separa = ""
        flag_servicio = "D"
        proceso_cobross

    End If

    If Index = 0 Then  'autoservicio

        If Picture2.Visible = False Then
    
            If flag_servicio = "D" Then ' SI ES DELIVERY
                If Len(telefono) = 0 Then Exit Sub
                If Len(dnombre) = 0 Then Exit Sub
                salon.Caption = ""
                mesa.Caption = ""
                mesero = ""
                cuenta_separa = ""
                flag_servicio = "D"
                proceso_cobross
            
            Else 'SI ES AUTOSERVICIO
   
                If Len(Trim(axcnumero)) > 0 Then
                    If Val(axctotal) < Val(rtxtotal) Then
                        MsgBox "Total a Cuenta no debe ser mayor que saldo ", 48, "Aviso"
                        Exit Sub

                    End If
        
                End If

                flag_servicio = "A"
                salon.Caption = ""
                mesa.Caption = ""
                mesero = ""
                cuenta_separa = ""
            
                '''' 17/07/2018 Factura de Exportación
                If busca_OpcionExportacion = "S" Then
                    xruc.MaxLength = "13"
            
                End If

                '''' 17/07/2018 Factura de Exportación
            
                proceso_cobross

            End If
        
        End If
   
        If Picture2.Visible = True Then

            'On Error GoTo cm89222_err
            If cmytablex.RecordCount = 0 Then Exit Sub
            If Me.Picture2.Visible = False Then Exit Sub
            'xopcioness_Click (16)
            buf = "Salon " & cmytablex.Fields("salon") '& Chr$("impuesto") & Chr$("neto")
    
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            'buf = buf & glomesa & " " & cmytablex.Fields(1)
            buf = buf & glomesa & " " & extra_loquesea(cmytablex.Fields(1))
            ' 25/07/2018 Delivery y Para Llevar desde mozo
    
            If MsgBox("Desea Cobrar " & buf, 1, "Cobrar Comanda ") <> 1 Then Exit Sub
            found = carga_comanda(0)

            If found = 0 Then
                MsgBox "No se Puede Cobrar,No existen Comandas ", 48, "Aviso"
                Exit Sub

            End If

            salon.Caption = "" & cmytablex.Fields("salon")
    
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            'mesa.Caption = "" & cmytablex.Fields(1)
            mesa.Caption = "" & extra_loquesea(cmytablex.Fields(1))
            ' 25/07/2018 Delivery y Para Llevar desde mozo
    
            'cproven = cmytablex.Fields("vendedor")
    
            flag_servicio = "C"
            'Label55_Click
            proceso_cobross
            Exit Sub

        End If
   
    End If

    If Index = 1 Then  'pago cash ya no es, ahora es pedido delivery
        dki3432_Click

        ''   If Len(Trim(axcnumero)) > 0 Then
        ''      If Val(axctotal) < Val(rtxtotal) Then
        ''      MsgBox "Total a Cuenta no debe ser mayor que saldo ", 48, "Aviso"
        ''      Exit Sub
        ''      End If
        ''   End If
        ''   proceso_cierre_automatico "1"
    End If

    If Index = 2 Then  'cuenta separada

        'On Error GoTo cm889222_err
        If cmytablex.RecordCount = 0 Then Exit Sub
        If Me.Picture2.Visible = False Then Exit Sub
        'xopcioness_Click (16)
   
        buf = "Salon " & cmytablex.Fields("salon")
   
        ' 25/07/2018 Delivery y Para Llevar desde mozo
        'buf = buf & glomesa & " " & cmytablex.Fields(1)  'mesa
        buf = buf & glomesa & " " & extra_loquesea(cmytablex.Fields(1))
        ' 25/07/2018 Delivery y Para Llevar desde mozo
    
        If MsgBox("Desea Cobrar " & buf, 1, "Cobrar Comanda ") <> 1 Then Exit Sub
        found = carga_comanda(1)

        If found = 0 Then
            MsgBox "No se Puede Cobrar,No existen Comandas ", 48, "Aviso"
            Exit Sub

        End If

        salon.Caption = cmytablex.Fields("salon")
    
        ' 25/07/2018 Delivery y Para Llevar desde mozo
        'mesa.Caption = cmytablex.Fields(1)
        mesa.Caption = extra_loquesea(cmytablex.Fields(1))
        ' 25/07/2018 Delivery y Para Llevar desde mozo
    
        flag_servicio = "C"
        'Label55_Click
        cuenta_separa = "S"
        proceso_cobross
        'cuenta_separa = ""
        Exit Sub
cm889222_err:
        MsgBox "Seleccione Salon Y Mesa ", 48, "Aviso"
        Exit Sub

    End If

    'inicio 21/04/2017 pll
    If Index = 3 Then 'cobra TORCIDO!

        '''27/10/2017 Correcion Venta Interna. Duplicidad de comprobantes
        DBGrid2.SetFocus
        xopciones(3).Enabled = False
        '''27/10/2017 Correcion Venta Interna. Duplicidad de comprobantes

        opcion1 = "FINAL"

        If Picture2.Visible = False Then  ' Cobro Para llevar Directo
            If Len(Trim(axcnumero)) > 0 Then
                If Val(axctotal) < Val(rtxtotal) Then
                    MsgBox "Total a Cuenta no debe ser mayor que saldo ", 48, "Aviso"
                    Exit Sub

                End If

            End If

            If Val(hknumero) < Val(rtxtotal) And Val(hknumero) > 0 Then
                MsgBox "Valores deben ser mayor de la venta ", 48, "Aviso"
                Exit Sub

            End If
        
            If hknumero.Caption = "" And Val(rtxtotal) <> 0 Then
                hknumero = Val(rtxtotal)

            End If
        
            cmdCobrar.Enabled = False
            proceso_cierre_ticket
            cmdCobrar.Enabled = True
            Picture4.Visible = False

        End If
  
        '''27/10/2017 Correcion Venta Interna. Duplicidad de comprobantes
        xopciones(3).Enabled = True
        '''27/10/2017 Correcion Venta Interna. Duplicidad de comprobantes

        If Picture2.Visible = True Then  ' Cobro de mesa seleccionada

            'On Error GoTo cm89222_err
            If cmytablex.RecordCount = 0 Then Exit Sub
            If Me.Picture2.Visible = False Then Exit Sub
            'xopcioness_Click (16)
   
            buf = "Salon " & cmytablex.Fields("salon")
    
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            'buf = buf & glomesa & " " & cmytablex.Fields(1)
            buf = buf & glomesa & " " & extra_loquesea(cmytablex.Fields(1))
            ' 25/07/2018 Delivery y Para Llevar desde mozo
     
            If Val(hknumero) < Val(table2.columns(2)) And Val(hknumero) > 0 Then
                MsgBox "Valores deben ser mayor de la venta ", 48, "Aviso"
                Exit Sub

            End If
        
            If MsgBox("Desea Cobrar " & buf, 1, "Cobrar Comanda ") <> 1 Then Exit Sub
            found = carga_comanda(0)

            If found = 0 Then
                MsgBox "No se Puede Cobrar,No existen Comandas ", 48, "Aviso"
                Exit Sub

            End If
    
            salon.Caption = "" & extra_loquesea(cmytablex.Fields("salon"))
    
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            'mesa.Caption = "" & cmytablex.Fields(1)
            mesa.Caption = "" & extra_loquesea(cmytablex.Fields(1))
            ' 25/07/2018 Delivery y Para Llevar desde mozo

            If hknumero.Caption = "" And Val(rtxtotal) <> 0 Then
                hknumero = Val(rtxtotal)

            End If

            flag_servicio = "C"
 
            proceso_cierre_ticket
            Picture4.Visible = False
            Exit Sub

        End If
    
    End If

    'fin 21/04/2017 pll

    If Index = 30 Then
        If xopciones(30).Caption = "NORMAL" Then
            xopciones(30).Caption = "CONSUMO"
        Else
            xopciones(30).Caption = "NORMAL"

        End If

    End If

End Sub

Private Sub xruc_DblClick()
    tkeyboar.FLAG = dicruc
    tkeyboar.Show 1

End Sub

Private Sub xruc_KeyPress(KeyAscii As Integer)

    Dim found As Integer

    If KeyAscii <> 13 Then Exit Sub
    If Len(pedido) > 0 Then
        xnombre.SetFocus
        Exit Sub

    End If

    If local1 = "PEDIDO" Then  'pedido a almacen
        If Len(xruc) = 0 Then
            xruc.SetFocus
            Exit Sub

        End If

        xnombre.SetFocus
        Exit Sub

    End If

    If acu = "B" Or acu = "D" Then
        If Len(xruc) = 0 Then
            xruc.SetFocus
            Exit Sub

        End If

        If Len(xruc) <> 11 Then
            xruc.SetFocus
            Exit Sub

        End If

        found = valida_ruc("" & xruc)

        If found = 0 Then
            MsgBox dicruc & " No Valido", 48, "Aviso"
            xruc = ""
            xruc.SetFocus
            Exit Sub

        End If

        'valida el ruc
    End If

    If Len(xruc) > 0 Then
        found = busca_codigocl("" & xruc, 1)

        If found = 0 Then

        End If

    End If

    If xtipo = "7" Then
        xnombre.SetFocus
        Exit Sub

    End If

    If "" & mytable11.Fields("cliente") = "S" Or acu = "A" Or acu = "B" Or acu = "D" Then
        xnombre.SetFocus
        Exit Sub

    End If

    Command13_Click

End Sub

Private Sub xruc_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        xvendedor.SetFocus
        Exit Sub

    End If

    If KeyCode = &H76 Then
        tnclie.DBPROV = "clientes"
        tnclie.fdlo893.Visible = True
        tnclie.Show 1
        Exit Sub

    End If

    If KeyCode = &H70 Then  'f1
        'If local1.Visible <> True Then
        consulta_xruc

        'End If
        '  If local1.Visible = True Then
        '   consulta_xruc2
        'End If
    End If

End Sub

Private Sub xserie_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then Exit Sub
    If Len(Trim(xserie)) = 0 Then
        MsgBox "Definir un numero de Serie ", 48, "Aviso"
        xserie.SetFocus
        Exit Sub

    End If

    xnumero.SetFocus

End Sub

Private Sub xserie_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        xdistrito.SetFocus
        Exit Sub

    End If

End Sub

Private Sub xtipo_DblClick()
    'If local1.Visible <> True Then  'si no es traslado
    consulta_xtipo

    '   End If
End Sub

Private Sub xtipo_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H70 Then  'f1
        'If local1.Visible <> True Then  'si no es traslado
        consulta_xtipo

        'End If
    End If

End Sub

Private Sub xvendedor_DblClick()
    consulta_xvendedor

End Sub

Private Sub xvendedor_KeyPress(KeyAscii As Integer)

    Dim found As Integer

    If KeyAscii <> 13 Then Exit Sub
    If Len(xvendedor) = 0 Then

        'xvendedor = gusuario
    End If

    If Len(xvendedor) > 0 Then
        found = busca_xvendedor()

        If found = 0 Then
            xvendedor = ""
            MsgBox "No existe Vendedor ", 48, "Aviso"
            xvendedor.SetFocus
            Exit Sub

        End If

    End If

    If flag_servicio = "D" Then

        'If Len(xvendedor) = 0 Then
        '   xvendedor.SetFocus
        '   Exit Sub
        'End If
    End If

    xruc.SetFocus

End Sub

Private Sub xvendedor_KeyUp(KeyCode As Integer, Shift As Integer)

    If KeyCode = &H26 Then
        'If sentido.Enabled = True Then
        '   If sentido.Visible = True Then
        '      sentido.SetFocus
        '      Exit Sub
        '   End If
        'End If
        xtipo.SetFocus
        Exit Sub

    End If

    If KeyCode = &H70 Then  'f1
        consulta_xvendedor

    End If

End Sub

Function busca_xtipo(buf As String, sw As Integer)

    Dim sdx      As Double

    Dim buf1     As String

    Dim mytablex As New ADODB.Recordset

    ntipox = ""
    buf1 = buf

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM tipo where  tipo='" & buf1 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        ntipox = "" & mytablex.Fields("descripcio")
        acu = "" & mytablex.Fields("tipodoc")
        busca_xtipo = 1

        If sw = 0 Then
            If "" & mytablex.Fields("tipodoc") = "Z" Then  'traslado
                'gocabeza = "factura"
                'godetalle = "detalle"
                'gofpago = "fpagov"
                xserie = "" & mytablex.Fields("serie")
                sdx = Val("" & mytablex.Fields("numero")) + 1
                xnumero = "" & sdx
                xserie.Enabled = True
                xnumero.Enabled = True

            End If

            If "" & mytablex.Fields("tipodoc") = "A" Then
                'gocabeza = "factura"
                'godetalle = "detalle"
                'gofpago = "fpagov"
                xserie = "" & mytable11.Fields("seriebm")
                sdx = Val("" & mytable11.Fields("numerobm")) + 1

                If Len(xnumero) = 0 Then
                    xnumero = "" & sdx

                End If

                xserie.Enabled = True
                xnumero.Enabled = True

            End If

            If "" & mytablex.Fields("tipodoc") = "B" Then
                xserie = "" & mytable11.Fields("serieFM")
                sdx = Val("" & mytable11.Fields("numeroFM")) + 1

                'xnumero = "" & sdx
                If Len(xnumero) = 0 Then
                    xnumero = "" & sdx

                End If

                xserie.Enabled = True
                xnumero.Enabled = True

            End If
      
            If "" & mytablex.Fields("tipodoc") = "C" Then
                xserie = "" & mytable11.Fields("serietb")
                sdx = Val("" & mytable11.Fields("numerotb")) + 1
                xnumero = "" & sdx
                xserie.Enabled = False
                xnumero.Enabled = False

            End If
      
            If "" & mytablex.Fields("tipodoc") = "1" Then
                xserie = "" & mytable11.Fields("serieexo")
                sdx = Val("" & mytable11.Fields("numeroexo")) + 1
                xnumero = "" & sdx
                xserie.Enabled = False
                xnumero.Enabled = False

            End If

            'nota de credito
            If "" & mytablex.Fields("tipodoc") = "E" Then 'nc
                xserie = "" & mytable11.Fields("serienc")
                sdx = Val("" & mytable11.Fields("numeronc")) + 1
                xnumero = "" & sdx
                xserie.Enabled = False
                xnumero.Enabled = False

            End If
      
            If "" & mytablex.Fields("tipodoc") = "D" Then
                'gocabeza = "factura"
                'godetalle = "detalle"
                'gofpago = "fpagov"
                xserie = "" & mytable11.Fields("serietf")
                sdx = Val("" & mytable11.Fields("numerotf")) + 1
                xnumero = "" & sdx
                xserie.Enabled = False
                xnumero.Enabled = False

            End If

            If "" & mytablex.Fields("tipodoc") = "G" Then
                'gocabeza = "factura"
                'godetalle = "detalle"
                'gofpago = "fpagov"
                xserie = "" & mytable11.Fields("serienv")
                sdx = Val("" & mytable11.Fields("numeronv")) + 1
                xnumero = "" & sdx
                xserie.Enabled = False
                xnumero.Enabled = False

            End If

            If "" & mytablex.Fields("tipodoc") = "N" Then   '
                'gocabeza = "factura"
                'godetalle = "detalle"
                'gofpago = "fpagov"
                xserie = "" & mytable11.Fields("serienc")
                sdx = Val("" & mytable11.Fields("numeronc")) + 1
                xnumero = "" & sdx
                xserie.Enabled = True
                xnumero.Enabled = True

            End If

            If "" & mytablex.Fields("tipodoc") = "F" Then
                'gocabeza = "factura"
                'godetalle = "detalle"
                'gofpago = "fpagov"
                xserie = "" & mytable11.Fields("seriend")
                sdx = Val("" & mytable11.Fields("numerond")) + 1
                xnumero = "" & sdx
                xserie.Enabled = True
                xnumero.Enabled = True

            End If

            'si es pedidos remotos
            If "" & mytablex.Fields("tipodoc") = "I" Then   'pedido a cuenta
                xserie = "" & mytable11.Fields("seriepe")
                sdx = Val("" & mytable11.Fields("numerope")) + 1
                xnumero = "" & sdx
                xserie.Enabled = True
                xnumero.Enabled = True

            End If

            If "" & mytablex.Fields("tipodoc") = "Q" Then  'pedido reposicion
                'gocabeza = "cpedidov"
                'godetalle = "dpedidov"
                'gofpago = "fpagov"
                xserie = "" & mytable11.Fields("caja")
                sdx = Val("" & mytable11.Fields("numerope")) + 1
                xnumero = "" & sdx
                xserie.Enabled = True
                xnumero.Enabled = True

            End If

        End If

    End If

vuelve1:
    mytablex.Close
 
End Function

Function busca_xvendedor()

    Dim mytablex As New ADODB.Recordset

    nvendedorx = ""

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM vendedor where  codigo='" & xvendedor & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        If "" & mytablex.Fields("esvendedor") = "N" Then
            MsgBox "Usuario No permitido para ser vendedor ", 48, "Aviso"
            mytablex.Close
            Exit Function

        End If

        nvendedorx = "" & mytablex.Fields("nombre")
        busca_xvendedor = 1

    End If

    mytablex.Close
 
End Function

Function busca_xtipog(buf As String)

    Dim sdx      As Double

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd7888_err

    'MsgBox buf
    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM tipo where  tipo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then  'si existe
        busca_xtipog = 1

        'MsgBox "" & mytablex.Fields("tipodoc")
        If "" & mytablex.Fields("tipodoc") = "Z" Then
            'mytablex.Edit
            mytablex.Fields("numero") = xnumero
            'mytablex.Fields("uvueltos") = Val(stxtotals)
            'mytablex.Fields("uvueltod") = Val(stxtotald)
            mytablex.Update

        End If

        If "" & mytablex.Fields("tipodoc") = "1" Then  'exonerado

            'mytable11.Edit
            If Val(tdetra) > 0 Then
                mytable11.Fields("detraccion") = Val(ndetraccion)

            End If

            mytable11.Fields("numeroexo") = xnumero
            mytable11.Fields("uvueltos") = Val(stxtotals)
            mytable11.Fields("uvueltod") = Val(stxtotald)
            mytable11.Update

        End If
      
        If "" & mytablex.Fields("tipodoc") = "E" Then  'NC

            'mytable11.Edit
            If Val(tdetra) > 0 Then
                mytable11.Fields("detraccion") = Val(ndetraccion)

            End If

            mytable11.Fields("numeronc") = xnumero
            mytable11.Fields("uvueltos") = Val(stxtotals)
            mytable11.Fields("uvueltod") = Val(stxtotald)
            mytable11.Update

        End If
      
        If "" & mytablex.Fields("tipodoc") = "A" Then
            'mytable11.Edit
            'If Val(tdetra) > 0 Then
            'mytable11.Fields("detraccion") = Val(ndetraccion)
            'End If
            mytable11.Fields("numerobm") = xnumero
            mytable11.Fields("uvueltos") = Val(stxtotals)
            mytable11.Fields("uvueltod") = Val(stxtotald)
            mytable11.Update

        End If

        If "" & mytablex.Fields("tipodoc") = "B" Then
            'mytablex.Edit
            mytable11.Fields("numerofm") = xnumero
            'mytable11.Update
            'mytable11.Edit
            'If Val(tdetra) > 0 Then
            'mytable11.Fields("detraccion") = Val(ndetraccion)
            'End If
            mytable11.Fields("uvueltos") = Val(stxtotals)
            mytable11.Fields("uvueltod") = Val(stxtotald)
            mytable11.Update

        End If

        If "" & mytablex.Fields("tipodoc") = "C" Then

            'mytable11.Edit
            If Val(tdetra) > 0 Then
                mytable11.Fields("detraccion") = Val(ndetraccion)

            End If

            mytable11.Fields("numerotb") = xnumero
            mytable11.Fields("uvueltos") = Val(stxtotals)
            mytable11.Fields("uvueltod") = Val(stxtotald)
            mytable11.Update

        End If

        If "" & mytablex.Fields("tipodoc") = "D" Then
            'mytable11.Edit
            'If Val(tdetra) > 0 Then
            'mytable11.Fields("detraccion") = Val(ndetraccion)
            'End If
            mytable11.Fields("numerotf") = xnumero
            mytable11.Fields("uvueltos") = Val(stxtotals)
            mytable11.Fields("uvueltod") = Val(stxtotald)

            If Val(ndetraccion) > 0 Then
                mytable11.Fields("detraccion") = Val(ndetraccion)

            End If

            mytable11.Update

        End If

        If "" & mytablex.Fields("tipodoc") = "G" Then
            'mytable11.Edit
            'If Val(tdetra) > 0 Then
            'mytable11.Fields("detraccion") = Val(ndetraccion)
            'End If
            mytable11.Fields("numeronv") = xnumero
            mytable11.Fields("uvueltos") = Val(stxtotals)
            mytable11.Fields("uvueltod") = Val(stxtotald)

            If Val(ndetraccion) > 0 Then
                mytable11.Fields("detraccion") = Val(ndetraccion)

            End If

            mytable11.Update

        End If

        If "" & mytablex.Fields("tipodoc") = "N" Then   '
            'mytable11.Edit
            'If Val(tdetra) > 0 Then
            'mytable11.Fields("detraccion") = Val(ndetraccion)
            'End If
            mytable11.Fields("numeronc") = xnumero
            mytable11.Fields("uvueltos") = Val(stxtotals)
            mytable11.Fields("uvueltod") = Val(stxtotald)
            mytable11.Update

        End If

        If "" & mytablex.Fields("tipodoc") = "F" Then
            'mytable11.Edit
            'If Val(tdetra) > 0 Then
            'mytable11.Fields("detraccion") = Val(ndetraccion)
            'End If
            mytable11.Fields("numerond") = xnumero
            mytable11.Fields("uvueltos") = Val(stxtotals)
            mytable11.Fields("uvueltod") = Val(stxtotald)
            mytable11.Update

        End If

        If "" & mytablex.Fields("tipodoc") = "I" Then
            'MsgBox "x"
            'mytable11.Edit
            'If Val(tdetra) > 0 Then
            'mytable11.Fields("detraccion") = Val(ndetraccion)
            'End If
            mytable11.Fields("numerope") = xnumero
            mytable11.Fields("uvueltos") = Val(stxtotals)
            mytable11.Fields("uvueltod") = Val(stxtotald)
            mytable11.Update

        End If

        If "" & mytablex.Fields("tipodoc") = "Q" Then
            'MsgBox "x"
            'mytable11.Edit
            'If Val(tdetra) > 0 Then
            'mytable11.Fields("detraccion") = Val(ndetraccion)
            'End If
            mytable11.Fields("numerope") = xnumero
            mytable11.Fields("uvueltos") = Val(stxtotals)
            mytable11.Fields("uvueltod") = Val(stxtotald)
            mytable11.Update

        End If

    End If

    mytablex.Close
    Exit Function
cmd7888_err:
    MsgBox "Error busa_xtipog " + error$, 48, "Aviso"
    Exit Function

End Function

Function valida_total()

    Dim found As Integer

    If Len(xtipo) = 0 Then
        xtipo.SetFocus
        Exit Function

    End If

    '------------------------------------------------
    'MsgBox Local1
    If local1 = "PEDIDO" Then 'si es pedido almacen
        If xtipo <> "Q" Then
            xtipo = "Q"
            xtipo.SetFocus
            Exit Function

        End If

        found = busca_xtipo("" & xtipo, 0)

        If found = 0 Then
            xtipo = ""
            MsgBox "No existe Tipo Documento", 48, "Aviso"
            xtipo.SetFocus
            Exit Function

        End If

        found = busca_xvendedor()

        If found = 0 Then
            xvendedor = ""
            MsgBox "No existe Vendedor ", 48, "Aviso"
            xvendedor.SetFocus
            Exit Function

        End If

        'If Len(xruc) = 0 Then
        '   xruc.SetFocus
        '   Exit Function
        'End If
        valida_total = 1
        Exit Function

    End If

    '------------------------------------------------

    found = valida_tipo_pago("" & xtipo)

    If found = 0 Then
        MsgBox "No permitido ", 48, "Aviso"
        xtipo.SetFocus
        Exit Function

    End If

    found = busca_xtipo("" & xtipo, 0)

    If found = 0 Then
        xtipo = ""
        MsgBox "No existe Tipo Documento", 48, "Aviso"
        xtipo.SetFocus
        Exit Function

    End If

    If ot = "S" And Len(petipo) = 0 Then
        If xtipo <> "" & mytable11.Fields("tipope") Then
            MsgBox "Tipo documento admitido,solamente,Pedidos", 48, "Aviso"
            xtipo = "" & mytable11.Fields("tipope")
            xtipo.SetFocus
            Exit Function

        End If

    End If

    'MsgBox "abc"
    'If sentido.Enabled = True Then
    '   If sentido <> "S" And sentido <> "B" Then
    '      sentido = ""
    '      If sentido.Visible = True Then
    '         sentido.SetFocus
    '      End If
    '      Exit Function
    '   End If
    'End If
    'MsgBox "abc"
    If Len(xvendedor) > 0 Then
        found = busca_xvendedor()

        If found = 0 Then
            xvendedor = ""
            MsgBox "No existe Vendedor ", 48, "Aviso"
            xvendedor.SetFocus
            Exit Function

        End If

    End If

    'MsgBox "abc"
    If "" & mytable11.Fields("vendedor") = "S" Then
        If Len(xvendedor) = 0 Then
            'inicio 21/04/2017 pll consistencia vendedor
            'xvendedor.SetFocus
            MsgBox "Falta Ingresar Datos del vendedor", 48, "Aviso"
            consulta_xvendedor
            'inicio 21/04/2017 pll consistencia vendedor
            Exit Function

        End If

    End If

    If Len(Trim(fechae)) > 0 Then
        If Not IsDate(fechae) Then
            MsgBox "Debe Poner Fecha Entrega ", 48, "Aviso"
            fechae = Format(Now, "dd/mm/yyyy")
            fechae.SetFocus
            Exit Function

        End If

    End If

    If flag_servicio = "D" Then  'validar el deliveri si ingreso datos

        'If Len(xvendedor) = 0 Then
        '    xvendedor.SetFocus
        '    Exit Function
        ' End If
    End If

    If xtipo = "7" Then
        If Len(xnombre) = 0 Then
            xnombre.SetFocus
            Exit Function

        End If

        If Len(xdistrito) = 0 Then
            xdistrito.SetFocus
            Exit Function

        End If

    End If

    If "" & mytable11.Fields("cliente") = "S" Then

        'If xtipo = "2" Or xtipo = "4" Then
        '   If Len(xruc) = 0 Then
        '      xruc.SetFocus
        '      Exit Function
        '   End If
        '   If Len(xnombre) = 0 Then
        '      xnombre.SetFocus
        '      Exit Function
        '   End If
        'End If
    End If

    'MsgBox "abc"
    If acu = "I" Then  'si es pedido ORDEN TRABAJO
        If Len(xvendedor) = 0 Then
            xvendedor.SetFocus
            Exit Function

        End If

        'If Len(xruc) = 0 Then
        '   xruc.SetFocus
        '   Exit Function
        'End If
        If Len(xnombre) = 0 Then
            xnombre.SetFocus
            Exit Function

        End If

        If Len(fechae) = 0 Then
            MsgBox "Debe Poner Fecha Entrega ", 48, "Aviso"
            fechae = Format(Now, "dd/mm/yyyy")
            fechae.SetFocus
            Exit Function

        End If

        If Len(Trim(fechae)) > 0 Then
            If Not IsDate(fechae) Then
                MsgBox "Debe Poner Fecha Entrega ", 48, "Aviso"
                fechae = Format(Now, "dd/mm/yyyy")
                fechae.SetFocus
                Exit Function

            End If

        End If

        If valida_hora(horaentrega) <> 1 Then
            horaentrega = Format(Now, "hh:mm:ss")
            horaentrega.SetFocus
            Exit Function

        End If

        valida_total = 1
        Exit Function

    End If

    If acu = "B" Or acu = "D" Then
        If Len(xruc) = 0 Then
            xruc.SetFocus
            Exit Function

        End If

        'If Len(xruc) <> 11 Then
        '   xruc.SetFocus
        '   Exit Function
        'End If
        found = valida_ruc("" & xruc)

        If found = 0 Then
            MsgBox dicruc & " No Valido", 48, "Aviso"
            xruc = ""
            xruc.SetFocus
            Exit Function

        End If

        'valida el ruc
    End If

    'MsgBox "abc"

    '''' 17/07/2018 Factura de Exportación
    'If busca_OpcionExportacion = "N" Then
    If Len(xruc) > 0 Then
        found = busca_codigocl("" & xruc, 1)

        If acu = "B" Or acu = "D" Then

        End If

    End If

    'End If
    '''' 17/07/2018 Factura de Exportación

    '990322082   sra nancy

    'inicio 02/02/2018 pll comprobantes electronicos
    If Frame7.Visible = True Then
        If Len(xruc) = 0 And xtipo = "1" And Val(rtxtotal) >= 700 Then
            MsgBox "Escribe Codigo -> DNI Nombre Direccion"
            Exit Function

        End If

    End If

    'fin 02/02/2018 pll

    If Len(Trim(xserie)) = 0 Then
        MsgBox "Necesita un Numero de Serie,Avisar Adm para configurar ", 48, "Aviso"
        xtipo.SetFocus
        Exit Function

    End If

    valida_total = 1

End Function

Function graba_fpagov(bxtipo As String, bxserie As String, bxnumero As String)

    Dim xbuf     As String

    Dim mytabley As New ADODB.Recordset

    Dim mytablex As Table

    Dim found    As Integer

    On Error GoTo cdm4411_err

    '---------- validando si es cuenta corriente
    'If mytablex.State = 1 Then mytablex.Close
    'mytablex.Open "SELECT * FROM " & fpusuario, cn, adOpenDynamic, adLockOptimistic
    'If mytablex.RecordCount = 0 Then  'si no existe
    '   mytablex.Close
    '   Exit Function
    'End If
amk223:
    mytabley.Open "SELECT * FROM " & gofpago & " where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & bxtipo & "' and serie='" & bxserie & "' and numero='" & bxnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytabley.RecordCount > 0 Then  'si existe
        mytabley.Delete
        GoTo amk223

    End If

    'mytabley.Open "SELECT * FROM " & gofpago, cn, adOpenDynamic, adLockOptimistic
    'If mytabley.RecordCount = 0 Then  'si no existe
    '   mytabley.Close
    '   Exit Function
    'End If
    'mytablez.Open "SELECT * FROM cuentac ", cn, adOpenDynamic, adLockOptimistic
    'If mytablez.RecordCount = 0 Then  'si no existe
    '   mytablez.Close
    '   Exit Function
    'End If

    xbuf = "antes:" & Format(Now, "hh:mm:ss")

    Set mytablex = mydbxglo.OpenTable(fpusuario)
    'Set mytabley = mydbxglo.OpenTable(gofpago)
    'Set mytablez = mydbxglo.OpenTable("cuentac")
    'mytabley.Index = "fpagov"
    Do

        If mytablex.EOF Then Exit Do
        If Len("" & mytablex.Fields("fpago")) > 0 Then
            mytabley.AddNew
            grabar_registro_fpagov mytablex, mytabley 'inicio 22/11/2017 pll para el credito <--no lo hecho pero digo para que sirve
            mytabley.Update

            If "" & mytabley.Fields("acufp") = "V" Then
                graba_acumulado_clientes mytabley, 1, Val("" & mytabley.Fields("recibe"))

            End If

        End If

        mytablex.MoveNext
    Loop

    If Len(petipo) > 0 And Len(peserie) > 0 And Len(penumero) > 0 Then
        mytabley.AddNew
        found = forma_pago_adicional(mytabley)
        mytabley.Update

    End If

    'xbuf = xbuf & "despues:" & Format(Now, "hh:mm:ss")
    'sgBox xbuf
    mytablex.Close
    mytabley.Close
    'mytablez.Close
    Exit Function
cdm4411_err:
    MsgBox "Error en graba_fpagov " + error$, 48, "Aviso"
    Exit Function

End Function

Sub grabar_registro_fpagov(mytablex As Table, mytabley As ADODB.Recordset)

    On Error GoTo cmd2008_err

    mytabley.Fields("vendedor") = xvendedor
    mytabley.Fields("paridad") = Val("" & paridadfp)
    mytabley.Fields("codigo") = "" & mytablex.Fields("codigo")
    mytabley.Fields("nombre") = "" & mytablex.Fields("nombre")
    mytabley.Fields("tipo") = "" & xtipo
    mytabley.Fields("serie") = "" & xserie
    mytabley.Fields("numero") = "" & xnumero
    mytabley.Fields("tipoclie") = "C"
   
    If Len(Trim("" & mytablex.Fields("codigo"))) = 0 Then
        mytabley.Fields("codigo") = "" & xruc

    End If

    If Len(Trim("" & mytablex.Fields("nombre"))) = 0 Then
        mytabley.Fields("nombre") = "" & xnombre

    End If

    mytabley.Fields("fecha") = Format("" & dia, "dd/mm/yyyy")
    mytabley.Fields("moneda") = "" & mytablex.Fields("moneda")
    mytabley.Fields("total") = Val(ttxtotals)
    mytabley.Fields("caja") = "" & caja
    mytabley.Fields("turno") = "" & turno
    mytabley.Fields("usuario") = "" & cajero
    'mytabley.Fields("vendedor") = "" & cajero
   
    mytabley.Fields("total") = Val("" & mytablex.Fields("total"))
    mytabley.Fields("cambio") = Val("" & mytablex.Fields("cambio"))
    mytabley.Fields("recibe") = Val("" & mytablex.Fields("recibe"))
    mytabley.Fields("recibes") = Val("" & mytablex.Fields("recibes"))
    mytabley.Fields("recibed") = Val("" & mytablex.Fields("recibed"))
    mytabley.Fields("saldos") = Val("" & mytablex.Fields("saldos"))
    mytabley.Fields("saldod") = Val("" & mytablex.Fields("saldod"))
   
    'mytabley.Fields("nombre") = "" & mytablex.Fields("nombre")
    mytabley.Fields("orden") = "" & mytablex.Fields("orden")
    mytabley.Fields("observa") = "" & mytablex.Fields("observa")

    '''06/08/2017 kenyo Testing Completo al Sistema
    'mytabley.Fields("dias") = "" & mytablex.Fields("dias")
    If fechae > "" & mytabley.Fields("fecha") Then
        mytabley.Fields("dias") = DateDiff("d", "" & mytabley.Fields("fecha"), fechae)
    Else
        mytabley.Fields("dias") = "" & mytablex.Fields("dias")

    End If

    '''06/08/2017 kenyo Testing Completo al Sistema

    mytabley.Fields("fpago") = "" & mytablex.Fields("fpago")
   
    mytabley.Fields("acufp") = busca_fpago("" & mytablex.Fields("fpago"))
   
    mytabley.Fields("descripcio") = "" & mytablex.Fields("descripcio")
    mytabley.Fields("acu") = "" & acu
   
    mytabley.Fields("local") = Trim("" & mytable11.Fields("local"))

    If "" & mytable11.Fields("terminal") = "T" Then

        'mytabley.Fields("acu") = "I"
    End If

    mytabley.Fields("servicio") = flag_servicio

    If flag_servicio = "A" Then
        mytabley.Fields("servicio") = "A"

    End If

    If flag_servicio = "D" Then
        mytabley.Fields("servicio") = "D"

    End If

    If flag_servicio = "C" Then
        mytabley.Fields("servicio") = "C"
      
        '24/08/2018  Delivery por mesa
        If V_EstadoMesa = "D" Then
            mytabley.Fields("servicio") = "D"

        End If

        '24/08/2018  Delivery por mesa
            
    End If
   
    mytabley.Fields("estado") = "2"

    'If "" & mytabley.Fields("acu") = "A" Or "" & mytabley.Fields("acu") = "B" Or "" & mytabley.Fields("acu") = "C" Or "" & mytablex.Fields("acu") = "D" Or "" & mytablex.Fields("acu") = "G" Then  'credito
    If "" & mytablex.Fields("acu") = "C" Then   'credito
         
        '19/06/2017 kenyo NOTA DE CREDITO
        '   graba_credito mytablex, mytabley
        
        If xtipo <> "N" Then ' es diferente a nota de credito
            graba_credito mytablex, mytabley 'inicio 22/11/2017 pll graba credito --> no lo he hecho pero digo para que sirve

        End If

        '19/06/2017 kenyo NOTA DE CREDITO
        
    End If

    If "" & mytablex.Fields("acu") = "I" Or "" & mytablex.Fields("acu") = "K" Then     'ORDEN DE TRABAJO/DEPOSITO/BANCO
        graba_credito2 mytabley, "" & mytablex.Fields("acu")

    End If

    If "" & mytablex.Fields("acu") = "K" Then   'si es deposito a banco

        'graba_deposito mytabley
    End If

    If "" & mytablex.Fields("acu") = "D" Or "" & mytablex.Fields("acu") = "F" Then   'si tarjeta credito o debito

        'graba_tarjetas mytabley
    End If

    If xxacu = "I" Then
        mytabley.Fields("acu") = xxacu

    End If

    If xtipo = "7" Then
        mytabley.Fields("total") = 0
        mytabley.Fields("cambio") = 0
        mytabley.Fields("recibe") = 0
        mytabley.Fields("recibes") = 0
        mytabley.Fields("recibed") = 0
        mytabley.Fields("saldos") = 0
        mytabley.Fields("saldod") = 0

    End If

    mytabley.Fields("flage") = "V"
   
    Exit Sub
cmd2008_err:
    MsgBox "Aviso en grabar_registro_fpagov " + error$, 48, "Aviso"
    Exit Sub

End Sub

Function busca_fpago(buf As String) As String

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM fpago where   fpago='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        busca_fpago = "" & mytablex.Fields("tipo")

    End If

    '------------------------------------- ------------
    mytablex.Close

End Function

Function ver_si_puedo_dbgrid(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM precios where producto='" & buf & "' and local='" & "" & mytable11.Fields("listap") & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.EOF = True Or mytablex.BOF = True Then
        mytablex.Close
        Exit Function

    End If

    If "" & Len("" & mytablex.Fields("unidad1")) > 0 Then
        If "" & Len("" & mytablex.Fields("unidad2")) > 0 Then
            ver_si_puedo_dbgrid = 1

        End If

    End If

    mytablex.Close

End Function

Sub menu_anula1()

    Dim found As Integer

    Frame1.Visible = True
    Frame1.Enabled = True
    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    buffer = ""
    opcion1 = "100"
    sw_consulta = 0
    found = sql_consulta(1)
    'dbGrid1.SetFocus

End Sub

Sub menu_copia()

    Dim found As Integer

    Dim buf   As String

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0

    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "15"
    sw_consulta = 0
    found = sql_consulta(1)

    'dbGrid1.SetFocus
End Sub

Sub menu_proforma()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "1900"
    sw_consulta = 0
    found = sql_consulta(1)

    'dbGrid1.SetFocus
End Sub

Function proceso_anular(ytipo As String, yserie As String, ynumero As String)

    Dim mytablex As New ADODB.Recordset

    Dim mytabley As New ADODB.Recordset

    On Error GoTo cmd_4356

    Dim found As Integer
   
    cn.Execute ("update " & gocabeza & " set estado='1' where local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & ytipo & "' and serie='" & yserie & "' and numero='" & ynumero & "'")
    cn.Execute ("update " & godetalle & " set estado='1' where local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & ytipo & "' and serie='" & yserie & "' and numero='" & ynumero & "'")
    cn.Execute ("update " & gofpago & " set estado='1' where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & ytipo & "' and serie='" & yserie & "' and numero='" & ynumero & "'")
    mytablex.Open "SELECT * FROM " & godetalle & " where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & ytipo & "' and serie='" & yserie & "' and numero='" & ynumero & "'", cn, adOpenStatic, adLockOptimistic  'adOpenDynamic

    If mytablex.RecordCount > 0 Then 'si existe
        found = descarga_saldo("" & mytable11.Fields("local"), mytablex, ytipo, yserie, ynumero, 1, 1)

    End If

    mytablex.Close
    mytablex.Open "SELECT * FROM " & gofpago & " where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & ytipo & "' and serie='" & yserie & "' and numero='" & ynumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        Do

            If mytablex.EOF Then Exit Do
            If "" & mytablex.Fields("acufp") = "V" Then
                graba_acumulado_clientes mytablex, -1, Val("" & mytablex.Fields("recibe"))

            End If

            found = borra_credito(ytipo, yserie, ynumero)
            desgraba_deposito mytablex
            mytablex.MoveNext
        Loop

    End If

    mytablex.Close
    '-------reversa orden trabajo
    'MsgBox gocabeza
    mytabley.Open "SELECT * FROM " & gocabeza & " where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & ytipo & "' and serie='" & yserie & "' and numero='" & ynumero & "'", cn, adOpenStatic, adLockOptimistic  'adOpenDynamic

    If mytabley.RecordCount > 0 Then
        cn.Execute ("update hotelcheckin set estado1='0' where checkin=" & Val(mytabley.Fields("PLACA")))
        cn.Execute ("update hotelcheckin set estado='0' where estado='2' and checkin=" & Val(mytabley.Fields("PLACA")))
      
        'MsgBox Trim("" & mytabley.Fields("tipo1"))
        If Trim("" & mytabley.Fields("tipo1")) = "RE" Then  'si es reserva
            '-----------------------------
            mytablex.Open "SELECT * FROM reserva where  reserva=" & Trim("" & mytabley.Fields("numero1")) & "", cn, adOpenDynamic, adLockOptimistic

            If mytablex.RecordCount > 0 Then  'si existe
                'MsgBox "abc"
                mytablex.Fields("abono") = Val("" & mytablex.Fields("abono")) - Val("" & mytabley.Fields("total"))
                mytablex.Fields("saldo") = Val("" & mytablex.Fields("total")) - Val("" & mytablex.Fields("abono"))
                mytablex.Update

            End If

            mytablex.Close
            GoTo cossio

            '-----------------------------
        End If

        If Trim("" & mytabley.Fields("tipo1")) = "CK" Then  'si es reserva
            '-----------------------------
            mytablex.Open "SELECT * FROM checkin where  checkin=" & Trim("" & mytabley.Fields("numero1")) & "", cn, adOpenDynamic, adLockOptimistic

            If mytablex.RecordCount > 0 Then  'si existe
                'MsgBox "abc"
                mytablex.Fields("abono") = Val("" & mytablex.Fields("abono")) - Val("" & mytabley.Fields("total"))
                mytablex.Fields("saldo") = Val("" & mytablex.Fields("total")) - Val("" & mytablex.Fields("abono"))
                mytablex.Update

            End If
      
            mytablex.Close
            GoTo cossio

            '-----------------------------
        End If
      
        mytablex.Open "SELECT * FROM cpedidov where  local='" & Trim("" & mytabley.Fields("local")) & "' and tipo='" & Trim("" & mytabley.Fields("tipo1")) & "' and serie='" & Trim("" & mytabley.Fields("serie1")) & "' and numero='" & Trim("" & mytabley.Fields("numero1")) & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then  'si existe
            'MsgBox "abc"
            mytablex.Fields("acuenta") = Val("" & mytablex.Fields("acuenta")) - Val("" & mytabley.Fields("total"))
            'mytablex.Fields("saldo") = Val("" & mytablex.Fields("total")) - Val("" & mytablex.Fields("acuenta"))
            mytablex.Update

        End If

        mytablex.Close

    End If

cossio:
    mytabley.Close
    reversa_guia_mensual "" & mytable11.Fields("local"), ytipo, yserie, ynumero
    proceso_anular = 1
    Exit Function
cmd_4356:
    MsgBox "Aviso en proceso anula " + error$, 48, "Aviso"
    Exit Function

End Function

Function graba_cliente_credito1(buf As String)

    Dim mytablex As New ADODB.Recordset

    If Len(buf) = 0 Then Exit Function
    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM clientes where  codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then 'si existe
        mytablex.AddNew
        mytablex.Fields("codigo") = "" & tcampo1
        mytablex.Fields("nombre") = "" & tcampo2
        mytablex.Update

    End If

    mytablex.Close

End Function

Function graba_cliente_tipo(buf As String)

    Dim mytablex  As New ADODB.Recordset

    Dim mytabley  As New ADODB.Recordset

    Dim sdx       As Double

    Dim buf1      As String

    Dim codigogen As String

    On Error GoTo cmdd7812_err

    If Len(xruc) = 0 And Len(xnombre) > 0 Then 'no no tiene codigo
        mytablex.Open "select * from parame where codigo='01'", cn, adOpenStatic, adLockOptimistic

        If mytablex.RecordCount = 0 Then
            mytablex.Close
            Exit Function

        End If

        sdx = Val("" & mytablex.Fields("clientes")) + 1
        codigogen = "" & sdx
        mytablex.Close
sigueb1:
        mytablex.Open "select * from clientes where codigo='" & codigogen & "'", cn, adOpenStatic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            mytablex.Close
            sdx = sdx + 1
            codigogen = "" & sdx
            GoTo sigueb1

        End If

        xruc = codigogen
        mytablex.AddNew
        mytablex.Fields("codigo") = "" & xruc
        mytablex.Fields("tipo") = "O"
        mytablex.Fields("nombre") = "" & xnombre
        mytablex.Fields("direccion") = "" & xdireccion
        mytablex.Fields("correo") = Trim("" & correo)
        mytablex.Fields("estado") = "A"
        mytablex.Fields("moneda") = "S"
        mytablex.Update
        xruc = "" & mytablex.Fields("codigo")
        'codigo = "" & mytablex.Fields("codigo")
        'nombre = "" & mytablex.Fields("nombre")
        mytablex.Close
        Exit Function

    End If

    If Len(xruc) > 0 And Len(xnombre) > 0 Then
        mytablex.Open "SELECT * FROM clientes  where  codigo='" & xruc & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            mytablex.Fields("nombre") = Trim("" & xnombre)

            If Len(Trim("" & xdireccion)) > 0 Then
                mytablex.Fields("direccion") = Trim("" & xdireccion)

            End If

            If Len(Trim("" & correo)) > 0 Then
                mytablex.Fields("correo") = Trim("" & correo)

            End If

            mytablex.Update
        Else
            mytablex.AddNew
            mytablex.Fields("nombre") = "" & xnombre
            mytablex.Fields("codigo") = "" & xruc

            If xtipo = "2" Or xtipo = "4" Then
                mytablex.Fields("tipo") = "J"
            Else
                mytablex.Fields("tipo") = "O"

            End If

            If Len("" & xdireccion) > 0 Then
                mytablex.Fields("direccion") = "" & xdireccion

            End If

            If Len(Trim("" & correo)) > 0 Then
                mytablex.Fields("correo") = Trim("" & correo)

            End If

            mytablex.Update

        End If

        mytablex.Close

    End If

    Exit Function
cmdd7812_err:
    MsgBox "Aviso en graba cliente tipo " + error$, 48, "Aviso"
    Exit Function
  
End Function

Function graba_credito(mytabley As Table, mytablez As ADODB.Recordset)

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd6712121_err

    'MsgBox ""
    mytablex.Open "SELECT * FROM cuentac where local='" & Trim("" & mytablez.Fields("local")) & "' and tipo='" & Trim("" & mytablez.Fields("tipo")) & "' and serie='" & Trim("" & mytablez.Fields("serie")) & "' and numero='" & Trim("" & mytablez.Fields("numero")) & "' and cuota='1'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then  'si no existe
        mytablex.AddNew
        mytablex.Fields("grupo") = "C"
        'MsgBox ""
        mytablex.Fields("acu") = "" & acu
        mytablex.Fields("observa") = Mid$("" & mytabley.Fields("descripcio"), 1, 30)
        mytablex.Fields("fpago") = "" & mytablez.Fields("acufp")
        mytablex.Fields("tipo") = "" & mytablez.Fields("tipo")
        mytablex.Fields("serie") = "" & mytablez.Fields("serie")
        mytablex.Fields("numero") = "" & mytablez.Fields("numero")
   
        '''27/07/2017 kenyo Testing Completo al Sistema
        ' mytablex.Fields("dias") = Val("" & mytabley.Fields("dias"))
        If fechae > "" & mytablez.Fields("fecha") Then
            mytablex.Fields("dias") = DateDiff("d", "" & mytablez.Fields("fecha"), fechae)
        Else
            mytablex.Fields("dias") = Val("" & mytablez.Fields("dias"))

        End If

        '''27/07/2017 kenyo Testing Completo al Sistema
   
        mytablex.Fields("cuota") = "1"
        mytablex.Fields("tipoclie") = "C"
        mytablex.Fields("codigo") = "" & mytablez.Fields("codigo")
        mytablex.Fields("nombre") = "" & mytablez.Fields("nombre")
        'MsgBox ""
        mytablex.Fields("fecha") = Format("" & mytablez.Fields("fecha"), "dd/mm/yyyy")
        mytablex.Fields("fechav") = Format("" & mytablez.Fields("fecha") + Val("" & mytabley.Fields("dias")), "dd/mm/yyyy")
        'MsgBox "1"
        mytablex.Fields("moneda") = "" & mytabley.Fields("moneda")
        mytablex.Fields("total") = Val("" & mytabley.Fields("recibe"))
        mytablex.Fields("abono") = 0
        mytablex.Fields("interes") = 0
        mytablex.Fields("saldo") = Val("" & mytabley.Fields("recibe"))
        'mytablex.Fields("c1") = Val("" & mytablez.Fields("c1"))
        'mytablex.Fields("c2") = Val("" & mytablez.Fields("c2"))
        'mytablex.Fields("c3") = Val("" & mytablez.Fields("c3"))
        'mytablex.Fields("c4") = Val("" & mytablez.Fields("c4"))
        'mytablex.Fields("c5") = Val("" & mytablez.Fields("c5"))
        'mytablex.Fields("c6") = Val("" & mytablez.Fields("c6"))
        'mytablex.Fields("c7") = Val("" & mytablez.Fields("c7"))
        'mytablex.Fields("c8") = Val("" & mytablez.Fields("c8"))
        'mytablex.Fields("c9") = Val("" & mytablez.Fields("c9"))
        mytablex.Fields("estado") = "0"
        mytablex.Fields("vendedor") = xvendedor
        mytablex.Fields("usuario") = cajero
        mytablex.Fields("caja") = caja
        mytablex.Fields("turno") = turno
        mytablex.Fields("zona") = ""
        mytablex.Fields("local") = "" & mytable11.Fields("local")
        mytablex.Update

    End If

    mytablex.Close
    Exit Function
cmd6712121_err:
    MsgBox "Aviso en Graba Credito " + error$, 48, "Aviso"
    Exit Function

End Function

Function graba_credito2(mytablez As ADODB.Recordset, buf As String) 'adelantos

    Dim mytablex As New ADODB.Recordset

    Dim mytabley As New ADODB.Recordset

    Dim sdx      As Double

    Dim sdx1     As Double

    Dim buf1     As String

    If buf = "I" Then
        buf1 = "A"

    End If

    If buf = "K" Then
        buf1 = "D"

    End If

    sdx = Val("" & mytablez.Fields("total"))
    mytabley.Open "SELECT * FROM cuentacd ", cn, adOpenDynamic, adLockOptimistic

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM cuentac where  tipoclie='C' and codigo='" & Trim("" & mytablez.Fields("codigo")) & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then 'si existe
        mytablex.Close
        Exit Function

    End If

    Do

        If mytablex.EOF Then Exit Do
        If "" & mytablex.Fields("grupo") = buf1 Then
            If Val("" & mytablex.Fields("saldo")) > 0 Then

                '------------------------------------------------
                If sdx > 0 Then
                    If Val("" & mytablex.Fields("saldo")) > sdx Then
                        'mytablex.Edit
                        graba_tmpcta mytablez, mytablex, mytabley, sdx
                        mytablex.Fields("abono") = Val("" & mytablex.Fields("abono")) + sdx
                        mytablex.Fields("saldo") = Val("" & mytablex.Fields("total")) + Val("" & mytablex.Fields("interes")) - Val("" & mytablex.Fields("abono"))
                        mytablex.Update
                        Exit Do

                    End If

                    If Val("" & mytablex.Fields("saldo")) <= sdx Then
                        'mytablex.Edit
                        sdx = sdx - Val("" & mytablex.Fields("saldo"))
                        graba_tmpcta mytablez, mytablex, mytabley, Val("" & mytablex.Fields("saldo"))
                        mytablex.Fields("abono") = Val("" & mytablex.Fields("abono")) + Val("" & mytablex.Fields("saldo"))
                        mytablex.Fields("saldo") = Val("" & mytablex.Fields("total")) + Val("" & mytablex.Fields("interes")) - Val("" & mytablex.Fields("abono"))
                        mytablex.Update

                    End If

                End If

                '------------------------------------------------
            End If

        End If

        mytablex.MoveNext
    Loop

End Function

Function anula_tmpcta(mytabley As ADODB.Recordset)

    Dim mytablex As New ADODB.Recordset

miramos:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM cuentacd  where  local='" & Trim("" & mytabley.Fields("local")) & "' and tipo='" & Trim("" & mytabley.Fields("tipo")) & "' and serie='" & Trim("" & mytabley.Fields("serie")) & "' and numero='" & Trim("" & mytabley.Fields("numero")) & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        cuentac_borra mytablex
        mytablex.Delete
        GoTo miramos

    End If

    mytablex.Close

End Function

Sub cuentac_borra(mytablex As ADODB.Recordset)

    Dim mytablez As New ADODB.Recordset

    If mytablez.State = 1 Then mytablez.Close
    mytablez.Open "SELECT * FROM cuentac  where  local='" & Trim("" & mytablex.Fields("local1")) & "' and tipo='" & Trim("" & mytablex.Fields("tipo1")) & "' and serie='" & Trim("" & mytablex.Fields("serie1")) & "' and numero='" & Trim("" & mytablex.Fields("numero1")) & "' and cuota='1'", cn, adOpenDynamic, adLockOptimistic

    If mytablez.RecordCount > 0 Then 'si existe
        'mytablez.Edit
        mytablez.Fields("abono") = Val("" & mytablez.Fields("abono")) - Val("" & mytablex.Fields("paga"))
        mytablez.Fields("saldo") = Val("" & mytablez.Fields("total")) + Val("" & mytablez.Fields("interes")) - Val("" & mytablez.Fields("abono"))
        mytablez.Update

    End If

End Sub

Sub graba_tmpcta(mytablez As ADODB.Recordset, _
                 mytablex As ADODB.Recordset, _
                 mytabley As ADODB.Recordset, _
                 sdx As Double)

    On Error GoTo cmd78121_err

    mytabley.AddNew

    mytabley.Fields("codigo") = "" & mytablez.Fields("codigo")
    mytabley.Fields("local") = "" & mytablez.Fields("local")
    mytabley.Fields("local1") = "" & mytablez.Fields("local")
    mytabley.Fields("tipo") = "" & mytablez.Fields("tipo")
    mytabley.Fields("serie") = "" & mytablez.Fields("serie")

    mytabley.Fields("numero") = "" & mytablez.Fields("numero")
    mytabley.Fields("acu") = "" & mytablez.Fields("acu")
    mytabley.Fields("tipo1") = "" & mytablex.Fields("tipo")
    mytabley.Fields("serie1") = "" & mytablex.Fields("serie")
    mytabley.Fields("numero1") = "" & mytablex.Fields("numero")
    mytabley.Fields("cuota") = "" & mytablex.Fields("cuota")
    mytabley.Fields("moneda") = "" & mytablex.Fields("moneda")
    mytabley.Fields("total") = Val("" & mytablex.Fields("saldo"))
    mytabley.Fields("paga") = sdx
    mytabley.Fields("estado") = "2"

    mytabley.Fields("fecha") = CVDate("" & mytablez.Fields("fecha"))

    'mytabley.Fields("hora") = "" & mytablez.Fields("hora")
    mytabley.Fields("usuario") = "" & mytablez.Fields("usuario")
    mytabley.Fields("caja") = "" & mytablez.Fields("caja")
    mytabley.Fields("turno") = "" & mytablez.Fields("turno")

    mytabley.Fields("tipoclie") = "" & mytablez.Fields("tipoclie")
    mytabley.Update
    Exit Sub
cmd78121_err:
    MsgBox "Aviso en graba_tmpctaa " + error$, 48, "Aviso"
    Exit Sub

End Sub

Function borra_credito(xtipo As String, xserie As String, xnumero As String)

    Dim mytablex As New ADODB.Recordset

amk2:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM cuentac where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "' and cuota='1'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        mytablex.Delete
        GoTo amk2

    End If

    mytablex.Close

End Function

Function menu_repone(xcongela As String)

    Dim i        As Integer

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd67112_err

    mytablex.Open "SELECT * FROM drequisa  where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='01' and serie='Q' and numero='" & xcongela & "'", cn, adOpenDynamic, adLockOptimistic
    Do

        If mytablex.EOF Then Exit Do
        Data2.Recordset.AddNew

        For i = 0 To mytablex.Fields.count - 1
            Data2.Recordset.Fields(i) = mytablex.Fields(i)
        Next i

        Data2.Recordset.Fields("caja") = "" & caja
        Data2.Recordset.Fields("turno") = "" & turno
        Data2.Recordset.Fields("usuario") = "" & cajero
        Data2.Recordset.Fields("fecha") = Format(dia, "dd/mm/yyyy")
        Data2.Recordset.Fields("hora") = Format(Now, "hh:MM:SS")
        Data2.Recordset.Fields("fechacrea") = Format(Now, "dd/mm/yyyy")
        Data2.Recordset.Fields("estado") = "2"
        Data2.Recordset.Update
        mytablex.MoveNext
    Loop
    '--------borrando
    mytablex.Close
    menu_repone = 1
    Exit Function
cmd67112_err:
    mytablex.Close
    Exit Function

End Function

Function menu_descongela(xcongela As String)

    Dim i        As Integer

    Dim mytablex As New ADODB.Recordset

    Dim mytablec As New ADODB.Recordset

    On Error GoTo cmd6711_err
   
    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM congelad where numero='" & xcongela & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.EOF = True Or mytablex.BOF = True Then
        mytablex.Close
        Exit Function

    End If
   
    Do

        If mytablex.EOF Then Exit Do
        If "" & mytablex.Fields("numero") = xcongela Then
 
            Data2.Recordset.AddNew

            For i = 0 To mytablex.Fields.count - 1
                Data2.Recordset.Fields(i) = mytablex.Fields(i)
            Next i

            Data2.Recordset.Fields("caja") = "" & caja
            Data2.Recordset.Fields("turno") = "" & turno
            Data2.Recordset.Fields("usuario") = "" & cajero
            Data2.Recordset.Fields("fecha") = Format(dia, "dd/mm/yyyy")
            'Data2.Recordset.Fields("hora") = Format(Now, "hh:MM")
            Data2.Recordset.Fields("fechacrea") = Format(Now, "dd/mm/yyyy")
            Data2.Recordset.Fields("estado") = "2"

            Data2.Recordset.Update
            mytablex.MoveNext
            Else: Exit Do

        End If
   
    Loop

    'INICIO 01/06/2017  KENYO APARECE EN CONGELA NOMBRE DE CLIENTE PARA DESCONGELAR
    If mytablec.State = 1 Then mytablec.Close
    mytablec.Open "SELECT * FROM congelaC where numero='" & xcongela & "'", cn, adOpenStatic, adLockOptimistic

    If mytablec.EOF = True Or mytablec.BOF = True Then
        mytablec.Close
        Exit Function

    End If

    opcioncongela = "2" ' no borra nombre de cliente xcongelax
    xcongelax = mytablec.Fields("NOMBRE")
   
    '12/06/2017 kenyo selecciona vendedor
    vendedor = mytablec.Fields("VENDEDOR")
    xvendedor = mytablec.Fields("VENDEDOR")
    '12/06/2017 kenyo selecciona vendedor
    
    'FIN 01/06/2017  KENYO APARECE EN CONGELA NOMBRE DE CLIENTE PARA DESCONGELAR

    '--------borrando
    mytablex.Close
    menu_descongela = 1
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus 'found = sumar_detalle()

    Exit Function
cmd6711_err:
    Exit Function

End Function

Sub borrar_descongela(xcongela As String)
    cn.Execute ("DELETE   FROM congelac WHERE numero='" & Trim(xcongela) & "'")

End Sub

Sub borrar_reponexx()

    On Error GoTo cmd133_err

    Data1.Recordset.Delete
    Exit Sub
cmd133_err:
    Exit Sub

End Sub

Sub borrar_descongela1(xcongela As String)
    cn.Execute ("DELETE   FROM congelad WHERE numero='" & Trim(xcongela) & "'")

End Sub

Sub borrar_repone(xcongela As String)
    cn.Execute ("DELETE   FROM drequisa WHERE local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='01' and serie='Q' and numero='" & xcongela & "'")

End Sub

Function descarga_saldo(bxlocal As String, _
                        mytablex As ADODB.Recordset, _
                        bxtipo As String, _
                        bxserie As String, _
                        bxnumero As String, _
                        sw As Integer, _
                        sw1 As Integer)

    Dim mytabley As New ADODB.Recordset

    Dim sdx      As Double

    'kenyo TALLAS

    Dim sdxT1    As Double

    Dim sdxT2    As Double

    Dim sdxT3    As Double

    Dim sdxT4    As Double

    Dim sdxT5    As Double

    Dim sdxT6    As Double

    Dim sdxT7    As Double

    Dim sdxT8    As Double

    Dim sdxT9    As Double

    Dim sdxT10   As Double

    Dim sdxT11   As Double

    Dim sdxT12   As Double

    Dim sdxT13   As Double

    Dim sdxT14   As Double

    Dim sdxT15   As Double

    Dim sdxT16   As Double

    Do

        If mytablex.EOF Then Exit Do
        '--------------------------
        mytabley.Open "SELECT * FROM almacen where  local='" & "" & mytablex.Fields("local") & "' and producto='" & "" & mytablex.Fields("producto") & "' and bodega='" & "" & mytablex.Fields("bodega") & "'", cn, adOpenDynamic, adLockOptimistic

        If mytabley.RecordCount > 0 Then  'si existe
            sdx = Val("" & mytabley.Fields("saldo")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("cantidad"))
            mytabley.Fields("saldo") = sdx
        
            'kenyo TALLAS
            sdxT1 = Val("" & mytabley.Fields("T1")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("T1"))
            mytabley.Fields("T1") = sdxT1
            mytabley.Update
        
            sdxT2 = Val("" & mytabley.Fields("t2")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t2"))
            mytabley.Fields("t2") = sdxT2
        
            sdxT3 = Val("" & mytabley.Fields("t3")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t3"))
            mytabley.Fields("t3") = sdxT3
        
            sdxT4 = Val("" & mytabley.Fields("t4")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t4"))
            mytabley.Fields("t4") = sdxT4
        
            sdxT5 = Val("" & mytabley.Fields("t5")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t5"))
            mytabley.Fields("t5") = sdxT5
        
            sdxT6 = Val("" & mytabley.Fields("t6")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t6"))
            mytabley.Fields("t6") = sdxT6
        
            sdxT7 = Val("" & mytabley.Fields("t7")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t7"))
            mytabley.Fields("t7") = sdxT7
     
            sdxT8 = Val("" & mytabley.Fields("t8")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t8"))
            mytabley.Fields("t8") = sdxT8
     
            sdxT9 = Val("" & mytabley.Fields("t9")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t9"))
            mytabley.Fields("t9") = sdxT9
        
            sdxT10 = Val("" & mytabley.Fields("t10")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t10"))
            mytabley.Fields("t10") = sdxT10
        
            sdxT11 = Val("" & mytabley.Fields("t11")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t11"))
            mytabley.Fields("t11") = sdxT11
        
            sdxT12 = Val("" & mytabley.Fields("t12")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t12"))
            mytabley.Fields("t12") = sdxT12
        
            sdxT13 = Val("" & mytabley.Fields("t13")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t13"))
            mytabley.Fields("t13") = sdxT13
        
            sdxT14 = Val("" & mytabley.Fields("t14")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t14"))
            mytabley.Fields("t14") = sdxT14
        
            sdxT15 = Val("" & mytabley.Fields("t15")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t15"))
            mytabley.Fields("t15") = sdxT15
        
            sdxT16 = Val("" & mytabley.Fields("t16")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t16"))
            mytabley.Fields("t16") = sdxT16
            mytabley.Update
                      
            'fin kenyo
        
        Else
            mytabley.AddNew
            mytabley.Fields("producto") = "" & mytablex.Fields("producto")
            mytabley.Fields("bodega") = "" & mytablex.Fields("bodega")
            mytabley.Fields("unidad") = "" & mytablex.Fields("unidad")
        
            sdx = Val("" & mytabley.Fields("saldo")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("cantidad"))
            mytabley.Fields("saldo") = sdx
        
            'kenyo
            'kenyo
            sdxT1 = Val("" & mytabley.Fields("T1")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("T1"))
            mytabley.Fields("T1") = sdxT1
            mytabley.Update
        
            sdxT2 = Val("" & mytabley.Fields("t2")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t2"))
            mytabley.Fields("t2") = sdxT2
        
            sdxT3 = Val("" & mytabley.Fields("t3")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t3"))
            mytabley.Fields("t3") = sdxT3
        
            sdxT4 = Val("" & mytabley.Fields("t4")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t4"))
            mytabley.Fields("t4") = sdxT4
        
            sdxT5 = Val("" & mytabley.Fields("t5")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t5"))
            mytabley.Fields("t5") = sdxT5
        
            sdxT6 = Val("" & mytabley.Fields("t6")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t6"))
            mytabley.Fields("t6") = sdxT6
        
            sdxT7 = Val("" & mytabley.Fields("t7")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t7"))
            mytabley.Fields("t7") = sdxT7
     
            sdxT8 = Val("" & mytabley.Fields("t8")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t8"))
            mytabley.Fields("t8") = sdxT8
     
            sdxT9 = Val("" & mytabley.Fields("t9")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t9"))
            mytabley.Fields("t9") = sdxT9
     
            sdxT10 = Val("" & mytabley.Fields("t10")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t10"))
            mytabley.Fields("t10") = sdxT10
        
            sdxT11 = Val("" & mytabley.Fields("t11")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t11"))
            mytabley.Fields("t11") = sdxT11
        
            sdxT12 = Val("" & mytabley.Fields("t12")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t12"))
            mytabley.Fields("t12") = sdxT12
        
            sdxT13 = Val("" & mytabley.Fields("t13")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t13"))
            mytabley.Fields("t13") = sdxT13
        
            sdxT14 = Val("" & mytabley.Fields("t14")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t14"))
            mytabley.Fields("t14") = sdxT14
        
            sdxT15 = Val("" & mytabley.Fields("t15")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t15"))
            mytabley.Fields("t15") = sdxT15
        
            sdxT16 = Val("" & mytabley.Fields("t16")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t16"))
            mytabley.Fields("t16") = sdxT16
            ' fin kenyo
        
            mytabley.Fields("local") = "" & mytable11.Fields("local")
            mytabley.Update

        End If

        mytabley.Close
        Set mytabley = Nothing
        '--------------------------
        mytablex.MoveNext
    Loop

End Function

Function descarga_SaldoPedido(bxlocal As String, _
                              mytablex As ADODB.Recordset, _
                              bxtipo As String, _
                              bxserie As String, _
                              bxnumero As String, _
                              sw As Integer, _
                              sw1 As Integer)

    Dim mytabley As New ADODB.Recordset

    Dim sdx      As Double

    'kenyo TALLAS

    Do

        If mytablex.EOF Then Exit Do
        '--------------------------
        mytabley.Open "SELECT * FROM almacen where  local='" & "" & mytablex.Fields("local") & "' and producto='" & "" & mytablex.Fields("producto") & "' and bodega='" & "" & mytablex.Fields("bodega") & "'", cn, adOpenDynamic, adLockOptimistic

        If mytabley.RecordCount > 0 Then  'si existe
            sdx = Val("" & mytabley.Fields("svirtual")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("cantidad"))
            mytabley.Fields("svirtual") = sdx
        
            mytabley.Update
                      
            'fin kenyo
        
        Else
            mytabley.AddNew
            mytabley.Fields("producto") = "" & mytablex.Fields("producto")
            mytabley.Fields("bodega") = "" & mytablex.Fields("bodega")
            mytabley.Fields("unidad") = "" & mytablex.Fields("unidad")
        
            sdx = Val("" & mytabley.Fields("svirtual")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("cantidad"))
            mytabley.Fields("svirtual") = sdx
        
            'kenyo
        
            mytabley.Fields("local") = "" & mytable11.Fields("local")
            mytabley.Update

        End If

        mytabley.Close
        Set mytabley = Nothing
        '--------------------------
        mytablex.MoveNext
    Loop

End Function

Function descarga_saldo1(bxlocal As String, _
                         mytablex As ADODB.Recordset, _
                         bxtipo As String, _
                         bxserie As String, _
                         bxnumero As String, _
                         sw As Integer, _
                         sw1 As Integer)

    Dim mytabley As New ADODB.Recordset

    Dim sdx      As Double

    'kenyo TALLAS

    Dim sdxT1    As Double

    Dim sdxT2    As Double

    Dim sdxT3    As Double

    Dim sdxT4    As Double

    Dim sdxT5    As Double

    Dim sdxT6    As Double

    Dim sdxT7    As Double

    Dim sdxT8    As Double

    Dim sdxT9    As Double

    Dim sdxT10   As Double

    Dim sdxT11   As Double

    Dim sdxT12   As Double

    Dim sdxT13   As Double

    Dim sdxT14   As Double

    Dim sdxT15   As Double

    Dim sdxT16   As Double

    '--------------------------
    mytabley.Open "SELECT * FROM almacen where  local='" & "" & mytablex.Fields("local") & "' and producto='" & "" & mytablex.Fields("producto") & "' and bodega='" & "" & mytablex.Fields("bodega") & "'", cn, adOpenDynamic, adLockOptimistic

    If mytabley.RecordCount > 0 Then  'si existe
        sdx = Val("" & mytabley.Fields("saldo")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("cantidad"))
        mytabley.Fields("saldo") = sdx
           
        'kenyo
        sdxT1 = Val("" & mytabley.Fields("T1")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("T1"))
        mytabley.Fields("T1") = sdxT1
        mytabley.Update
        
        sdxT2 = Val("" & mytabley.Fields("t2")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t2"))
        mytabley.Fields("t2") = sdxT2
        
        sdxT3 = Val("" & mytabley.Fields("t3")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t3"))
        mytabley.Fields("t3") = sdxT3
        
        sdxT4 = Val("" & mytabley.Fields("t4")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t4"))
        mytabley.Fields("t4") = sdxT4
        
        sdxT5 = Val("" & mytabley.Fields("t5")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t5"))
        mytabley.Fields("t5") = sdxT5
        
        sdxT6 = Val("" & mytabley.Fields("t6")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t6"))
        mytabley.Fields("t6") = sdxT6
        
        sdxT7 = Val("" & mytabley.Fields("t7")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t7"))
        mytabley.Fields("t7") = sdxT7
     
        sdxT8 = Val("" & mytabley.Fields("t8")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t8"))
        mytabley.Fields("t8") = sdxT8
     
        sdxT9 = Val("" & mytabley.Fields("t9")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t9"))
        mytabley.Fields("t9") = sdxT9
        
        sdxT10 = Val("" & mytabley.Fields("t10")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t10"))
        mytabley.Fields("t10") = sdxT10
        
        sdxT11 = Val("" & mytabley.Fields("t11")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t11"))
        mytabley.Fields("t11") = sdxT11
        
        sdxT12 = Val("" & mytabley.Fields("t12")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t12"))
        mytabley.Fields("t12") = sdxT12
        
        sdxT13 = Val("" & mytabley.Fields("t13")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t13"))
        mytabley.Fields("t13") = sdxT13
        
        sdxT14 = Val("" & mytabley.Fields("t14")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t14"))
        mytabley.Fields("t14") = sdxT14
        
        sdxT15 = Val("" & mytabley.Fields("t15")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t15"))
        mytabley.Fields("t15") = sdxT15
        
        sdxT16 = Val("" & mytabley.Fields("t16")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t16"))
        mytabley.Fields("t16") = sdxT16
        
        mytabley.Update
        
    Else
        mytabley.AddNew
        mytabley.Fields("producto") = "" & mytablex.Fields("producto")
        mytabley.Fields("bodega") = "" & mytablex.Fields("bodega")
        mytabley.Fields("unidad") = "" & mytablex.Fields("unidad")
        
        sdx = Val("" & mytabley.Fields("saldo")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("cantidad"))
        mytabley.Fields("saldo") = sdx
        
        'kenyo
        'kenyo
        sdxT1 = Val("" & mytabley.Fields("T1")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("T1"))
        mytabley.Fields("T1") = sdxT1
        mytabley.Update
        
        sdxT2 = Val("" & mytabley.Fields("t2")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t2"))
        mytabley.Fields("t2") = sdxT2
        
        sdxT3 = Val("" & mytabley.Fields("t3")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t3"))
        mytabley.Fields("t3") = sdxT3
        
        sdxT4 = Val("" & mytabley.Fields("t4")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t4"))
        mytabley.Fields("t4") = sdxT4
        
        sdxT5 = Val("" & mytabley.Fields("t5")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t5"))
        mytabley.Fields("t5") = sdxT5
        
        sdxT6 = Val("" & mytabley.Fields("t6")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t6"))
        mytabley.Fields("t6") = sdxT6
        
        sdxT7 = Val("" & mytabley.Fields("t7")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t7"))
        mytabley.Fields("t7") = sdxT7
     
        sdxT8 = Val("" & mytabley.Fields("t8")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t8"))
        mytabley.Fields("t8") = sdxT8
     
        sdxT9 = Val("" & mytabley.Fields("t9")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t9"))
        mytabley.Fields("t9") = sdxT9
     
        sdxT10 = Val("" & mytabley.Fields("t10")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t10"))
        mytabley.Fields("t10") = sdxT10
        
        sdxT11 = Val("" & mytabley.Fields("t11")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t11"))
        mytabley.Fields("t11") = sdxT11
        
        sdxT12 = Val("" & mytabley.Fields("t12")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t12"))
        mytabley.Fields("t12") = sdxT12
        
        sdxT13 = Val("" & mytabley.Fields("t13")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t13"))
        mytabley.Fields("t13") = sdxT13
        
        sdxT14 = Val("" & mytabley.Fields("t14")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t14"))
        mytabley.Fields("t14") = sdxT14
        
        sdxT15 = Val("" & mytabley.Fields("t15")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t15"))
        mytabley.Fields("t15") = sdxT15
        
        sdxT16 = Val("" & mytabley.Fields("t16")) + sw * Val("" & mytablex.Fields("factor")) * Val("" & mytablex.Fields("t16"))
        mytabley.Fields("t16") = sdxT16
        ' fin kenyo
        
        mytabley.Fields("local") = "" & mytable11.Fields("local")
        mytabley.Update

    End If

    mytabley.Close

End Function

Function proceso_carga_doc_antFormaPago(xlocal As String, _
                                        xtipo As String, _
                                        xserie As String, _
                                        xnumero As String)

    Dim i        As Integer

    Dim found    As Integer

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM fpagov where  local='" & xlocal & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
   
        '   Do
        '    If mytablex.EOF Then Exit Do
        '       Data9.Recordset.AddNew
        '       For i = 0 To mytablex.Fields.count - 1
        '           dbgrid10.Recordset.Fields(i) = mytablex.Fields(i)
        '       Next i
        '       Data9.Recordset.Update
        '       proceso_carga_doc_antFormaPago = 1
        '    mytablex.MoveNext
        '    Loop

        codigo = mytablex.Fields("codigo")
        nombre = mytablex.Fields("nombre")
  
    End If

    mytablex.Close
   
    '    found = sumar_detalle()
    '               dbgrid10.Col = 0
    '               dbgrid10.Row = dbgrid10.VisibleRows - 1
    '               dbgrid10.SetFocus

End Function

Function proceso_carga_doc_ant(xlocal As String, _
                               xtipo As String, _
                               xserie As String, _
                               xnumero As String)

    Dim i        As Integer

    Dim found    As Integer

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd67112_err

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM " & godetalle & " where  local='" & xlocal & "' and tipo='" & xtipo & "' and DUA IS NULL and serie='" & xserie & "' and numero='" & xnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe

        '16/06/2017 kenyo NOTA DE CREDITO
        Dim found2 As Integer

        codigo = ""
        codigo = mytablex.Fields("codigo")

        If Len(codigo) > 0 Then
            found2 = busca_codigo_descuento("" & codigo)

        End If
  
        'Obtiene datos de documento que se generó nota de compra
        nctipo = "" & xtipo
        ncserie = "" & xserie
        ncnumero = "" & xnumero
  
        '16/06/2017 kenyo NOTA DE CREDITO

        Do

            If mytablex.EOF Then Exit Do
            Data2.Recordset.AddNew

            For i = 0 To mytablex.Fields.count - 1
                Data2.Recordset.Fields(i) = mytablex.Fields(i)
        
            Next i

            Data2.Recordset.Update
            proceso_carga_doc_ant = 1
            mytablex.MoveNext
        Loop

    End If

    mytablex.Close
 
    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus
    Exit Function
cmd67112_err:
    'mytablex.Close
 
    Exit Function

End Function

Function proceso_carga_cotizacion(xlocal As String, _
                                  xtipo As String, _
                                  xserie As String, _
                                  xnumero As String)

    Dim i        As Integer

    Dim found    As Integer

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd67112_err

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM dcotizav where  local='" & xlocal & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        Do

            If mytablex.EOF Then Exit Do
            Data2.Recordset.AddNew

            For i = 0 To mytablex.Fields.count - 1
                Data2.Recordset.Fields(i) = mytablex.Fields(i)
            Next i

            Data2.Recordset.Update
            proceso_carga_cotizacion = 1
            mytablex.MoveNext
        Loop

    End If

    mytablex.Close
    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus
    Exit Function
cmd67112_err:
    mytablex.Close
    Exit Function

End Function

Function proceso_carga_Pedido(xlocal As String, _
                              xtipo As String, _
                              xserie As String, _
                              xnumero As String)

    Dim i        As Integer

    Dim found    As Integer

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd67112_err

    If mytablex.State = 1 Then mytablex.Close

    '''06/08/2017 kenyo Testing Completo al Sistema
    'mytablex.Open "SELECT * FROM dpedidov where  local='" & xlocal & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "'", cn, adOpenDynamic, adLockOptimistic
    mytablex.Open "SELECT * FROM dpedidov where acu='I' and local='" & xlocal & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "'", cn, adOpenDynamic, adLockOptimistic
    '''06/08/2017 kenyo Testing Completo al Sistema

    If mytablex.RecordCount > 0 Then 'si existe
        Do

            If mytablex.EOF Then Exit Do
            Data2.Recordset.AddNew

            For i = 0 To mytablex.Fields.count - 1
                Data2.Recordset.Fields(i) = mytablex.Fields(i)
            Next i

            Data2.Recordset.Update
            proceso_carga_Pedido = 1
            mytablex.MoveNext
        Loop

    End If

    mytablex.Close
    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus
    Exit Function
cmd67112_err:
    mytablex.Close
    Exit Function

End Function

Function proceso_proforma(xlocal As String, _
                          xtipo As String, _
                          xserie As String, _
                          xnumero As String)

    Dim i        As Integer

    Dim found    As Integer

    Dim mytablex As New ADODB.Recordset

    Dim sw       As Integer

    sw = 0

    On Error GoTo cmd6711212_err

    'MsgBox "" & mytable11.Fields("local") & " " & xtipo & " " & xserie & " " & xnumero
    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM dproform where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        Do

            If mytablex.EOF Then Exit Do
            'MsgBox ""
            Data2.Recordset.AddNew

            For i = 0 To mytablex.Fields.count - 2
                Data2.Recordset.Fields(i) = mytablex.Fields(i)
            Next i

            Data2.Recordset.Update
            sw = 1
            mytablex.MoveNext
        Loop

    End If

    mytablex.Close
    proceso_proforma = sw
    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus
    Exit Function
cmd6711212_err:
    MsgBox "Aviso en proceso proforma " + error$, 48, "Aviso"
    mytablex.Close
    Exit Function

End Function

Function verifica_balanza(buf As String) As String

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM producto where producto='" & buf & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.EOF = True Or mytablex.BOF = True Then
        mytablex.Close
        Exit Function

    End If

    verifica_balanza = "" & mytablex.Fields("peso")
    mytablex.Close

End Function

''Function puerto_balanza1() As String
'''On Error GoTo cmd6712_err
''Dim i As Long
''Dim d As Integer
''Dim buffers As String
''    Select Case "" & mytable11.Fields("portbala")
''           Case "COM1"
''           d = 1
''           Case "COM2"
''           d = 2
''           Case "COM3"
''           d = 3
''           Case "COM4"
''           d = 4
''           Case "COM5"
''           d = 5
''End Select
'''MsgBox "" & mytable11.Fields("tipo_balanza")
'''If "" & mytable11.Fields("tipo_balanza") = "" Then
''   'MsgBox acurabuffer
'''   puerto_balanza1 = acurabuffer
''   'puerto_balanza1 = acura_lectura()
'''   Exit Function
'''End If
''
''If "" & mytable11.Fields("tipo_balanza") = "1" Then 'torrey
''   'MsgBox acurabuffer
''   puerto_balanza1 = acurabuffer
''   'puerto_balanza1 = acura_lectura()
''   Exit Function
''End If
''If "" & mytable11.Fields("tipo_balanza") = "2" Then ' digi
''   'MsgBox acurabuffer
''   puerto_balanza1 = acurabuffer
''   'puerto_balanza1 = acura_lectura()
''   Exit Function
''End If
''
''
''
''MSComm1.CommPort = d
''MSComm1.Settings = "9600,n,8,1"
''MSComm1.InputLen = 10
''MSComm1.PortOpen = True
'''MSComm1.Output = Chr$(87) '87 para CAS  'P TORREY  Chr$(80)
''MSComm1.Output = Chr$(80) '87 para CAS  'P TORREY  Chr$(80)
''buffers = ""
''puerto_balanza1 = acurabuffer
'''Exit Function
'''For i = 1 To 9000
'''If "" & mytable11.Fields("tipobalanza") = "2" Then
'''   sw_acura = 1
'''End If
'''Next i
''i = 0
''Do
''    'DoEvents
''    buffers = buffers & MSComm1.Input
''    i = i + 1
''    If i > 15000 Then
''       Exit Do
''    End If
''Loop Until Len(buffers) >= 10
''cerrar_balanza
''puerto_balanza1 = buffers
''Exit Function
''cmd6712_err:
''cerrar_balanza
''Exit Function
''End Function
'Sub cerrar_balanza()
'On Error GoTo cmd892_err
'MSComm1.PortOpen = False
'Exit Sub
'cmd892_err:
'Exit Sub
'End Sub
Function busca_unidad(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM producto where  producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe

        If "" & mytablex.Fields("vtaund") = "S" Then
            busca_unidad = 1

        End If
   
    End If

    '------------------------------------- ------------
    mytablex.Close

End Function

Sub visualiza_detalle_factura(xtipo As String, xserie As String, xnumero As String)

    Dim buf         As String

    Dim afgodetalle As String

    Dim fgodetalle  As String

    Dim mytablex    As New ADODB.Recordset

    On Error GoTo cmd344_err

    afgodetalle = godetalle
    fgodetalle = godetalle
    dbgrid6.Visible = True

    If opcion1 = "1900" Then  'proformas
        fgodetalle = "dproform"

    End If

    If opcion1 = "15000" Then  'proformas
        fgodetalle = "dpedidov"

    End If

    'MsgBox opcion1

    '' 22/12/2017 Detalle de productos en copia,anulacion de ventas, pedidos y cotizaciones
    If opcion1 = "30000" Then  'proformas
        fgodetalle = "dcotizav"

    End If
    
    'If opcion1 <> "15000" And opcion1 <> "1900" Then Exit Sub
    'buf = "select Producto,Descripcio,Unidad,Factor,Cantidad as Cant,Precio,Total from " & fgodetalle & " where local='" & "" & mytable11.Fields("local") & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "'"
    buf = "select Producto,Descripcio,Unidad,Factor,Cantidad as Cant,Precio,Total from " & fgodetalle & " where DUA IS NULL AND local='" & "" & mytable11.Fields("local") & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "'"
    '' 22/12/2017 Detalle de productos en copia,anulacion de ventas, pedidos y cotizaciones

    'MsgBox buf
    mytablex.Open buf, cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then
        MsgBox "No existe detalle registros ", 48, "Aviso"
        mytablex.Close
        Exit Sub

    End If

    'MsgBox "abc"
    Set dbgrid6.DataSource = mytablex

    'DBGrid6.Refresh
               
    '' 22/12/2017 Detalle de productos en copia y anulacion de ventas
    'dbgrid6.columns(0).Width = 1200
    'dbgrid6.columns(1).Width = 4500
                    
    dbgrid6.columns(0).Width = 1200
    dbgrid6.columns(1).Width = 5100
    dbgrid6.columns(2).Width = 1000
    dbgrid6.columns(3).Width = 800
    dbgrid6.columns(4).Width = 1500
    dbgrid6.columns(5).Width = 1500
    dbgrid6.columns(6).Width = 1500
    '' 22/12/2017 Detalle de productos en copia y anulacion de ventas
               
    dbgrid6.SetFocus
    'MsgBox "abc"
    Exit Sub
    godetalle = afgodetalle
cmd344_err:
    MsgBox "Error en select visualiza Detalle " & error$, 48, "Aviso"
    Exit Sub

End Sub

Function verifica_oferta(buf As String) As String

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT producto,remate FROM producto where  producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        verifica_oferta = "" & mytablex.Fields("remate")

    End If

    '------------------------------------- ------------
    mytablex.Close
 
End Function

Function valida_tipo_pago(buf As String)

    Select Case buf

        Case "1"

            If "" & mytable11.Fields("ftb") <> "S" Then
                Exit Function

            End If

        Case "2"

            If "" & mytable11.Fields("ftf") <> "S" Then
                Exit Function

            End If

        Case "3"

            If "" & mytable11.Fields("fbm") <> "S" Then
                Exit Function

            End If

        Case "4"

            If "" & mytable11.Fields("ffm") <> "S" Then
                Exit Function

            End If

        Case "5"

            If "" & mytable11.Fields("fnv") <> "S" Then
                Exit Function

            End If

        Case "N" 'NOTA DoEvent CREDITO

            If "" & mytable11.Fields("fnc") <> "S" Then
                Exit Function

            End If

        Case "7"

            If "" & mytable11.Fields("fexo") <> "S" Then
                Exit Function

            End If

        Case "P"  'DE PEDIDOS

            If "" & mytable11.Fields("fpro") <> "S" Then
                Exit Function

            End If
             
        Case Else
            Exit Function

    End Select

    valida_tipo_pago = 1

End Function

Function borrar_proformas()

    On Error GoTo cmd89900_err

    cn.Execute ("delete from cproform where local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & protipo & "' and serie='" & proserie & "' and numero='" & pronumero & "'")
    cn.Execute ("delete from dproform where local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & protipo & "' and serie='" & proserie & "' and numero='" & pronumero & "'")
    cn.Execute ("delete from ppocket where pedido='" & pronumero & "'")
    Exit Function
cmd89900_err:
    MsgBox "Aviso en borrar proformas " + error$, 48, "Aviso"
    Exit Function

End Function

Function borrar_pedidos()

    Dim xbuf     As String

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd1289900_err

    If Len(petipo) = 0 Or Len(peserie) = 0 Or Len(penumero) = 0 Then
        Exit Function

    End If

    xbuf = ""
    mytablex.Open "SELECT * FROM tipo where tipo='" & petipo & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then
        mytablex.Close
        Exit Function

    End If

    Select Case "" & mytablex.Fields("tipodoc")

        Case "H"
            xbuf = "ccotizav"

        Case "I"
            xbuf = "cpedidov"

        Case "T"
            xbuf = "factura"
   
    End Select

    mytablex.Close

    If Len(xbuf) = 0 Then Exit Function
    If mytablex.State = 1 Then mytablex.Close

    ''''14/09/2017 cobra los pedidos de diferentes locales (Cobro OT)
    'mytablex.Open "SELECT * FROM " & xbuf & " where  local='" & Trim("" & "" & mytable11.Fields("local")) & "' and tipo='" & petipo & "' and serie='" & peserie & "' and numero='" & penumero & "'", cn, adOpenDynamic, adLockOptimistic
    mytablex.Open "SELECT * FROM " & xbuf & " where  tipo='" & petipo & "' and serie='" & peserie & "' and numero='" & penumero & "'", cn, adOpenDynamic, adLockOptimistic

    ''''14/09/2017 cobra los pedidos de diferentes locales (Cobro OT)
    If mytablex.RecordCount > 0 Then 'si existe
        'mytablex.Edit
        mytablex.Fields("tipo1") = petipo
        mytablex.Fields("serie1") = peserie
        mytablex.Fields("numero1") = penumero
        mytablex.Fields("yausado") = "1"
        'mytablex.Fields("acuenta") = Val("" & mytablex.Fields("total"))
        mytablex.Update

    End If

    mytablex.Close
    Exit Function
cmd1289900_err:
    MsgBox "Aviso en borrar pedidos", 48, "Aviso"
    mytablex.Close
    Exit Function

End Function

Function borrar_cotizacion()

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd1289900_err

    If Len(petipo) = 0 Or Len(peserie) = 0 Or Len(penumero) = 0 Then
        Exit Function

    End If

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM ccotizav where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & petipo & "' and serie='" & peserie & "' and numero='" & penumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        'mytablex.Edit
        mytablex.Fields("tipo1") = petipo
        mytablex.Fields("serie1") = peserie
        mytablex.Fields("numero1") = penumero
        mytablex.Fields("yausado") = "1"
        mytablex.Fields("acuenta") = Val("" & mytablex.Fields("total"))
        mytablex.Update

    End If

    mytablex.Close
    Exit Function
cmd1289900_err:
    MsgBox "Aviso en borrar Cotizacion", 48, "Aviso"
    mytablex.Close
    Exit Function

End Function

Sub pone_precios(buf As String)

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd89121_err

    label56 = ""
    'MsgBox buf
    mytablex.Open "SELECT * FROM precios where producto='" & buf & "' and local='" & Trim("" & mytable11.Fields("listap")) & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        label56 = "Pv1:" & mytablex.Fields("Unidad1") & " " & Format(Val("" & mytablex.Fields("pventa1")), nrodecimal)
        label56 = label56 + "  Pv2:" & mytablex.Fields("Unidad2") & " " & Format(Val("" & mytablex.Fields("pventa2")), nrodecimal)
        label56 = label56 + "  Pv3:" & mytablex.Fields("Unidad3") & " " & Format(Val("" & mytablex.Fields("pventa3")), nrodecimal)
        label56 = label56 + "  Pv4:" & mytablex.Fields("Unidad4") & " " & Format(Val("" & mytablex.Fields("pventa4")), nrodecimal)
        label56 = label56 + "  Pv5:" & mytablex.Fields("Unidad5") & " " & Format(Val("" & mytablex.Fields("pventa5")), nrodecimal)
        label56 = label56 + "  Pv6:" & mytablex.Fields("Unidad6") & " " & Format(Val("" & mytablex.Fields("pventa6")), nrodecimal)
        label56 = label56 + "  Pv7:" & mytablex.Fields("Unidad7") & " " & Format(Val("" & mytablex.Fields("pventa7")), nrodecimal)
        label56 = label56 + "  Pv8:" & mytablex.Fields("Unidad8") & " " & Format(Val("" & mytablex.Fields("pventa8")), nrodecimal)
        label56 = label56 + "  Pv9:" & mytablex.Fields("Unidad9") & " " & Format(Val("" & mytablex.Fields("pventa9")), nrodecimal)
        label56 = label56 + "  Pv10:" & mytablex.Fields("Unidad10") & " " & Format(Val("" & mytablex.Fields("pventa10")), nrodecimal)

    End If

    mytablex.Close
    mytablex.Open "SELECT * FROM almacen where local='" & Trim("" & mytable11.Fields("local")) & "' and producto='" & "" & buf & "' and bodega='" & Trim("" & mytable11.Fields("bodega")) & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        label56 = label56 + Chr$("impuesto") + Chr$("neto")
        label56 = label56 + " Saldo:" & Trim("" & rcconsulta.Fields("unidad")) & " " & calcula_saldo(Val("" & mytablex.Fields("saldo")), Val("" & rcconsulta.Fields("factor")))

    End If

    mytablex.Close
    Exit Sub
cmd89121_err:
    'MsgBox "Aviso en pone_precios " + error$, 48, "Aviso"
    Exit Sub

End Sub

Function consulta_saldo(buf As String, cant As Double, sw As Integer) As Double

    Dim mytablex As New ADODB.Recordset

    Dim found    As Integer

    'Combo1.Clear
    'Combo1.AddItem "bodega"
    'Combo1.ListIndex = 0
   
    'vemos si existen saldo en receta
    'MsgBox "cde"
    'AQUI DEBE VERIFICAR SI EXISTE PRODUCTO
    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM almacen where producto='" & buf & "' and local='" & Trim("" & mytable11.Fields("local")) & "' and bodega='" & Trim("" & mytable11.Fields("bodega")) & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.EOF = True Or mytablex.BOF = True Then
        mytablex.Close
        Exit Function

    End If

    consulta_saldo = 0.1

    If sw = 0 Then
        consulta_saldo = Val("" & mytablex.Fields("saldo"))

    End If

    If sw = 1 Then

        'MsgBox cant
        If cant > Val("" & mytablex.Fields("saldo")) Then
            consulta_saldo = 0

        End If

    End If

    mytablex.Close

End Function

Sub consulta_minimo(buf As String, buf1 As String)

    Dim mytablex As New ADODB.Recordset

    Dim found    As Integer

    stkminimo = ""
    'MsgBox buf
    mytablex.Open "SELECT * FROM almacen where producto='" & buf & "' and local='" & Trim("" & mytable11.Fields("local")) & "' and bodega='" & Trim("" & mytable11.Fields("bodega")) & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount = 0 Then
        mytablex.Close
        Exit Sub

    End If

    'MsgBox Val("" & mytablex.Fields("saldo")) & "  " & Val(buf1)
    If Val("" & mytablex.Fields("saldo")) <= Val(buf1) Then
        stkminimo = "Stock  Minimo:     " & "" & mytablex.Fields("saldo")

    End If

    mytablex.Close

End Sub

Sub imprime_precuenta()

    Dim found As Integer

    Dim sFile As String

    'impresora por default atachado
    On Error GoTo cmd90000_err

    cerrar_archivo
    FileName = globaldir & "\temporal\" & gusuario & ".txt"
    cerrar_archivo
    found = borra_nombre("" & FileName)
    Open FileName For Append As #1
    '------------------------------------
    cabecera_estado_cuenta
    cuerpo_estado_cuenta
    '------------------------------------
    cerrar_archivo
    Close #1

    If Len(Trim("" & mytable11.Fields("ecpuerto"))) = 0 Then
        MsgBox "Puerto de Precuenta no configurado", 48, "Aviso"
        Exit Sub

    End If

    If Trim("" & mytable11.Fields("eccola")) = "S" Then
        sFile = globaldir & "\temporal\" & gusuario & ".txt"
        found = Imprime_archivojj(sFile, 0, "" & mytable11.Fields("tamanoletra"), "" & mytable11.Fields("nombrefont"), "" & mytable11.Fields("BOLD"), "" & mytable11.Fields("letrainterna"))
        Exit Sub

    End If

    If Trim("" & mytable11.Fields("eccola")) <> "S" Then
        found = star_sp342(Trim("" & mytable11.Fields("ecpuerto")), 0)
        found = corte_papel(Trim("" & mytable11.Fields("ecpuerto")), Val("" & mytable11.Fields("catipo")))
        Exit Sub

    End If

    Exit Sub
cmd90000_err:
    MsgBox "Error en imprime precuenta" + error$, 48, "Aviso"
    Exit Sub
    Exit Sub
    
    'genver.File = globaldir & "\temporal\" & gusuario & ".txt"
    'genver.Show 1

End Sub

Sub cuerpo_estado_cuenta()

    Dim buf   As String

    Dim found As Integer

    Dim i     As Integer

    On Error GoTo cmd3999_err

    suma1 = 0
    Data2.refresh
    Do

        If Data2.Recordset.EOF Then Exit Do
        imprime_estado_cuenta
        Data2.Recordset.MoveNext
    Loop
    buf = "    NroUnidades "
    found = formateaa(buf, 20, 0, 0)
    found = formateaa("", 1, 0, 0)
    buf = Str(suma1)
    buf = Format(Val(buf), nrodecimal)
    found = formateaa(buf, 7, 2, 1)
    buf = "****TOTAL       "
    found = formateaa(buf, 22, 0, 0)
    found = formateaa("", 1, 0, 0)
    found = formateaa(Trim("" & mytable11.Fields("moneda")), 3, 0, 0)
    found = formateaa("", 1, 0, 0)
    buf = Format(Val(txtotal), nrodecimal)
    found = formateaa(buf, 9, 2, 1)

    For i = 1 To 11
        found = formateaa("", 1, 2, 0)
    Next i

    DBGrid2.SetFocus
    Exit Sub
cmd3999_err:
    MsgBox "Error en cuer po estado cuenta " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub cabecera_estado_cuenta()

    Dim found As Integer

    Dim buf   As String

    Dim btipo As String

    On Error GoTo cmd4111_err

    buf = String(45, "-")
    found = formateaa(buf, 45, 2, 0)
    buf = "       ESTADO DE CUENTA"
    found = formateaa(buf, 36, 2, 0)
    buf = "    Cajero:" & cajero & " Caja:" & caja & " Turno:" & turno
    found = formateaa(buf, 36, 2, 0)
    buf = "  Fecha:" & Format(Now, "dd/mm/yyyy") & "  Hora:" & Format(Now, "hh:mm:ss")
    found = formateaa(buf, 36, 2, 0)
    buf = servicio_generado("" & flag_servicio)
    'If flag_servicio <> "C" And flag_servicio <> "D" Then
    '   buf = servicio_generado("" & flag_servicio)
    '   found = formateaa(buf, 25, 2, 0)
    'End If
    'If FLAG_SERVICIO = "C" Then
    '   buf = "   Salon : " & salon & " Mesa:" & mesa
    '   found = formateaa(buf, 36, 2, 0)
    'End If
    'If flag_servicio = "D" Then
    found = formateaa(buf, 36, 2, 0)
    'imprime_cliente_delivery "" & codigocli
    'End If
    buf = String(45, "-")
    found = formateaa(buf, 45, 2, 0)
    Exit Sub
cmd4111_err:
    MsgBox "Mensaje,Error en cabecera Pedido " & error$
    Exit Sub

End Sub

Sub imprime_estado_cuenta()

    Dim buf   As String

    Dim found As Integer

    On Error GoTo cmd45888_err

    buf = "" & Data2.Recordset.Fields("producto")
    found = formateaa(buf, 13, 0, 0)
    found = formateaa(" ", 1, 0, 0)
    buf = "" & Data2.Recordset.Fields("unidad")
    found = formateaa(buf, 3, 2, 0)

    buf = Mid$("" & Data2.Recordset.Fields("descripcio"), 1, 20)
    found = formateaa(buf, 20, 0, 0)
    found = formateaa(" ", 1, 0, 0)

    buf = "" & Data2.Recordset.Fields("cantidad")
    'buf = Format(Val(buf), nrodecimal)
    found = formateaa(buf, 7, 0, 1)
    found = formateaa(" ", 1, 0, 0)

    buf = "" & Data2.Recordset.Fields("total")
    buf = Format(Val(buf), nrodecimal)
    found = formateaa(buf, 7, 2, 1)
    suma1 = suma1 + Val("" & Data2.Recordset.Fields("cantidad"))
    Exit Sub
cmd45888_err:
    MsgBox "Error en imprime estado de cuenta " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub sql_saldo_locales(buf As String)

    Dim rxconsulta As New ADODB.Recordset

    On Error GoTo cmd87678_err

    'buf = "select * from almacen where producto='" & buf & "'"
    buf = "select Almacen.saldo,Bodega.nombre,almacen.bodega,Almacen.local from almacen left join bodega on almacen.bodega=bodega.codigo where almacen.producto='" & buf & "' order by almacen.bodega"

    If rxconsulta.State = 1 Then rxconsulta.Close
    rxconsulta.Open buf, cn, adOpenStatic, adLockOptimistic
    'If rxconsulta.EOF = True And rxconsulta.BOF = True Then
    '   rxconsulta.Close
    '   Exit Sub
    'End If
    Set dbgrid7.DataSource = rxconsulta
    Exit Sub
cmd87678_err:
    MsgBox "Aviso en sql-saldo local " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub limpia_general()
    Frame7.Visible = False
    Framefp.Visible = False
    habilita_lab7 0
    'If flag_servicio = "C" Then
    'If cmytablex.RecordCount > 0 Then
    '   cn.Execute ("delete from dcomanda where salon='" & cmytablex.Fields("salon") & "' and mesa='" & cmytablex.Fields("mesa") & "'")
    'End If
    'End If
    consulta_comanda "" & mytable11.Fields("salon")
    borrar_todo
    sql_detalle
    tiposervicio1 = "Autoservicio"
    salon.Caption = ""
    mesa.Caption = ""
    mesero = ""
    cuenta_separa = ""
    flag_servicio = "A"

End Sub

Sub proceso_cierre_automatico(bufpago As String)

    Dim found As Integer

    Dim buf   As String

    If Frame2.Visible = True Then Exit Sub
    'local1.Visible = False
    'local1.Visible = False
    found = sumar_detalle()

    If found = 0 Then
        MsgBox "debe de Existir un Precio=0", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    If Val(txtotal) = 0 Then
        If exisdev <> -10 Then  'si existe devolucion
            DBGrid2.SetFocus
            Exit Sub

        End If

    End If

    carga_tiposdoc "%"

    If Trim("" & mytable11.Fields("terminal")) = "T" Or (ot = "S" And Len(petipo) = 0) Then 'pedidos o acuenta>0
        'MsgBox "Hola"
        xruc = codigo
        xnombre = nombre
        xdireccion = ydireccion
        Frame7.Visible = True
        habilita_lab7 1
        Framefp.Enabled = False

        If ot = "S" Then
            xtipo = Trim("" & mytable11.Fields("tipope"))

        End If

        xtipo.SetFocus
        Exit Sub

    End If

    If flag_servicio = "A" Then  'venta rapida

    End If

    If flag_servicio = "D" Then  'validar el deliveri si ingreso datos

    End If

    If flag_servicio = "C" Then  'venta mesas

    End If

    Label36.Caption = "Codigo"
    found = proceso_cobros()  'PONE EN CERO TODAS LA FORMAS DE PAGO
    opcion2 = 0
    'MsgBox dbgrid10.Visible
    ttxtotals = Format(Val(rtxtotal), nrodecimal)
    ttxtotald = Format(Val(rtxtotald), nrodecimal)
    stxtotals = Format(Val(rtxtotal), nrodecimal)
    stxtotald = Format(Val(rtxtotald), nrodecimal)
    Framefp.Visible = True
    Framefp.Enabled = True
    habilita_lab7 0
    'MsgBox ""
    'MsgBox dbgrid10.Enabled
    buf = "select * from fpago where fpago='" & bufpago & "'"

    If mytablefpago.State = 1 Then mytablefpago.Close
    mytablefpago.Open buf, cn, adOpenDynamic, adLockOptimistic
    Set dbgrid10.DataSource = mytablefpago
    dbgrid10.refresh

    If mytablefpago.RecordCount > 0 Then
        mytablefpago.MoveFirst
        dbgrid10.Enabled = False
        dbgrid10.Visible = True
        dbgrid10.Enabled = True
        dbgrid10.SetFocus
        DBGrid10_KeyDown 13, 0
        dbgrid9.Enabled = True
        'Exit Sub
        dbgrid9.SetFocus
        DBGrid9_KeyDown 13, 0
        RGPAGO_KeyPress 13

        'RGPAGO.SetFocus
        'xtipo = "7"
        'Else
        'MsgBox "No existe exonerado ", 48, "Aviso"
    End If

    'mytablex.Close
End Sub

Sub proceso_cierre_pedido()

    Dim found As Integer

    Dim buf   As String

    If Frame2.Visible = True Then Exit Sub
    'local1.Visible = False
    'local1.Visible = False
    found = sumar_detalle()

    If found = 0 Then
        MsgBox "debe de Existir un Precio=0", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    If Val(txtotal) = 0 Then
        If exisdev <> -10 Then  'si existe devolucion
            DBGrid2.SetFocus
            Exit Sub

        End If

    End If

    carga_tiposdoc "I"

    If Trim("" & mytable11.Fields("terminal")) = "T" Or (ot = "S" And Len(petipo) = 0) Then 'pedidos o acuenta>0
        'MsgBox "Hola"
        xruc = codigo
        xnombre = nombre
        xdireccion = ydireccion
        Frame7.Visible = True
        habilita_lab7 1
        Framefp.Enabled = False

        If ot = "S" Then
            xtipo = Trim("" & mytable11.Fields("tipope"))

        End If

        xtipo.SetFocus
        Exit Sub

    End If

    If flag_servicio = "A" Then  'venta rapida

    End If

    If flag_servicio = "D" Then  'validar el deliveri si ingreso datos

    End If

    If flag_servicio = "C" Then  'venta mesas

    End If

    Label36.Caption = "Codigo"

    found = proceso_cobros()  'PONE EN CERO TODAS LA FORMAS DE PAGO
    opcion2 = 0
    'MsgBox dbgrid10.Visible
    ttxtotals = Format(Val(rtxtotal), nrodecimal)
    ttxtotald = Format(Val(rtxtotald), nrodecimal)
    stxtotals = Format(Val(rtxtotal), nrodecimal)
    stxtotald = Format(Val(rtxtotald), nrodecimal)
    Framefp.Visible = True
    Framefp.Enabled = True
    habilita_lab7 0
    'MsgBox ""
    'MsgBox dbgrid10.Enabled
    buf = "select * from fpago where fpago='1'"

    If mytablefpago.State = 1 Then mytablefpago.Close
    mytablefpago.Open buf, cn, adOpenDynamic, adLockOptimistic
    Set dbgrid10.DataSource = mytablefpago
    dbgrid10.refresh

    If mytablefpago.RecordCount > 0 Then
        mytablefpago.MoveFirst
        dbgrid10.Enabled = False
        dbgrid10.Visible = True
        dbgrid10.Enabled = True
        dbgrid10.SetFocus
        DBGrid10_KeyDown 13, 0
        dbgrid9.Enabled = True
        'Exit Sub
        dbgrid9.SetFocus
        DBGrid9_KeyDown 13, 0
        RGPAGO_KeyPress 13

        'RGPAGO.SetFocus
        'xtipo = "7"
        'Else
        'MsgBox "No existe exonerado ", 48, "Aviso"
    End If

    'mytablex.Close

End Sub

Sub menu_graba_fpedido()

    Dim found    As Integer

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM fpagov ", cn, adOpenDynamic, adLockOptimistic
    graba_fpago_pedido mytablex
    found = graba_credito_trabajo() 'RECIEN LO DESHABILITE
    'found = pone_recibo_caja()
    mytablex.Close

End Sub

Sub graba_fpago_pedido(mytabley As ADODB.Recordset)
    mytabley.AddNew
    mytabley.Fields("paridad") = Val("" & paridadfp)
    mytabley.Fields("codigo") = "" & xruc
    mytabley.Fields("nombre") = "" & xnombre
    mytabley.Fields("tipo") = xtipo
    mytabley.Fields("serie") = xserie
    mytabley.Fields("numero") = xnumero
    mytabley.Fields("tipoclie") = "C"
    mytabley.Fields("fecha") = Format("" & dia, "dd/mm/yyyy")
    mytabley.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))
    mytabley.Fields("total") = Val(acuenta)
   
    mytabley.Fields("caja") = "" & caja
    mytabley.Fields("turno") = "" & turno
    mytabley.Fields("usuario") = "" & cajero
   
    mytabley.Fields("total") = Val(acuenta)
    mytabley.Fields("cambio") = 0
    mytabley.Fields("recibe") = Val(acuenta)
    mytabley.Fields("recibes") = 0
    mytabley.Fields("recibed") = 0
    mytabley.Fields("saldos") = 0
    mytabley.Fields("saldod") = 0
    mytabley.Fields("orden") = ""
    mytabley.Fields("observa") = ""
    mytabley.Fields("dias") = ""
    mytabley.Fields("fpago") = "1"
    mytabley.Fields("acufp") = "A" 'acu de recibo ingreso por
    mytabley.Fields("descripcio") = "EFECTIVO"
    mytabley.Fields("acu") = "I"
    mytabley.Fields("local") = Trim("" & mytable11.Fields("local"))
    mytabley.Fields("servicio") = flag_servicio

    If flag_servicio = "A" Then
        mytabley.Fields("servicio") = "A"

    End If

    If flag_servicio = "D" Then
        mytabley.Fields("servicio") = "D"

    End If

    If flag_servicio = "C" Then
        mytabley.Fields("servicio") = "C"

    End If

    mytabley.Fields("estado") = "2"
    mytabley.Update
    'la diferencia al credito
    mytabley.AddNew
    mytabley.Fields("paridad") = Val("" & paridadfp)
    mytabley.Fields("codigo") = "" & xruc
    mytabley.Fields("nombre") = "" & xnombre
    mytabley.Fields("tipo") = xtipo
    mytabley.Fields("serie") = xserie
    mytabley.Fields("numero") = xnumero
    mytabley.Fields("tipoclie") = "C"
    mytabley.Fields("fecha") = Format("" & dia, "dd/mm/yyyy")
    mytabley.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))
    mytabley.Fields("total") = Val(acuenta)
   
    mytabley.Fields("caja") = "" & caja
    mytabley.Fields("turno") = "" & turno
    mytabley.Fields("usuario") = "" & cajero
   
    mytabley.Fields("total") = Val(txtotal) - Val(acuenta)
    mytabley.Fields("cambio") = 0
    mytabley.Fields("recibe") = Val(txtotal) - Val(acuenta)
    mytabley.Fields("recibes") = 0
    mytabley.Fields("recibed") = 0
    mytabley.Fields("saldos") = 0
    mytabley.Fields("saldod") = 0
    mytabley.Fields("orden") = ""
    mytabley.Fields("observa") = ""
    mytabley.Fields("dias") = "1"
    mytabley.Fields("fpago") = "6" 'ojo debe existir este dato de credito formpago
    mytabley.Fields("acufp") = "J" 'acu de recibo ingreso por
    mytabley.Fields("descripcio") = "ORDENTRABAJO"
    mytabley.Fields("acu") = "I"
    mytabley.Fields("local") = Trim("" & mytable11.Fields("local"))
    mytabley.Fields("servicio") = flag_servicio

    If flag_servicio = "A" Then
        mytabley.Fields("servicio") = "A"

    End If

    If flag_servicio = "D" Then
        mytabley.Fields("servicio") = "D"

    End If

    If flag_servicio = "C" Then
        mytabley.Fields("servicio") = "C"

    End If

    mytabley.Fields("estado") = "2"
    mytabley.Fields("flage") = "I"
    mytabley.Update

End Sub

Sub grabar_descto()
    'tipodescuento = "" & List1.ListIndex
    'valordescuento = valor
    '0.- List1.AddItem "DESCUENTO EN % -TOTAL"
    '1.- List1.AddItem "DESCUENTO EN MONTO - TOTAL"
    '2.- List1.AddItem "BORRAR TODOS LOS DESCUENTOS TOTALES"
    '4.- List1.AddItem "RECARGO EN % -TOTAL "

    On Error GoTo cmd6543_err

    Dim found       As Integer

    Dim a           As Double

    Dim xpercepcion As Double

    xpercepcion = selecciona_percepcion("" & codigo, "" & clasesunat)
    Data2.refresh
    Do

        If Data2.Recordset.EOF Then Exit Do
        If (Val("" & Data2.Recordset.Fields("cantidad")) > 0 Or Val("" & Data2.Recordset.Fields("cantidad")) < 0) And Val("" & Data2.Recordset.Fields("precio")) > 0 Then
            Data2.Recordset.Edit

            If tipodescuento = "0" Then
                Data2.Recordset.Fields("destopo") = Val(valordescuento)

            End If

            If tipodescuento = "1" Then
                a = (Val(valordescuento) * 100) / Val(txtotal)
                Data2.Recordset.Fields("destopo") = a

            End If

            If tipodescuento = "2" Then
                Data2.Recordset.Fields("destopo") = 0

            End If

            If tipodescuento = "3" Then   '----recargos
                Data2.Recordset.Fields("destopo") = 0
                Data2.Recordset.Fields("precio") = Val("" & Data2.Recordset.Fields("precio")) + Val("" & Data2.Recordset.Fields("precio")) * valordescuento / 100
                Data2.Recordset.Fields("TOTAL") = Val("" & Data2.Recordset.Fields("precio")) * Val("" & Data2.Recordset.Fields("cantidad"))

            End If

            suma_linea xpercepcion
            Data2.Recordset.Update

        End If

        Data2.Recordset.MoveNext
    Loop
    'sql_detalle
    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus

    Exit Sub
cmd6543_err:
    MsgBox "Aviso " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub suma_linea(xpercepcion As Double)

    resuma_precios xpercepcion

End Sub

Function graba_credito_trabajo()

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM cuentac where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "' and cuota='1'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then  'si existe
        mytablex.Close
        Exit Function

    End If

    mytablex.AddNew
    mytablex.Fields("OBSERVA") = "ADEL.ORDENTRA"
    mytablex.Fields("GRUPO") = "O"
    mytablex.Fields("fpago") = "A"
    mytablex.Fields("acu") = "I"
    mytablex.Fields("tipo") = xtipo
    mytablex.Fields("serie") = xserie
    mytablex.Fields("numero") = xnumero
    mytablex.Fields("dias") = 1
    mytablex.Fields("cuota") = "1"
    mytablex.Fields("tipoclie") = "C"
    mytablex.Fields("codigo") = xruc
    mytablex.Fields("nombre") = xnombre
    mytablex.Fields("fecha") = Format(dia, "dd/mm/yyyy")
    mytablex.Fields("fechav") = Format(dia, "dd/mm/yyyy")
    mytablex.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))
    mytablex.Fields("total") = Val(txtotal)
    mytablex.Fields("abono") = Val(acuenta)
    mytablex.Fields("interes") = 0
    mytablex.Fields("saldo") = Val(txtotal) - Val(acuenta)
    mytablex.Fields("estado") = "0"
    mytablex.Fields("vendedor") = "" & xvendedor
    mytablex.Fields("zona") = ""
    mytablex.Fields("local") = Trim("" & mytable11.Fields("local"))
    mytablex.Fields("caja") = "" & caja
    mytablex.Fields("turno") = "" & turno
    mytablex.Fields("usuario") = "" & cajero
    mytablex.Update
    mytablex.Close

End Function

Function descuenta_credito_pedido()

    On Error GoTo cmd65u_err

    Dim mytabley As New ADODB.Recordset

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    'ADICIONAR EL PAGO
    mytabley.Open "SELECT * FROM cuentacd where local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & petipo & "' and serie='" & peserie & "' and numero='" & penumero & "' and cuota='1'", cn, adOpenStatic, adLockOptimistic
    mytabley.AddNew

    mytabley.Fields("codigo") = "" & xruc
    mytabley.Fields("local") = Trim("" & mytable11.Fields("local"))
    mytabley.Fields("local1") = Trim("" & mytable11.Fields("local"))
    mytabley.Fields("tipo") = xtipo
    mytabley.Fields("serie") = xserie

    mytabley.Fields("numero") = xnumero
    mytabley.Fields("acu") = ""
    mytabley.Fields("tipo1") = petipo
    mytabley.Fields("serie1") = peserie
    mytabley.Fields("numero1") = penumero

    mytabley.Fields("cuota") = "1" '& mytablex.Fields("cuota")
    mytabley.Fields("moneda") = moneda
    mytabley.Fields("total") = Val(acuenta)
    mytabley.Fields("paga") = Val(acuenta)
    mytabley.Fields("estado") = "2"
    mytabley.Fields("fecha") = CVDate(dia)

    'mytabley.Fields("hora") = "" & mytablez.Fields("hora")
    mytabley.Fields("usuario") = cajero
    mytabley.Fields("caja") = caja
    mytabley.Fields("turno") = turno

    mytabley.Fields("tipoclie") = "C"
    mytabley.Update
    mytabley.Close

    mytablex.Open "SELECT * FROM cuentac where local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & petipo & "' and serie='" & peserie & "' and numero='" & penumero & "' and cuota='1'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount = 0 Then
        mytablex.Close
        Exit Function

    End If

    sdx = Val("" & mytablex.Fields("abono")) + (Val(txtotal) - Val(acuenta))
    mytablex.Fields("abono") = sdx
    mytablex.Fields("saldo") = (Val("" & mytablex.Fields("total")) - Val("" & mytablex.Fields("abono")))
    mytablex.Update
    mytablex.Close
    Exit Function
cmd65u_err:
    MsgBox "Aviso en descuento credito pedido " + error, 48, "Aviso"
    Exit Function
   
End Function

Function pone_recibo_caja()

    On Error GoTo cmd891212_err

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM recibo where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then 'si existe
        mytablex.AddNew
        mytablex.Fields("local") = Trim("" & mytable11.Fields("local"))
        mytablex.Fields("caja") = "" & caja
        mytablex.Fields("turno") = "" & turno
        mytablex.Fields("usuario") = "" & cajero
  
        mytablex.Fields("tipo") = xtipo
        mytablex.Fields("serie") = xserie
        mytablex.Fields("numero") = xnumero

        mytablex.Fields("afecta") = "C"
        mytablex.Fields("fecha") = Format(dia, "dd/mm/yyyy")
        mytablex.Fields("hora") = Format(Now, "hh:mm:SS")
        mytablex.Fields("tipoclie") = "C"
        mytablex.Fields("codigo") = xruc
        mytablex.Fields("nombre") = Trim(Mid$(nombre, 1, 60))
        'mytablex.Fields("observa") = observa
        mytablex.Fields("vendedor") = xvendedor
        mytablex.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))
        mytablex.Fields("paridad") = 2.8
        mytablex.Fields("total") = Val(txtotal)
        mytablex.Fields("estado") = "2"
        mytablex.Fields("acu") = "W"
        mytablex.Fields("servicio") = "W"
        'mytablex.Fields("c1") = Val(c11)
        'mytablex.Fields("c2") = Val(c12)
        'mytablex.Fields("c3") = Val(c13)
        'mytablex.Fields("c4") = Val(c14)
        mytablex.Update

    End If

    mytablex.Close
    Exit Function
cmd891212_err:
    MsgBox "Aviso en Pone recibo caja " + error$, 48, "Aviso"
    Exit Function

End Function

Function forma_pago_adicional(mytabley As ADODB.Recordset)  'forma pago adicional orden pedido
    mytabley.Fields("paridad") = Val("" & paridadfp)
    mytabley.Fields("codigo") = "" & xruc
    mytabley.Fields("nombre") = "" & xnombre
    mytabley.Fields("tipo") = xtipo
    mytabley.Fields("serie") = xserie
    mytabley.Fields("numero") = xnumero
    mytabley.Fields("tipoclie") = "C"
    mytabley.Fields("fecha") = Format("" & dia, "dd/mm/yyyy")
    mytabley.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))
    mytabley.Fields("total") = Val(acuenta)
   
    mytabley.Fields("caja") = "" & caja
    mytabley.Fields("turno") = "" & turno
    mytabley.Fields("usuario") = "" & cajero
    mytabley.Fields("total") = Val(acuenta)
    mytabley.Fields("cambio") = 0
    mytabley.Fields("recibe") = Val(acuenta)
    mytabley.Fields("recibes") = 0
    mytabley.Fields("recibed") = 0
    mytabley.Fields("saldos") = 0
    mytabley.Fields("saldod") = 0
    mytabley.Fields("orden") = ""
    mytabley.Fields("observa") = ""
    mytabley.Fields("dias") = ""
    mytabley.Fields("fpago") = "6"
    mytabley.Fields("acufp") = "J" 'acu de recibo ingreso por
    mytabley.Fields("descripcio") = "ORDENTRABAJO"
    mytabley.Fields("acu") = acu
    mytabley.Fields("local") = Trim("" & mytable11.Fields("local"))
    mytabley.Fields("servicio") = flag_servicio

    If flag_servicio = "A" Then
        mytabley.Fields("servicio") = "A"

    End If

    If flag_servicio = "D" Then
        mytabley.Fields("servicio") = "D"

    End If

    If flag_servicio = "C" Then
        mytabley.Fields("servicio") = "C"

    End If

    mytabley.Fields("estado") = "2"
    'If xxacu = "I" Then
    '   mytabley.Fields("acu") = xxacu
    'End If

End Function

Function verifica_producto(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM producto where  producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        verifica_producto = 1

    End If

    mytablex.Close

End Function

Function busca_tipo_lineas(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM tipo  where  tipo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        busca_tipo_lineas = Val("" & mytablex.Fields("nrolineas"))

        'MsgBox ""
    End If

    mytablex.Close

End Function

Function busca_tipo_acu(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM tipo  where  tipo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        busca_tipo_acu = "" & mytablex.Fields("tipodoc")

    End If

    mytablex.Close

End Function

Sub carga_foto(buf As String)

    Dim fotonombre As String

    On Error GoTo cmd4432_err

    foto = LoadPicture()
    fotonombre = buf

    If Len(fotonombre) > 0 Then

        If existe_archivo(fotonombre) > 0 Then
            foto = LoadPicture(fotonombre)

        End If

    End If

    Exit Sub
cmd4432_err:
    Exit Sub

End Sub

Sub pone_fotonombre(mytablex As ADODB.Recordset)

    Dim valor As String

    foto = LoadPicture()
    valor = App.path & "\001d\06\grafico\temp.jpg" 'Trim("" & mytablex.Fields("fotonombre"))
    viewBMP mytablex, valor

    If Len(valor) > 0 Then
        If existe_archivo(valor) > 0 Then
            foto = LoadPicture(valor)

        End If

    End If

cm897888_err:
    Exit Sub

End Sub

Sub palabra_bienvenida1()

    Dim buf  As String

    Dim sdx  As Double

    Dim buf1 As String

    Dim buf2 As String

    On Error GoTo cmd3678112_err

    Exit Sub
    sdx = Val(stxtotals)
    buf = Format(sdx, nrodecimal)
    buf1 = Mid$(buf, Len(buf) - 1, 2)
    buf = Mid$(buf, 1, Len(buf) - 3)
    buf = letras(buf, 40)
    buf = LTrim$(Trim$(buf))
    buf = UCase(buf)
    buf2 = LTrim(RTrim(buf)) & " con " & LTrim(RTrim(buf1))
    'MsgBox buf2
    'buf = Trim(pone_letras(stxtotals, "S", 60))
    'MsgBox "" & ttxtotals
    'Speech.Pitch = 170 ' Set Pitch Value
    'Speech.Speed = 120 ' Set Speed Value
    'Speech.AudioReset
    'MsgBox "Hola"
    'Speech.Speak "Su cuenta es  " & buf2 & " NUEVOS SOLES"
    'Speech.Sayit = "son " + "" & ttxtotals + " SOLES "
    'Sleep (5000)
    Exit Sub
cmd3678112_err:
    MsgBox "Error en palabra " & error$, 48, "Aviso"
    Exit Sub

End Sub

Sub graba_tarjetas(mytabley As ADODB.Recordset)

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    On Error GoTo cmd7811_err

    sdx = busca_banco_numero()
busvf:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM chequemo  where  transaccio='" & sdx & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        sdx = sdx + 1
        GoTo busvf

    End If

    mytablex.AddNew
    mytablex.Fields("transaccio") = "" & sdx
    mytablex.Fields("moneda") = "" & mytabley.Fields("moneda")
    mytablex.Fields("tipoclie") = "C"
    mytablex.Fields("codigo") = "" & mytabley.Fields("codigo")
    mytablex.Fields("banco") = "BCP"
    mytablex.Fields("cuenta") = ""
    mytablex.Fields("tipo") = "72"
    mytablex.Fields("numero") = ""
    mytablex.Fields("fechan") = Format("" & mytabley.Fields("fecha"), "dd/mm/yyyy")
    mytablex.Fields("fechae") = Format("" & mytabley.Fields("fecha"), "dd/mm/yyyy")
    mytablex.Fields("nombre") = "" & mytabley.Fields("nombre")
    mytablex.Fields("conciliado") = "N"
    mytablex.Fields("concepto") = "" & mytabley.Fields("descripcio")
    mytablex.Fields("acu") = "X"
    mytablex.Fields("comenta") = ""
    mytablex.Fields("total") = Val("" & mytabley.Fields("recibe"))
    mytablex.Fields("descuento") = 0
    mytablex.Fields("recargo") = 0
    mytablex.Fields("abono") = 0
    mytablex.Fields("neto") = Val("" & mytabley.Fields("recibe"))
    mytablex.Fields("saldo") = Val("" & mytabley.Fields("recibe"))
    mytablex.Fields("cajero") = "" & cajero
    mytablex.Fields("caja") = "" & caja
    mytablex.Fields("turno") = "" & turno
    mytablex.Fields("xtipo") = "" & mytabley.Fields("tipo")
    mytablex.Fields("xserie") = "" & mytabley.Fields("serie")
    mytablex.Fields("xnumero") = "" & mytabley.Fields("numero")
    mytablex.Update
    mytablex.Close
    Exit Sub
cmd7811_err:
    MsgBox "Aviso en graba tarjetas " + error$, 48, "Aviso"
    Exit Sub

End Sub

Function busca_banco_numero() As Double

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM parame where codigo='01'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        busca_banco_numero = Val("" & mytablex.Fields("banco"))

    End If

    mytablex.Close

End Function

'Facturacion Mensual Kenyo
Function graba_guia_mensual()

    Dim buf As String

    Dim i   As Integer

    Dim j   As Integer

    Dim AA  As String

    Dim BB  As String

    Dim cC  As String

    Dim dd  As String

    On Error GoTo cmd12004992_err

    For i = 0 To crucefa.ListCount - 1
        extrae_crucefa crucefa.List(i), AA, BB, cC, dd
   
        'KENYO
   
        'buf = "update cuentac set estado='1'  where  local='" & "" & AA & "' and tipo='" & "" & BB & "' and serie='" & "" & cC & "' and  numero='" & "" & dd & "'"
   
        'ESTADO 1 A CUENTAC
        cn.Execute ("update cuentac set estado='1'  where  local='" & "" & AA & "' and tipo='" & "" & BB & "' and serie='" & "" & cC & "' and  numero='" & "" & dd & "'")
      
        'ESTADO 1 A FACTURA,DETALLE,FPAGOV...el ACU es para que no afecte reporte ENTRADA- SALIDAS
    
        cn.Execute ("update FACTURA set estado='1',acu=''  where  local='" & "" & AA & "' and tipo='" & "" & BB & "' and serie='" & "" & cC & "' and  numero='" & "" & dd & "'")
        cn.Execute ("update DETALLE set estado='1',acu=''  where  local='" & "" & AA & "' and tipo='" & "" & BB & "' and serie='" & "" & cC & "' and  numero='" & "" & dd & "'")
        cn.Execute ("update FPAGOV set estado='1',acu=''  where  local='" & "" & AA & "' and tipo='" & "" & BB & "' and serie='" & "" & cC & "' and  numero='" & "" & dd & "'")
        cn.Execute ("update FPAGOV set estado='1',acu=''  where  local='" & "" & AA & "' and tipo='" & "" & BB & "' and serie='" & "" & cC & "' and  numero='" & "" & dd & "'")
        ' cn.Execute (buf)
        'mydbxglo.Execute buf
    Next i

    Exit Function
cmd12004992_err:

    Exit Function
    MsgBox "Aviso en graba_guia Mensual" + error$, 24, "AVISO DE NO ERROR"
    Resume

End Function

Sub reversa_guia_mensual(axlocal As String, _
                         axtipo As String, _
                         axserie As String, _
                         axnumero As String)

    Dim buf As String

    buf = "update cuentac set estado='0'  where  local='" & axlocal & "' and tipo='" & axtipo & "' and serie='" & axserie & "' and  numero='" & axnumero & "'"
    cn.Execute buf

End Sub

Sub extrae_crucefa(DATO As String, _
                   ccampo1 As String, _
                   ccampo2 As String, _
                   ccampo3 As String, _
                   ccampo4 As String)

    Dim i    As Integer

    Dim j    As Integer

    Dim temp As String

    i = 0
    temp = Trim$(DATO)

    If Len(temp) = 0 Then Exit Sub
    Do
        j = InStr(temp, "|")

        If j > 0 Then
            i = i + 1

            Select Case i

                Case 1: ccampo1 = Trim(Mid$(temp, 1, j - 1))

                Case 2: ccampo2 = Trim(Mid$(temp, 1, j - 1))

                Case 3: ccampo3 = Trim(Mid$(temp, 1, j - 1))

                Case 4: ccampo4 = Trim(Mid$(temp, 1, j - 1))

                    'Case 5: campo5 = Mid$(temp, 1, J - 1)
            End Select

            temp = Trim$(Mid$(temp, j + 1))
        Else
            Exit Sub

        End If

    Loop
    Exit Sub

End Sub

Function verifica_ofertax(buf As String, xcant As Double, buf1 As Double)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close

    mytablex.Open "SELECT * FROM precios  where  producto='" & buf & "' and local='" & Trim("" & mytable11.Fields("listap")) & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        buf1 = Val("" & mytablex.Fields("pventa1"))

        If Val("" & mytablex.Fields("minimo11")) > 0 And Val("" & mytablex.Fields("maximo11")) > 0 Then
            If xcant >= Val("" & mytablex.Fields("minimo11")) And xcant <= Val("" & mytablex.Fields("maximo11")) Then
                buf1 = Val("" & mytablex.Fields("pventa11"))

                If Val(buf1) > 0 Then
                    verifica_ofertax = 1

                End If

                mytablex.Close
                Exit Function

            End If

        End If

        If Val("" & mytablex.Fields("minimo12")) > 0 And Val("" & mytablex.Fields("maximo12")) > 0 Then
            If xcant >= Val("" & mytablex.Fields("minimo12")) And xcant <= Val("" & mytablex.Fields("maximo12")) Then
                buf1 = Val("" & mytablex.Fields("pventa12"))

                If Val(buf1) > 0 Then
                    verifica_ofertax = 1

                End If

                mytablex.Close
                Exit Function

            End If

        End If

        If Val("" & mytablex.Fields("minimo13")) > 0 And Val("" & mytablex.Fields("maximo13")) > 0 Then
            If xcant >= Val("" & mytablex.Fields("minimo13")) And xcant <= Val("" & mytablex.Fields("maximo13")) Then
                buf1 = Val("" & mytablex.Fields("pventa13"))

                If Val(buf1) > 0 Then
                    verifica_ofertax = 1

                End If

                mytablex.Close
                Exit Function

            End If

        End If

        If Val("" & mytablex.Fields("minimo14")) > 0 And Val("" & mytablex.Fields("maximo14")) > 0 Then
            If xcant >= Val("" & mytablex.Fields("minimo14")) And xcant <= Val("" & mytablex.Fields("maximo14")) Then
                buf1 = Val("" & mytablex.Fields("pventa14"))

                If Val(buf1) > 0 Then
                    verifica_ofertax = 1

                End If

                mytablex.Close
                Exit Function

            End If

        End If

        verifica_ofertax = 1
   
    End If

    mytablex.Close

End Function

Function busca_credito_adelanto(buf As String, buf2 As String)

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    Dim found    As Integer

    Dim buf1     As String

    saldoabo = ""
    buf1 = buf

    If buf = "I" Then
        buf1 = "A"

    End If

    If buf = "K" Then
        buf1 = "D"

    End If

    sdx = 0

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM cuentac  where  tipoclie='C' and codigo='" & buf2 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        busca_credito_adelanto = 1
        Do

            If mytablex.EOF Then Exit Do
            If Val("" & mytablex.Fields("saldo")) > 0 Then
                If "" & mytablex.Fields("grupo") = buf1 Then
                    sdx = sdx + Val("" & mytablex.Fields("saldo"))

                End If

            End If

            mytablex.MoveNext
        Loop

    End If

    mytablex.Close
    saldoabo = Format(sdx, "0.00")

    'If buf2 = "C" Then
    'mytablex.Open "SELECT * FROM clientes where  codigo='" & buf2 & "'", cn, adOpenDynamic, adLockOptimistic
    'If mytablex.RecordCount > 0 Then 'si existe
    '   mytablex.Fields("credito_usado") = sdx
    'End If
    'mytablex.Close
    'End If
End Function

Function busca_credito_adelanto1(buf1 As String, buf As String) As Double

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    Dim buf2     As String

    Dim found    As Integer

    If buf = "I" Then
        buf2 = "A"

    End If

    If buf = "K" Then
        buf2 = "D"

    End If

    sdx = 0

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM cuentac  where  tipoclie='C' and codigo='" & buf1 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        Do

            If mytablex.EOF Then Exit Do
            If "" & mytablex.Fields("codigo") = buf1 Then
                If Val("" & mytablex.Fields("saldo")) > 0 Then
                    If "" & mytablex.Fields("grupo") = buf2 Then
                        sdx = sdx + Val("" & mytablex.Fields("saldo"))

                    End If

                End If

                Else: Exit Do

            End If

            mytablex.MoveNext
        Loop

    End If

    mytablex.Close
    busca_credito_adelanto1 = Val(Format(sdx, "0.00"))

End Function

Function busca_codigo_clientedeliveri(buf As String)

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    trdescuento = ""
    saldo = ""

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM clientes  where  codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        dnombre = "" & mytablex.Fields("nombre")
        correo = "" & mytablex.Fields("correo")
        ddireccion = "" & mytablex.Fields("direccion")
        referencia = "" & mytablex.Fields("observa")
        telefono = "" & mytablex.Fields("codigo")
        'trdescuento = Format(Val("" & mytablex.Fields("descuento")), "0.00")
        'saldo = Format(Val("" & mytablex.Fields("credito")), "0.00")
        busca_codigo_clientedeliveri = 1
 
    End If

    mytablex.Close

End Function

Function busca_codigo_descuento(buf As String)

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    trdescuento = ""
    saldo = ""

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM clientes  where  codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        nombre = "" & mytablex.Fields("nombre")
        correo = "" & mytablex.Fields("correo")
        ydireccion = "" & mytablex.Fields("direccion")
        trdescuento = Format(Val("" & mytablex.Fields("descuento")), "0.00")
        saldo = Format(Val("" & mytablex.Fields("credito")), "0.00")
        busca_codigo_descuento = 1
   
        If mytablex.Fields("estado") = "I" Then
            MsgBox ("USUARIO INACTIVO"), vbCritical
            nombre = ""
            correo = ""
            ydireccion = ""
    
        End If

    End If

    mytablex.Close
    sdx = 0
    saldo = ""

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM cuentac  where  tipoclie='C' and codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        Do

            If mytablex.EOF Then Exit Do
            If Val("" & mytablex.Fields("saldo")) > 0 Then
                sdx = sdx + Val("" & mytablex.Fields("saldo"))

            End If

            mytablex.MoveNext
        Loop

    End If

    mytablex.Close
    saldo = Format(sdx, "0.00")

End Function

Function valida_otros()

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM factura  where  local='" & rrlocal11 & "' and tipo='" & rrtipo & "' and serie='" & rrserie & "' and numero='" & rrnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        valida_otros = 1

    End If

    mytablex.Close

End Function

Function valida_rango()

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    If Len(Trim(Label12)) > 0 Then
        valida_rango = 1
        Exit Function

    End If

    If Trim("" & mytable11.Fields("pm")) <> "S" Then
        valida_rango = 1
        Exit Function

    End If

    'MsgBox "" & DBGrid2.Columns(51)
    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM precios  where  producto='" & Trim(DBGrid2.columns(0)) & "' and local='" & Trim("" & mytable11.Fields("local")) & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        valida_rango = 1

        Select Case "" & DBGrid2.columns("nroprecio")

            Case "1"
                'MsgBox "" & dbgrid2.columns("precio")
                sdx = Val("" & mytablex.Fields("pventa1")) - Val("" & mytablex.Fields("pventa1")) * Val("" & mytablex.Fields("pm1")) / 100

                If Val("" & DBGrid2.columns("precio")) < sdx Then
                    valida_rango = 0

                End If
               
            Case "2"
                sdx = Val("" & mytablex.Fields("pventa2")) - Val("" & mytablex.Fields("pventa2")) * Val("" & mytablex.Fields("pm2")) / 100

                If Val("" & DBGrid2.columns("precio")) < sdx Then
                    valida_rango = 0

                End If

            Case "3"
                sdx = Val("" & mytablex.Fields("pventa3")) - Val("" & mytablex.Fields("pventa3")) * Val("" & mytablex.Fields("pm3")) / 100

                If Val("" & DBGrid2.columns("precio")) < sdx Then
                    valida_rango = 0

                End If

            Case "4"
                sdx = Val("" & mytablex.Fields("pventa4")) - Val("" & mytablex.Fields("pventa4")) * Val("" & mytablex.Fields("pm4")) / 100

                If Val("" & DBGrid2.columns("precio")) < sdx Then
                    valida_rango = 0

                End If

            Case "5"
                sdx = Val("" & mytablex.Fields("pventa5")) - Val("" & mytablex.Fields("pventa5")) * Val("" & mytablex.Fields("pm5")) / 100

                If Val("" & DBGrid2.columns("precio")) < sdx Then
                    valida_rango = 0

                End If

            Case "6"
                sdx = Val("" & mytablex.Fields("pventa6")) - Val("" & mytablex.Fields("pventa6")) * Val("" & mytablex.Fields("pm6")) / 100

                If Val("" & DBGrid2.columns("precio")) < sdx Then
                    valida_rango = 0

                End If

            Case "7"
                sdx = Val("" & mytablex.Fields("pventa7")) - Val("" & mytablex.Fields("pventa7")) * Val("" & mytablex.Fields("pm7")) / 100

                If Val("" & DBGrid2.columns("precio")) < sdx Then
                    valida_rango = 0

                End If

            Case "8"
                sdx = Val("" & mytablex.Fields("pventa8")) - Val("" & mytablex.Fields("pventa8")) * Val("" & mytablex.Fields("pm8")) / 100

                If Val("" & DBGrid2.columns("precio")) < sdx Then
                    valida_rango = 0

                End If

            Case "9"
                sdx = Val("" & mytablex.Fields("pventa9")) - Val("" & mytablex.Fields("pventa9")) * Val("" & mytablex.Fields("pm9")) / 100

                If Val("" & DBGrid2.columns("precio")) < sdx Then
                    valida_rango = 0

                End If

            Case "10"
                sdx = Val("" & mytablex.Fields("pventa10")) - Val("" & mytablex.Fields("pventa10")) * Val("" & mytablex.Fields("pm10")) / 100

                If Val("" & DBGrid2.columns("precio")) < sdx Then
                    valida_rango = 0

                End If

        End Select

    End If

    mytablex.Close

End Function

Function valida_placa(buf As String, buf1 As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM linea  where  linea='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        If "" & mytablex.Fields("t1") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t2") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t3") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t4") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t5") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t6") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t7") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t8") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t9") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t10") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t11") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t12") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t13") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t14") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t15") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

        If "" & mytablex.Fields("t16") = buf1 Then
            valida_placa = 1
            GoTo usalir

        End If

    End If

usalir:
    mytablex.Close
    Exit Function

End Function

Sub graba_video_concar(buf As String)

End Sub

Sub valida_camara()
    'If 0 < tdeliver.ezVidCap1.NumCapDevs Then
    '     tdeliver.ezVidCap1.ShowDlgVideoSource
    'Else
    '    MsgBox "No Video Capture Device!", vbInformation, App.Title
    'End If
    Exit Sub

End Sub

Sub busca_ocurrencia()

    Dim X        As Double

    Dim buf      As String

    Dim mytablex As New ADODB.Recordset

    Dim ufile    As String

usigue:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM parame  where  codigo='01'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        X = Val("" & mytablex.Fields("ocurrencia")) + 1
        ufile = globaldir + "\ocurrencia\" + caja + "-" + "" & X

        If UCase(gocabeza) = "CADIARIO" Then
            ufile = globaldir + "\ocurrencia\" + caja + "-" + "" & X

        End If

        If Dir(ufile) = "" Then 'si no existe
        Else
            'mytablex.Edit
            mytablex.Fields("ocurrencia") = X
            mytablex.Update
            GoTo usigue

        End If

        buf = caja & "-" + "" & X
        graba_video_concar1 buf
        'mytablex.Edit
        mytablex.Fields("ocurrencia") = X
        mytablex.Update

    End If

    mytablex.Close

End Sub

Sub graba_video_concar1(buf As String)

    Dim vr

    On Error GoTo cm643122_err

    Dim ufile As String

    MsgBox "Presione enter para continuar..", 48, "Aviso"
      
    ufile = globaldir & "\ocurrencia\" & buf

    If UCase(gocabeza) = "CADIARIO" Then
        ufile = globaldir & "\ocurrencia\" & buf

    End If

    'ezVidCap1.TimeLimit = CInt("" & mytable11.Fields("segundo"))
    'ezVidCap1.CaptureFile = ufile
    'Call ezVidCap1.CaptureVideo
    'ezVidCap1.Height = 1920
    'ezVidCap1.Top = 240
    'ezVidCap1.Left = 0
    'ezVidCap1.Width = 3840
    Exit Sub
cm643122_err:
    MsgBox "Aviso en Video " + error$, 48, "Aviso"

End Sub

Function crea_nuevos_clientes(buf1 As String, _
                              buf2 As String, _
                              buf3 As String, _
                              buf4 As String, _
                              buf5 As String, _
                              buf6 As String, _
                              buf7 As String)

    On Error GoTo cmd45777_err

    Dim mytablex As New ADODB.Recordset

    Exit Function

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM codclie  where  codigo='" & buf1 & "' and producto='" & buf2 & "' and unidad='" & buf5 & "' and factor='" & buf6 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        'mytablex.Edit
        mytablex.Fields("codigo") = "" & buf1
        mytablex.Fields("producto") = "" & buf2
        mytablex.Fields("descripcio") = "" & buf7
        mytablex.Fields("costo") = Val("" & buf3)
        mytablex.Fields("unidad") = "" & buf5
        mytablex.Fields("factor") = Val("" & buf6)

        If Len(buf4) = 10 Then
            mytablex.Fields("fecha") = Format(buf4, "dd/mm/yyyy")

        End If

        mytablex.Update
    Else
        mytablex.AddNew
        mytablex.Fields("codigo") = "" & buf1
        mytablex.Fields("producto") = "" & buf2
        mytablex.Fields("descripcio") = "" & buf7
        mytablex.Fields("costo") = Val("" & buf3)
        mytablex.Fields("unidad") = "" & buf5
        mytablex.Fields("factor") = Val("" & buf6)

        If Len(buf4) = 10 Then
            mytablex.Fields("fecha") = Format(buf4, "dd/mm/yyyy")

        End If

        mytablex.Update

    End If

    mytablex.Close
    Exit Function
cmd45777_err:
    MsgBox "Aviso en nuevo clientes" + error$, 48, "Aviso"
    Exit Function

End Function

Function busca_especial(buf, buf1 As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM codclie  where  producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        buf1 = "" & mytablex.Fields("precio")
        busca_especial = 1

    End If

    mytablex.Close

End Function

Function familia_saldo(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM FAMILIA where familia='" & buf & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        If "" & mytablex.Fields("tipo") = "1" Then
            familia_saldo = 1

        End If

    End If

    mytablex.Close

End Function

Function adiciona_deliveri(bxtipo As String, bxserie As String, bxnumero As String)

    Dim i            As Integer

    Dim sdx          As Double

    Dim xbuf         As String

    Dim found        As Integer

    Dim mytabler     As New ADODB.Recordset

    Dim mytablex     As New ADODB.Recordset

    Dim mytabley     As String

    Dim mytableb     As New ADODB.Recordset

    Dim antgocabeza  As String

    Dim antgodetalle As String

    Dim rs

    Dim mytablezx        As New ADODB.Recordset

    'inicio integracion 07/02/2018 pll
    Dim salida           As Boolean

    Dim my_idubigeo      As String

    Dim my_codcliente    As String

    Dim my_credito       As Boolean

    Dim paso             As Boolean

    Dim my_ruc           As String

    Dim file             As String

    Dim input_file       As String

    Dim sFolderPath      As String

    Dim encontro         As Boolean

    Dim my_cantidad_file As Integer

    Dim llego            As Boolean

    Dim m                As Integer

    'fin integracion 07/02/2018 pll

    'fin integracion 07/02/2018 pll
    ''On Error GoTo cmd67333_err 'leito
    'MsgBox gocabeza
    antgocabeza = gocabeza
    antgodetalle = godetalle

    'If local1.Visible = True Then
    '   gocabeza = "ctraslad"
    '   godetalle = "dtraslad"
    'End If
    If local1 = "PEDIDO" Then
        gocabeza = "crequisa"
        godetalle = "drequisa"

    End If

    xxacu = busca_acu()

    If xxacu = "I" Then 'si es pedido
        gocabeza = "cpedidov"
        godetalle = "dpedidov"

    End If

    '---validar si el numero ya existe----
    'MsgBox globaldir & " " & gocabeza
    'AQUI ABRIMOS GAVETA PARA SER MASRAPIDO
    'If local1 <> "PEDIDO" Then  'si nos traslado

    ''''20/09/2017 kenyo No abrir gaveta al realizar OT
    'If Trim("" & mytable11.Fields("terminal")) <> "T" And Trim("" & mytable11.Fields("gavetasw")) <> "N" Then
    '   found = abre_puerto(Trim("" & mytable11.Fields("capuerto")), Val("" & mytable11.Fields("catipo")), "" & mytable11.Fields("gavetacola"))
    'End If
    
    If bxtipo <> "P" Then
        If Trim("" & mytable11.Fields("terminal")) <> "T" And Trim("" & mytable11.Fields("gavetasw")) <> "N" Then
            found = abre_puerto(Trim("" & mytable11.Fields("capuerto")), Val("" & mytable11.Fields("catipo")), "" & mytable11.Fields("gavetacola"))

        End If

    End If

    ''''20/09/2017 kenyo No abrir gaveta al realizar OT

    'End If

    'MsgBox gocabeza
    DBGrid2.Enabled = True
    found = sumar_detalle()
    DBGrid2.Enabled = False
    'MsgBox gocabeza

    'aqui le sumamos el valor al pedido
    If Len(Trim("" & Label12)) > 0 Then

        'MsgBox "abc"
        If axctipo = "RE" Then
            mytablex.Open "SELECT * FROM reserva where  reserva=" & axcnumero & "", cn, adOpenDynamic, adLockOptimistic

            If mytablex.RecordCount > 0 Then  'si existe
                mytablex.Fields("abono") = Val("" & mytablex.Fields("abono")) + Val("" & txtotal)
                mytablex.Fields("saldo") = Val("" & mytablex.Fields("total")) - Val("" & mytablex.Fields("abono"))

                If Val("" & mytablex.Fields("saldo")) <= 0 Then
                    mytablex.Fields("estado") = "1"

                End If

                mytablex.Update

            End If

            mytablex.Close
            GoTo sihue

        End If

        If axctipo = "CK" Then
            mytablex.Open "SELECT * FROM checkin where  checkin=" & axcnumero & "", cn, adOpenDynamic, adLockOptimistic

            If mytablex.RecordCount > 0 Then  'si existe
                mytablex.Fields("abono") = Val("" & mytablex.Fields("abono")) + Val("" & txtotal)
                mytablex.Fields("saldo") = Val("" & mytablex.Fields("total")) - Val("" & mytablex.Fields("abono"))

                If Val("" & mytablex.Fields("saldo")) <= 0 Then
                    mytablex.Fields("estado") = "1"

                End If

                mytablex.Update

            End If

            mytablex.Close
            GoTo sihue

        End If
   
        mytablex.Open "SELECT * FROM cpedidov where  local='" & Trim("" & axclocal) & "' and tipo='" & axctipo & "' and serie='" & axcserie & "' and numero='" & axcnumero & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then  'si existe
            mytablex.Fields("acuenta") = Val("" & mytablex.Fields("acuenta")) + Val("" & txtotal)

            If Val("" & mytablex.Fields("total")) <= Val("" & mytablex.Fields("acuenta")) Then
                mytablex.Fields("yausado") = "1"

            End If

            mytablex.Update

        End If

        mytablex.Close

    End If

sihue:

    mytablex.Open "SELECT * FROM " & gocabeza & " where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & bxtipo & "' and serie='" & bxserie & "' and numero='" & bxnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then  'si existe
        'mytablex.Edit
        grabando_cabecera mytablex, bxtipo, bxserie, bxnumero
        mytablex.Update
    Else
        mytablex.AddNew
        grabando_cabecera mytablex, bxtipo, bxserie, bxnumero
        mytablex.Update

    End If

    mytablex.Close

    If Len(petipo) > 0 And Len(penumero) > 0 Then  'si ha sido jalado pedido o orden trabajo descontar credito
        found = descuenta_credito_pedido()

    End If

    'MsgBox ""
    Data2.refresh
ak1:

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM " & godetalle & " where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='" & bxtipo & "' and serie='" & bxserie & "' and numero='" & bxnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then  'si existe
        mytablex.Delete
        GoTo ak1

    End If

    'aqui debe borrar el otro si es traslado
ak123:

    If mytableb.State = 1 Then mytableb.Close
    mytableb.Open "SELECT * FROM detalle where  local='" & Trim("" & mytable11.Fields("local")) & "' and tipo='TS' and serie='" & bxserie & "' and numero='" & bxnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytableb.RecordCount > 0 Then  'si existe
        mytableb.Delete
        GoTo ak123

    End If

    'End If 'fin local visible
    xbuf = "cABECERA:" & Format(Now, "hh:mm:ss")

    Do

        If Data2.Recordset.EOF Then Exit Do
        mytablex.AddNew

        For i = 0 To Data2.Recordset.Fields.count - 1
            mytablex.Fields(i) = Data2.Recordset.Fields(i)
        Next i
    
        If Val(tdetra) > 0 Then
            mytablex.Fields("denumero") = Format(Val(ndetraccion), "0000000000")

        End If

        mytablex.Fields("sentido") = "" & sentido
        mytablex.Fields("local") = Trim("" & mytable11.Fields("local"))
        mytablex.Fields("tipo") = "" & bxtipo
        mytablex.Fields("serie") = "" & bxserie
        mytablex.Fields("numero") = "" & bxnumero

        If Len(Trim(xvendedor)) > 0 Then
            mytablex.Fields("vendedor") = xvendedor
    
            ''' 29/01/2018 Comisiones por producto por trabajador.
            mytablex.Fields("comision") = busca_comisiones(mytablex.Fields("producto"), xvendedor)
            ''' 29/01/2018 Comisiones por producto por trabajador.
    
        End If

        mytablex.Fields("tipoclie") = "C"
    
        mytablex.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))
        mytablex.Fields("bodega") = Trim("" & mytable11.Fields("bodega"))
        mytablex.Fields("bodegaf") = ""
    
        mytablex.Fields("acu") = acu
        mytablex.Fields("localf") = Trim("" & mytable11.Fields("local"))  '& codigo  'si no es traslado
    
        'If local1.Visible = True Then
        '   mytablex.Fields("acu") = "T"
        '   mytablex.Fields("bodegaf") = xruc '"" & mytable11.Fields("bodega")  'ojo si no esta vacio es traslado
        '   mytablex.Fields("tipoclie") = "V"
        'End If
        If Trim("" & mytable11.Fields("terminal")) = "T" Then

            'mytablex.Fields("acu") = "I"
        End If
    
        mytablex.Fields("acu1") = ""
        'para traslado no debe existir nada
        mytablex.Fields("servicio") = flag_servicio

        If flag_servicio = "A" Then
            mytablex.Fields("servicio") = "A"

        End If

        If flag_servicio = "C" Then
            mytablex.Fields("servicio") = "C"
            mytablex.Fields("salon") = "" & cmytablex.Fields("salon")
            
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            'mytablex.Fields("mesa") = "" & cmytablex.Fields(1)
            mytablex.Fields("mesa") = "" & extra_loquesea(cmytablex.Fields(1))
            
            '24/08/2018  Delivery por mesa
            If V_EstadoMesa = "D" Then
                mytablex.Fields("servicio") = "D"

            End If

            '24/08/2018  Delivery por mesa
            
            ' 25/07/2018 Delivery y Para Llevar desde mozo
            
        End If

        If flag_servicio = "D" Then
            mytablex.Fields("servicio") = "D"

        End If

        mytablex.Fields("flage") = ""
        mytablex.Fields("codigo") = "" & xruc
        mytablex.Fields("caja") = "" & caja
        mytablex.Fields("turno") = "" & turno
        mytablex.Fields("usuario") = "" & cajero
        mytablex.Fields("fecha") = Format(dia, "dd/mm/yyyy")
        mytablex.Fields("hora") = Format(Now, "hh:MM:SS")
    
        mytablex.Fields("fechacrea") = Format(Now, "dd/mm/yyyy")
        mytablex.Fields("estado") = "2"

        'If local1.Visible = True Then
        'mytablex.Fields("codigo") = Trim("" & mytable11.Fields("local"))
        'End If
        If xxacu = "I" Then
            mytablex.Fields("acu") = xxacu

        End If
    
        If Label36.Caption = "Almac.Fuente." Then
            mytablex.Fields("bodega") = xruc
            mytablex.Fields("bodegaf") = Trim("" & mytable11.Fields("bodega"))

        End If

        If xxacu = "Q" Then
            mytablex.Fields("acu") = xxacu

        End If

        If local1 = "PEDIDO" Then
            mytablex.Fields("codigo") = ""

        End If

        If bxtipo = "7" Then
            mytablex.Fields("neto") = 0
            mytablex.Fields("descuento") = 0
            mytablex.Fields("subtotal") = 0
            mytablex.Fields("impuesto") = 0
            mytablex.Fields("total") = 0
            mytablex.Fields("xneto") = 0
            mytablex.Fields("tdetra") = 0

        End If

        'ojo aqui debe estar primero creado el codigo
 
        If Len(codigo) > 0 And (bxtipo = "1" Or bxtipo = "2" Or bxtipo = "3" Or bxtipo = "4" Or bxtipo = "5" Or bxtipo = "7") Then
            found = crea_nuevos_clientes("" & codigo, mytablex.Fields("producto"), mytablex.Fields("precio"), mytablex.Fields("fecha"), mytablex.Fields("unidad"), mytablex.Fields("factor"), mytablex.Fields("descripcio"))

        End If
 
        mytablex.Fields("flage") = "V"
        mytablex.Update
        'miramos si es combo-------------------------
        'If verifica_combo("" & Data2.Recordset.Fields("producto")) = 1 Then
        'If mytablezx.State = 1 Then mytablezx.Close
        '    mytablezx.Open "SELECT * FROM _c" & gusuario & " where producto='" & Data2.Recordset.Fields("producto") & "'", cn, adOpenDynamic, adLockOptimistic
        '    If mytablezx.RecordCount > 0 Then
        '      Do
        '      If mytablezx.EOF Then Exit Do
        '      mytablex.AddNew
        '      For i = 0 To Data2.Recordset.Fields.count - 1
        '      mytablex.Fields(i) = Data2.Recordset.Fields(i)
        '      Next i
        '
        '      mytablex.Fields("sentido") = "" & sentido
        '      mytablex.Fields("local") = Trim("" & mytable11.Fields("local"))
        '      mytablex.Fields("tipo") = "" & bxtipo
        '      mytablex.Fields("serie") = "" & bxserie
        '      mytablex.Fields("numero") = "" & bxnumero
        '      mytablex.Fields("vendedor") = xvendedor
        '      mytablex.Fields("tipoclie") = "C"
        '      mytablex.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))
        '      mytablex.Fields("bodega") = Trim("" & mytable11.Fields("bodega"))
        '      mytablex.Fields("bodegaf") = ""
        '      mytablex.Fields("acu") = acu
        '      mytablex.Fields("localf") = Trim("" & mytable11.Fields("local"))  '& codigo  'si no es traslado
        
        '      mytablex.Fields("flage") = ""
        '      mytablex.Fields("codigo") = "" & xruc
        '      mytablex.Fields("caja") = "" & caja
        '      mytablex.Fields("turno") = "" & turno
        '      mytablex.Fields("usuario") = "" & cajero
        '      mytablex.Fields("fecha") = Format(dia, "dd/mm/yyyy")
        '      mytablex.Fields("hora") = Format(Now, "hh:MM")
        '      mytablex.Fields("fechacrea") = Format(Now, "dd/mm/yyyy")
        '      mytablex.Fields("estado") = "2"
    
        '      mytablex.Fields("producto") = "" & mytablezx.Fields("productop")
        '      mytablex.Fields("descripcio") = "" & mytablezx.Fields("descripciop")
        '      mytablex.Fields("unidad") = "UND" '& mytablezx.Fields("unidad")
        '      mytablex.Fields("cantidad") = Val("" & Data2.Recordset.Fields("cantidad")) * Val("" & mytablezx.Fields("cantidad")) * 1 ' Val("" & mytablezx.Fields("factor"))
        '      mytablex.Fields("dua") = "C"  'C ES COMBO flag que dice que es receta
        '      mytablex.Fields("acu") = "T"  'guia de salida
        '      mytablex.Fields("precio") = 0
        '      mytablex.Fields("total") = 0
        '      mytablex.Fields("subtotal") = 0
        '      mytablex.Fields("impuesto") = 0
        '      mytablex.Update
        '    mytablezx.MoveNext
        '    Loop
        '    End If
        '    mytablezx.Close
    
        '------ fin de combo
        'End If
    
        'GRABANDO CLIENTES
        'verificamos si tiene receta
        'GoTo pasa_receta
        '----------------------------------------
    
        'aca ha
        If verifica_receta("" & Data2.Recordset.Fields("producto")) = 1 Then

            '---------------------------------------
            If mytablezx.State = 1 Then mytablezx.Close
            mytablezx.Open "SELECT * FROM receta where producto='" & Data2.Recordset.Fields("producto") & "'", cn, adOpenDynamic, adLockOptimistic

            If mytablezx.RecordCount > 0 Then
                Do

                    If mytablezx.EOF Then Exit Do
          
                    ''' 11/12/2017 SubReceta
                    'If verifica_descargaproducto("" & mytablezx.Fields("productoi")) = 0 Then
                    ''' 11/12/2017 SubReceta
          
                    mytablex.AddNew

                    For i = 0 To Data2.Recordset.Fields.count - 1
                        mytablex.Fields(i) = Data2.Recordset.Fields(i)
                    Next i
            
                    mytablex.Fields("sentido") = "" & sentido
                    mytablex.Fields("local") = Trim("" & mytable11.Fields("local"))
                    mytablex.Fields("tipo") = "" & bxtipo
                    mytablex.Fields("serie") = "" & bxserie
                    mytablex.Fields("numero") = "" & bxnumero

                    If Len(Trim(xvendedor)) > 0 Then
                        mytablex.Fields("vendedor") = xvendedor

                    End If

                    'mytablex.Fields("vendedor") = xvendedor
                    mytablex.Fields("tipoclie") = "C"
                    mytablex.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))
                    mytablex.Fields("bodega") = Trim("" & mytable11.Fields("bodega"))
                    mytablex.Fields("bodegaf") = ""
                    mytablex.Fields("acu") = acu
                    mytablex.Fields("localf") = Trim("" & mytable11.Fields("local"))  '& codigo  'si no es traslado
            
                    mytablex.Fields("flage") = ""
                    mytablex.Fields("codigo") = "" & xruc
                    mytablex.Fields("caja") = "" & caja
                    mytablex.Fields("turno") = "" & turno
                    mytablex.Fields("usuario") = "" & cajero
                    mytablex.Fields("fecha") = Format(dia, "dd/mm/yyyy")
                    mytablex.Fields("hora") = Format(Now, "hh:MM:ss")
                    'mytablex.Fields("fechacrea") = Format(Now, "hh:MM:SS")
                    mytablex.Fields("fechacrea") = Format(Now, "dd/mm/yyyy")
                    mytablex.Fields("estado") = "2"
    
                    mytablex.Fields("producto") = "" & mytablezx.Fields("productoi")
                    mytablex.Fields("descripcio") = "" & mytablezx.Fields("descripcio")
                    mytablex.Fields("unidad") = "" & mytablezx.Fields("unidad")
                    mytablex.Fields("cantidad") = Val("" & Data2.Recordset.Fields("cantidad")) * Val("" & mytablezx.Fields("cantidad")) * Val("" & mytablezx.Fields("factor"))
                    mytablex.Fields("dua") = "R"  'flag que dice que es receta
                    mytablex.Fields("acu") = "T"  'guia de salida
              
                    ''' kenyo 23/08/2017 Descontar stock de recetas en Recalculo de saldos
                    mytablex.Fields("acu1") = ""  'guia de salida
                    ''' kenyo 23/08/2017 Descontar stock de recetas en Recalculo de saldos
              
                    mytablex.Fields("precio") = 0
                    mytablex.Fields("total") = 0
                    mytablex.Fields("subtotal") = 0
                    mytablex.Fields("impuesto") = 0
              
                    '24/08/2018  Delivery por mesa
                    If V_EstadoMesa = "D" Then
                        mytablex.Fields("servicio") = "D"

                    End If

                    '24/08/2018  Delivery por mesa
              
                    mytablex.Update
                    ''' 11/12/2017 SubReceta
                    'End If
                    ''' 11/12/2017 SubReceta
                    mytablezx.MoveNext
                Loop

            End If

            mytablezx.Close

            '---------------------------------------
        End If

pasa_receta:
    
        Data2.Recordset.MoveNext
    Loop
    'MsgBox "Hola"
    xbuf = xbuf & " Detalle:" & Format(Now, "hh:mm:ss")

    'AQUI DEBE DESCARGAR EL SALDO ACTUAL
    If Trim("" & mytable11.Fields("terminal")) <> "T" And local1 <> "PEDIDO" Then

        'MsgBox "Hola1"
        If crucefa.ListCount = 0 Then  'si no es facturacion mensual
            mytablex.MoveFirst

            If UCase$(godetalle) = "DETALLE" Or UCase$(godetalle) = "DEDIARIO" Then

                'ALMACEN NOTA DE CREDITO 30/05/2017
                If xtipo = "N" Then 'NOTA DE CREDITO THEN
                    found = descarga_saldo(Trim("" & mytable11.Fields("local")), mytablex, bxtipo, bxserie, bxnumero, 1, 0)
                Else
                    found = descarga_saldo(Trim("" & mytable11.Fields("local")), mytablex, bxtipo, bxserie, bxnumero, -1, 0)

                End If

            End If

        End If

    End If

    mytablex.Close
    xbuf = xbuf & " Saldo:" & Format(Now, "hh:mm:ss")

    'kenyo inventario virtual 17/04/2017
    'AQUI DEBE DESCARGAR EL SALDO ACTUAL

    'If (xtipo = "P") Then
    '
    'If crucefa.ListCount = 0 Then  'si no es facturacion mensual
    '   mytablex.MoveFirst
    '   'If UCase$(godetalle) = "DETALLE" Or UCase$(godetalle) = "DEDIARIO" Then
    '      found = descarga_SaldoPedido(Trim("" & mytable11.Fields("local")), mytablex, bxtipo, bxserie, bxnumero, 1, 0)
    '   'End If
    'End If
    'End If
    '
    '
    'If (stockvirtual = "S") Then
    '
    'If crucefa.ListCount = 0 Then  'si no es facturacion mensual
    '   mytablex.MoveFirst
    '   'If UCase$(godetalle) = "DETALLE" Or UCase$(godetalle) = "DEDIARIO" Then
    '      found = descarga_SaldoPedido(Trim("" & mytable11.Fields("local")), mytablex, bxtipo, bxserie, bxnumero, -1, 0)
    '   'End If
    'End If
    'stockvirtual = "N"
    'End If
    'mytablex.Close

    'KENYO PONE EN ESTADO 1 A CUENTAC CUANDO ES FACTURACION MENSUAL
    'If Trim("" & mytable11.Fields("terminal")) <> "T" Then  'finalizar el terminal
    '   found = graba_guia_mensual() 'graba cuando es cruce de guias
    'End If

    If crucefa.ListCount = 0 Then
    Else
        graba_guia_mensual

    End If

    found = busca_xtipog("" & bxtipo)  'graba el numero al actual
    xbuf = xbuf & " tipo:" & Format(Now, "hh:mm:ss")

    'MsgBox "XX"
    'MsgBox "Pedido Grabado con la Orden Nro:" & xnumero
    If Trim("" & mytable11.Fields("terminal")) <> "T" And local1 <> "PEDIDO" Then

        'MsgBox "x"
        'If local1.Visible = False Then
        If ot = "S" And xtipo = Trim("" & mytable11.Fields("tipope")) And Len(petipo) = 0 Then 'si es pedido a cuenta grabar
            'menu_graba_fpedido
        Else
            xbuf = xbuf & " Fpago Antes:" & Format(Now, "hh:mm:ss")
            found = graba_fpagov(bxtipo, bxserie, bxnumero) 'graba fpagov
            xbuf = xbuf & " Fpago Despues:" & Format(Now, "hh:mm:ss")

        End If

        'End If
    End If

    xbuf = xbuf & " FIN:" & Format(Now, "hh:mm:ss")
    'MsgBox xbuf

    ' 26/07/2018 Desactivar Facturacion Electronica
    V_EstadoSistema = Obtiene_EstadoSistema
    '###########################################
    'DANIELKHEAVY
    '03/10/2018
    If V_EstadoSistema = "FE ARIES" Then
        If acu <> "A" And acu <> "B" And acu <> "I" And acu <> "G" Then     'si no es BOLETA MANUAL, FACTURA MANUAL,PEDIDO,VENTA INTERNA
   
            Call busca_tipo_comprobante(mytable11.Fields("local"), xtipo, xserie, xnumero, acu, salida, my_tipo, my_codcliente, "")

            If salida = True Then
   
                'Testing Facturacion Electronica 14/03/2018
                'Call Datos_Empresa(my_struc_datos_empresa(), caja, salida, 0)
                Call Datos_Empresa(my_struc_datos_empresa(), mytable11.Fields("local"), salida, 0)
                'Testing Facturacion Electronica 14/03/2018
    
                my_ruc = my_struc_datos_empresa(0).codigo1
                Call b_ubigeo_receptor(my_codcliente, salida, my_struc_ubigeo_Receptor())
    
                Call b_ubigeo_emisor(my_ruc, salida, my_struc_ubigeo_Emisor())
    
                Call busca_cliente(my_codcliente, my_carga_busca_cliente(), salida, 0)
                '**Información Adicional  - Anticipos
                '**busca trasporte
                Call b_credito(xserie, xnumero, my_credito, my_struc_credito())
                Call control_trasporte(mytable11.Fields("local"), xtipo, xserie, xnumero, "", salida, my_struc_Etransporte(), 0)

                '**fin busca trasporte
                'inicio 30/01/2018 pll
                For m = 0 To 10000
                    'DoEvents
                Next

                'fin 30/01/2018 pll
     
                my_tipoigv = extra_loquesea(CboTipoIgv)
                my_tipooperacion = extra_loquesea(CboTipoOperacion)

                'If my_tipo = "1" Then
                '    Call estrae_boletaARIES(my_ruc, mytable11.Fields("local"), xtipo, xserie, xnumero, my_idubigeo, acu, my_struc_datos_empresa(), my_struc_ubigeo_Receptor(), my_carga_busca_cliente, my_struc_credito(), my_struc_ubigeo_Emisor(), file)
                'ElseIf my_tipo = "2" Then
                '    Call estrae_facturaARIES(my_ruc, mytable11.Fields("local"), xtipo, xserie, xnumero, my_idubigeo, acu, my_struc_datos_empresa(), my_struc_ubigeo_Receptor(), my_carga_busca_cliente, my_struc_credito(), my_struc_ubigeo_Emisor(), my_struc_Etransporte(), file)

                'End If
                
                Call estrae_ComprobanteAries

                'aqui seria la busqueda del file
                Do While encontro = False
                    salida = FileExists("D:\ce_Input\FIRMADO\R_" & Left(file, (Len(file) - 10)) & ".txt")

                    If salida = True Then
                        Call busca_respuesta_electronica(file, "D:\ce_Input\FIRMADO\R_")
                        input_file = "D:\ce_Input\FIRMADO\R_" & Left(file, (Len(file) - 10)) & ".txt"
                        encontro = True

                    End If

                    salida = FileExists("D:\ce_Input\ERROR\R_" & Left(file, (Len(file) - 10)) & ".txt")

                    If salida = True Then
                        Call busca_respuesta_electronica(file, "D:\ce_Input\ERROR\R_")
                        input_file = "D:\ce_Input\ERROR\R_" & Left(file, (Len(file) - 10)) & ".txt"
                        encontro = True

                    End If

                Loop
                'input_file = file
                Call read_save_electronico(input_file, mytable11.Fields("local"), xserie, xnumero, xtipo, acu, "")
                '**fin 02/12/2017 pll
                'inicio 01/02/2018 pll
                'control impresion
                Call Busca_comprobante_sunat(mytable11.Fields("local"), xserie, xnumero, xtipo, salida)

                'aqui inicia a imprimir ..
                If salida = False Then

                    Do While encontro = False
                        salida = FileExists("D:\ce_Input\FIRMADO\R_" & Left(file, (Len(file) - 10)) & ".txt")

                        If salida = True Then
                            Call busca_respuesta_electronica(file, "D:\ce_Input\FIRMADO\R_")
                            input_file = "D:\ce_Input\FIRMADO\R_" & Left(file, (Len(file) - 10)) & ".txt"
                            encontro = True

                        End If

                        salida = FileExists("D:\ce_Input\ERROR\R_" & Left(file, (Len(file) - 10)) & ".txt")

                        If salida = True Then
                            Call busca_respuesta_electronica(file, "D:\ce_Input\ERROR\R_")
                            input_file = "D:\ce_Input\ERROR\R_" & Left(file, (Len(file) - 10)) & ".txt"
                            encontro = True

                        End If

                    Loop
                    'input_file = file
                    Call read_save_electronico(input_file, mytable11.Fields("local"), xserie, xnumero, xtipo, acu, "")

                End If

            End If

        End If

    End If
    '###########################################
    'DANIELKHEAVY
    '03/10/2018

    If V_EstadoSistema = "FE BYH" Then
        If acu <> "A" And acu <> "B" And acu <> "I" And acu <> "G" Then     'si no es BOLETA MANUAL, FACTURA MANUAL,PEDIDO,VENTA INTERNA
   
            Call busca_tipo_comprobante(mytable11.Fields("local"), xtipo, xserie, xnumero, acu, salida, my_tipo, my_codcliente, "")

            If salida = True Then
   
                'Testing Facturacion Electronica 14/03/2018
                'Call Datos_Empresa(my_struc_datos_empresa(), caja, salida, 0)
                Call Datos_Empresa(my_struc_datos_empresa(), mytable11.Fields("local"), salida, 0)
                'Testing Facturacion Electronica 14/03/2018
    
                my_ruc = my_struc_datos_empresa(0).codigo1
                Call b_ubigeo_receptor(my_codcliente, salida, my_struc_ubigeo_Receptor())
    
                Call b_ubigeo_emisor(my_ruc, salida, my_struc_ubigeo_Emisor())
    
                Call busca_cliente(my_codcliente, my_carga_busca_cliente(), salida, 0)
                '**Información Adicional  - Anticipos
                '**busca trasporte
                Call b_credito(xserie, xnumero, my_credito, my_struc_credito())
                Call control_trasporte(mytable11.Fields("local"), xtipo, xserie, xnumero, "", salida, my_struc_Etransporte(), 0)

                '**fin busca trasporte
                'inicio 30/01/2018 pll
                For m = 0 To 10000
                    'DoEvents
                Next

                'fin 30/01/2018 pll
     
                my_tipoigv = extra_loquesea(CboTipoIgv)
                my_tipooperacion = extra_loquesea(CboTipoOperacion)

                If my_tipo = "1" Then
                    Call estrae_boleta(my_ruc, mytable11.Fields("local"), xtipo, xserie, xnumero, my_idubigeo, acu, my_struc_datos_empresa(), my_struc_ubigeo_Receptor(), my_carga_busca_cliente, my_struc_credito(), my_struc_ubigeo_Emisor(), file)
                ElseIf my_tipo = "2" Then
                    Call estrae_factura(my_ruc, mytable11.Fields("local"), xtipo, xserie, xnumero, my_idubigeo, acu, my_struc_datos_empresa(), my_struc_ubigeo_Receptor(), my_carga_busca_cliente, my_struc_credito(), my_struc_ubigeo_Emisor(), my_struc_Etransporte(), file)

                End If

                'aqui seria la busqueda del file
                Do While encontro = False
                    salida = FileExists("D:\ce_Input\FIRMADO\R_" & Left(file, (Len(file) - 10)) & ".txt")

                    If salida = True Then
                        Call busca_respuesta_electronica(file, "D:\ce_Input\FIRMADO\R_")
                        input_file = "D:\ce_Input\FIRMADO\R_" & Left(file, (Len(file) - 10)) & ".txt"
                        encontro = True

                    End If

                    salida = FileExists("D:\ce_Input\ERROR\R_" & Left(file, (Len(file) - 10)) & ".txt")

                    If salida = True Then
                        Call busca_respuesta_electronica(file, "D:\ce_Input\ERROR\R_")
                        input_file = "D:\ce_Input\ERROR\R_" & Left(file, (Len(file) - 10)) & ".txt"
                        encontro = True

                    End If

                Loop
                'input_file = file
                Call read_save_electronico(input_file, mytable11.Fields("local"), xserie, xnumero, xtipo, acu, "")
                '**fin 02/12/2017 pll
                'inicio 01/02/2018 pll
                'control impresion
                Call Busca_comprobante_sunat(mytable11.Fields("local"), xserie, xnumero, xtipo, salida)

                'aqui inicia a imprimir ..
                If salida = False Then

                    Do While encontro = False
                        salida = FileExists("D:\ce_Input\FIRMADO\R_" & Left(file, (Len(file) - 10)) & ".txt")

                        If salida = True Then
                            Call busca_respuesta_electronica(file, "D:\ce_Input\FIRMADO\R_")
                            input_file = "D:\ce_Input\FIRMADO\R_" & Left(file, (Len(file) - 10)) & ".txt"
                            encontro = True

                        End If

                        salida = FileExists("D:\ce_Input\ERROR\R_" & Left(file, (Len(file) - 10)) & ".txt")

                        If salida = True Then
                            Call busca_respuesta_electronica(file, "D:\ce_Input\ERROR\R_")
                            input_file = "D:\ce_Input\ERROR\R_" & Left(file, (Len(file) - 10)) & ".txt"
                            encontro = True

                        End If

                    Loop
                    'input_file = file
                    Call read_save_electronico(input_file, mytable11.Fields("local"), xserie, xnumero, xtipo, acu, "")

                End If

            End If

        End If

    End If
  
    ' 26/07/2018 Desactivar Facturacion Electronica

    proceso_impresion11 "" & bxtipo, "" & bxserie, "" & bxnumero, 1, ""

    If Trim("" & mytable11.Fields("hod")) = "S" And flag_servicio <> "C" Then 'enviar orden de despacho
        'If "" & mytable11.Fields("comanda") = "S" Then
        'orden13012015 "" & mytable11.Fields("local"), bxtipo, bxserie, bxnumero
               
        ''11/07/2017 kenyo multicomandas
        'found = orden_despacho_n("" & mytable11.Fields("local"), bxtipo, bxserie, bxnumero, "", 0)
        
        If mytable11.Fields("multicomanda") = "S" Then
 
            nroimpresion = 0
            found = orden_despacho_n("" & mytable11.Fields("local"), bxtipo, bxserie, bxnumero, "", 0)
         
            nroimpresion = 1
            found = orden_despacho_n("" & mytable11.Fields("local"), bxtipo, bxserie, bxnumero, "", 1)
        
            nroimpresion = 2
            found = orden_despacho_n("" & mytable11.Fields("local"), bxtipo, bxserie, bxnumero, "", 2)
        
            nroimpresion = 3
            found = orden_despacho_n("" & mytable11.Fields("local"), bxtipo, bxserie, bxnumero, "", 3)
        
        Else
            nroimpresion = 0
            found = orden_despacho_n("" & mytable11.Fields("local"), bxtipo, bxserie, bxnumero, "", 0)
        
        End If
        
        ''11/07/2017 kenyo multicomandas
        'found = orden_despacho_n("" & mytable11.Fields("local"), bxtipo, bxserie, bxnumero, "", 1)
        'Else
        'orden_normal
        'End If
    End If

    If Trim("" & mytable11.Fields("video")) = "S" Then
        If bxtipo = "7" Or Len(ndetraccion) > 0 Then
            graba_video_concar bxserie & "-" & bxnumero

        End If

    End If

    'impresion_sin_formato xtipo, xserie, xnumero
    'MsgBox "x"
    found = borrar_proformas()
    'MsgBox "Hola"
    found = borrar_pedidos()
    'MsgBox "Hola"
    found = borrar_cotizacion()
    cn.Execute ("update hotelcheckin set estado1='2' where checkin=" & Val(vHabitacion))
    found = borrar_comanda()

    '09/03/2018 Borra envio_correos en venta
    'envio_correos
    '09/03/2018 Borra envio_correos en venta

    '16/06/2017 kenyo NOTA DE CREDITO
    If xtipo = "N" Then
 
        'factura:   total , descuento, neto, impuesto, subtotal, destopo, gravado
        'detalle:  cantidad , igv, neto, descuento, subtotal, impuesto, total,comision
        'fpagov:total,recibe,cambio

        'Actualizando en negativo a FACTURA para Nota de Credito
        Dim buffac As String

        buffac = "update factura SET total=total*-1,DESCUENTO=descuento*-1,NETO=NETO*-1,"
        buffac = buffac & "IMPUESTO=IMPUESTO*-1,SUBTOTAL=SUBTOTAL*-1,DESTOPO=DESTOPO*-1,GRAVADO=GRAVADO*-1   WHERE TIPO='N'  and tipo='"
        buffac = buffac & xtipo & "' and DUA IS NULL and serie='" & xserie & "' and numero='" & xnumero & "'"
        cn.Execute (buffac)
        
        'Actualizando en negativo a DETALLE para Nota de Credito
        Dim bufdet As String

        bufdet = "update detalle set cantidad=cantidad*-1,igv=igv*-1,neto=neto*-1,descuento=descuento*-1, "
        bufdet = bufdet & " subtotal=subtotal*-1,impuesto=impuesto*-1,total=total*-1,comision=comision*-1   WHERE TIPO='N'  and tipo='"
        bufdet = bufdet & xtipo & "' and DUA IS NULL and serie='" & xserie & "' and numero='" & xnumero & "'"
        cn.Execute (bufdet)
    
        'Actualizando en negativo a FORMAS DE PAGO para Nota de Credito
        Dim buffp As String

        buffp = "update fpagov set total=total*-1,recibe=recibe*-1,cambio=cambio*-1  WHERE TIPO='N'  and tipo='"
        buffp = buffp & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "'"
        cn.Execute (buffp)
        '
    
    End If

    'total,descuento,neto,impuesto,subtotal,destopo,gravado
    '16/06/2017 kenyo NOTA DE CREDITO

    inicialIzatodo

    'MsgBox "Hola"
    gocabeza = antgocabeza
    godetalle = antgodetalle
    'losao94_Click
    'losao94_Click

    Exit Function
cmd67333_err:
    gocabeza = antgocabeza
    godetalle = antgodetalle
    MsgBox "Error en GRABACION TOTAL " + error$, 48, "Aviso"
    Exit Function

End Function

Function borrar_comanda()

    Dim buf      As String

    Dim buf1     As String

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd8900012_err

    If flag_servicio = "C" Then
        buf = cmytablex.Fields("salon")

        ' 25/07/2018 Delivery y Para Llevar desde mozo
        'buf1 = cmytablex.Fields(1)
        buf1 = extra_loquesea(cmytablex.Fields(1))
        ' 25/07/2018 Delivery y Para Llevar desde mozo

        'If cmytablex.RecordCount > 0 Then
        If cuenta_separa <> "S" Then
            cn.Execute ("delete from dcomanda where salon='" & buf & "' and mesa='" & buf1 & "'")
            cn.Execute ("update mesa set estado='' where salon='" & buf & "' and mesa='" & buf1 & "'")

        End If

        If cuenta_separa = "S" Then
            cn.Execute ("update dcomanda set cantidad=cantidad-cantdev where salon='" & buf & "' and mesa='" & buf1 & "' and cantdev>0")
            cn.Execute ("delete from dcomanda where salon='" & buf & "' and mesa='" & buf1 & "' and cantidad=0 and cantdev>0")
            cn.Execute ("update dcomanda set cantdev=0 ,total=cantidad*precio where salon='" & buf & "' and mesa='" & buf1 & "' and  cantdev>0")

            'cn.Execute ("delete from dcomanda where salon='" & buf & "' and mesa='" & buf1 & "' and flage='S'")
            'mytablex.Open "SELECT * FROM dcomanda where  salon='" & buf & "' and mesa='" & buf1 & "' and cantdev>0", cn, adOpenDynamic, adLockOptimistic
            'If mytablex.RecordCount = 0 Then  'si existe
            '   mytablex.Close
            'End If
            'Do
            'If mytablex.EOF Then Exit Do
            'mytablex.MoveNext
            'Loop
        End If

    End If

    Exit Function
cmd8900012_err:
    MsgBox "Aviso en borrar Comanda " + error$, 48, "Aviso"
    Exit Function

End Function

Sub grabando_cabecera(mytablex As ADODB.Recordset, _
                      bxtipo As String, _
                      bxserie As String, _
                      bxnumero As String)

    Dim mytablecom As New ADODB.Recordset

    'On Error GoTo cmd232_err   ''LEO: 14-03-17-
    'MsgBox ""
    If Val(tdetra) > 0 Then
        mytablex.Fields("denumero") = Format(Val(ndetraccion), "0000000000")

    End If

    'MsgBox Trim(extra_loquesea(clasesunat))
    mytablex.Fields("destopo") = Val(valordescuento)
    mytablex.Fields("clasesunat") = Trim(extra_loquesea(clasesunat))
    mytablex.Fields("sentido") = sentido
    mytablex.Fields("observa") = xdistrito
    mytablex.Fields("tdetra") = Val(tdetra)
    mytablex.Fields("xneto") = Val(tpeaje)
    mytablex.Fields("tisc") = Val(tisc)
    mytablex.Fields("tivap") = Val(tivap)

    '16/06/2017 kenyo NOTA DE CREDITO
    'mytablex.Fields("tipo1") = petipo
    'mytablex.Fields("serie1") = peserie
    'mytablex.Fields("numero1") = penumero

    If xtipo = "N" Then
        mytablex.Fields("tipo1") = nctipo
        mytablex.Fields("serie1") = ncserie
        mytablex.Fields("numero1") = ncnumero
    Else
        mytablex.Fields("tipo1") = petipo
        mytablex.Fields("serie1") = peserie
        mytablex.Fields("numero1") = penumero

    End If

    '16/06/2017 kenyo NOTA DE CREDITO

    If Len(axctipo) > 0 Then
        mytablex.Fields("tipo1") = axctipo
        mytablex.Fields("serie1") = axcserie
        mytablex.Fields("numero1") = axcnumero

    End If

    If Len(Trim(referencia)) > 0 Then  'que es referencia
        mytablex.Fields("observa") = Mid$("" & referencia, 1, 60)

    End If

    'MsgBox ""
    mytablex.Fields("adetotal") = 0
    mytablex.Fields("acuenta") = Val(acuenta)
    mytablex.Fields("retipo1") = ""
    mytablex.Fields("renumero1") = ""
    mytablex.Fields("renumero2") = ""
    mytablex.Fields("renumero3") = ""
    mytablex.Fields("retotal1") = 0
    mytablex.Fields("retotal2") = 0
    mytablex.Fields("retotal3") = 0
    mytablex.Fields("retotal") = 0
    mytablex.Fields("zona") = ""
    mytablex.Fields("nombre") = xnombre
    'MsgBox ""
    mytablex.Fields("estado") = "2"
    mytablex.Fields("tipoclie") = "C"
    mytablex.Fields("tipo") = "" & bxtipo
    mytablex.Fields("serie") = "" & bxserie
    mytablex.Fields("numero") = bxnumero

    mytablex.Fields("codigo") = xruc

    mytablex.Fields("partida") = ""
    mytablex.Fields("destino") = ""
    mytablex.Fields("yausado") = "0"
    mytablex.Fields("nro_items") = Val(ntcant)
    mytablex.Fields("fecha") = Format(dia, "dd/mm/yyyy")
    mytablex.Fields("fechae") = Format(Now, "dd/mm/yyyy")

    '' 02/12/2017 Modulo Delivery Proyecto Principal

    ''' kenyo 31/08/2017 Modulo delivery personalizado
    'mytablex.Fields("horae") = Format(horaentrega, "hh:mm:ss")

    If flag_servicio = "D" Then
        mytablex.Fields("horae") = ""
    Else
        mytablex.Fields("horae") = Format(horaentrega, "hh:mm:ss")

    End If

    ''' kenyo 31/08/2017 Modulo delivery personalizado

    '' 02/12/2017 Modulo Delivery Proyecto Principal

    If Len(Trim(fechae)) > 0 Then
        If IsDate(fechae) Then
            mytablex.Fields("fechae") = Format(fechae, "dd/mm/yyyy")

        End If

    End If

    mytablex.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))

    If Len(Trim(xvendedor)) > 0 Then
        mytablex.Fields("vendedor") = xvendedor

    End If

    '07/08/2018 Testing
    'inicio 06/1272017 pll
    'mytablex.Fields("vendedor") = xvendedor
    'fin 06/1272017 pll
    '07/08/2018 Testing

    'KENYO 18/04/2017 FORMA DE PAGO FACTURACION MANUAL
    'mytablex.Fields("fpago") = ""
    'INicio 06/12/2017 pll
    If xtipo = "3" Or xtipo = "4" Or xtipo = "1" Or xtipo = "2" Then
        'If xtipo = "3" Or xtipo = "4" Then
        'fIN 06/12/2017 pll
        mytablex.Fields("fpago") = "" & dbgrid10.columns(1)
    Else
        mytablex.Fields("fpago") = ""

    End If

    mytablex.Fields("transporte") = ""
    mytablex.Fields("paridad") = Val(paridad)
    mytablex.Fields("dias") = 1
    mytablex.Fields("bodega") = Trim("" & mytable11.Fields("bodega"))
    mytablex.Fields("bodegaf") = ""
    'mytablex.Fields("observa") = ""

    mytablex.Fields("usuario") = "" & gusuario
    mytablex.Fields("caja") = "" & caja
    mytablex.Fields("turno") = "" & turno
    mytablex.Fields("usuario") = "" & cajero
    mytablex.Fields("acu") = acu

    'MsgBox acu
    If Trim("" & mytable11.Fields("terminal")) = "T" Then

        'mytablex.Fields("acu") = "I"
    End If

    mytablex.Fields("acu1") = ""
    mytablex.Fields("flage") = ""
    mytablex.Fields("telefono") = "" & telefono
    mytablex.Fields("hora") = Format(Now, "hh:MM:SS")
    'mytablex.Fields("fechacrea") = Format(Now, "HH:MM:SS")
    mytablex.Fields("fechacrea") = Format(Now, "dd/mm/yyyy")
    
    mytablex.Fields("gravado") = Val("" & gravado)
    mytablex.Fields("total") = Val("" & txtotal)
    mytablex.Fields("redondeo") = Val(Format(txtotlare, nrodecimal))
    mytablex.Fields("descuento") = Val("" & txdescuento)
    mytablex.Fields("neto") = Val("" & txneto)
    'MsgBox Val(tximpuesto)
    mytablex.Fields("impuesto") = Val("" & tximpuesto)
    mytablex.Fields("subtotal") = Val("" & txsubtotal)

    'MsgBox "abc"
    'mytablex.Fields("tipo1") = ""
    'mytablex.Fields("serie1") = ""
    mytablex.Fields("serie2") = ""
    mytablex.Fields("serie3") = ""
    mytablex.Fields("serie4") = ""
    mytablex.Fields("serie5") = ""
    mytablex.Fields("serie6") = ""
    mytablex.Fields("serie7") = ""

    'mytablex.Fields("numero1") = ""
    mytablex.Fields("numero2") = ""
    mytablex.Fields("numero3") = ""
    mytablex.Fields("numero4") = ""
    mytablex.Fields("numero5") = ""
    mytablex.Fields("numero6") = ""
    mytablex.Fields("numero7") = ""
    mytablex.Fields("c1") = Val(c1)
    mytablex.Fields("c2") = Val(c2)
    mytablex.Fields("c3") = Val(c3)
    mytablex.Fields("c4") = Val(c4)
    mytablex.Fields("c5") = Val(c5)
    mytablex.Fields("c6") = Val(c6)
    mytablex.Fields("c7") = Val(c7)
    mytablex.Fields("c8") = Val(c8)

    mytablex.Fields("c9") = Val(c9)

    ''25/07/2017 kenyo CONDICION DE PAGO SISTEMA
    If bxtipo <> "P" Then
        If dbgrid10.columns(1) = "3" Then
            mytablex.Fields("C9") = "3"
        Else
            mytablex.Fields("C9") = "1"

        End If

    End If

    ''25/07/2017 kenyo CONDICION DE PAGO SISTEMA

    '''30/10/2017 Impresión de Tipo de documento en comprobantes
    'mytablex.Fields("documento") = "" & ntipox
    '''30/10/2017 Impresión de Tipo de documento en comprobantes

    'MsgBox "ABC"
    mytablex.Fields("SERVICIOCO") = Val(serviciocobro)
    'MsgBox "abc"
    mytablex.Fields("local") = Trim("" & mytable11.Fields("local"))
    mytablex.Fields("montopagar") = 0
    mytablex.Fields("ruc") = "" & xruc
    mytablex.Fields("TDOCDELI") = ""
    mytablex.Fields("servicio") = flag_servicio
    'mytablex.Fields("placa") = ""

    If flag_servicio = "A" Then
        mytablex.Fields("servicio") = "A"
        mytablex.Fields("placa") = ""

    End If

    If flag_servicio = "D" Then
        mytablex.Fields("servicio") = "D"
        mytablex.Fields("placa") = "PENDIENTE"

    End If

    If flag_servicio = "C" Then
        mytablex.Fields("servicio") = "C"
        mytablex.Fields("placa") = ""

        mytablex.Fields("salon") = "" & cmytablex.Fields("salon")

        '24/08/2018  Delivery por mesa
        If V_EstadoMesa = "D" Then
            mytablex.Fields("servicio") = "D"

        End If

        '24/08/2018  Delivery por mesa

        ' 25/07/2018 Delivery y Para Llevar desde mozo

        'mytablex.Fields("mesa") = "" & cmytablex.Fields(1)
        mytablex.Fields("mesa") = "" & extra_loquesea(cmytablex.Fields(1))
        ' 25/07/2018 Delivery y Para Llevar desde mozo
        ''kenyo 14-03
        'obtiene numero de personas por mesa

        ' 25/07/2018 Delivery y Para Llevar desde mozo
        'mytablecom.Open "SELECT * FROM mesa where salon='" & cmytablex.Fields("salon") & "' and mesa='" & cmytablex.Fields(1) & "'", cn, adOpenDynamic, adLockOptimistic
        mytablecom.Open "SELECT * FROM mesa where salon='" & cmytablex.Fields("salon") & "' and mesa='" & extra_loquesea(cmytablex.Fields(1)) & "'", cn, adOpenDynamic, adLockOptimistic
        ' 25/07/2018 Delivery y Para Llevar desde mozo

        personasx = mytablecom.Fields("capacidad")
        mytablex.Fields("personas") = "" & mytablecom.Fields("capacidad")

        If mytablecom.RecordCount = 0 Then
            mytablecom.Close

        End If

        mytablecom.Close

        'mytablex.Fields("mesa") = "" & cmytablex.Fields(1)

    End If

    'validamos aqui si es traslado
    If xxacu = "I" Then
        mytablex.Fields("acu") = xxacu
        mytablex.Fields("placa") = "PENDIENTE"

    End If

    If xxacu = "Q" Then
        mytablex.Fields("acu") = xxacu

    End If

    If local1 = "PEDIDO" Then
        mytablex.Fields("CODIGO") = ""
        mytablex.Fields("nombre") = "PEDIDO REPOSICION"

    End If

    If Label36.Caption = "Almac.Fuente." Then
        mytablex.Fields("bodega") = xruc
        mytablex.Fields("bodegaf") = Trim("" & mytable11.Fields("local"))

    End If

    mytablex.Fields("percepcion") = Val(txpercepcion)

    If bxtipo = "7" Then
        mytablex.Fields("neto") = 0
        mytablex.Fields("descuento") = 0
        mytablex.Fields("subtotal") = 0
        mytablex.Fields("impuesto") = 0
        mytablex.Fields("total") = 0
        mytablex.Fields("xneto") = 0
        mytablex.Fields("tdetra") = 0
        mytablex.Fields("servicioco") = 0
        mytablex.Fields("percepcion") = 0

    End If

    'MsgBox "x"

    ' Testing Proyecto Facturacion Electronica 12/04/2018
    If xxacu <> "I" Then
        mytablex.Fields("E_SUNAT") = "N"

    End If

    ' Testing Proyecto Facturacion Electronica 12/04/2018

    grabar_dato_pedido codigo, bxtipo, bxserie, bxnumero
    Exit Sub
cmd232_err:
    MsgBox "Error en grabando Cabecera " & error$, 48, "Aviso"
    Exit Sub

End Sub

Sub busca_correlativo(sw As Integer)

    Dim sdx      As Double

    Dim mytablex As New ADODB.Recordset

    '''' 25/07/2018 Delivery y Para Llevar desde mozo
    'mytablex.Open "select * from parame where codigo='01'", cn, adOpenStatic, adLockOptimistic
    mytablex.Open "select max(codigo)  as clientes from CLIENTES WHERE LEN(CODIGO)<=10", cn, adOpenStatic, adLockOptimistic

    '''' 25/07/2018 Delivery y Para Llevar desde mozo

    If mytablex.RecordCount = 0 Then
        mytablex.Close
        Exit Sub

    End If

    If sw = 0 Then
        sdx = Val("" & mytablex.Fields("clientes")) + 1
        dcodigo = "" & sdx

    End If

    If sw = 1 Then
        If IsNumeric(dcodigo) Then
   
            '''' 25/07/2018 Delivery y Para Llevar desde mozo
            'mytablex.Fields("clientes") = dcodigo
            'mytablex.Update
            cn.Execute ("update parame set  clientes='" & dcodigo & "'")
  
            '''' 25/07/2018 Delivery y Para Llevar desde mozo
   
        End If

        mytablex.Close
        Exit Sub

    End If

    mytablex.Close
sigueb:
    mytablex.Open "select * from clientes where codigo='" & dcodigo & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        mytablex.Close
        sdx = sdx + 1
        dcodigo = "" & sdx
        GoTo sigueb
        Exit Sub

    End If

    mytablex.Close

End Sub

Function busca_banco(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM banco where banco='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        busca_banco = 1

    End If

    mytablex.Close

End Function

Function verifica_receta(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM receta where producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        verifica_receta = 1

    End If

    mytablex.Close

End Function

Function verifica_combo(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM _c" & gusuario & " where producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        verifica_combo = 1

    End If

    mytablex.Close

End Function

Function busca_remate(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT producto,remate FROM producto where producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        If "" & mytablex.Fields("remate") = "S" Then
            busca_remate = 1

        End If

    End If

    mytablex.Close

End Function

Sub sumar_reforzar()

    Dim sdx      As Double

    Dim mytablex As Table

    Exit Sub
    Set mytablex = mydbxglo.OpenTable(dgusuario)
    sdx = 0
    Do

        If mytablex.EOF Then Exit Do
        MsgBox "" & mytablex.Fields("producto")
        'If Val("" & mytablex.Fields("total")) > 0 Then
        sdx = sdx + Val("" & mytablex.Fields("total"))
        'End If
        mytablex.MoveNext
    Loop
    MsgBox sdx
    rtxtotal = Format(sdx, "0.00")
    mytablex.Close

End Sub

Private Sub zfamilia_Click(Index As Integer)

    Dim buff As String

    If flagsubfamilia <> "S" Then  'si no se usa subfamilia quiebre por familia
        If Len(wwfamcod(Index)) = 0 Then
            Exit Sub

        End If

        buff = "" & wwfamcod(Index)
        menu_carga_producto buff
        menu_producto "INI"
        Exit Sub

    End If

    'If Trim(Label2.Caption) = "FAMILIA" Then
    If Trim(Label2.Caption) = "FAMILIA" Then
        If Len(wwfamcod(Index)) = 0 Then
            Exit Sub

        End If

        buff = "" & wwfamcod(Index)
        Label2.Caption = buff
        carga_subfamilia "" & buff
        Exit Sub

    End If

    'menu_carga_producto zfamilia(Index).Caption
    If Len(wwsfamcod(Index)) = 0 Then
        Exit Sub

    End If
  
    buff = "" & wwsfamcod(Index)
    'MsgBox buff
    menu_carga_producto buff
    menu_producto "INI"

End Sub

Private Sub ydireccion_DblClick()
    tkeyboar.FLAG = "YDIRECCION"
    tkeyboar.Show 1

End Sub

Private Sub ydireccion_KeyDown(KeyCode As Integer, Shift As Integer)

    ''27/07/2017 kenyo OCULTA CONTROL DE CLIENTES
    If KeyCode = vbKeyEscape Then
        frmClientesRUC.Visible = False

    End If

    ''27/07/2017 kenyo OCULTA CONTROL DE CLIENTES
End Sub

Private Sub ydireccion_KeyPress(KeyAscii As Integer)

    If KeyAscii <> 13 Then Exit Sub
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus
   
End Sub

Private Sub zfamilias_Click(Index As Integer)

    Dim buff As String

    'inicio 25/04/2017 kenyo
    If frmClientesRUC.Visible = True Then
        frmClientesRUC.Visible = False

    End If
  
    'fin 25/04/2017 kenyo

    If flagsubfamilia <> "S" Then  'si no se usa subfamilia quiebre por familia
        If Len(wwfamcod(Index)) = 0 Then
            Exit Sub

        End If

        buff = "" & wwfamcod(Index)
   
        'Color por familia y producto  30/05/2018
        ffamilia = ""
        ffamilia = "" & buff
        'Color por familia y producto  30/05/2018
    
        menu_carga_producto buff
        menu_producto "INI"
        ' iResultadoSound = mciExecute("Play " & "C:\Windows\click.wav")
        Exit Sub

    End If

    'If Trim(Label2.Caption) = "FAMILIA" Then
    If Trim(Label2.Caption) = "FAMILIA" Then
        If Len(wwfamcod(Index)) = 0 Then
            Exit Sub

        End If

        buff = "" & wwfamcod(Index)
   
        'Color por familia y producto  30/05/2018
        ffamilia = ""
        ffamilia = "" & buff
        'Color por familia y producto  30/05/2018

        Label2.Caption = buff
        'Label2.Caption = buff
        carga_subfamilia "" & buff
        Exit Sub

    End If

    If Len(wwsfamcod(Index)) = 0 Then
        Exit Sub

    End If
  
    buff = "" & wwsfamcod(Index)
    'MsgBox buff
    menu_carga_producto buff
    menu_producto "INI"

End Sub

Sub menu_carga_producto(buf As String)

    Dim mytablex As New ADODB.Recordset

    Dim mytabley As New ADODB.Recordset

    Dim i        As Integer

    Dim buf1     As String

    Dim buf2     As String

    Dim buf3     As String

    buf1 = ""
    buf2 = ""
    buf3 = ""
    mytabley.Open "SELECT * FROM parame where  codigo='01'", cn, adOpenDynamic, adLockOptimistic

    If mytabley.RecordCount > 0 Then 'si existe
        buf1 = Trim("" & mytabley.Fields("diasemana"))

    End If

    mytabley.Close

    For i = 0 To 31
        wwprodcod(i) = ""
    Next i

    For i = 0 To 14999
        mprodcod(i) = ""
        wprodcod(i) = ""
    Next i

    i = -1

    If mytablex.State = 1 Then mytablex.Close
    '22/06/2017 kenyo CORRECION orden familia y producto touch

    If flagsubfamilia <> "S" Then  'si no se usa subfamilia quiebre por familia
        If buf1 = "S" Then
            mytablex.Open "SELECT * FROM producto where " & buf2 & " familia='" & buf & "'" & buf3 & " and dia='" & Trim(dia_dela_semana()) & "' order by touch,descripcio ", cn, adOpenDynamic, adLockOptimistic
        Else
            mytablex.Open "SELECT * FROM producto where" & buf2 & " familia='" & buf & "'" & buf3 & " order by touch,descripcio ", cn, adOpenDynamic, adLockOptimistic

        End If

    End If

    If flagsubfamilia = "S" Then  'si no se usa subfamilia quiebre por familia
    
        If buf1 = "S" Then
            mytablex.Open "SELECT * FROM producto where " & buf2 & " familia='" & Trim(Label2.Caption) & "'" & buf3 & " and subfamilia='" & buf & "' and dia='" & Trim(dia_dela_semana()) & "' order by touch,descripcio ", cn, adOpenDynamic, adLockOptimistic
        Else
            mytablex.Open "SELECT * FROM producto where " & buf2 & " familia='" & Trim(Label2.Caption) & "'" & buf3 & " and subfamilia='" & buf & "' order by touch,descripcio ", cn, adOpenDynamic, adLockOptimistic

        End If

    End If

    '
    '    If flagsubfamilia <> "S" Then  'si no se usa subfamilia quiebre por familia
    '        If buf1 = "S" Then
    '            mytablex.Open "SELECT * FROM producto where " & buf2 & " familia='" & buf & "'" & buf3 & " and dia='" & Trim(dia_dela_semana()) & "' order by descripcio,touch ", cn, adOpenDynamic, adLockOptimistic
    '        Else
    '            mytablex.Open "SELECT * FROM producto where" & buf2 & " familia='" & buf & "'" & buf3 & " order by descripcio,touch ", cn, adOpenDynamic, adLockOptimistic
    '        End If
    '    End If
    '
    '    If flagsubfamilia = "S" Then  'si no se usa subfamilia quiebre por familia
    '
    '        If buf1 = "S" Then
    '            mytablex.Open "SELECT * FROM producto where " & buf2 & " familia='" & Trim(Label2.Caption) & "'" & buf3 & " and subfamilia='" & buf & "' and dia='" & Trim(dia_dela_semana()) & "' order by descripcio,touch ", cn, adOpenDynamic, adLockOptimistic
    '        Else
    '            mytablex.Open "SELECT * FROM producto where " & buf2 & " familia='" & Trim(Label2.Caption) & "'" & buf3 & " and subfamilia='" & buf & "' order by descripcio,touch ", cn, adOpenDynamic, adLockOptimistic
    '        End If
    '    End If
    '
    '22/06/2017 kenyo CORRECION orden familia y producto touch
    
    'MsgBox mytablex.RecordCount
    Do

        If mytablex.EOF Then Exit Do

        'If "" & mytablex.Fields("familia") = buf Then
        If Trim("" & mytablex.Fields("vecaja")) <> "N" Then
            If Len(Trim("" & mytablex.Fields("dia"))) <> 0 Then
                If Trim("" & mytablex.Fields("dia")) <> Trim(dia_dela_semana()) Then
                    GoTo guiese

                End If

            End If

            i = i + 1
            mprodcod(i) = "" & mytablex.Fields("descripcio")
            wprodcod(i) = "" & mytablex.Fields("producto")
            Else: Exit Do

        End If

        'End If
guiese:
        mytablex.MoveNext
    Loop

    mytablex.Close
    mprodtop = i
    mprodpag = 0

End Sub

Sub menu_producto(buf As String)

    Dim i As Integer

    Dim j As Integer

    Select Case buf

        Case "INI"
            mprodpag = 0

        Case "SIG"
            mprodpag = mprodpag + 27

            If mprodpag > 102 Then
                mprodpag = 0

            End If

        Case "ANT"
            mprodpag = mprodpag - 27

            If mprodpag < 0 Then
                mprodpag = 0

            End If

    End Select

    j = -1

    For i = mprodpag To 27 + mprodpag
        j = j + 1
        zproductos(j).Caption = mprodcod(i)
        wwprodcod(j) = wprodcod(i)
        lectura_grafico wprodcod(i), j
    
        'Color por familia y producto  30/05/2018

        If flagcolorfamprod = "S" Then

            Dim I1       As Integer

            Dim I2       As Integer

            Dim I3       As Integer
        
            Dim mytablex As New ADODB.Recordset

            mytablex.Open "SELECT * FROM familia where  familia='" & "" & ffamilia & "'", cn, adOpenKeyset, adLockOptimistic

            If mytablex.RecordCount > 0 Then
                I1 = "" & mytablex.Fields("c")
                I2 = "" & mytablex.Fields("d")
                I3 = "" & mytablex.Fields("e")
                zproductos(j).BackColor = RGB(I1, I2, I3)

            End If

            mytablex.Close

        End If
    
        '    'Color por familia y producto  30/05/2018

    Next i

End Sub

Private Sub znumber_Click(Index As Integer)

    If hknumero.Caption = "®" Then hknumero.Caption = ""

    Dim found As Integer

    If Index = 12 Then
          
        '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017
        If Frame5.Visible = True Then Exit Sub
        If hknumero.Caption = "" Then Exit Sub
        '''06/08/2017 kenyo Testing Completo al Sistema 15/12/2017
    
        vBUSCAXPRODUCTO = 1
        busca_cod_producto "" & hknumero.Caption, 1
        vBUSCAXPRODUCTO = 0
        Exit Sub

    End If

    If Index = 13 Then
        hknumero = ""
        Exit Sub

    End If

    If Index = 14 Then

        'hknumero = "00"
        ' Exit Sub
    End If

    found = InStr(hknumero, "/")

    If found > 1 Then  ' si es cantidad
        Exit Sub
    End If '

    hknumero = hknumero & znumber(Index).Caption '

End Sub

Private Sub znumbert_Click(Index As Integer)

    If Index = 11 Then
        RGPAGO = ""
        Exit Sub

    End If

    RGPAGO = RGPAGO & znumbert(Index).Caption

End Sub

Private Sub zproductos_Click(Index As Integer)

    If Len(wwprodcod(Index)) = 0 Then
        Exit Sub

    End If

    '-----------LEONARDO 28-10-2016----------------------------
    xprecioDsctox = 0: xprecioDsctox2 = 0: xprecioDsctox3 = 0: xprecioDsctox4 = 0: xprecioDsctox5 = 0: xprecioDsctox6 = 0: xprecioDsctox7 = 0: xprecioDsctox8 = 0: xprecioDsctox9 = 0: xprecioDsctox10 = 0
    xfactorDsctox = 0: xfactorDsctox2 = 0: xfactorDsctox3 = 0: xfactorDsctox4 = 0: xfactorDsctox5 = 0: xfactorDsctox6 = 0: xfactorDsctox7 = 0: xfactorDsctox8 = 0: xfactorDsctox9 = 0: xfactorDsctox10 = 0
    xunidadDsctox = "": xunidadDsctox2 = "": xunidadDsctox3 = "": xunidadDsctox4 = "": xunidadDsctox5 = "": xunidadDsctox6 = "": xunidadDsctox7 = "": xunidadDsctox8 = "": xunidadDsctox9 = 0: xunidadDsctox10 = ""
    busca_cod_producto "" & wwprodcod(Index), 0

    'Combos Combinaciones 07/07/2018
  
    If Frame5.Visible = True Then Exit Sub
    combinac = "N"

    Dim mytablezx As New ADODB.Recordset
  
    If Len(wwprodcod(Index)) = 0 Then
        Exit Sub

    End If

    If mytablezx.State = 1 Then mytablezx.Close
    mytablezx.Open "SELECT * FROM combina where producto='" & "" & wwprodcod(Index) & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablezx.RecordCount > 0 Then
        combinac = "S"
        Do

            If mytablezx.EOF Then Exit Do
            DBGrid2.Col = 0
            DBGrid2.SetFocus
            DBGrid2.Row = DBGrid2.VisibleRows - 1
            hknumero = mytablezx.Fields("cantidad")

            busca_cod_producto mytablezx.Fields("productop"), 0
            mytablezx.MoveNext
        Loop
        mytablezx.Close
        combinac = "N"

    End If

    'Combos Combinaciones 07/07/2018

End Sub

Sub busca_cod_producto(buff As String, sw As Integer)

    Dim mytablex  As New ADODB.Recordset

    Dim bufy      As String

    Dim found     As Integer

    Dim canti     As String

    Dim buf       As String

    Dim xcampo    As String

    Dim buf1      As String

    Dim xsw       As Integer

    Dim abuf      As String

    Dim XCantidad As String

    XCantidad = ""

    '''02/11/2017 Ordena lista de productos despues de congelar
    'If opcioncongela <> "2" Then
    '    Data2.refresh
    'End If
    '''02/11/2017 Ordena lista de productos despues de congelar

    Data2.refresh
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus

    stkminimo = ""
    xsw = 0

    '''02/11/2017 Ordena lista de productos despues de congelar
    'If opcioncongela <> "2" Then
    '    If Not Data2.Recordset.EOF Then
    '       Data2.Recordset.MoveLast
    '       dbgrid2.Col = 0
    '       dbgrid2.Row = dbgrid2.VisibleRows - 1
    '       dbgrid2.SetFocus
    '    End If
    'End If
    ''02/11/2017 Ordena lista de productos despues de congelar

    If Not Data2.Recordset.EOF Then
        Data2.Recordset.MoveLast
        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus

    End If

    XCantidad = hknumero.Caption  '

    '''03/08/2017 kenyo. Correcion de total y cantidad 0
    If (hknumero.Caption) = "" Then
        hknumero = ""
        XCantidad = ""

    End If
    
    If (Val(hknumero) = "0") And mytable11.Fields("actbala") <> "S" Then
        hknumero = "1"
        XCantidad = "1"

    End If
    
    If Val(hknumero) = "0" And mytable11.Fields("actbala") = "S" Then
        hknumero = ""
        XCantidad = ""

    End If

    '''03/08/2017 kenyo. Correcion de total y cantidad 0

    If sw = 1 Then
        XCantidad = "1"
        canti = 1

    End If

    If "" & mytable11.Fields("nosaldo") = "S" Then
        '-------------------------
        found = verifica_saldo_receta(buff, Val(XCantidad))

        If found = 2 Then
            MsgBox "Se detecto un saldo receta con saldo<=0 ", 48, "Aviso"
            Exit Sub

        End If

        '-------------------------
        mytablex.Open "SELECT * FROM producto where producto='" & buff & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            If familia_saldo("" & mytablex.Fields("familia")) = 0 Then
                If consulta_saldo(buff, Val(XCantidad), 0) <= 0 Then
                    MsgBox "x.No existe saldo", 48, "Aviso"
                    Exit Sub

                End If

            End If

        End If

    End If

    stkminimo.Caption = ""

    If "" & mytable11.Fields("stkminimo") = "S" And Len(Trim(Label12)) = 0 Then
        If mytablex.State = 1 Then mytablex.Close
        mytablex.Open "SELECT * FROM producto where producto='" & buff & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            If familia_saldo("" & mytablex.Fields("familia")) = 0 Then
                consulta_minimo buff, "" & mytablex.Fields("minimo")

            End If

        End If

        mytablex.Close

    End If
     
    canti = XCantidad
    buf = buff  'se modifico en U. Union
    bufy = buf
    found = 0
    control_flujo = 0
    found = InStr(canti, "/")

    If found > 1 Then  ' si es cantidad
        xcampo = Mid$(canti, found + 1, Len(canti) - found)
        canti = Mid$(canti, 1, found - 1)

        If Val(canti) = 0 Then
            Exit Sub

        End If

        xsw = 1

    End If

    found = busca_producto(buff, 0, canti, xsw)

    If found = 2 Then  'si es precio 0
        'MsgBox "XX-XX"
        control_flujo = 1
        Exit Sub

    End If
          
    'Combos Combinaciones 07/07/2018
    If combinac = "N" Then
        If ver_si_puedo_dbgrid("" & DBGrid2.columns(0)) = 1 Then  'existe mas de un precio
            'MsgBox "abc"
            xproducto = "" & DBGrid2.columns(0)
            carga_dbgrid4 "" & DBGrid2.columns(0)
            Exit Sub

        End If
          
        '' kenyo 02/11/2017 Configuración Productos Comentarios Obligatorios
        If mytablex.State = 1 Then mytablex.Close
        mytablex.Open "SELECT obligacomentario FROM producto where producto='" & DBGrid2.columns("producto") & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And ("" & mytablex.Fields("obligacomentario")) = "S" Then
                DBGrid2.Col = 1
                DBGrid2.SetFocus
                txobserv.Show 1

            End If

        End If

        mytablex.Close
        '' kenyo 02/11/2017 Configuración Productos Comentarios Obligatorios
               
        If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Len(Trim("" & DBGrid2.columns("linea"))) > 0 Then
            DBGrid2.Col = 3
            DBGrid2.SetFocus
            ingreso_tallas "" & DBGrid2.columns("linea")
            Exit Sub

        End If
              
        If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Trim("" & mytable11.Fields("obligavendedor")) = "S" Then
            DBGrid2.Col = 3
            DBGrid2.SetFocus
            carga_vendedorpp
            'ingreso_tallas "" & DBGrid2.columns("linea")
            Exit Sub

        End If

    End If

    'Combos Combinaciones 07/07/2018
     
    found = existe_fuel("" & DBGrid2.columns(0))

    If found = 1 And Val("" & DBGrid2.columns("cantidad")) = 1 Then
        DBGrid2.Col = 7
        DBGrid2.SetFocus
        Exit Sub

    End If
     
    '''02/11/2017 Ordena lista de productos despues de congelar
    'If opcioncongela <> "2" Then
    '   found = sumar_detalle()
    '''02/11/2017 Ordena lista de productos despues de congelar
  
    found = sumar_detalle()
  
    'Data2.Refresh
    'Data2.Recordset.MoveLast
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    'Data2.Refresh
    hknumero = ""
    'MsgBox ""
     
    '''02/11/2017 Ordena lista de productos despues de congelar
    '''End If
    '''02/11/2017 Ordena lista de productos despues de congelar
   
End Sub

Function busca_producto(buf As String, sw As Integer, canti As String, xsw As Integer)

    Dim mytablex As New ADODB.Recordset

    Dim mytabley As New ADODB.Recordset

    Dim buf1     As String

    Dim i        As Integer

    Dim ssw      As Integer

    Dim found    As Integer

    'verificamos si es codigo barras
    i = 0
    found = 0

    If mytablex.State = 1 Then mytablex.Close
        
    '''17/08/2017  kenyo Codigo de barras con ticket de peso
    If Len(buf) = 13 And (Left(buf, 1) = 2) Then
        
        'Balanza 2/3 dígitos
        'buf = (Left(buf, 12))
        If mytable11.Fields("digitos") = "3" Then
            hknumero = (Right(buf, 6)) / 1000
            hknumero = (Left(hknumero, 5))
        Else
            hknumero = (Right(buf, 6)) / 10000
            hknumero = (Left(hknumero, 5))

        End If

        'hknumero = Round(hknumero, -2)
        'Balanza 2/3 dígitos
        
        buf = Left(buf, 7)

    End If

    '''17/08/2017  kenyo Codigo de barras con ticket de peso
        
    '' 05/07/2018 Busqueda por Codigo de barras !
      
    If Mid(buf, 1, 1) = "*" Then
        buf = Mid(buf, 2, Len(buf) - 1)
        mytablex.Open "SELECT * FROM producto where barras='" & buf & "'", cn, adOpenStatic, adLockOptimistic
              
        If mytablex.RecordCount > 0 Then
            buf = "" & mytablex.Fields("producto")

        End If
              
        If mytablex.RecordCount = 0 Then
            mytablex.Close
            found = busca_equiva(buf) 'busca en la table codigo barras

            If found = 0 Then
                Exit Function

            End If
        
            mytablex.Open "SELECT * FROM producto where producto='" & buf & "'", cn, adOpenStatic, adLockOptimistic

            If mytablex.RecordCount = 0 Then
                mytablex.Close
                Exit Function

            End If

        End If

    Else
        
        mytablex.Open "SELECT * FROM producto where producto='" & buf & "'", cn, adOpenStatic, adLockOptimistic

        If mytablex.RecordCount = 0 Then
            mytablex.Close
            found = busca_equiva(buf) 'busca en la table codigo barras

            If found = 0 Then
                Exit Function

            End If
        
            mytablex.Open "SELECT * FROM producto where producto='" & buf & "'", cn, adOpenStatic, adLockOptimistic

            If mytablex.RecordCount = 0 Then
                mytablex.Close
                Exit Function

            End If

        End If

    End If

    '' 05/07/2018 Busqueda por Codigo de barras !

    'MsgBox "def"
    If "" & mytablex.Fields("estado") = "N" Then  'si no esta activo
        MsgBox "Producto no activo ", 48, "Aviso"
        mytablex.Close
        Exit Function

    End If
   
    '--- KENYO 29/05/2017-----------
    Dim xTabla As String

    xTabla = "PRECIOS"
    xprecioDsctox = 0
     
    If Len(Trim(codigo.Text)) <> 0 Then

        Dim mytablexy As New ADODB.Recordset

        mytablexy.Open "SELECT * FROM PRECIO1 where CODIGO = '" & Trim(codigo.Text) & "' and producto='" & buf & "'", cn, adOpenKeyset, adLockReadOnly

        If mytablexy.RecordCount > 0 Then
            xprecioDsctox = mytablexy.Fields("pventa1")

        End If

    End If
      
    If xprecioDsctox > 0 Then xTabla = "precio1" 'TABLA DE LOS PRODUCTOS CON DESCUENTO POR CLIENTE
     
    If mytabley.State = 1 Then mytabley.Close
    If xTabla = "PRECIOS" Then
        mytabley.Open "SELECT * FROM " & xTabla & " where producto='" & buf & "' and local='" & "" & mytable11.Fields("listap") & "'", cn, adOpenStatic, adLockOptimistic
    Else
        mytabley.Open "SELECT * FROM " & xTabla & " where  CODIGO = '" & Trim(codigo.Text) & "' and producto='" & buf & "' and local='" & "" & mytable11.Fields("listap") & "'", cn, adOpenStatic, adLockOptimistic

    End If

    '--- KENYO 29/05/2017-----------
   
    If mytabley.RecordCount = 0 Then
        MsgBox "No existe precio alguno ", 48, "Aviso"
        mytabley.Close
        mytablex.Close
        Exit Function

    End If

    If Val("" & mytabley.Fields("pventa1")) <= 0 Then
        If "" & mytable11.Fields("noprecio") = "S" Then
            MsgBox "" & mytablex.Fields("descripcio") & "  Precio <=0 No Permitido ", 48, "Aviso"
            mytablex.Close
            busca_producto = 2
            Exit Function

        End If

        If "" & mytablex.Fields("remate") <> "S" Then

            'NO PASA NADA
        End If

    End If

    '---- leer puerto balanza torrey y digi 2017 -------------
    buf = ""
    canti = 0

    If Val(canti) <= 0 Then
        If "" & mytable11.Fields("actbala") = "S" Then
            If "" & mytablex.Fields("peso") = "S" Then
                'CAMBIO BALANZA KENYO
             
                '                If hknumero.Caption = "1" Then
                '                    hknumero.Caption = ""
                '                End If
                '
                If hknumero.Caption = "" Or hknumero = "" Then
                    buf = Trim(Replace(LeerPuertoBascula, "kg", "")) '<<<<<<<<<<<<<>>>>>>>>>>>>>>>>>>>>>>>>>>>
                Else
                    buf = hknumero.Caption

                End If

            Else

                'buf = hknumero.Caption
            End If

        End If

    End If

    'canti = Format(Val(buf), "0.000")
    canti = Format(buf, "0.000")

    If Trim(buf) = "" Then canti = Me.hknumero.Caption ' en caso k la balanza tenga error
    
    If buf <> "" Then
        canti = canti 'buf
    Else

        If hknumero.Caption <> "" Then
            If hknumero.Caption = "®" Then
                canti = 1
            Else

                'si se busco por codigo de producto, entonces cantidad = 1,
                If vBUSCAXPRODUCTO = 1 Then
                    canti = "1"
                Else
                    canti = Val(hknumero.Caption) 'aki es

                End If

            End If

        Else
            canti = "1"

        End If

    End If
   
    busca_producto = 1

    '---------------------------------------
    If sw = 0 Or sw = 2 Then
        graba_temporald mytablex, sw, canti, mytabley, xsw

    End If

    mytablex.Close
    mytabley.Close

End Function

Private Function LeerPuertoBascula() As String

    Dim valorCas As String

    '--- variables balanza -------
    On Error Resume Next

    Dim D             As Integer

    Dim cBuffer       As String

    Dim cBuffer1      As String

    Dim vtipo_balanza As String ' 1=TORREY, 2=DIGI , 3=CAS

    cBuffer = "": cBuffer1 = ""
    hknumero.Caption = ""

    Dim i As Long

    '----------- verfica a forzar la balanza codigo 2017 hecho por mi --------------------
    Select Case "" & mytable11.Fields("portbala")

        Case "COM1": D = 1

        Case "COM2": D = 2

        Case "COM3": D = 3

        Case "COM4": D = 4

        Case "COM5": D = 5

        Case "COM6": D = 6

        Case "COM7": D = 7

        Case "COM8": D = 8

        Case "COM9": D = 9

        Case "COM10": D = 10

    End Select
                         
    If "" & mytable11.Fields("tipo_balanza") = "1" Then 'P=TORREY
        vtipo_balanza = Chr$(80)

        With MSComm1

            If .PortOpen = True Then .PortOpen = False
            '.CommPort = 2 'Numero de puerto que deseas capturar, puede ser cualquier otro numero
            .CommPort = D 'Numero de puerto que deseas capturar, puede ser cualquier otro numero
            .Settings = "9600,N,8,1"
            .InputLen = 0 'Leer todos los datos
            .InputMode = comInputModeText 'Los datos se dan en modo texto
            .Handshaking = 0
            .PortOpen = True 'suele suceder cuando no lee, o esta desconectada la balanza
            'En las basculas TORREY 80, DIGI=87 debes enviar el caracter 'P' para que te devuelva el peso, en este caso lo envio con Chr$(80)
            cBuffer = ""
            .Output = vtipo_balanza 'Chr$(80)

            'limpiamos la variable que almacenara el peso que envie la bascula
        
            Do 'En este ciclo esta el truco para que tome la lectura de la bascula
                DoEvents
                cBuffer = cBuffer & .input
            Loop Until InStr(cBuffer, "kg")

            'cerramos el puerto
            .PortOpen = False

        End With

    End If
                     
    If "" & mytable11.Fields("tipo_balanza") = "2" Then 'digi
       
        valorCas = ""
    
        vtipo_balanza = Chr$(87) 'Chr$(87) 'DIGI

        With MSComm1

            If .PortOpen = True Then .PortOpen = False
            .CommPort = D 'Numero de puerto que deseas capturar, puede ser cualquier otro numero
            .Settings = "9600,N,8,1"
            .InputLen = 0 'Leer todos los datos
            .InputMode = comInputModeText 'Los datos se dan en modo texto
            .Handshaking = 0
            .PortOpen = True
            
            'cBuffer1 = Trim(MSComm1.Input)
            'Do 'En este ciclo esta el truco para que tome la lectura de la bascula
            '  DoEvents
            For i = 0 To 50000
                DoEvents
                cBuffer1 = cBuffer1 & .input
                'Loop 'Until InStr(cBuffer1, "kg")
            Next
            .PortOpen = False

        End With

        'cBuffer = Left(cBuffer1, 15)
        cBuffer = Right(cBuffer1, 7)

    End If

    '19/06/2018 'Configuracion Balanza Cas SW II
    If "" & mytable11.Fields("tipo_balanza") = "3" Then 'CAS SW
        vtipo_balanza = "W" + Chr(13)
        ' vtipo_balanza = Chr$(80)
    
        With MSComm1

            If .PortOpen = True Then .PortOpen = False
            '.CommPort = 2 'Numero de puerto que deseas capturar, puede ser cualquier otro numero
            .CommPort = D 'Numero de puerto que deseas capturar, puede ser cualquier otro numero
            .Settings = "9600,N,8,1"
            .InputLen = "" 'Leer todos los datos
            .InputMode = comInputModeText 'Los datos se dan en modo texto
            .Handshaking = 0
            .PortOpen = True 'suele suceder cuando no lee, o esta desconectada la balanza
            'En las basculas TORREY 80, DIGI=87 debes enviar el caracter 'P' para que te devuelva el peso, en este caso lo envio con Chr$(80)
            cBuffer = ""
            .Output = vtipo_balanza 'Chr$(80)

            Dim cantidad As Integer

            cantidad = 0

            'limpiamos la variable que almacenara el peso que envie la bascula
            'Sleep 1
            Do 'En este ciclo esta el truco para que tome la lectura de la bascula

                'For I = 0 To 35000
                cantidad = cantidad + 1
                DoEvents
                cBuffer = cBuffer & .input

                If cantidad >= 10 Then
                    cantidad = 0
                    valorCas = ""
                    valorCas = Regreso
                    Exit Do

                End If

                ' Next
                'MsgBox ("a")
                Sleep 50
              
            Loop Until Len(cBuffer) > 25
         
            'cerramos el puerto
            .PortOpen = False

        End With

    End If

    If "" & mytable11.Fields("tipo_balanza") = "4" Then 'CAS SW
        vtipo_balanza = "W" + Chr(13)
        ' vtipo_balanza = Chr$(80)
    
        With MSComm1

            If .PortOpen = True Then .PortOpen = False
            '.CommPort = 2 'Numero de puerto que deseas capturar, puede ser cualquier otro numero
            .CommPort = D 'Numero de puerto que deseas capturar, puede ser cualquier otro numero
            .Settings = "9600,N,8,N"
            .InputLen = "" 'Leer todos los datos
            .InputMode = comInputModeText 'Los datos se dan en modo texto
            .Handshaking = 0
            .PortOpen = True 'suele suceder cuando no lee, o esta desconectada la balanza
            'En las basculas TORREY 80, DIGI=87 debes enviar el caracter 'P' para que te devuelva el peso, en este caso lo envio con Chr$(80)
            cBuffer = ""
            .Output = vtipo_balanza 'Chr$(80)

            Dim cantidad2 As Integer

            cantidad2 = 0

            'limpiamos la variable que almacenara el peso que envie la bascula
            'Sleep 1
            Do 'En este ciclo esta el truco para que tome la lectura de la bascula

                'For I = 0 To 35000
                cantidad2 = cantidad2 + 1
                DoEvents
                Sleep 50
                cBuffer = cBuffer & .input

                If cantidad2 >= 10 Then
                    cantidad2 = 0
                    valorCas = ""
                    valorCas = Regreso
                    Exit Do

                End If

                ' Next
                'MsgBox ("a")
                Sleep 50
              
            Loop Until Len(cBuffer) > 25
         
            'cerramos el puerto
            .PortOpen = False

        End With

    End If

    If cantidad <> 0 Or cantidad2 <> 0 Then
        valorCas = EncuentraPeso(cBuffer)
    Else
        valorCas = EncuentraPeso(valorCas)

    End If
    
    If valorCas = "" Then

        ' Do
        If cantidad2 >= 1 Then
            cantidad2 = 0
            valorCas = ""
            valorCas = Regreso

        End If
    
        If cantidad <> 0 Or cantidad2 <> 0 Then
            valorCas = EncuentraPeso(cBuffer)
        Else
            valorCas = EncuentraPeso(valorCas)

        End If
        
        'Loop Until Len(valorCas) > 0
    
    End If

    '19/06/2018 'Configuracion Balanza Cas SW II

    '19/06/2018 'Configuracion Balanza Cas SW II
    'LeerPuertoBascula = cBuffer
    If "" & mytable11.Fields("tipo_balanza") = "3" Or "" & mytable11.Fields("tipo_balanza") = "4" Then
        LeerPuertoBascula = valorCas
        
    Else
        LeerPuertoBascula = cBuffer

    End If

    '19/06/2018 'Configuracion Balanza Cas SW II

    'If Trim(cBuffer) = "" Then LeerPuertoBascula = Me.hknumero.Caption
    'If "" & mytable11.Fields("tipo_balanza") = "2" Then
    '    If IsNumeric(Mid(cBuffer, Len(cBuffer) - 9, 6)) = True And Val(Mid(cBuffer, Len(cBuffer) - 9, 6)) < 80000 Then
    '        LeerPuertoBascula = FormatNumber(Val(Mid(cBuffer, Len(cBuffer) - 9, 6)), 2, vbFalse, vbFalse, vbFalse)
    '    End If
    'End If
    'MsgBox cBuffer
End Function

Function Regreso() As String

    '--- variables balanza -------
    On Error Resume Next

    Dim D             As Integer

    Dim cBuffer       As String

    Dim cBuffer1      As String

    Dim vtipo_balanza As String ' 1=TORREY, 2=DIGI , 3=CAS

    cBuffer = "": cBuffer1 = ""
    hknumero.Caption = ""

    Dim i        As Long

    Dim valorCas As String

    With MSComm1

        If .PortOpen = True Then .PortOpen = False
        '.CommPort = 2 'Numero de puerto que deseas capturar, puede ser cualquier otro numero
        .CommPort = D 'Numero de puerto que deseas capturar, puede ser cualquier otro numero
        .Settings = "9600,N,8,1"
        .InputLen = "" 'Leer todos los datos
        .InputMode = comInputModeText 'Los datos se dan en modo texto
        .Handshaking = 0
        .PortOpen = True 'suele suceder cuando no lee, o esta desconectada la balanza
        'En las basculas TORREY 80, DIGI=87 debes enviar el caracter 'P' para que te devuelva el peso, en este caso lo envio con Chr$(80)
        cBuffer = ""
        .Output = Chr$(80)  'Chr$(80)

        Dim cantidad As Integer

        cantidad = 0

        'limpiamos la variable que almacenara el peso que envie la bascula
        'For I = 0 To 50000
        Do 'En este ciclo esta el truco para que tome la lectura de la bascula
            cantidad = cantidad + 1
            DoEvents
            cBuffer = cBuffer & .input

            If cantidad >= 10 Then
                cantidad = 0
                valorCas = ""
                valorCas = Regreso2
                cBuffer = valorCas
                Exit Do

            End If
       
        Loop Until Len(cBuffer) > 25

        'Next
        'cerramos el puerto
        .PortOpen = False

    End With
    
    Regreso = cBuffer

End Function

Function Regreso2() As String

    '--- variables balanza -------
    On Error Resume Next

    Dim D             As Integer

    Dim cBuffer       As String

    Dim cBuffer1      As String

    Dim vtipo_balanza As String ' 1=TORREY, 2=DIGI , 3=CAS

    cBuffer = "": cBuffer1 = ""
    hknumero.Caption = ""

    Dim i        As Long

    Dim valorCas As String

    With MSComm1

        If .PortOpen = True Then .PortOpen = False
        '.CommPort = 2 'Numero de puerto que deseas capturar, puede ser cualquier otro numero
        .CommPort = D 'Numero de puerto que deseas capturar, puede ser cualquier otro numero
        .Settings = "9600,N,8,1"
        .InputLen = "" 'Leer todos los datos
        .InputMode = comInputModeText 'Los datos se dan en modo texto
        .Handshaking = 0
        .PortOpen = True 'suele suceder cuando no lee, o esta desconectada la balanza
        'En las basculas TORREY 80, DIGI=87 debes enviar el caracter 'P' para que te devuelva el peso, en este caso lo envio con Chr$(80)
        cBuffer = ""
        .Output = Chr$(80)  'Chr$(80)

        Dim cantidad As Integer

        cantidad = 0

        'limpiamos la variable que almacenara el peso que envie la bascula
        'For I = 0 To 50000
        Do 'En este ciclo esta el truco para que tome la lectura de la bascula
            cantidad = cantidad + 1
            DoEvents
            cBuffer = cBuffer & .input
   
            If cantidad >= 10 Then
                cantidad = 0
                valorCas = ""
                valorCas = Regreso
                Exit Do

            End If

            Sleep 50
       
        Loop Until Len(cBuffer) > 25

        'Next
        'cerramos el puerto
        .PortOpen = False

    End With
    
    Regreso2 = cBuffer

End Function

'19/06/2018 'Configuracion Balanza Cas SW II

Function EncuentraPeso(car As String) As String

    Dim i, sw As Integer

    Dim cant     As Integer

    Dim cantult  As Integer

    Dim cadena   As String

    Dim cadfinal As String

    cadena = car
    cadfinal = car

    Dim cadrpta As String

    Dim rptaDoc As String

    cadrpta = ""
    rptaDoc = ""
 
    cant = 0

    i = 0
    
    If "" & mytable11.Fields("tipo_balanza") = "4" Then
        cadena = Mid$(cadena, 1, 500)

    End If

    Do While Len(cadena) > 0
        i = i + 1

        'cadfinal = cadfinal & Mid(cadfinal, 1, 1)
        cadena = Left(car, Len(cadena) - 1)
        
        If Right(cadena, 1) = "g" Then
            rptaDoc = Right(cadena, 1) & rptaDoc
            cant = cant + 1
            
            If cant = 1 Then
                cadena = Left(car, Len(cadena) - 1)

                If Right(cadena, 1) = "k" Then
                    rptaDoc = Right(cadena, 1) & rptaDoc
                    cant = cant + 1
                Else
                    rptaDoc = ""
                    cant = 0

                End If
            
                If cant = 2 Then
                    cadena = Left(car, Len(cadena) - 1)

                    If IsNumeric(Right(cadena, 1)) = True Then
                        rptaDoc = Right(cadena, 1) & rptaDoc
                        cant = cant + 1
                    Else
                        rptaDoc = ""
                        cant = 0

                    End If
                 
                    If cant = 3 Then
                        cadena = Left(car, Len(cadena) - 1)

                        If IsNumeric(Right(cadena, 1)) = True Then
                            rptaDoc = Right(cadena, 1) & rptaDoc
                            cant = cant + 1
                        Else
                            rptaDoc = ""
                            cant = 0

                        End If

                        If cant = 4 Then
                            cadena = Left(car, Len(cadena) - 1)

                            If IsNumeric(Right(cadena, 1)) = True Then
                                rptaDoc = Right(cadena, 1) & rptaDoc
                                cant = cant + 1
                            Else
                                rptaDoc = ""
                                cant = 0

                            End If

                            If cant = 5 Then
                                cadena = Left(car, Len(cadena) - 1)

                                If Right(cadena, 1) = "." Then
                                    rptaDoc = Right(cadena, 1) & rptaDoc
                                    cant = cant + 1
                                Else
                                    rptaDoc = ""
                                    cant = 0

                                End If

                                If cant = 6 Then
                                    cadena = Left(car, Len(cadena) - 1)

                                    If IsNumeric(Right(cadena, 1)) = True Then
                                        rptaDoc = Right(cadena, 1) & rptaDoc
                                        cant = cant + 1
                                    Else
                                        rptaDoc = ""
                                        cant = 0

                                    End If

                                    If cant = 7 Then
                                        cadena = Left(car, Len(cadena) - 1)

                                        If IsNumeric(Right(cadena, 1)) = True Then
                                            rptaDoc = Right(cadena, 1) & rptaDoc
                                            EncuentraPeso = rptaDoc
                                            Exit Do
                                        Else
                                            rptaDoc = rptaDoc
                                            EncuentraPeso = rptaDoc
                                            Exit Do
                                            
                                        End If

                                    End If

                                End If

                            End If

                        End If

                    End If

                End If

            End If
          
        End If
     
        EncuentraPeso = rptaDoc

        '        If cant = 1 Then
        '            If Len(rptaDoc) = 0 Then
        '                    rptaDoc = Left(cadfinal, Len(cadfinal) - 1)
        '                    cadena = ""
        '                    cadfinal = ""
        '            End If
        '
        '            If my_tipo = "01" Then
        '                my_tipo = "2"
        '            ElseIf my_tipo = "07" Or my_tipo = "08" Then
        '                my_tipo = obtiene_TipoDocumento(my_acu)
        '            End If
        '
        '
        '            Call Actualiza_Estado_Sunat(rptaDoc, my_local, my_tipo, my_serie, my_numero, my_acu)
        '            cadrpta = ""
        '            rptaDoc = ""
        '            cant = 0
        '        End If

    Loop
          
End Function

'19/06/2018 'Configuracion Balanza Cas SW II

Function orden_despacho(nroimp As Integer)

    Dim xdato   As String

    Dim buf     As String

    Dim bufx    As String

    Dim Puerto  As String

    Dim puertos As String

    Dim puertod As String

    Dim found   As Integer

    Dim cola    As String

    Dim i       As Integer

    Dim j       As Integer

    Dim X       As Integer

    Dim xbuf0   As String

    Dim xbuf1   As String

    Dim xbuf2   As String

    Dim sFile   As String

    Dim sw      As Integer

    Dim oldprinter

    'Dim mydbf As Database
    On Error GoTo cmd7890_err

    'impresora por default atachado
    'If MsgBox("Desea Imprimir Orden Despacho ", 1, "Aviso") <> 1 Then Exit Function
    'sum1 = 0
    Puerto = ""
    puertod = ""
    puertos = "oc" '& mytable11.Fields("puertocie")  'impresora x defecto
    Puerto = puertos
    cerrar_archivo
    FileName = caja & Puerto
    found = borra_nombre("" & FileName)
    '-----------ORDEN DE DESPACHO---------------------------------------------
    List1.Clear
    '---------------------
    cola = "N"
    Puerto = "LPT"
    Data2.refresh
    ncanal = 1
    Do

        If Data2.Recordset.EOF Then Exit Do

        'MsgBox "" & Data2.Recordset.Fields("producto")
        If Len("" & Data2.Recordset.Fields("producto")) > 0 And (Val("" & Data2.Recordset.Fields("cantidad")) > 0 Or Val("" & Data2.Recordset.Fields("cantidad")) < 0) Then
            found = busca_familia_orden("" & Data2.Recordset.Fields("producto"), Puerto, puertod, cola, nroimp)

            If found = 0 Then   'si no existe debe tomar el defaul de la impresora
                Puerto = puertos

                'GoTo pasoprint
            End If

            If Len(Trim(Puerto)) = 0 Then
                Puerto = "LPT"

            End If

            'MsgBox found
            '--------------------------------------
            sw = 0
            FileName = Trim(caja & Puerto)
            found = existearchivo("" & FileName)

            If found = 1 Then  'verificar si no existe en la lista
                sw = 0

                For i = 0 To List1.ListCount - 1
                    j = InStr(List1.List(i), "|")
                    xbuf0 = Mid$(List1.List(i), 1, j - 1)

                    If xbuf0 = FileName Then
                        sw = 1

                    End If

                Next i

                If sw = 0 Then  'no existe en la lista
                    found = borra_nombre(FileName)
                    found = 0

                End If

            End If

            cerrar_archivo
            Open FileName For Append As #ncanal

            If found = 0 Then
                List1.AddItem FileName & "|" & puertod & "|" & cola & "|" 'adiciona en la lista
                cabecera_orden_despacho "" & Data2.Recordset.Fields("vendedor"), "", "", ""

            End If

            imprime_detalle_orden
            Close #ncanal

        End If

        Data2.Recordset.MoveNext
    Loop
    cerrar_archivo
    buf = ""

    For i = 0 To List1.ListCount - 1
        buf = buf & List1.List(i)
    Next i

    'MsgBox buf

    '-------------se adiciono para agilidad--------------------------------
    For i = 0 To List1.ListCount - 1
        xdato = List1.List(i)
        extrae_puertos xdato, xbuf0, xbuf1, xbuf2
        FileName = xbuf0

        If existearchivo(xbuf0) = 1 Then
            Open FileName For Append As #ncanal

            For X = 1 To 5
                Print #ncanal, ""
            Next X

            Print #ncanal, ""
            Close #ncanal

        End If

    Next i

    'MsgBox List1.ListCount
    For i = 0 To List1.ListCount - 1
        xdato = List1.List(i)
        'MsgBox xdato
        extrae_puertos xdato, xbuf0, xbuf1, xbuf2
        FileName = xbuf0

        'MsgBox xdato & " " & xbuf0 & " " & xbuf1 & " " & xbuf2
        If existearchivo(xbuf0) = 1 Then
            If xbuf2 = "S" Then
                'MsgBox xbuf1
                oldprinter = Printer.DeviceName
                selecciona_impresoras (Trim(xbuf1))
                'imprime_archivotexto xbuf0
                found = Imprime_archivojj(xbuf0, 0, "" & mytable11.Fields("tamanorden"), "" & mytable11.Fields("nombrefont"), "" & mytable11.Fields("BOLD"), "" & mytable11.Fields("letrainterna"))
                'found = imprime_archivoj(xbuf0, 0, "" & mytable11.Fields("tamanorden"))
                selecciona_impresoras (Trim(oldprinter))
                'found = orden_oprn(xbuf1, "" & mytable11.Fields("tipoleta"), "" & mytable11.Fields("tamano"), "" & mytable11.Fields("negrita"))
            Else
                Open FileName For Append As #ncanal

                For X = 1 To 2
                    Print #ncanal, ""
                Next X

                Print #ncanal, ""
                Close #ncanal
                found = star_sp342(Trim(xbuf1), 0)
                found = corte_papel(Trim(xbuf1), 1)

            End If

            cerrar_archivo
            found = borra_nombre(xbuf0)

        End If

    Next i

    cerrar_archivo
    orden_despachot 0
    Exit Function
cmd7890_err:
    MsgBox "MENSAJE, ERROR EN ORDEN DESPACHO " & error$, 24, "AVISO"
    cerrar_archivo
    Exit Function

End Function

Function busca_familia_orden(buf1 As String, _
                             Puerto As String, _
                             puertod As String, _
                             cola As String, _
                             nroimp As Integer)

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd90fam_err

    mytablex.Open "SELECT * FROM producto where producto='" & buf1 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then

        ''11/07/2017 kenyo multicomandas

        If nroimp = 0 Then
            Puerto = "" & mytablex.Fields("grupoimpresion")
            puertod = "" & mytablex.Fields("puertoimpresion")
            cola = "" & mytablex.Fields("cola")
            busca_familia_orden = 1

            If Len(Trim(puertod)) = 0 Then
                busca_familia_orden = 0

            End If

        End If

        If nroimp = 1 Then
           
            Puerto = "" & mytablex.Fields("grupoimpresion")
            puertod = "" & mytablex.Fields("puertoimpresion1")
            cola = "" & mytablex.Fields("cola")
            
            If Len(Trim(mytablex.Fields("puertoimpresion1"))) = "0" Then
           
                puertod = ""
                Puerto = ""
                cola = ""
                busca_familia_orden = 0
           
            End If
                
            busca_familia_orden = 1

            If Len(Trim(puertod)) = 0 Then
                busca_familia_orden = 0

            End If

        End If

        If nroimp = 2 Then
           
            Puerto = "" & mytablex.Fields("grupoimpresion")
            puertod = "" & mytablex.Fields("puertoimpresion2")
            cola = "" & mytablex.Fields("cola")
            
            If Len(Trim(mytablex.Fields("puertoimpresion2"))) = "0" Then
           
                puertod = ""
                Puerto = ""
                cola = ""
                busca_familia_orden = 0
           
            End If
                
            busca_familia_orden = 1

            If Len(Trim(puertod)) = 0 Then
                busca_familia_orden = 0

            End If

        End If

        If nroimp = 3 Then
           
            Puerto = "" & mytablex.Fields("grupoimpresion")
            puertod = "" & mytablex.Fields("puertoimpresion3")
            cola = "" & mytablex.Fields("cola")
            
            If Len(Trim(mytablex.Fields("puertoimpresion3"))) = "0" Then
           
                puertod = ""
                Puerto = ""
                cola = ""
                busca_familia_orden = 0
           
            End If
                
            busca_familia_orden = 1

            If Len(Trim(puertod)) = 0 Then
                busca_familia_orden = 0

            End If

        End If

        '
        '     If nroimp = 1 Then
        '           Puerto = "" & mytablex.Fields("grupoimpresion")
        '           puertod = "" & mytablex.Fields("puertoimpresion1")
        '           cola = "" & mytablex.Fields("cola")
        '
        '           If Len(Trim(puertod)) = 0 Then
        '           busca_familia_orden = 0
        '              End If
        '           busca_familia_orden = 1
        '        End If

        '     If nroimp = 3 Then
        '           puerto = "" & mytablex.Fields("grupoimpresion")
        '           puertod = "" & mytablex.Fields("puertoimpresion3")
        '           cola = "" & mytablex.Fields("cola")
        '           If Len(Trim(puertod)) = 0 Then
        '           busca_familia_orden = 0
        '              End If
        '           busca_familia_orden = 1
        '        End If
    End If

    mytablex.Close

    Exit Function
cmd90fam_err:
    MsgBox "Aviso en Busca Familia orden " + error$, 48, "Aviso"
    Exit Function

End Function

Sub cabecera_orden_despacho(buvendedor As String, _
                            buf1 As String, _
                            buf2 As String, _
                            buf3 As String)

    Dim found As Integer

    Dim buf   As String

    Dim btipo As String

    On Error GoTo cmd114111_err

    'buf = String(42, "-")
    'found = formateaa(buf, 45, 2, 0)
   
    If mytable11.Fields("FLAG1") <> "P" Then ' KENYO EDICION DE PEDIDOS/COMANDA
        
        '' 10/07/2018 Tamaño grande cabecera comanda
        If flag_servicio = "A" Then
            found = formateaa("  *** PARA LLEVAR *** ", 28, 2, 0)

        End If
                
        If flag_servicio = "D" Then
            found = formateaa("   **** DELIVERY *****    ", 28, 2, 0)

        End If
   
        If flag_servicio = "C" Then
           
            '25/07/2018 Delivery y Para Llevar desde mozo
            If V_EstadoMesa = "D" Then
                
                '24/08/2018  Delivery por mesa
                found = formateaa("   **** DELIVERY *****    ", 28, 2, 0)

                buf = " Cliente: " & extrae_datos_codnombre(2, Trim(salon.Caption), Trim(extra_loquesea(mesa.Caption)))
                
                found = formateaa(buf, 28, 2, 0)
                buf = " Salon:" & salon.Caption & " ****:" & extra_loquesea(mesa.Caption)
                found = formateaa(buf, 28, 2, 0)
                '24/08/2018  Delivery por mesa
               
            ElseIf V_EstadoMesa = "L" Then
                '24/08/2018  Delivery por mesa
                found = formateaa("  *** PARA LLEVAR *** ", 28, 2, 0)
                
                buf = " Cliente:" & extrae_datos_codnombre(2, Trim(salon.Caption), Trim(extra_loquesea(mesa.Caption)))
                
                found = formateaa(buf, 28, 2, 0)
                buf = " Salon:" & salon.Caption & " ****:" & mesa.Caption
                found = formateaa(buf, 28, 2, 0)
                '24/08/2018  Delivery por mesa
            Else
                ' 10/07/2018 Edicion Comanda
                'buf = " Salon:" & salon.Caption & " Mesa:" & mesa.Caption
                'found = formateaa(buf, 28, 2, 0)
                buf = "  ***  Mesa:" & mesa.Caption & "***"
                found = formateaa(buf, 28, 2, 0)
                
                ' 10/07/2018 Edicion Comanda
                
            End If

            '25/07/2018 Delivery y Para Llevar desde mozo

        End If

        '' 10/07/2018 Tamaño grande cabecera comanda
   
        ' 10/07/2018 Edicion Comanda
        If formatocomanda = "G" Then 'si es generia o con driver
            buf = String(40, "-")
            found = formateaa(buf, 45, 2, 0)
        Else
            buf = String(0, " ")
            found = formateaa(buf, 0, 2, 0)
            buf = String(60, "-")
            found = formateaa(buf, 65, 2, 0)

        End If

        ' 10/07/2018 Edicion Comanda
        
        ' 10/07/2018 Edicion Comanda
        'found = formateaa(" .", 28, 2, 0)
        ' 10/07/2018 Edicion Comanda
        
    End If
   
    If Len(buf2) > 0 Then
        found = formateaa("       Numero:" & buf2, 28, 2, 0)

    End If
   
    ''' 15/11/2017 Comentario completo en servicio para llevar y delivery
    ''' 15/11/2017 Comentario completo en servicio para llevar y delivery
   
    buf = "     ORDEN DESPACHO " & comanda
    found = formateaa(buf, 28, 2, 0)
    
    '' 10/07/2018 Edicion Comanda
    'buf = "     Caja :" & caja & " Turno:" & turno
    'found = formateaa(buf, 28, 2, 0)
    '' 10/07/2018 Edicion Comanda
   
    buf = "Fecha:" & Format(Now, "dd/mm/yyyy") & " " & "Hora :" & Format(Now, "hh:mm:ss")
    found = formateaa(buf, 28, 2, 0)

    If flag_servicio = "A" Then
   
        If mytable11.Fields("FLAG1") = "P" Then ' KENYO EDICION DE PEDIDOS/COMANDA
            found = formateaa("Cliente:" + Mid$(buf3, 1, 20), 28, 2, 0)
            buf = "Usuario:"
            found = formateaa(buf, 8, 0, 0)
            found = busca_vendedor_mesero(buvendedor)
        Else
            found = formateaa("Cliente:" + Mid$(buf3, 1, 20), 28, 2, 0)

            If flag_servicio = "C" Then
                buf = "Mozo  :"
                found = formateaa(buf, 8, 0, 0)
                found = busca_vendedor_mesero(buvendedor)

            End If

        End If
      
    End If
   
    If flag_servicio = "A" Then
        buf = "VENTA RAPIDA"
        found = formateaa(buf, 28, 2, 0)
      
    End If
   
    If flag_servicio = "C" Then
      
        '' 10/07/2018 Edicion Comanda
        'buf = "Salon : " & salon.Caption & " Mesa:" & mesa.Caption
        'found = formateaa(buf, 28, 2, 0)
        '' 10/07/2018 Edicion Comanda
    
        buf = "Mozo  :"
        found = formateaa(buf, 8, 0, 0)
        found = busca_vendedor_mesero(mesero)
            
    End If
   
    If flag_servicio = "D" Then

        'found = formateaa("       *** DELIVERY ***", 28, 2, 0)
        'found = formateaa(buf, 28, 2, 0)
        '' 02/12/2017 Modulo Delivery Proyecto Principal
        'imprime_cliente_delivery "" & codigo
        Dim found2 As Integer

        found2 = obtienedatos()
        buf = "* " + documentod + " " + seried + "-" + numerod
        found = formateaa(buf, 22, 2, 2)
        imprime_cliente_delivery7 "" & codigo

    End If
   
    If flag_servicio <> "A" And flag_servicio <> "D" And flag_servicio <> "C" Then
        buf = "OTROS SERVICIOS"
        found = formateaa(buf, 28, 2, 0)

    End If
   
    '' 02/12/2017 Modulo Delivery Proyecto Principal
    'buf = "///" & xnombre
    'found = formateaa(buf, 28, 2, 0)
   
    '' 10/07/2018 Edicion Comanda
    If flag_servicio = "A" Or flag_servicio = "D" Then
        buf = "///"
        found = formateaa(buf, 28, 2, 0)

    End If

    '' 10/07/2018 Edicion Comanda
   
    '' 02/12/2017 Modulo Delivery Proyecto Principal
      
    If buf1 = "***ANULADO***" Then
        found = formateaa("ANULADO", 25, 2, 0)

    End If
   
    ' 10/07/2018 Edicion Comanda
    'buf = String(1, "+")
    ' found = formateaa(buf, 1, 2, 0)
    
    ' 10/07/2018 Edicion Comanda
    If formatocomanda = "G" Then 'si es generia o con driver
        
        buf = String(42, "-")
        found = formateaa(buf, 45, 2, 0)
    
    Else
        buf = String(0, " ")
        found = formateaa(buf, 0, 2, 0)
        buf = String(60, "-")
        found = formateaa(buf, 65, 2, 0)
    
    End If
    
    '
    '   found = formateaa("CANT", 6, 0, 0)
    '
    '   found = formateaa("PRODUCTO ", 21, 0, 0)
    '   found = formateaa(" ", 1, 2, 0)
    '
    '   buf = String(42, "-")
    '   found = formateaa(buf, 45, 2, 0)
    ' 10/07/2018 Edicion Comanda

    Exit Sub
cmd114111_err:
    MsgBox "Mensaje,Error en cabecera Pedido " & error$, 48, "Aviso"
    Exit Sub

End Sub

'' 02/12/2017 Modulo Delivery Proyecto Principal
Function obtienedatos()

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close

    tipod = ""
    documentod = ""
    seried = ""
    numerod = ""
 
    mytablex.Open "SELECT t.descripcio as descripcio ,f.tipo as tipo,f.serie as serie,f.numero  as numero FROM factura f inner join tipo t on t.tipo=f.tipo and f.tipo='" & xtipo & "' and f.serie='" & xserie & "' and f.numero='" & xnumero & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        obtienedatos = 1
        tipod = mytablex.Fields("tipo")
        documentod = mytablex.Fields("descripcio")
        seried = mytablex.Fields("serie")
        numerod = mytablex.Fields("numero")

    End If

    mytablex.Close

End Function

''''22/09/2017 kenyo Direccion de delivery en comanda
Sub imprime_cliente_delivery7(buf1 As String)

    Dim mytablex As New ADODB.Recordset

    Dim buf      As String

    Dim found    As Integer

    mytablex.Open "SELECT * FROM deliveri where codigo='" & buf1 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        'found = formateaa(" *** DOMICILIO ***", 36, 2, 0)
     
        '''09/08/2017 kenyo Mejor en Comanda Delivery
        'buf = "Telf:" & "" & mytablex.Fields("codigo")
        'found = formateaa(buf, 36, 2, 0)
        'buf = "Nomb:" & "" & mytablex.Fields("nombre")
        'found = formateaa(buf, 36, 2, 0)
        'buf = "Dire:" & "" & mytablex.Fields("direccion")
        'found = formateaa(buf, 36, 2, 0)
            
        'buf = "cOD:" & "" & mytablex.Fields("codigo")
        buf = "*"
        found = formateaa(buf, 1, 2, 0)
      
        buf = "Telefono: " & "" & mytablex.Fields("telefono")
        found = formateaa(buf, 30, 2, 0)

        ''' NOMBRE CLIENTE
        If Val("" & mytable11.Fields("tamanorden")) = "12" Or Val("" & mytable11.Fields("tamanorden")) = "11" Then
            buf = "Nombre: " & "" & mytablex.Fields("nombre")
            found = formateaa(buf, 28, 2, 0)

            If Len("" & mytablex.Fields("nombre")) > 24 Then
                buf = Mid$("" & mytablex.Fields("nombre"), 21, 60)
                found = formateaa(buf, 29, 2, 0)

            End If

            If Len("" & mytablex.Fields("nombre")) > 53 Then
                buf = Mid$("" & mytablex.Fields("nombre"), 54, 60)
                found = formateaa(buf, 33, 2, 0)

            End If

        ElseIf Val("" & mytable11.Fields("tamanorden")) = "10" Then
            buf = "Nombre: " & "" & mytablex.Fields("direccion")
            found = formateaa(buf, 36, 2, 0)

            If Len("" & mytablex.Fields("nombre")) > 36 Then
                buf = Mid$("" & mytablex.Fields("nombre"), 26, 70)
                found = formateaa(buf, 34, 2, 0)

            End If

            If Len("" & mytablex.Fields("nombre")) > 57 Then
                buf = Mid$("" & mytablex.Fields("nombre"), 60, 70)
                found = formateaa(buf, 33, 2, 0)

            End If

        Else
            buf = "Nombre:" & "" & mytablex.Fields("nombre")
            found = formateaa(buf, 36, 2, 0)

        End If

        ''' NOMBRE CLIENTE

        '''09/08/2017 kenyo Mejor en Comanda Delivery
        '     buf = "DIRECCION: " & "" & mytablex.Fields("direccion")
        '     found = formateaa(buf, 72, 2, 0)

        ''' DIRECCION
        If Val("" & mytable11.Fields("tamanorden")) = "12" Or Val("" & mytable11.Fields("tamanorden")) = "11" Then

            buf = "Dir.: " & "" & mytablex.Fields("direccion")
            found = formateaa(buf, 30, 2, 0)

            If Len("" & mytablex.Fields("direccion")) > 24 Then
                buf = Mid$("" & mytablex.Fields("direccion"), 25, 60)
                found = formateaa(buf, 29, 2, 0)

            End If

            If Len("" & mytablex.Fields("direccion")) > 53 Then
                buf = Mid$("" & mytablex.Fields("direccion"), 54, 60)
                found = formateaa(buf, 33, 2, 0)

            End If

        ElseIf Val("" & mytable11.Fields("tamanorden")) = "10" Then
            buf = "DIRECCION: " & "" & mytablex.Fields("direccion")
            found = formateaa(buf, 36, 2, 0)

            If Len("" & mytablex.Fields("direccion")) > 36 Then
                buf = Mid$("" & mytablex.Fields("direccion"), 26, 70)
                found = formateaa(buf, 34, 2, 0)

            End If

            If Len("" & mytablex.Fields("direccion")) > 57 Then
                buf = Mid$("" & mytablex.Fields("direccion"), 60, 70)
                found = formateaa(buf, 33, 2, 0)

            End If

        Else

            buf = "DIRECCION: " & "" & mytablex.Fields("direccion")
            found = formateaa(buf, 72, 2, 0)

        End If

        ''' DIRECCION

        '''09/08/2017 kenyo Mejor en Comanda Delivery
    
        ''' REFERENCIA
        If Val("" & mytable11.Fields("tamanorden")) = "12" Or Val("" & mytable11.Fields("tamanorden")) = "11" Then
            buf = "Ref.: " & "" & mytablex.Fields("Referencia")
            found = formateaa(buf, 30, 2, 0)

            If Len("" & mytablex.Fields("Referencia")) > 24 Then
                buf = Mid$("" & mytablex.Fields("Referencia"), 24, 60)
                found = formateaa(buf, 29, 2, 0)

            End If

            If Len("" & mytablex.Fields("Referencia")) > 53 Then
                buf = Mid$("" & mytablex.Fields("Referencia"), 54, 60)
                found = formateaa(buf, 33, 2, 0)

            End If

        ElseIf Val("" & mytable11.Fields("tamanorden")) = "10" Then
            buf = "Ref.: " & "" & mytablex.Fields("direccion")
            found = formateaa(buf, 36, 2, 0)

            If Len("" & mytablex.Fields("Referencia")) > 36 Then
                buf = Mid$("" & mytablex.Fields("Referencia"), 26, 70)
                found = formateaa(buf, 34, 2, 0)

            End If

            If Len("" & mytablex.Fields("Referencia")) > 57 Then
                buf = Mid$("" & mytablex.Fields("Referencia"), 60, 70)
                found = formateaa(buf, 33, 2, 0)

            End If

        Else

            buf = "Ref. " & "" & mytablex.Fields("Referencia")
            found = formateaa(buf, 72, 2, 0)

        End If

        ''' REFERENCIA
    
        '''09/08/2017 kenyo Mejor en Comanda Delivery
  
        '
        
    End If

    mytablex.Close

End Sub

''''22/09/2017 kenyo Direccion de delivery en comanda

'' 02/12/2017 Modulo Delivery Proyecto Principal

Sub imprime_cliente_delivery(buf1 As String)

    Dim mytablex As New ADODB.Recordset

    Dim buf      As String

    Dim found    As Integer

    mytablex.Open "SELECT * FROM clientes where codigo='" & buf1 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        'found = formateaa(" *** DOMICILIO ***", 36, 2, 0)
     
        '''09/08/2017 kenyo Mejor en Comanda Delivery
        'buf = "Telf:" & "" & mytablex.Fields("codigo")
        'found = formateaa(buf, 36, 2, 0)
        'buf = "Nomb:" & "" & mytablex.Fields("nombre")
        'found = formateaa(buf, 36, 2, 0)
        'buf = "Dire:" & "" & mytablex.Fields("direccion")
        'found = formateaa(buf, 36, 2, 0)
            
        'buf = "cOD:" & "" & mytablex.Fields("codigo")
        buf = "."
        found = formateaa(buf, 1, 2, 0)
      
        buf = "Nomb:" & "" & mytablex.Fields("nombre")
        found = formateaa(buf, 36, 2, 0)
        '      buf = ""
        '      found = formateaa(buf, 2, 2, 0)

        '''09/08/2017 kenyo Mejor en Comanda Delivery
        'buf = "DIRECCION: " & "" & mytablex.Fields("direccion")
        'found = formateaa(buf, 72, 2, 0)

        If Val("" & mytable11.Fields("tamanorden")) = "12" Or Val("" & mytable11.Fields("tamanorden")) = "11" Then

            buf = "DIRECCION: " & "" & mytablex.Fields("direccion")
            found = formateaa(buf, 33, 2, 0)

            If Len("" & mytablex.Fields("direccion")) > 33 Then
                buf = Mid$("" & mytablex.Fields("direccion"), 23, 60)
                found = formateaa(buf, 32, 2, 0)

            End If

            If Len("" & mytablex.Fields("direccion")) > 57 Then
                buf = Mid$("" & mytablex.Fields("direccion"), 55, 60)
                found = formateaa(buf, 33, 2, 0)

            End If

        ElseIf Val("" & mytable11.Fields("tamanorden")) = "10" Then

            buf = "DIRECCION: " & "" & mytablex.Fields("direccion")
            found = formateaa(buf, 36, 2, 0)

            If Len("" & mytablex.Fields("direccion")) > 36 Then
                buf = Mid$("" & mytablex.Fields("direccion"), 26, 70)
                found = formateaa(buf, 34, 2, 0)

            End If

            If Len("" & mytablex.Fields("direccion")) > 70 Then
                buf = Mid$("" & mytablex.Fields("direccion"), 60, 70)
                found = formateaa(buf, 33, 2, 0)

            End If

        Else
   
            buf = "DIRECCION: " & "" & mytablex.Fields("direccion")
            found = formateaa(buf, 72, 2, 0)
   
        End If

        '''09/08/2017 kenyo Mejor en Comanda Delivery

        buf = "REFERENCIA: " & "" & mytablex.Fields("observa")
        found = formateaa(buf, 72, 2, 0)
        '''09/08/2017 kenyo Mejor en Comanda Delivery
  
        '
        
    End If

    mytablex.Close

End Sub

Function busca_vendedor_mesero(buvendedor As String)

    Dim buf      As String

    Dim found    As Integer

    'MsgBox buvendedor
    Dim mytablex As New ADODB.Recordset

    mytablex.Open "SELECT * FROM vendedor where codigo='" & buvendedor & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then
        found = formateaa("", 1, 2, 0)

    End If

    If mytablex.RecordCount > 0 Then
        buf = "" & mytablex.Fields("nombre")
        found = formateaa(buf, 20, 2, 0)
        busca_vendedor_mesero = 1

    End If

    mytablex.Close
    Exit Function

End Function

Sub imprime_detalle_orden()

    Dim buf      As String

    Dim found    As Integer

    Dim xbuffer  As String

    Dim mytablex As New ADODB.Recordset

    'On Error GoTo cmd4711_err 'leonardo - kenyo mensaje error impresion
    '----- formato nuevo
    buf = "" & Data2.Recordset.Fields("cantidad")
    found = formateaa(buf, 5, 0, 0)
    found = formateaa("", 1, 0, 0)
    'MsgBox ""
    '-----------------------------------------
         
    '' 10/07/2018 Edicion Comanda
    
    'buf = "*" & Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 1, 30)
    'found = formateaa(buf, 31, 2, 0)
    'If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 30 Then
    'buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 31, 30)
    'found = formateaa(buf, 30, 2, 0)
    'End If
    'If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 60 Then
    'buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 61, 30)
    'found = formateaa(buf, 30, 2, 0)
    'End If
    'If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 90 Then
    'buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 91, 30)
    'found = formateaa(buf, 30, 2, 0)
    'End If
    'If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 120 Then
    'buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 121, 30)
    'found = formateaa(buf, 30, 2, 0)
    'End If
         
    If formatocomanda = "G" Then
        buf = "*" & Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 1, 37)
        found = formateaa(buf, 38, 2, 0)

        If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 37 Then
            buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 38, 44)
            found = formateaa(buf, 44, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 81 Then
            buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 82, 44)
            found = formateaa(buf, 44, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 125 Then
            buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 110, 44)
            found = formateaa(buf, 44, 2, 0)

        End If

    End If
   
    If formatocomanda = "D" Then
        If tipocomanda = "DL" Then
            
            If ("" & mytable11.Fields("tamanorden")) = 8 Then
            
                buf = "*" & Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 1, 35)
                found = formateaa(buf, 36, 2, 0)

                If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 35 Then
                    buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 36, 38)
                    found = formateaa(buf, 38, 2, 0)

                End If

                If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 73 Then
                    buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 74, 42)
                    found = formateaa(buf, 38, 2, 0)

                End If

                If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 121 Then
                    buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 108, 42)
                    found = formateaa(buf, 38, 2, 0)

                End If
        
            Else
                buf = "*" & Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 1, 23)
                found = formateaa(buf, 23, 2, 0)

                If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 22 Then
                    buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 22, 44)
                    found = formateaa(buf, 28, 2, 0)

                End If

                If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 46 Then
                    buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 50, 66)
                    found = formateaa(buf, 28, 2, 0)

                End If

                If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 90 Then
                    buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 78, 88)
                    found = formateaa(buf, 28, 2, 0)

                End If

                If Len("" & Data2.Recordset.Fields("DESCRIPCIO")) > 114 Then
                    buf = Mid$("" & Data2.Recordset.Fields("DESCRIPCIO"), 106, 110)
                    found = formateaa(buf, 28, 2, 0)

                End If

            End If

        ElseIf tipocomanda = "CO" Then
            buf = "*" & Mid$("" & Data2.Recordset.Fields("PRODUCTO"), 1, 30)
            found = formateaa(buf, 31, 2, 0)
        ElseIf tipocomanda = "DC" Then

            Dim mytablepr As New ADODB.Recordset

            mytablepr.Open "SELECT DESCORTO FROM PRODUCTO where producto='" & "" & Data2.Recordset.Fields("producto") & "'", cn, adOpenDynamic, adLockOptimistic

            If mytablepr.RecordCount > 0 Then
                buf = "*" & Mid$("" & mytablepr.Fields("DESCORTO"), 1, 30)
                found = formateaa(buf, 31, 2, 0)
            Else
                buf = "*" & Mid$("" & mytablepr.Fields("descorto"), 1, 30)
                found = formateaa(buf, 31, 2, 0)

            End If
            
            mytablepr.Close

        End If

    End If
    
    '' 10/07/2018 Edicion Comanda
        
    '-----------------------------------------
    'verificar si tiene receta
    If vendedor_imprimecombo("" & Data2.Recordset.Fields("producto")) = 1 Then
        mytablex.Open "SELECT * FROM receta where producto='" & "" & Data2.Recordset.Fields("producto") & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            Do

                If mytablex.EOF Then Exit Do
                '-------------------------------------------
                found = formateaa("++", 2, 0, 0)
                buf = "" & mytablex.Fields("cantidad")
                found = formateaa(buf, 5, 0, 0)
                found = formateaa("", 1, 0, 0)
                'MsgBox ""
                buf = "" & Mid$("" & mytablex.Fields("descripcio"), 1, 31)
                found = formateaa(buf, 31, 0, 0)
                found = formateaa(" ", 1, 2, 0)

                If Len("" & mytablex.Fields("descripcio")) > 21 Then
                    'buf = "      " & Mid$("" & mytablex.Fields("descripcio"), 32, 31)
                    buf = "" & Mid$("" & mytablex.Fields("descripcio"), 32, 31)
                    found = formateaa(buf, 31, 0, 0)
                    found = formateaa(" ", 1, 2, 0)

                End If

                '-------------------------------------------
                mytablex.MoveNext
            Loop

        End If

        mytablex.Close

    End If

    'MsgBox "" & Data2.Recordset.Fields("observa1")
    'found = formateaa("------------------------------------- ", 28, 2, 0)
    If Len("" & Data2.Recordset.Fields("observa1")) > 0 Then
        buf = "*" & Mid$("" & Data2.Recordset.Fields("observa1"), 1, 30)
        found = formateaa(buf, 31, 2, 0)

        If Len("" & Data2.Recordset.Fields("observa1")) > 30 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa1"), 31, 30)
            found = formateaa(buf, 30, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("observa1")) > 60 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa1"), 61, 30)
            found = formateaa(buf, 30, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("observa1")) > 90 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa1"), 91, 30)
            found = formateaa(buf, 30, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("observa1")) > 120 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa1"), 121, 30)
            found = formateaa(buf, 30, 2, 0)

        End If
        
    End If

    If Len("" & Data2.Recordset.Fields("observa2")) > 0 Then
        buf = "*" & Mid$("" & Data2.Recordset.Fields("observa2"), 1, 30)
        found = formateaa(buf, 31, 2, 0)

        If Len("" & Data2.Recordset.Fields("observa2")) > 30 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa2"), 31, 30)
            found = formateaa(buf, 30, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("observa2")) > 60 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa2"), 61, 30)
            found = formateaa(buf, 30, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("observa2")) > 90 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa2"), 91, 30)
            found = formateaa(buf, 30, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("observa2")) > 120 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa2"), 121, 30)
            found = formateaa(buf, 30, 2, 0)

        End If
         
    End If

    If Len("" & Data2.Recordset.Fields("observa3")) > 0 Then
        buf = "*" & Mid$("" & Data2.Recordset.Fields("observa3"), 1, 30)
        found = formateaa(buf, 31, 2, 0)

        If Len("" & Data2.Recordset.Fields("observa3")) > 30 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa3"), 31, 30)
            found = formateaa(buf, 30, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("observa3")) > 60 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa3"), 61, 30)
            found = formateaa(buf, 30, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("observa3")) > 90 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa3"), 91, 30)
            found = formateaa(buf, 30, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("observa3")) > 120 Then
            buf = Mid$("" & Data2.Recordset.Fields("observa3"), 121, 30)
            found = formateaa(buf, 30, 2, 0)

        End If

    End If

    If Len(Trim("" & Data2.Recordset.Fields("observa4"))) > 0 Then
        found = imprime_combina("" & Data2.Recordset.Fields("producto"))

    End If
    
    ' 10/07/2018 Edicion Comanda
    
    If formatocomanda = "G" Then
        buf = String(42, "-")
        found = formateaa(buf, 45, 2, 0)
    Else
        buf = String(0, " ")
        found = formateaa(buf, 0, 2, 0)
        buf = String(60, "-")
        found = formateaa(buf, 65, 2, 0)

    End If
    
    ' 10/07/2018 Edicion Comanda

    Exit Sub
    ''cmd4711_err:
    ''    MsgBox "Aviso en imprime detalle orden " + error$, 48, "Aviso"
    ''    Exit Sub
    
End Sub

Sub extrae_puertos(temp As String, CAMPO1 As String, CAMPO2 As String, campo3 As String)

    Dim i As Integer

    Dim j As Integer

    i = 0

    'i = InStr(cadena, Parte)
    'If i Then
    'Extrae = Left$(cadena, i - 1) & Mid$(cadena, i + Len(Parte))
    'Else
    'Extrae = cadena
    'End If

    Do
        j = InStr(temp, "|")

        If j > 0 Then
            i = i + 1

            Select Case i

                Case 1: CAMPO1 = Mid$(temp, 1, j - 1)

                Case 2: CAMPO2 = Mid$(temp, 1, j - 1)

                Case 3: campo3 = Mid$(temp, 1, j - 1)

                    'MsgBox campo3
            End Select

            temp = Trim$(Mid$(temp, j + 1))
        Else
            Exit Sub

        End If

    Loop

End Sub

Sub consulta_comanda(buf2 As String)

    Dim found As Integer

    Dim buf   As String

    Dim buf3  As String

    On Error GoTo cmd456_err

    buf3 = ""
    buf2 = Trim(buf2)

    If Len(buf2) > 0 Then
        buf3 = " and salon='" & Trim(buf2) & "'"

    End If

    If cmytablex.State = 1 Then cmytablex.Close
    
    ' 25/07/2018 Delivery y Para Llevar desde mozo
    V_EstadoMesa = "" & busca_tipoSalon(Trim(buf2))

    '24/08/2018  Delivery por mesa
    If V_EstadoMesa = "D" Then
        cmytablex.Open "SELECT Salon,Mesa + ' | ' + ISNULL(NOMBRE,'') as " & glomesa & ",SUM(TOTAL) AS Total,Count(Producto) as C FROM dcomanda d where len(salon)>0 and len(mesa)>0 and len(numero)>0 " & buf3 & " group by SALON,MESA,NOMBRE ORDER BY SALON,MESA", cn, adOpenDynamic, adLockOptimistic
    ElseIf V_EstadoMesa = "L" Then
        cmytablex.Open "SELECT Salon,Mesa + ' | ' + ISNULL(NOMBRE,'') as " & glomesa & ",SUM(TOTAL) AS Total,Count(Producto) as C FROM dcomanda d where len(salon)>0 and len(mesa)>0 and len(numero)>0 " & buf3 & " group by SALON,MESA,NOMBRE ORDER BY SALON,MESA", cn, adOpenDynamic, adLockOptimistic
    Else
        cmytablex.Open "SELECT Salon,Mesa as " & glomesa & ",SUM(TOTAL) AS Total,Count(Producto) as C FROM dcomanda where len(salon)>0 and len(mesa)>0 and len(numero)>0 " & buf3 & " group by SALON,MESA ORDER BY SALON,MESA", cn, adOpenDynamic, adLockOptimistic

    End If

    '24/08/2018  Delivery por mesa
    
    ' 25/07/2018 Delivery y Para Llevar desde mozo
    
    Set table2.DataSource = cmytablex
    table2.refresh
    
    ' 25/07/2018 Delivery y Para Llevar desde mozo
    'table2.columns(0).Width = 1300
    'table2.columns(1).Width = 1300
    'table2.columns(2).Width = 1300
    'table2.columns(3).Width = 1300
    table2.columns(0).Width = 800
    table2.columns(1).Width = 2400
    table2.columns(2).Width = 1100
    table2.columns(3).Width = 1100

    ' 25/07/2018 Delivery y Para Llevar desde mozo

    table2.ForeColor = 1

    suma_comanda

    If cmytablex.RecordCount > 0 Then
        cmytablex.MoveFirst

    End If

    'table2.SetFocus
    'table2.Col = 0
    'table2.Row = table2.VisibleRows - 1
    
    'table2.SetFocus
    Exit Sub
cmd456_err:
    MsgBox "Aviso consulta comanda " & error$, 48, "Aviso"
    Exit Sub

End Sub

Sub suma_comanda()

    Dim sdx As Double

    xopciones(29).Caption = "" 'ESTE BOTON ES DE LA SUMATORIA

    If cmytablex.RecordCount = 0 Then Exit Sub
    cmytablex.MoveFirst
    sdx = 0

    Do

        If cmytablex.EOF Then Exit Do
        sdx = sdx + Val("" & cmytablex.Fields("total"))
        cmytablex.MoveNext
    Loop
    xopciones(29).Caption = Format(sdx, "0.00")

End Sub

Function carga_comanda(sw As Integer)

    Dim i          As Integer

    Dim found      As Integer

    'On Error GoTo cmd890012_err
    Dim mytablex   As New ADODB.Recordset

    Dim mytablecom As New ADODB.Recordset

    If sw = 0 Then
        ' 25/07/2018 Delivery y Para Llevar desde mozo
        ' mytablex.Open "SELECT * FROM dcomanda where salon='" & cmytablex.Fields("salon") & "' and mesa='" & cmytablex.Fields(1)& "'", cn, adOpenDynamic, adLockOptimistic
        mytablex.Open "SELECT * FROM dcomanda where salon='" & cmytablex.Fields("salon") & "' and mesa='" & extra_loquesea(cmytablex.Fields(1)) & "'", cn, adOpenDynamic, adLockOptimistic
        ' 25/07/2018 Delivery y Para Llevar desde mozo
   
    End If

    If sw = 1 Then ' LEO: 14-03-17
        ' 25/07/2018 Delivery y Para Llevar desde mozo
        'mytablex.Open "SELECT * FROM dcomanda where salon='" & cmytablex.Fields("salon") & "' and mesa='" & cmytablex.Fields(1) & "' and cantdev>0", cn, adOpenDynamic, adLockOptimistic
        mytablex.Open "SELECT * FROM dcomanda where salon='" & cmytablex.Fields("salon") & "' and mesa='" & extra_loquesea(cmytablex.Fields(1)) & "' and cantdev>0", cn, adOpenDynamic, adLockOptimistic
   
        ' 25/07/2018 Delivery y Para Llevar desde mozo
    
        'mytablecom.Open "SELECT * FROM mesa where salon='" & cmytablex.Fields("salon") & "' and mesa='" & cmytablex.Fields(1) & "' and cantdev>0", cn, adOpenDynamic, adLockOptimistic
        'mytablex.Open "SELECT * FROM dcomanda where salon='" & cmytablex.Fields("salon") & "' and mesa='" & cmytablex.Fields(1) & "'", cn, adOpenDynamic, adLockOptimistic
        'mytablecom.Open "SELECT * FROM mesa where salon='" & cmytablex.Fields("salon") & "' and mesa='" & cmytablex.Fields(1) & "'", cn, adOpenDynamic, adLockOptimistic
    End If

    If mytablex.RecordCount = 0 Then
        mytablex.Close
        Exit Function

    End If

    ' 25/07/2018 Delivery y Para Llevar desde mozo
    ' mytablecom.Open "SELECT * FROM mesa where salon='" & cmytablex.Fields("salon") & "' and mesa='" & cmytablex.Fields(1) & "'", cn, adOpenDynamic, adLockOptimistic
    mytablecom.Open "SELECT * FROM mesa where salon='" & cmytablex.Fields("salon") & "' and mesa='" & extra_loquesea(cmytablex.Fields(1)) & "'", cn, adOpenDynamic, adLockOptimistic

    ' 25/07/2018 Delivery y Para Llevar desde mozo
    personasx = mytablecom.Fields("capacidad")

    If mytablecom.RecordCount = 0 Then
        mytablecom.Close
        Exit Function

    End If

    '-------------------------
    Data2.refresh
    borrar_campos
    sql_detalle
    Data2.refresh
    cproven = ""

    Do

        If mytablex.EOF Then Exit Do
        If Val("" & mytablex.Fields("cantidad")) > 0 Then
            cproven = mytablex.Fields("vendedor")
    
            '''20/01/2018 kenyo Testing General Sistema
            vendedor = mytablex.Fields("vendedor")
            xvendedor = mytablex.Fields("vendedor")
            '''20/01/2018 kenyo Testing General Sistema
    
            Data2.Recordset.AddNew

            'For i = 0 To mytablex.Fields.count - 1
            For i = 0 To mytablex.Fields.count - 2 ' LEONARDO, CLASICO ERROR DE ITEMS .... LEO: 14-03-17
        
                '24/08/2018  Delivery por mesa
        
                'Data2.Recordset.Fields(I) = mytablex.Fields(I)
                If mytablex.Fields(i).Name <> "nombre" Then
                    Data2.Recordset.Fields(i) = mytablex.Fields(i)

                End If
        
                '24/08/2018  Delivery por mesa
        
            Next i

            If sw = 1 Then
                Data2.Recordset.Fields("cantdev") = 0
                Data2.Recordset.Fields("cantidad") = Val("" & mytablex.Fields("cantdev"))
                Data2.Recordset.Fields("total") = Val("" & mytablex.Fields("cantdev")) * Val("" & mytablex.Fields("precio"))

            End If

            Data2.Recordset.Update

        End If

        mytablex.MoveNext
    Loop

    mytablex.Close
    mytablecom.Close
    found = sumar_detalle()
    carga_comanda = 1

    'Exit Function
    'cmd890012_err:
    'MsgBox "Aviso en Carga Comanda " + error$, 48, "Aviso"
    'Exit Function
End Function

Sub cabecera_orden_despacho1(buf2 As String, mytablex As ADODB.Recordset)

    Dim found     As Integer

    Dim buf       As String

    Dim btipo     As String

    Dim mytable6x As New ADODB.Recordset

    On Error GoTo cmd1141111_err

    'MsgBox "xx"
    buf = String(43, "-")
    found = formateaa(buf2, 34, 2, 0)
    found = formateaa(buf, 45, 2, 0)
    buf = "     ORDEN DESPACHO " & "" & mytablex.Fields("numero")
    found = formateaa(buf, 34, 2, 0)
    buf = "     Caja :" & "" & mytablex.Fields("caja") & " Turno:" & "" & mytablex.Fields("turno")
    found = formateaa(buf, 34, 2, 0)
    buf = "  Fecha:" & Format("" & mytablex.Fields("fecha"), "dd/mm/yyyy") & " " & "Hora :" & Format(Now, "hh:mm:ss")
    found = formateaa(buf, 34, 2, 0)

    If "" & mytablex.Fields("servicio") = "A" Then
   
        found = formateaa("       *** PARA LLEVAR    ***", 25, 2, 0)

        If Len("" & mytablex.Fields("codigo")) > 0 Then
            buf = "CODIGO :" & "" & mytablex.Fields("codigo")
            found = formateaa(buf, 34, 2, 0)
            buf = ""
            mytable6x.Open "SELECT * FROM clientes where codigo='" & mytablex.Fields("codigo") & "'", cn, adOpenDynamic, adLockOptimistic

            If mytable6x.RecordCount > 0 Then
                buf = "" & mytable6x.Fields("nombre")

            End If

            mytable6x.Close
            'buf = "Nom:" & "" & mytablex.Fields("nombreb")
            found = formateaa(buf, 36, 2, 0)

        End If

    End If
   
    If "" & mytablex.Fields("servicio") = "C" Then
        found = formateaa("   *** ATENCION MESA ***", 25, 2, 0)
        buf = "Salon : " & "" & mytablex.Fields("salon") & " Mesa:" & "" & mytablex.Fields("mesa")
        found = formateaa(buf, 34, 2, 0)
        buf = "Mesero:"
        found = formateaa(buf, 8, 0, 0)
        found = busca_vendedor_mesero("" & mytablex.Fields("vendedor"))

    End If

    If "" & mytablex.Fields("servicio") = "D" Then
        found = formateaa("       *** DOMICILIO ***", 25, 2, 0)
        found = formateaa(buf, 34, 2, 0)
        imprime_cliente_delivery "" & mytablex.Fields("codigo")

    End If

    If Val("" & mytablex.Fields("estado")) = 1 Then
        buf = "     ***  ANULADO  ***"
        found = formateaa(buf, 34, 2, 0)

    End If
   
    buf = "///" & xnombre
    found = formateaa(buf, 28, 2, 0)

    buf = String(43, "-")
    found = formateaa(buf, 45, 2, 0)

    found = formateaa("CANT", 7, 0, 0)
   
    found = formateaa("PRODUCTO ", 25, 0, 0)
    found = formateaa(" ", 1, 2, 0)

    buf = String(43, "-")
    found = formateaa(buf, 45, 2, 0)

    Exit Sub
cmd1141111_err:
    MsgBox "Mensaje,Error en cabecera Pedido " & error$
    Exit Sub

End Sub

Private Sub dlo2342_Click()

    Dim found As Integer

    'aqui probamos el autoservicio
    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    If Frame2.Visible = True Then Exit Sub
    found = sumar_detalle()

    If Val(txtotal) > 0 Then
        MsgBox "Tiene Pedido Pendiente", 48, "Aviso"
        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus
        Exit Sub

    End If

    borrar_todo
    sql_detalle
    tiposervicio1 = "Autoservicio"
    salon.Caption = ""
    mesa.Caption = ""
    mesero = ""
    cuenta_separa = ""
    flag_servicio = "A"
    DBGrid2.SetFocus

End Sub

Sub borrar_data2()

    On Error GoTo cmd356_err

    ir_primero
    Do

        If Data2.Recordset.EOF Then Exit Do
        Data2.Recordset.Delete
        Data2.refresh
    Loop
    Exit Sub
cmd356_err:
    Exit Sub

End Sub

Function servicio_generado(buf As String) As String

    Dim mytablex As New ADODB.Recordset

    mytablex.Open "SELECT * FROM servicio where servicio='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        servicio_generado = "" & mytablex.Fields("descripcio")

    End If

    mytablex.Close

End Function

Sub cobra_servicio()

    Dim found As Integer

    Dim buf   As String

    If Frame2.Visible = True Then Exit Sub
    'local1.Visible = False
    'local1.Visible = False
    found = sumar_detalle()

    If found = 0 Then
        MsgBox "debe de Existir un Precio=0", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    If Val(txtotal) = 0 Then
        If exisdev <> -10 Then  'si existe devolucion
            DBGrid2.SetFocus
            Exit Sub

        End If

    End If

    If Trim("" & mytable11.Fields("terminal")) = "T" Or (ot = "S" And Len(petipo) = 0) Then 'pedidos o acuenta>0
        'MsgBox "Hola"
        xruc = codigo
        xnombre = nombre
        xdireccion = ydireccion
        Frame7.Visible = True
        habilita_lab7 1
        Framefp.Enabled = False

        If ot = "S" Then
            xtipo = Trim("" & mytable11.Fields("tipope"))

        End If

        xtipo.SetFocus
        Exit Sub

    End If

    If flag_servicio = "A" Then  'venta rapida

    End If

    If flag_servicio = "D" Then  'validar el deliveri si ingreso datos

    End If

    If flag_servicio = "C" Then  'venta mesas

    End If

    Label36.Caption = "Codigo"
    found = proceso_cobros()  'PONE EN CERO TODAS LA FORMAS DE PAGO
    opcion2 = 0
    'MsgBox dbgrid10.Visible
    ttxtotals = Format(Val(rtxtotal), nrodecimal)
    ttxtotald = Format(Val(rtxtotald), nrodecimal)
    stxtotals = Format(Val(rtxtotal), nrodecimal)
    stxtotald = Format(Val(rtxtotald), nrodecimal)
    Framefp.Visible = True
    Framefp.Enabled = True
    habilita_lab7 0

    'MsgBox ""
    'MsgBox dbgrid10.Enabled
    buf = "select * from fpago where fpago='6'"

    If mytablefpago.State = 1 Then mytablefpago.Close
    mytablefpago.Open buf, cn, adOpenDynamic, adLockOptimistic
    Set dbgrid10.DataSource = mytablefpago
    dbgrid10.refresh

    If mytablefpago.RecordCount > 0 Then
        mytablefpago.MoveFirst
        dbgrid10.Enabled = False
        dbgrid10.Visible = True
        dbgrid10.Enabled = True
        dbgrid10.SetFocus
        DBGrid10_KeyDown 13, 0
        dbgrid9.Enabled = True
        'Exit Sub
        dbgrid9.SetFocus
        DBGrid9_KeyDown 13, 0

        'xtipo = "7"
        'Else
        'MsgBox "No existe exonerado ", 48, "Aviso"
    End If

    'mytablex.Close

End Sub

Sub carga_tiposdoc(buf As String)

    Dim i        As Integer

    Dim mytablex As New ADODB.Recordset

    For i = 0 To 2
        nbxtipo(i) = ""
    Next i

    i = 0

    If buf = "%" Then
        mytablex.Open "select * from tipo where tipodoc='1' or tipodoc='C' or tipodoc='E'  or tipodoc='D' or tipodoc='G' ", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount = 0 Then
            mytablex.Close
            Exit Sub

        End If

        Do

            If mytablex.EOF Then Exit Do
            If "" & mytablex.Fields("tipodoc") = "A" Or "" & mytablex.Fields("tipodoc") = "B" Or "" & mytablex.Fields("tipodoc") = "C" Or "" & mytablex.Fields("tipodoc") = "D" Then
                nbxtipo(i) = "" & mytablex.Fields("tipo")
                i = i + 1

            End If

            ' LEONARDO: AGREGAR 1="BOL" 2="FAC"
            If Trim(nbxtipo(0).Caption) = "1" Then nbxtipo(0).Caption = "Bol"
            If Trim(nbxtipo(1).Caption) = "2" Then nbxtipo(1).Caption = "Fac"
            If i > 2 Then Exit Do
            mytablex.MoveNext
        Loop
        mytablex.Close

    End If

    If buf <> "%" Then
        mytablex.Open "select * from tipo where tipodoc='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount = 0 Then
            mytablex.Close
            Exit Sub

        End If

        Do

            If mytablex.EOF Then Exit Do
            nbxtipo(i) = "" & mytablex.Fields("tipo")
            i = i + 1

            If i > 2 Then Exit Do
            mytablex.MoveNext
        Loop
        mytablex.Close

    End If

End Sub

Function imprime_combina(buf)

    Dim mytablex As New ADODB.Recordset

    Dim found    As Integer

    mytablex.Open "select * from _c" & gusuario & " where producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount = 0 Then
        mytablex.Close
        Exit Function

    End If

    Do

        If mytablex.EOF Then Exit Do
        '----------------------------------------------
        found = formateaa("*" & mytablex.Fields("descripciop"), 15, 0, 0)
        'If Len("" & mytablex.Fields("descripciop")) > 15 Then
        '   buf = Mid$("" & mytablex.Fields("descripciop"), 16, 15)
        '   found = formateaa("" & mytablex.Fields("cantidad"), 15, 2, 0)
        '    found = formateaa(" X ", 3, 0, 0)
        'End If
        found = formateaa("" & mytablex.Fields("cantidad"), 3, 2, 0)
        '----------------------------------------------
        mytablex.MoveNext
    Loop
    mytablex.Close

End Function

Function existe_fuel(buf As String)

    Dim mytablex As New ADODB.Recordset

    mytablex.Open "SELECT * FROM producto where producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        If "" & mytablex.Fields("fuel") = "S" Then
            existe_fuel = 1

        End If

    End If

    mytablex.Close

End Function

Sub resuma_precios(xpercepcion As Double)

    Dim xtivap      As Double

    Dim tdscto      As Double

    Dim sdx2        As Double

    Dim sdx1        As Double

    Dim xtisc       As Double

    Dim X           As Double

    Dim Y           As Double

    Dim sdx         As Double

    Dim ypercepcion As Double

    Dim xneto       As Double

    On Error GoTo cmd94534_err

    ypercepcion = 0

    Data2.Recordset.Fields("percepcion") = xpercepcion

    If busca_tipoprecio() = "N" Then
        Data2.Recordset.Fields("neto") = Val("" & Data2.Recordset.Fields("cantidad")) * Val("" & Data2.Recordset.Fields("precio"))
        Data2.Recordset.Fields("descuento") = Val("" & Data2.Recordset.Fields("neto")) * Val("" & Data2.Recordset.Fields("deslipo")) / 100 + Val("" & Data2.Recordset.Fields("neto")) * Val("" & Data2.Recordset.Fields("destopo")) / 100     'calcular descuento
        'inicio 01/02/2017 pll
        'Data2.Recordset.Fields("subtotal") = Val("" & Data2.Recordset.Fields("neto")) - Val("" & Data2.Recordset.Fields("descuento")) 'cobrar
        'Data2.Recordset.Fields("impuesto") = Val("" & Data2.Recordset.Fields("subtotal")) * Val("" & Data2.Recordset.Fields("igv")) / 100  'calcular descuento
        Data2.Recordset.Fields("subtotal") = Round(Val("" & Data2.Recordset.Fields("neto")) - Val("" & Data2.Recordset.Fields("descuento")), 2) 'cobrar
        Data2.Recordset.Fields("impuesto") = Round(Val("" & Data2.Recordset.Fields("subtotal")) * Val("" & Data2.Recordset.Fields("igv")) / 100, 2) 'calcular descuento

        'Data2.Recordset.Fields("total") = Val("" & Data2.Recordset.Fields("subtotal")) + Val("" & Data2.Recordset.Fields("impuesto")) 'cobrar
        Data2.Recordset.Fields("total") = Round(Val("" & Data2.Recordset.Fields("subtotal")) + Val("" & Data2.Recordset.Fields("impuesto")), 2) 'cobrar
        'fin 01/02/2017 pll

        Data2.Recordset.Fields("tivap") = Val("" & Data2.Recordset.Fields("total")) * Val("" & Data2.Recordset.Fields("ivap")) / 100
        Data2.Recordset.Fields("tpercepcio") = 0

        If "" & Data2.Recordset.Fields("l1") = "S" Then
            Data2.Recordset.Fields("tpercepcio") = Val("" & Data2.Recordset.Fields("total")) * Val("" & Data2.Recordset.Fields("percepcion")) / 100    'calcular descuento
            Data2.Recordset.Fields("total") = Val("" & Data2.Recordset.Fields("total")) + Val("" & Data2.Recordset.Fields("tpercepcio")) 'cobrar

        End If

        Data2.Recordset.Fields("servicioco") = Val("" & Data2.Recordset.Fields("subtotal")) * Val("" & Data2.Recordset.Fields("serviciopo")) / 100     'calcular descuento
        Data2.Recordset.Fields("total") = Val("" & Data2.Recordset.Fields("total")) + Val("" & Data2.Recordset.Fields("servicioco")) 'cobrar

    Else
        Data2.Recordset.Fields("neto") = Val("" & Data2.Recordset.Fields("cantidad")) * Val("" & Data2.Recordset.Fields("precio"))
        Data2.Recordset.Fields("descuento") = Val("" & Data2.Recordset.Fields("neto")) * Val("" & Data2.Recordset.Fields("deslipo")) / 100 + Val("" & Data2.Recordset.Fields("neto")) * Val("" & Data2.Recordset.Fields("destopo")) / 100
        Data2.Recordset.Fields("total") = Val("" & Data2.Recordset.Fields("neto")) - Val("" & Data2.Recordset.Fields("descuento")) 'cobrar
        'inicio 01/12/2017 pll
        'Data2.Recordset.Fields("subtotal") = Val("" & Data2.Recordset.Fields("total")) / (1 + Val("" & Data2.Recordset.Fields("igv")) / 100) 'calcular descuento
        'Data2.Recordset.Fields("impuesto") = Val("" & Data2.Recordset.Fields("total")) - Val("" & Data2.Recordset.Fields("subtotal")) 'cobrar

        '07/08/2018 Testing decimales 'se quito redondeo
        'Data2.Recordset.Fields("subtotal") = Round(Val("" & Data2.Recordset.Fields("total")) / (1 + Val("" & Data2.Recordset.Fields("igv")) / 100), 2) 'calcular descuento
        Data2.Recordset.Fields("subtotal") = Val("" & Data2.Recordset.Fields("total")) / (1 + Val("" & Data2.Recordset.Fields("igv")) / 100) 'calcular descuento
        '07/08/2018 Testing decimales

        Data2.Recordset.Fields("impuesto") = Round(Val("" & Data2.Recordset.Fields("total")) - Val("" & Data2.Recordset.Fields("subtotal")), 2) 'cobrar

        'fin 01/12/2017 pll
        xtivap = Val("" & Data2.Recordset.Fields("total")) * Val("" & Data2.Recordset.Fields("ivap")) / 100
        Data2.Recordset.Fields("tivap") = xtivap
        Data2.Recordset.Fields("tpercepcio") = 0

        If "" & Data2.Recordset.Fields("l1") = "S" Then
            Data2.Recordset.Fields("tpercepcio") = Val("" & Data2.Recordset.Fields("total")) * Val("" & Data2.Recordset.Fields("percepcion")) / 100   'calcular descuento
            Data2.Recordset.Fields("total") = Val("" & Data2.Recordset.Fields("total")) + Val("" & Data2.Recordset.Fields("tpercepcio")) 'cobrar

        End If

        'inicio 01/12/2017  pll
        'Data2.Recordset.Fields("servicioco") = Val("" & Data2.Recordset.Fields("subtotal")) * Val("" & Data2.Recordset.Fields("serviciopo")) / 100      'calcular descuento
        Data2.Recordset.Fields("servicioco") = Round(Val("" & Data2.Recordset.Fields("subtotal")) * Val("" & Data2.Recordset.Fields("serviciopo")) / 100, 2)     'calcular descuento

        'fin 01/12/2017  pll
    End If

    Exit Sub
cmd94534_err:
    MsgBox "Aviso en resuma_precios ", 48, "Aviso"
    Exit Sub

End Sub

Function vendedor_imprimecombo(buf As String)

    Dim mytablex As New ADODB.Recordset

    mytablex.Open "SELECT recetaprn FROM producto where producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        If "" & mytablex.Fields("recetaprn") = "S" Then
            vendedor_imprimecombo = 1

        End If

    End If

    mytablex.Close

End Function

Function suma_pedidos(buf As String, _
                      buf1 As String, _
                      buf2 As String, _
                      buf3 As String) As String

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    sdx = 0
    'MsgBox "SELECT * FROM cpedidov where  codigo='" & buf & "' and tipo='" & buf1 & "' and serie='" & buf2 & "' and numero='" & buf3 & "'"
    mytablex.Open "SELECT * FROM cpedidov where  codigo='" & buf & "' and tipo='" & buf1 & "' and serie='" & buf2 & "' and numero='" & buf3 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        sdx = Val("" & mytablex.Fields("total")) - Val("" & mytablex.Fields("acuenta"))

    End If

    mytablex.Close
    suma_pedidos = "" & sdx

End Function

Sub graba_acumulado_clientes(mytabley As ADODB.Recordset, _
                             signo As Double, _
                             sumador As Double)

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    mytablex.Open "SELECT * FROM cpedidov where  codigo='" & mytabley.Fields("codigo") & "' and tipo='" & "" & mytabley.Fields("orden") & "' and serie='" & "" & mytabley.Fields("observa") & "' and numero='" & "" & mytabley.Fields("dias") & "'", cn, adOpenKeyset, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        sdx = Val("" & mytablex.Fields("acuenta")) + signo * sumador
        mytablex.Fields("acuenta") = sdx
        mytablex.Update

    End If

    mytablex.Close

End Sub

Function verifica_fpago(buf As String) As String

    Dim mytablex As New ADODB.Recordset

    mytablex.Open "SELECT * FROM fpago where  fpago='" & buf & "'", cn, adOpenKeyset, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        verifica_fpago = "" & mytablex.Fields("tipo")

    End If

    mytablex.Close

End Function

Sub inicia_color_familia()

    Dim i        As Integer

    Dim I1       As Integer

    Dim I2       As Integer

    Dim I3       As Integer

    Dim I4       As Integer

    Dim mytablex As New ADODB.Recordset

    mytablex.Open "SELECT * FROM paramecacolor where  caja='" & "" & mytable11.Fields("caja") & "'", cn, adOpenKeyset, adLockOptimistic

    If mytablex.RecordCount > 0 Then

        I1 = Val("" & mytablex.Fields("colorfamilia1"))
        I2 = Val("" & mytablex.Fields("colorfamilia2"))
        I3 = Val("" & mytablex.Fields("colorfamilia3"))
        I4 = Val("" & mytablex.Fields("sizefamilia"))

        If I4 < 8 Then
            I4 = 8

        End If

        For i = 0 To 15
            zFamilias(i).BackColor = RGB(I1, I2, I3)
            zFamilias(i).FontSize = I4
        Next i

    End If

    mytablex.Close

End Sub

Sub inicia_color_producto()

    Dim i        As Integer

    Dim I1       As Integer

    Dim I2       As Integer

    Dim I3       As Integer

    Dim I4       As String

    Dim mytablex As New ADODB.Recordset

    mytablex.Open "SELECT * FROM paramecacolor where  caja='" & "" & mytable11.Fields("caja") & "'", cn, adOpenKeyset, adLockOptimistic

    If mytablex.RecordCount > 0 Then

        I1 = Val("" & mytablex.Fields("colorproducto1"))
        I2 = Val("" & mytablex.Fields("colorproducto2"))
        I3 = Val("" & mytablex.Fields("colorproducto3"))
        I4 = Val("" & mytablex.Fields("size"))

        If I4 < 8 Then
            I4 = 9

        End If

        'Exit Sub
        For i = 0 To 27
            'zfamilia(i).BackColor = 200
            zproductos(i).BackColor = RGB(I1, I2, I3)
            zproductos(i).FontSize = I4
    
        Next i

    End If

    mytablex.Close

End Sub

'Sub carga_cobranza()
'Dim mytablex As New ADODB.Recordset
'Dim i As Integer
'f or i = 0 To 20
'    mcobcod(i) = ""
'    wcobcod(i) = ""
'Next i

'i = -1
'mytablex.Open "select Descripcio,Fpago,Tipo,Moneda from fpago where vecaja='S'", cn, adOpenStatic, adLockOptimistic

'Do
'If mytablex.EOF Then Exit Do
'i = i + 1
'mcobcod(i) = "" & mytablex.Fields("descripcio")
'wcobcod(i) = "" & mytablex.Fields("fpago")
'If i > 20 Then Exit Do
'mytablex.MoveNext
'Loop
'mcobtop = i
'mytablex.Close
'mcobpag = 0
'menu_cobranza "INI"

'End Sub
'Sub menu_cobranza(buf As String)
'Dim i As Integer
'Dim j As Integer
'Select Case buf
'       Case "INI"
'            mcobpag = 0
'       Case "SIG"
'            mcobpag = mcobpag + 3
'            If mcobpag > 102 Then
'               mcobpag = 0
'            End If
'       Case "ANT"
'            mcobpag = mcobpag - 3
'            If mcobpag < 0 Then
'               mcobpag = 0
'            End If
'End Select
'j = -1
'For i = mcobpag To 3 + mcobpag
'    j = j + 1
'    tmediopa(j).Caption = mcobcod(i)
'    wwcobcod(j) = wcobcod(i)
'Next i
'
'End Sub
Sub menu_fin_tallas()

    Dim found As Integer

    'calcula_igv 0
    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus
    Command3_Click

End Sub

Sub inicia_color_comandos()

    Dim a  As String

    Dim i  As Integer

    Dim I1 As Integer

    Dim I2 As Integer

    Dim I3 As Integer

    On Error GoTo cmd89320_err

    Dim mytablex As New ADODB.Recordset

    'MsgBox Trim("" & mytable11.Fields("caja"))
    mytablex.Open "SELECT * FROM paramecacolor where caja='" & Trim("" & mytable11.Fields("caja")) & "'", cn, adOpenKeyset, adLockOptimistic

    If mytablex.RecordCount > 0 Then

        'MsgBox "abc"
        For i = 0 To 34 ' suspendo colores
            '''        a = "c" & i
            '''        I1 = Val("" & mytablex.Fields(a))
            '''        a = "d" & i
            '''        I2 = Val("" & mytablex.Fields(a))
            '''        a = "e" & i
            '''        I3 = Val("" & mytablex.Fields(a))
            '''xopcioness(i).BackColor = RGB(I1, I2, I3) ' LEONARDO COLOR DE BOTONES
            'xopciones.Visible = True
            a = "f" & i

            If UCase(Trim("" & mytablex.Fields(a))) = "N" Then
                'xopcioness(i).Visible = True
                xopciones(i).Caption = ""
                xopciones(i).Enabled = False

                'xopciones.Visible = True 'TAPA LAS MESAS Y LOS SALONES - ANTES ERA 30 AHORA ES SOLO
                'xopcioness(i).BackColor = RGB(I1, I2, I3)
                If i = 30 Then
                    xopciones(30).Caption = "NORMAL"
                    xopciones(30).Enabled = True

                End If

            End If

        Next i
    
        'KENYO BLOQUEA CASH Y BILLETES DE 20,50 Y 100
        If xopciones(21).Enabled = False Then ' 21 ES EFECTIVO/CASH
            cmdCobrar.Enabled = False
            cmdCobrar.Caption = ""
     
            cmd50.Enabled = False
            cmd50.Caption = ""
     
            cmd100.Enabled = False
            cmd100.Caption = ""
     
            cmd200.Enabled = False
            cmd200.Caption = ""

        Else
            cmdCobrar.Enabled = True
            cmdCobrar.Caption = "EFECTIVO"
     
            cmd50.Enabled = True
            cmd50.Caption = "50"
     
            cmd100.Enabled = True
            cmd100.Caption = "100"
     
            cmd200.Enabled = True
            cmd200.Caption = "200"

        End If

        'MsgBox i
    End If

    mytablex.Close

    Exit Sub
cmd89320_err:
    MsgBox "Aviso en inicia color Comando " + error$, 48, "Aviso"
    Exit Sub

End Sub

Function verifica_saldo_receta(buf1 As String, cant As Double)

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    Dim sw       As Integer

    Dim buf      As String

    sw = 0

    'MsgBox buf
    On Error GoTo cmd908912_err

    buf = "SELECT dbo.RECETA.PRODUCTOI, dbo.ALMACEN.SALDO "
    buf = buf & "FROM dbo.RECETA INNER JOIN "
    buf = buf & " dbo.ALMACEN on dbo.RECETA.PRODUCTOI = dbo.ALMACEN.PRODUCTO"
    buf = buf & " and dbo.receta.producto='" & buf1 & "'"
    'MsgBox buf
    mytablex.Open buf, cn, adOpenKeyset, adLockOptimistic

    If mytablex.RecordCount = 0 Then
        mytablex.Close
        Exit Function

    End If

    sdx = 1
    Do

        If mytablex.EOF Then Exit Do
        If cant >= Val("" & mytablex.Fields(1)) Then
            sw = 2
            Exit Do

        End If

        mytablex.MoveNext
    Loop
    mytablex.Close
    verifica_saldo_receta = sw
    Exit Function
cmd908912_err:
    MsgBox "Aviso en veridfica saldo receta " + error$, 48, "Aviso"
    Exit Function

End Function

Sub carga_color()

    Dim mytablex As New ADODB.Recordset

    mytablex.Open "select * from color order by descripcio", cn, adOpenStatic, adLockOptimistic
    Do

        If mytablex.EOF Then Exit Do
        mytablex.MoveNext
    Loop
    mytablex.Close

    'dpcolor.ListIndex = 0
End Sub

Sub carga_dcvendedor()

    Dim mytablex As New ADODB.Recordset

    dcvendedor.Clear
    dcvendedor.AddItem "%"
    mytablex.Open "select * from vendedor order by nombre", cn, adOpenStatic, adLockOptimistic
    Do

        If mytablex.EOF Then Exit Do
        dcvendedor.AddItem "" & mytablex.Fields("codigo") & "|" & mytablex.Fields("nombre")
        mytablex.MoveNext
    Loop
    mytablex.Close
    dcvendedor.ListIndex = 0

End Sub

Function orden_despachot(nroimp As Integer)

    Dim buf As String

    Dim X   As Integer

    Dim oldprinter

    Dim found    As Integer

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd47113_err

    If Len(Trim("" & mytable11.Fields("copiaod"))) = 0 Then Exit Function
    FileName = caja & "LP"
    found = borra_nombre("" & FileName)
    cerrar_archivo
    ncanal = 1
    Open FileName For Append As #ncanal
    Data2.refresh
    cabecera_orden_despacho "" & Data2.Recordset.Fields("vendedor"), "", "", ""
    Do

        If Data2.Recordset.EOF Then Exit Do
        '----- formato nuevo
        buf = "" & Data2.Recordset.Fields("cantidad")
        found = formateaa(buf, 5, 0, 0)
        found = formateaa("", 1, 0, 0)
        'MsgBox ""
        buf = "" & Mid$("" & Data2.Recordset.Fields("descripcio"), 1, 31)
        found = formateaa(buf, 31, 0, 0)
        found = formateaa(" ", 1, 2, 0)

        If Len("" & Data2.Recordset.Fields("descripcio")) > 21 Then
            buf = "      " & Mid$("" & Data2.Recordset.Fields("descripcio"), 32, 31)
            'buf = "" & Mid$("" & Data2.Recordset.Fields("descripcio"), 32, 31)
            found = formateaa(buf, 31, 0, 0)
            found = formateaa(" ", 1, 2, 0)

        End If

        'verificar si tiene receta
        If vendedor_imprimecombo("" & Data2.Recordset.Fields("producto")) = 1 Then
            mytablex.Open "SELECT * FROM receta where producto='" & "" & Data2.Recordset.Fields("producto") & "'", cn, adOpenDynamic, adLockOptimistic

            If mytablex.RecordCount > 0 Then
                Do

                    If mytablex.EOF Then Exit Do
                    '-------------------------------------------
                    found = formateaa("++", 2, 0, 0)
                    buf = "" & mytablex.Fields("cantidad")
                    found = formateaa(buf, 5, 0, 0)
                    found = formateaa("", 1, 0, 0)
                    'MsgBox ""
                    buf = "" & Mid$("" & mytablex.Fields("descripcio"), 1, 31)
                    found = formateaa(buf, 31, 0, 0)
                    found = formateaa(" ", 1, 2, 0)

                    If Len("" & mytablex.Fields("descripcio")) > 21 Then
                        'buf = "      " & Mid$("" & mytablex.Fields("descripcio"), 32, 31)
                        buf = "" & Mid$("" & mytablex.Fields("descripcio"), 32, 31)
                        found = formateaa(buf, 31, 0, 0)
                        found = formateaa(" ", 1, 2, 0)

                    End If

                    '-------------------------------------------
                    mytablex.MoveNext
                Loop

            End If

            mytablex.Close

        End If

        'found = formateaa("------------------------------------- ", 28, 2, 0)
        If Len("" & Data2.Recordset.Fields("observa1")) > 0 Then
            buf = "*" & Data2.Recordset.Fields("observa1")
            found = formateaa(buf, 28, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("observa2")) > 0 Then
            buf = "*" & Data2.Recordset.Fields("observa2")
            found = formateaa(buf, 28, 2, 0)

        End If

        If Len("" & Data2.Recordset.Fields("observa3")) > 0 Then
            buf = "*" & Data2.Recordset.Fields("observa3")
            found = formateaa(buf, 28, 2, 0)

        End If

        If Len(Trim("" & Data2.Recordset.Fields("observa4"))) > 0 Then
            found = imprime_combina("" & Data2.Recordset.Fields("producto"))

        End If

        Data2.Recordset.MoveNext
    Loop

    For X = 1 To 5
        Print #ncanal, ""
    Next X

    Print #ncanal, ""
    Close #ncanal
    cerrar_archivo

    'MsgBox "xxxx"
    '---impresion del archivo------------
    If existearchivo(FileName) = 1 Then
        oldprinter = Printer.DeviceName
        'MsgBox "xx"
        selecciona_impresoras ("" & mytable11.Fields("copiaod"))
        'MsgBox "xxx"
        found = Imprime_archivojj(FileName, 0, "" & mytable11.Fields("tamanorden"), "" & mytable11.Fields("nombrefont"), "" & mytable11.Fields("BOLD"), "" & mytable11.Fields("letrainterna"))
        'MsgBox "xxx"
        selecciona_impresoras (Trim(oldprinter))

        'MsgBox "xabc"
    End If

    found = borra_nombre(FileName)
    Exit Function
cmd47113_err:
    MsgBox "Aviso en orden despachot " + error$, 48, "Aviso"
    Exit Function

End Function

Sub carga_minimo(buf As String)

    Dim mytablex As New ADODB.Recordset

    On Error GoTo CMD89222_ERR

    stkminimo = ""

    If "" & mytable11.Fields("stkminimo") = "S" And Len(Trim(Label12)) = 0 Then
        'If "" & mytable11.Fields("stkminimo") = "S" Then
        mytablex.Open "SELECT * FROM producto where producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            If familia_saldo("" & mytablex.Fields("familia")) = 0 Then
                consulta_minimo buf, "" & mytablex.Fields("minimo")

            End If

        End If

        mytablex.Close

    End If

    Exit Sub
CMD89222_ERR:
    Exit Sub

End Sub

Function credito_habilitado(buf As String)

    Dim mytablex As New ADODB.Recordset

    Dim buf1     As String

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM clientes where  codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        If "" & mytablex.Fields("estadocredito") = "S" Then
            credito_habilitado = 1

        End If

    End If

    mytablex.Close

End Function

Function busca_credito_credito(buf As String, buf2 As String)

    Dim mytablex As New ADODB.Recordset

    Dim sdx      As Double

    Dim found    As Integer

    Dim buf1     As String

    sdx = 0

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM cuentac  where  tipoclie='C' and codigo='" & buf2 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        Do

            If mytablex.EOF Then Exit Do
            If Val("" & mytablex.Fields("saldo")) > 0 Then
                If "" & mytablex.Fields("grupo") = buf Then
                    sdx = sdx + Val("" & mytablex.Fields("saldo"))

                End If

            End If

            mytablex.MoveNext
        Loop

    End If

    mytablex.Close
    saldoabo = Format(sdx, "0.00")
    mytablex.Open "SELECT * FROM clientes where  codigo='" & buf2 & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        mytablex.Fields("credito_usado") = sdx
        mytablex.Update

    End If

    mytablex.Close

End Function

Function saldo_clientes(buf As String, deltax As Double) As Double

    Dim sdx      As Double

    Dim mytablex As New ADODB.Recordset

    sdx = 0
    mytablex.Open "SELECT * FROM clientes where  codigo='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        sdx = Val("" & mytablex.Fields("credito")) - (Val("" & mytablex.Fields("credito_usado")) + deltax)

    End If

    saldo_clientes = sdx

End Function

Sub carga_clasificacion()

    Dim mytablex As New ADODB.Recordset

    coclasifica.Clear
    coclasifica.AddItem "%"
    mytablex.Open "select * from clasifi ", cn, adOpenStatic, adLockOptimistic
    Do

        If mytablex.EOF Then Exit Do
        coclasifica.AddItem "" & mytablex.Fields("clasifica") & "|" & mytablex.Fields("descripcio")
        mytablex.MoveNext
    Loop
    mytablex.Close
    coclasifica.ListIndex = 0

End Sub

Sub saludo_cumpe()

    Dim dd  As String

    Dim mm  As String

    Dim ddd As String

    Dim mmm As String

    felizc = ""

    If Not IsDate(fechanac) Then
        Exit Sub

    End If

    dd = Format(Day(Now), "00")
    mm = Format(Month(Now), "00")

    ddd = Format(Day(fechanac), "00")
    mmm = Format(Month(fechanac), "00")
   
    If dd = ddd And mm = mmm Then
        felizc = "FELIZ CUMPLEAÑOS "

    End If

End Sub

''' 15/11/2017 Comentario completo en servicio para llevar y delivery
'Sub imprime_detalle_orden1(mytablex As ADODB.Recordset)
'Dim buf As String
'Dim found As Integer
'Dim mytabley As New ADODB.Recordset
'On Error GoTo cmd90003_err
'    '----- formato nuevo
'    If Val("" & mytablex.Fields("estado")) = 1 Then
'       buf = "-" & mytablex.Fields("cantidad")
'       Else
'       buf = "" & mytablex.Fields("cantidad")
'    End If
'    found = formateaa(buf, 5, 0, 0)
'    found = formateaa("", 1, 0, 0)
'    buf = "" & Mid$("" & mytablex.Fields("descripcio"), 1, 31)
'    found = formateaa(buf, 31, 0, 0)
'    found = formateaa(" ", 1, 2, 0)
'
'
'    If Len("" & mytablex.Fields("descripcio")) > 21 Then
'       buf = "      " & Mid$("" & mytablex.Fields("descripcio"), 32, 31)
'       'buf = "" & Mid$("" & mytablex.Fields("descripcio"), 32, 31)
'       found = formateaa(buf, 31, 0, 0)
'       found = formateaa(" ", 1, 2, 0)
'    End If
'
'    '--------------------------------------------------------
'    If vendedor_imprimecombo("" & mytablex.Fields("producto")) = 1 Then
'    mytabley.Open "SELECT * FROM receta where producto='" & "" & mytablex.Fields("producto") & "'", cn, adOpenDynamic, adLockOptimistic
'   If mytabley.RecordCount > 0 Then
'      Do
'      If mytabley.EOF Then Exit Do
'      '-------------------------------------------
'      found = formateaa("++", 1, 0, 0)
'      buf = "" & mytabley.Fields("cantidad")
'    found = formateaa(buf, 5, 0, 0)
'    found = formateaa("", 1, 0, 0)
'    'MsgBox ""
'       buf = "" & Mid$("" & mytabley.Fields("descripcio"), 1, 31)
'       found = formateaa(buf, 31, 0, 0)
'       found = formateaa(" ", 1, 2, 0)
'    If Len("" & mytabley.Fields("descripcio")) > 21 Then
'       buf = "      " & Mid$("" & mytabley.Fields("descripcio"), 32, 31)
'       found = formateaa(buf, 31, 0, 0)
'       found = formateaa(" ", 1, 2, 0)
'    End If
'      '-------------------------------------------
'      mytabley.MoveNext
'      Loop
'   End If
'   mytabley.Close
'   End If
'
'    '--------------------------------------------------------
'
'    'found = formateaa("------------------------------------- ", 28, 2, 0)
'    If Len("" & mytablex.Fields("observa1")) > 0 Then
'       'buf = "*" & mytablex.fields("observa")
'       'debe descriminar los productos
'       'found = verifica_receta_flag("" & mytablex.fields("observa"), 0)
'       'found = imprime_combina("" & mytablex.Fields("caja"), "" & mytablex.Fields("producto"))
'       'If found = 0 Then
'       'found = formateaa(buf, 28, 2, 0)
'       'End If
'    End If
'    If Len("" & mytablex.Fields("observa1")) > 0 Then
'       buf = "*" & mytablex.Fields("observa1")
'       found = formateaa(buf, 28, 2, 0)
'    End If
'    If Len("" & mytablex.Fields("observa2")) > 0 Then
'       buf = "*" & mytablex.Fields("observa2")
'       found = formateaa(buf, 28, 2, 0)
'    End If
'    If Len(Trim("" & mytablex.Fields("observa4"))) > 0 Then
'       found = imprime_combina("" & mytablex.Fields("producto"))
'    End If
''''    If "" & mytablex.Fields("isla") = "1" Then 'LEITO SOLUCION IMPRESION KENYO
''''       buf = "Consumo"
''''       found = formateaa(buf, 28, 2, 0)
''''    End If
'    suma1 = suma1 + Val("" & mytablex.Fields("cantidad"))
'    Exit Sub
'cmd90003_err:
'    MsgBox "Aviso en imprime detalle orden 1" + error$, 48, "Aviso"
'    Exit Sub
'End Sub

Sub imprime_detalle_orden1(mytablex As ADODB.Recordset)

    Dim buf      As String

    Dim found    As Integer

    Dim mytabley As New ADODB.Recordset
   
    On Error GoTo cmd90003_err

    If Val("" & mytablex.Fields("estado")) = 1 Then
        buf = "-" & mytablex.Fields("cantidad")
    Else
        buf = "" & mytablex.Fields("cantidad")

    End If
    
    found = formateaa(buf, 5, 0, 0)
    found = formateaa("", 1, 0, 0)
            
    '' 10/07/2018 Edicion Comanda
    '    buf = "" & Mid$("" & mytablex.Fields("descripcio"), 1, 31)
    '    found = formateaa(buf, 31, 0, 0)
    '    found = formateaa(" ", 1, 2, 0)
    '
    '    If Len("" & mytablex.Fields("descripcio")) > 21 Then
    '        buf = "      " & Mid$("" & mytablex.Fields("descripcio"), 32, 31)
    '        found = formateaa(buf, 31, 0, 0)
    '        found = formateaa(" ", 1, 2, 0)
    '    End If
             
    If formatocomanda = "G" Then
        
        buf = "*" & Mid$("" & mytablex.Fields("DESCRIPCIO"), 1, 37)
        found = formateaa(buf, 38, 2, 0)

        If Len("" & mytablex.Fields("DESCRIPCIO")) > 37 Then
            buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 38, 44)
            found = formateaa(buf, 44, 2, 0)

        End If

        If Len("" & mytablex.Fields("DESCRIPCIO")) > 81 Then
            buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 82, 44)
            found = formateaa(buf, 44, 2, 0)

        End If

        If Len("" & mytablex.Fields("DESCRIPCIO")) > 125 Then
            buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 110, 44)
            found = formateaa(buf, 44, 2, 0)

        End If

    End If
             
    If formatocomanda = "D" Then
        If tipocomanda = "DL" Then
        
            If ("" & mytable11.Fields("tamanorden")) = 8 Then
            
                buf = "*" & Mid$("" & mytablex.Fields("DESCRIPCIO"), 1, 35)
                found = formateaa(buf, 36, 2, 0)

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 35 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 36, 38)
                    found = formateaa(buf, 38, 2, 0)

                End If

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 73 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 74, 42)
                    found = formateaa(buf, 38, 2, 0)

                End If

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 121 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 108, 42)
                    found = formateaa(buf, 38, 2, 0)

                End If

            Else
        
                buf = "*" & Mid$("" & mytablex.Fields("DESCRIPCIO"), 1, 23)
                found = formateaa(buf, 23, 2, 0)

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 22 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 22, 44)
                    found = formateaa(buf, 28, 2, 0)

                End If

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 46 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 50, 66)
                    found = formateaa(buf, 28, 2, 0)

                End If

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 90 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 78, 88)
                    found = formateaa(buf, 28, 2, 0)

                End If

                If Len("" & mytablex.Fields("DESCRIPCIO")) > 114 Then
                    buf = Mid$("" & mytablex.Fields("DESCRIPCIO"), 106, 110)
                    found = formateaa(buf, 28, 2, 0)

                End If
        
            End If
        
        ElseIf tipocomanda = "CO" Then
            buf = "*" & Mid$("" & mytablex.Fields("PRODUCTO"), 1, 30)
            found = formateaa(buf, 31, 2, 0)
        ElseIf tipocomanda = "DC" Then

            Dim mytablepr As New ADODB.Recordset

            mytablepr.Open "SELECT DESCORTO FROM PRODUCTO where producto='" & "" & mytablex.Fields("producto") & "'", cn, adOpenDynamic, adLockOptimistic

            If mytablepr.RecordCount > 0 Then
                buf = "*" & Mid$("" & mytablex.Fields("DESCORTO"), 1, 30)
                found = formateaa(buf, 31, 2, 0)
            Else
                buf = "*" & Mid$("" & mytablex.Fields("descorto"), 1, 30)
                found = formateaa(buf, 31, 2, 0)

            End If
            
            mytablepr.Close

        End If
    
    End If
    
    '--------------------------------------------------------
    If vendedor_imprimecombo("" & mytablex.Fields("producto")) = 1 Then
        mytabley.Open "SELECT * FROM receta where producto='" & "" & mytablex.Fields("producto") & "'", cn, adOpenDynamic, adLockOptimistic

        If mytabley.RecordCount > 0 Then
            Do

                If mytabley.EOF Then Exit Do
                '-------------------------------------------
                found = formateaa("++", 1, 0, 0)
                buf = "" & mytabley.Fields("cantidad")
                found = formateaa(buf, 5, 0, 0)
                found = formateaa("", 1, 0, 0)
                'MsgBox ""
                buf = "" & Mid$("" & mytabley.Fields("descripcio"), 1, 31)
                found = formateaa(buf, 31, 0, 0)
                found = formateaa(" ", 1, 2, 0)

                If Len("" & mytabley.Fields("descripcio")) > 21 Then
                    buf = "      " & Mid$("" & mytabley.Fields("descripcio"), 32, 31)
                    found = formateaa(buf, 31, 0, 0)
                    found = formateaa(" ", 1, 2, 0)

                End If

                '-------------------------------------------
                mytabley.MoveNext
            Loop

        End If

        mytabley.Close

    End If
   
    '--------------------------------------------------------

    'found = formateaa("------------------------------------- ", 28, 2, 0)
    If Len("" & mytablex.Fields("observa1")) > 0 Then

        'buf = "*" & mytablex.fields("observa")
        'debe descriminar los productos
        'found = verifica_receta_flag("" & mytablex.fields("observa"), 0)
        'found = imprime_combina("" & mytablex.Fields("caja"), "" & mytablex.Fields("producto"))
        'If found = 0 Then
        'found = formateaa(buf, 28, 2, 0)
        'End If
    End If

    If Len("" & mytablex.Fields("observa1")) > 0 Then
       
        buf = "*" & Mid$("" & mytablex.Fields("observa1"), 1, 30)
        found = formateaa(buf, 31, 2, 0)
       
        If Len("" & mytablex.Fields("observa1")) > 30 Then
            buf = Mid$("" & mytablex.Fields("observa1"), 31, 30)
            found = formateaa(buf, 30, 2, 0)

        End If
       
        If Len("" & mytablex.Fields("observa1")) > 60 Then
            buf = Mid$("" & mytablex.Fields("observa1"), 61, 30)
            found = formateaa(buf, 30, 2, 0)

        End If
       
        If Len("" & mytablex.Fields("observa1")) > 90 Then
            buf = Mid$("" & mytablex.Fields("observa1"), 91, 30)
            found = formateaa(buf, 30, 2, 0)

        End If
         
        If Len("" & mytablex.Fields("observa1")) > 120 Then
            buf = Mid$("" & mytablex.Fields("observa1"), 121, 30)
            found = formateaa(buf, 30, 2, 0)

        End If

    End If
    
    If Len("" & mytablex.Fields("observa2")) > 0 Then
        buf = "*" & mytablex.Fields("observa2")
        found = formateaa(buf, 28, 2, 0)

    End If

    If Len(Trim("" & mytablex.Fields("observa4"))) > 0 Then
        found = imprime_combina("" & mytablex.Fields("producto"))

    End If

    '''    If "" & mytablex.Fields("isla") = "1" Then 'LEITO SOLUCION IMPRESION KENYO
    '''       buf = "Consumo"
    '''       found = formateaa(buf, 28, 2, 0)
    '''    End If

    suma1 = suma1 + Val("" & mytablex.Fields("cantidad"))
    
    ' 10/07/2018 Edicion Comanda
    If formatocomanda = "G" Then 'si es generia o con driver
        
        buf = String(42, "-")
        found = formateaa(buf, 45, 2, 0)
    
    Else
        buf = String(0, " ")
        found = formateaa(buf, 0, 2, 0)
        buf = String(60, "-")
        found = formateaa(buf, 65, 2, 0)
    
    End If
    
    ' 10/07/2018 Edicion Comanda
    
    Exit Sub
cmd90003_err:
    MsgBox "Aviso en imprime detalle orden 1" + error$, 48, "Aviso"
    Exit Sub

End Sub

''' 15/11/2017 Comentario completo en servicio para llevar y delivery

Sub proceso_cierre_ticket()

    Dim found As Integer

    Dim buf   As String

    If Frame2.Visible = True Then Exit Sub
    'local1.Visible = False
    'local1.Visible = False
    found = sumar_detalle()

    If found = 0 Then
        MsgBox "debe de Existir un Precio=0", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    'MsgBox exisdev
    If Val(txtotal) = 0 Then
        If exisdev <> -10 Then  'si existe devolucion
    
            DBGrid2.SetFocus
            Exit Sub

        End If

    End If

    carga_tiposdoc "%"

    If Trim("" & mytable11.Fields("terminal")) = "T" Or (ot = "S" And Len(petipo) = 0) Then 'pedidos o acuenta>0
        xruc = codigo
        xnombre = nombre
        xdireccion = ydireccion
        Frame7.Visible = True
        habilita_lab7 1
        Framefp.Enabled = False

        If ot = "S" Then
            xtipo = Trim("" & mytable11.Fields("tipope"))

        End If

        xtipo.SetFocus
        Exit Sub

    End If

    If flag_servicio = "A" Then  'venta rapida

    End If

    If flag_servicio = "D" Then  'validar el deliveri si ingreso datos

    End If

    If flag_servicio = "C" Then  'venta mesas

    End If

    Label36.Caption = "Codigo"
    found = proceso_cobros()  'PONE EN CERO TODAS LA FORMAS DE PAGO
    opcion2 = 0
    'MsgBox dbgrid10.Visible
    ttxtotals = Format(Val(rtxtotal), nrodecimal)
    ttxtotald = Format(Val(rtxtotald), nrodecimal)
    stxtotals = Format(Val(rtxtotal), nrodecimal)
    stxtotald = Format(Val(rtxtotald), nrodecimal)

    habilita_lab7 0

    buf = "select * from fpago where fpago='1'"

    If mytablefpago.State = 1 Then mytablefpago.Close
    mytablefpago.Open buf, cn, adOpenDynamic, adLockOptimistic
    Set dbgrid10.DataSource = mytablefpago
    dbgrid10.refresh

    If mytablefpago.RecordCount > 0 Then
        mytablefpago.MoveFirst
      
        ' If Val(hknumero) > Val(rtxtotal) Then
        RGPAGO = hknumero
        'End If
      
        RGPAGO_KeyPress 13
        xtipo = "5"
        '      If Len(Trim(codigo)) = 11 Then
        '         If valida_numero_ruc(Trim(codigo)) = True Then
        '         xtipo = "2"
        '         xruc = codigo
        '         End If
        '      End If
      
        xtipo_keyPress 13

        'RGPAGO.SetFocus
        'xtipo = "7"
        'Else
        'MsgBox "No existe exonerado ", 48, "Aviso"
    End If

    'mytablex.Close
End Sub

Sub proceso_cierre_efectivo()

    Dim found As Integer

    Dim buf   As String

    If Frame2.Visible = True Then Exit Sub
    'local1.Visible = False
    'local1.Visible = False
    found = sumar_detalle()

    If found = 0 Then
        MsgBox "debe de Existir un Precio=0", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    'MsgBox exisdev
    If Val(txtotal) = 0 Then
        If exisdev <> -10 Then  'si existe devolucion
    
            DBGrid2.SetFocus
            Exit Sub

        End If

    End If

    carga_tiposdoc "%"

    If Trim("" & mytable11.Fields("terminal")) = "T" Or (ot = "S" And Len(petipo) = 0) Then 'pedidos o acuenta>0
        'MsgBox "Hola"
        xruc = codigo
        xnombre = nombre
        xdireccion = ydireccion
        Frame7.Visible = True
        habilita_lab7 1
        Framefp.Enabled = False

        If ot = "S" Then
            xtipo = Trim("" & mytable11.Fields("tipope"))

        End If

        xtipo.SetFocus
        Exit Sub

    End If

    If flag_servicio = "A" Then  'venta rapida

    End If

    If flag_servicio = "D" Then  'validar el deliveri si ingreso datos

    End If

    If flag_servicio = "C" Then  'venta mesas

    End If

    Label36.Caption = "Codigo"
    found = proceso_cobros()  'PONE EN CERO TODAS LA FORMAS DE PAGO
    opcion2 = 0
    'MsgBox dbgrid10.Visible
    ttxtotals = Format(Val(rtxtotal), nrodecimal)
    ttxtotald = Format(Val(rtxtotald), nrodecimal)
    stxtotals = Format(Val(rtxtotal), nrodecimal)
    stxtotald = Format(Val(rtxtotald), nrodecimal)

    'Inicio 17/04/2017 pll no visualiza la forma de pago en efectivo
    'Framefp.Visible = True
    'Framefp.Enabled = True
    'Fin 17/04/2017 pll no visualiza la forma de pago en efectivo

    habilita_lab7 0
    'MsgBox ""
    'MsgBox dbgrid10.Enabled
    buf = "select * from fpago where fpago='1'"

    If mytablefpago.State = 1 Then mytablefpago.Close
    mytablefpago.Open buf, cn, adOpenDynamic, adLockOptimistic
    Set dbgrid10.DataSource = mytablefpago
    dbgrid10.refresh

    If mytablefpago.RecordCount > 0 Then
        mytablefpago.MoveFirst
      
        'inicio 17/04/2017 pll no visualiza el frame forma de pago en la opcion efectivo
      
        'dbgrid10.Enabled = False
        'dbgrid10.Visible = True
        'dbgrid10.Enabled = True
        'dbgrid10.SetFocus
        'DBGrid10_KeyDown 13, 0
        'DBGrid9.Enabled = True
        'Exit Sub
        'If DBGrid9.Visible = False Then DBGrid9.Visible = True
        'dbgrid9.SetFocus 'ya estaba en comento
        'DBGrid9_KeyDown 13, 0
       
        'fin 17/04/2017 pll no visualiza el frame forma de pago
      
        ' If Val(hknumero) > Val(rtxtotal) Then
        RGPAGO = hknumero
        'End If
      
        RGPAGO_KeyPress 13
        xtipo = "1"

        If Len(Trim(codigo)) = 11 Then
            If valida_numero_ruc(Trim(codigo)) = True Then
                xtipo = "2"
                xruc = codigo

            End If

        End If
      
        xtipo_keyPress 13

        'RGPAGO.SetFocus
        'xtipo = "7"
        'Else
        'MsgBox "No existe exonerado ", 48, "Aviso"
    End If

    'mytablex.Close
End Sub

'inicio 21/04/2017 pll
Private Sub Proceso_tipoPago5_Click()

    Dim found As Integer

    Dim sw    As Integer

    Dim sdx   As Double

    If Len(pedido) = 0 Then  'si no es modificacion
        found = valida_total()

        If found = 0 Then
            MsgBox "Campos invalidos", 48, "Aviso"
            Exit Sub

        End If

    End If

    ndetraccion = ""
   
    If Len(xnombre) > 0 Or Len(nombre) > 0 Then
        'If local1.Visible = False Then  'si no es traslado locales
   
        '  xruc = Trim(codigo.Text)
        '      xruc = Trim(codigo.Text)
        '     xnombre = Trim(nombre.Text)
        '         xdireccion = Trim(ydireccion.Text)
        '         correo = Trim(correo.Text)
        xruc = Trim(codigo.Text)
        xnombre = Trim(nombre.Text)
        xdireccion = Trim(ydireccion.Text)
        correo = Trim(correo.Text)
  
        graba_cliente_tipo (xruc) 'ojo graba con el correlativo

        'End If
    End If

    If Len(pedido) > 0 Then
        xtipo = "P"
        xserie = "P"
        xnumero = "" & pedido

    End If

    cgusuario = gocabeza
    dgusuariog = godetalle

    If Len(flag_servicio) = 0 Then
        MsgBox "No existe servicio seleccionado ", 48, "Aviso"
        Exit Sub

    End If

    found = busca_numero(xtipo, xserie, xnumero) 'busca numero libre
   
    If found = -1 Then  'si es boleta o factura manual
        'xnumero.SetFocus
        Exit Sub

    End If
   
    opcion1 = "0"

    adiciona_deliveri xtipo, xserie, xnumero
    'Command6_Click ' ha controlar
    limpia_general

End Sub

Sub proceso_cierre_dolar()

    Dim found As Integer

    Dim buf   As String

    If Frame2.Visible = True Then Exit Sub
    'local1.Visible = False
    'local1.Visible = False
    found = sumar_detalle()

    If found = 0 Then
        MsgBox "debe de Existir un Precio=0", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    If Val(txtotal) = 0 Then
        If exisdev <> -10 Then  'si existe devolucion
            DBGrid2.SetFocus
            Exit Sub

        End If

    End If

    carga_tiposdoc "%"

    If Trim("" & mytable11.Fields("terminal")) = "T" Or (ot = "S" And Len(petipo) = 0) Then 'pedidos o acuenta>0
        'MsgBox "Hola"
        xruc = codigo
        xnombre = nombre
        xdireccion = ydireccion
        Frame7.Visible = True
        habilita_lab7 1
        Framefp.Enabled = False

        If ot = "S" Then
            xtipo = Trim("" & mytable11.Fields("tipope"))

        End If

        xtipo.SetFocus
        Exit Sub

    End If

    If flag_servicio = "A" Then  'venta rapida

    End If

    If flag_servicio = "D" Then  'validar el deliveri si ingreso datos

    End If

    If flag_servicio = "C" Then  'venta mesas

    End If

    Label36.Caption = "Codigo"
    found = proceso_cobros()  'PONE EN CERO TODAS LA FORMAS DE PAGO
    opcion2 = 0
    'MsgBox dbgrid10.Visible
    ttxtotals = Format(Val(rtxtotal), nrodecimal)
    ttxtotald = Format(Val(rtxtotald), nrodecimal)
    stxtotals = Format(Val(rtxtotal), nrodecimal)
    stxtotald = Format(Val(rtxtotald), nrodecimal)
    Framefp.Visible = True
    Framefp.Enabled = True
    habilita_lab7 0
    'MsgBox ""
    'MsgBox dbgrid10.Enabled
    buf = "select * from fpago where fpago='2'"

    If mytablefpago.State = 1 Then mytablefpago.Close
    mytablefpago.Open buf, cn, adOpenDynamic, adLockOptimistic
    Set dbgrid10.DataSource = mytablefpago
    dbgrid10.refresh

    If mytablefpago.RecordCount > 0 Then
        mytablefpago.MoveFirst
        dbgrid10.Enabled = False
        dbgrid10.Visible = True
        dbgrid10.Enabled = True
        dbgrid10.SetFocus
        DBGrid10_KeyDown 13, 0
        dbgrid9.Enabled = True
        'Exit Sub
        dbgrid9.SetFocus
        DBGrid9_KeyDown 13, 0

        If Val(hknumero) > 0 Then
            RGPAGO = hknumero

        End If

        RGPAGO_KeyPress 13
        xtipo = "1"

        If Len(Trim(codigo)) = 11 Then
            If valida_numero_ruc(Trim(codigo)) = True Then
                xtipo = "2"
                xruc = codigo

            End If

        End If
      
        xtipo_keyPress 13

        'RGPAGO.SetFocus
        'xtipo = "7"
        'Else
        'MsgBox "No existe exonerado ", 48, "Aviso"
    End If

    'mytablex.Close
End Sub

Sub replicacion_remoto()

    'Dim SqlComando As SqlCommand
    'Dim Conexion As SqlConnection
    'Conexion = New SqlConnection("Data Source=" & servidor & ";Initial Catalog=" & BaseDatos & ";User ID=" & usuario & ";Password=" & password & ";")
    'Conexion.Open()
    'SqlComando = Conexion.CreateCommand
    'SqlComando.CommandText = "Insert into [SERVICIOS].dbo.Pedidos select * from [BASED].dbo.Pedidos ."
    'SqlComando.ExecuteNonQuery()
    'SqlComando.Dispose()
End Sub

''Function acura_lectura() As String
''Dim d As Integer
''Dim i As Integer
''Dim buf As String
''acura_lectura = acurabuffer
''Exit Function
''Select Case "" & mytable11.Fields("portbala")
''           Case "COM1"
''           d = 1
''           Case "COM2"
''           d = 2
''           Case "COM3"
''           d = 3
''           Case "COM4"
''           d = 4
''           Case "COM5"
''           d = 5
''End Select
''buf = ""
''MSComm1.CommPort = d
''MSComm1.Settings = "9600,n,8,1"
''MSComm1.InputLen = 10
''MSComm1.PortOpen = True
''
''Do
''DoEvents
''buf = buf & MSComm1.Input
''Loop Until Len(buf) >= 17
''If Trim(Mid$(buf, 1, 8)) = "ST,GS,+" Then
''   'MsgBox Trim(Mid$(buf, 9, 9))
''   acura_lectura = Trim(Mid$(buf, 9, 9))
''End If
'''MsgBox Mid$(buf, 1, 8)
''MSComm1.PortOpen = False
'''acura_lectura = Mid$(buf, Len(buf) - 7, 6)
''End Function
Sub lectura_grafico(buf As String, i As Integer)

    ''On Error GoTo cmd909090_err
    ''Dim mytablex As New ADODB.Recordset
    ''Dim fotonombre As String
    ''zproductos(i).Picture = LoadPicture()
    ''mytablex.Open "select * from producto where producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic
    ''If mytablex.RecordCount > 0 Then
    ''   fotonombre = globalpath & "\001d\06\grafico\tmp.jpg"
    ''   viewBMP mytablex, fotonombre
    ''   If Len(Trim(fotonombre)) > 0 Then
    ''      If existe_archivo(fotonombre) > 0 Then
    ''         'fotoimagen = LoadPicture(fotonombre)
    ''         redimensionar_grafico fotonombre
    ''         zproductos(i).Picture = LoadPicture(fotonombre)
    ''      End If
    ''   End If
    ''End If
    ''mytablex.Close
    ''Exit Sub
    ''cmd909090_err:
    ''MsgBox "Aviso en lectura grafico " + error$, 48, "Aviso"
    ''Exit Sub
End Sub

Sub redimensionar_grafico(fotonombre As String)

    '''' 17/07/2018 Factura de Exportación
    'On Error GoTo cmd90111_err
    'Picture1.AutoRedraw = True
    'Picture1.PaintPicture LoadPicture(fotonombre), 0, 0, _
    'Picture1.ScaleWidth, Picture1.ScaleHeight, , , , , vbSrcCopy
    'SavePicture Picture1.Image, fotonombre
    'Exit Sub
    'cmd90111_err:
    'Exit Sub
    '''' 17/07/2018 Factura de Exportación
End Sub

Sub carga_clase_sunat()

    Dim mytablex As New ADODB.Recordset

    clasesunat.Clear
    clasesunat.AddItem ""
    mytablex.Open "SELECT * FROM clasesunat ", cn, adOpenDynamic, adLockOptimistic
    Do

        If mytablex.EOF Then Exit Do
        clasesunat.AddItem Trim("" & mytablex.Fields("clasesunat")) & "|" & Trim("" & mytablex.Fields("descripcio"))
        mytablex.MoveNext
    Loop
    mytablex.Close
    clasesunat.ListIndex = 0

End Sub

Sub carga_serviciomesa()
    'Dim mytablex As New ADODB.Recordset
    'serviciomesa.Clear
    ' serviciomesa.AddItem ""
    ' mytablex.Open "SELECT * FROM serviciomesa ", cn, adOpenDynamic, adLockOptimistic
    ' Do
    ' If mytablex.EOF Then Exit Do
    'serviciomesa.AddItem Trim("" & mytablex.Fields("porcentaje"))
    ' mytablex.MoveNext
    ' Loop
    ' mytablex.Close
    ' serviciomesa.ListIndex = 0
 
End Sub

Function verifica_servicio(buf As String) As Double

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM producto where producto='" & buf & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        verifica_servicio = Val("" & mytablex.Fields("serviciomesa"))

    End If

    mytablex.Close

End Function

Function redondeo3(buf3 As String, nnrodecimal As String)

    Dim buf0 As String

    Dim buf1 As String

    Dim buf2 As String

    Dim sdx  As Double

    Dim buf  As String

    Dim c    As Double

    Dim D    As Double

    buf = buf3
    c = Val(buf3)
    D = Round(c, 3)
    redondeo3 = "" & D
    Exit Function

End Function

Function Redondear(Numero As String, knrod As Integer) As String

    Dim parteentera  As String

    Dim partedecimal As String

    parteentera = Int(Numero)

    If Not (Len(Numero) - Len(parteentera)) = 0 Then
        partedecimal = Right(Numero, Len(Numero) - Len(parteentera) - 1)
    Else
        partedecimal = "00"

    End If

    Dim num As Double

    If Len(partedecimal) >= 3 Then
        partedecimal = Left(partedecimal, 3)

        If Mid(partedecimal, 3, 1) >= "5" Then
            partedecimal = Left(partedecimal, 2)
            num = Val(partedecimal)
            num = num + 1

            If Len(CStr(num)) = 3 Then parteentera = parteentera + 1
            partedecimal = Right(CStr(num), 2)

        End If

    Else
        partedecimal = Left(partedecimal, 2) '<-- El problema estaba aquí. Si el tercer decimal no
        ' empezaba por un numero mayor de 5, saltaba y retornaba
        ' el mismo valor de entrada.

    End If

    Redondear = parteentera & "," & partedecimal

End Function

Sub orden_trabajos()

    Dim found As Integer

    If Frame2.Visible = True Then Exit Sub
    local1 = ""
    'local1.Visible = False
    found = sumar_detalle()

    If found = 0 Then
        MsgBox "debe de Existir un Precio=0", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    If Val(txtotal) = 0 Then
        If exisdev <> -10 Then  'si existe devolucion
            If Val(ntcant) = 0 Then
                DBGrid2.SetFocus
                Exit Sub

            End If
      
        End If

    End If

    Frame7.Visible = True
    habilita_lab7 1
    Framefp.Enabled = False
    xtipo = "" & mytable11.Fields("tipope")
          
    'xtipo.SetFocus
    xtipo_keyPress 13
           
    Exit Sub

End Sub

Sub carga_vendedorpp()

    'MsgBox "abc"
    If dbvarios.State = 1 Then dbvarios.Close
    dbvarios.Open "select Nombre,Codigo from vendedor   where local='" & "" & mytable11.Fields("local") & "' order by nombre ", cn, adOpenStatic, adLockOptimistic

    If dbvarios.RecordCount = 0 Then
        dbvarios.Close
        Exit Sub

    End If

    Set table6.DataSource = dbvarios
    Frame8.Caption = "VENDEDOR"
    Frame8.Visible = True
    table6.SetFocus
   
End Sub

Sub abono_orden()

    Dim buf   As String

    Dim sdx   As Double

    Dim found As Integer

    buf = "ABONOSSSS " & axclocal & " " & axctipo & " " & axcserie & " " & axcnumero
    sdx = (Val("" & rcconsulta.Fields("total")) - Val("" & rcconsulta.Fields("acuenta")))
    DBGrid2.refresh
    DBGrid2.columns("zona") = ""
    DBGrid2.columns("nroprecio") = "1"
    DBGrid2.columns(52) = Format(Now, "hh:mm:ss")
    DBGrid2.columns(56) = ""
    DBGrid2.columns(0) = "XXX" '& mytablex.Fields("producto")
    DBGrid2.columns(38) = "" '& mytablex.Fields("proveedor1")
    DBGrid2.columns(44) = ""
    DBGrid2.columns(14) = ""
    DBGrid2.columns(15) = ""
    DBGrid2.columns(16) = ""  '& mytablex.Fields("vendedor")
    DBGrid2.columns(1) = buf
    'MsgBox xxca
    DBGrid2.columns("cantidad") = 1 'Val(Format(Val(xxca), "0.000"))
    'DBGrid2.Columns("descuento") = Val("" & mytablex.Fields("isc"))

    DBGrid2.columns(2) = "UND" '& mytabley.Fields("unidad1")  'ojo se cambio por placa
    DBGrid2.columns(4) = 1 'Val("" & mytabley.Fields("factor1"))
    DBGrid2.columns("precio") = sdx
    DBGrid2.columns("total") = sdx
    DBGrid2.columns("subtotal") = sdx

    'DBGrid2.Columns("neto") = Val("" & mytablex.Fields("tax"))
    'DBGrid2.Columns(2) = "" & mytabley.Fields("unidad1")

    'dbgrid2.columns("COMISION") = Val("" & mytabley.Fields("comision"))
    DBGrid2.columns(4) = 1
    DBGrid2.columns("precio") = sdx
    DBGrid2.columns("total") = sdx
    DBGrid2.columns("subtotal") = sdx

    'DBGrid2.Columns("deslipo") = 0
    DBGrid2.columns("deslipo") = 0
    DBGrid2.columns(9) = 0
    DBGrid2.columns("isc") = 0 'Val("" & mytablex.Fields("isc"))
    DBGrid2.columns("impuesto") = 0
    DBGrid2.columns("igv") = 18 'Val("" & mytablex.Fields("igv"))
    DBGrid2.columns(17) = "" '& mytablex.Fields("linea")
    DBGrid2.columns("serviciopo") = 0 'Val("" & mytablex.Fields("serviciomesa"))

    DBGrid2.columns("descuento") = 0
    DBGrid2.columns("neto") = sdx

    'If "" & mytablex.Fields("recetaprn") <> "S" Then
    '   dbgrid2.columns("dua") = "R"
    'End If

    'If xsw = 1 Then   'si es el precio que eligio grifos ojos..

    'sdx = 0
    'DBGrid2.columns("l1") = Trim("" & mytablex.Fields("percepcion"))

    'carga_minimo "" & mytablex.Fields("producto")
    'End If
    'mytables.Open "SELECT * FROM DUENO where  local='" & "" & mytable11.Fields("local") & "' and producto='" & "" & mytablex.Fields("producto") & "' ", cn, adOpenKeyset, adLockOptimistic
    'If mytables.RecordCount > 0 Then  'si existe
    '   DBGrid2.columns(48) = Trim("" & mytables.Fields("codigo"))  'ojo si no es por local
    'End If
    'mytables.Close

    '---------pone a quien pertenece --------------------
    'DBGrid2.Columns(34) = "" & mytablex.Fields("c11")
    'DBGrid2.Columns(35) = "" & mytablex.Fields("c12")
    'DBGrid2.Columns(36) = "" & mytablex.Fields("c13")
    'DBGrid2.Columns(37) = "" & mytablex.Fields("c14")
    '-----------------------------
    'le pone las familias+subfamil+seccion+marca
    DBGrid2.columns(45) = "ABONO" '& mytablex.Fields("Familia")
    DBGrid2.columns(46) = "" '& mytablex.Fields("subFamilia")
    DBGrid2.columns(47) = "" '& mytablex.Fields("marca")
    DBGrid2.columns("total") = sdx ' Val(DBGrid2.columns("cantidad")) * Val(DBGrid2.columns("precio"))
    DBGrid2.columns("ivap") = 0 'Val("" & mytablex.Fields("ivap"))
    'DBGrid2.Col = 5
    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus

End Sub

Sub abono_reserva()

    Dim buf   As String

    Dim sdx   As Double

    Dim found As Integer

    buf = "ABONO RESERVA Nro." & " " & axcnumero
    sdx = Val("" & rcconsulta.Fields("saldo"))
    DBGrid2.refresh
    DBGrid2.columns("zona") = ""
    DBGrid2.columns("nroprecio") = "1"
    DBGrid2.columns(52) = Format(Now, "hh:mm:ss")
    DBGrid2.columns(56) = ""
    DBGrid2.columns(0) = "XXX" '& mytablex.Fields("producto")
    DBGrid2.columns(38) = "" '& mytablex.Fields("proveedor1")
    DBGrid2.columns(44) = ""
    DBGrid2.columns(14) = ""
    DBGrid2.columns(15) = ""
    DBGrid2.columns(16) = ""  '& mytablex.Fields("vendedor")
    DBGrid2.columns(1) = buf
    'MsgBox xxca
    DBGrid2.columns("cantidad") = 1 'Val(Format(Val(xxca), "0.000"))
    'DBGrid2.Columns("descuento") = Val("" & mytablex.Fields("isc"))

    DBGrid2.columns(2) = "UND" '& mytabley.Fields("unidad1")  'ojo se cambio por placa
    DBGrid2.columns(4) = 1 'Val("" & mytabley.Fields("factor1"))
    DBGrid2.columns("precio") = sdx
    DBGrid2.columns("total") = sdx
    DBGrid2.columns("subtotal") = sdx

    'DBGrid2.Columns("neto") = Val("" & mytablex.Fields("tax"))
    'DBGrid2.Columns(2) = "" & mytabley.Fields("unidad1")

    'dbgrid2.columns("COMISION") = Val("" & mytabley.Fields("comision"))
    DBGrid2.columns(4) = 1
    DBGrid2.columns("precio") = sdx
    DBGrid2.columns("total") = sdx
    DBGrid2.columns("subtotal") = sdx

    'DBGrid2.Columns("deslipo") = 0
    DBGrid2.columns("deslipo") = 0
    DBGrid2.columns(9) = 0
    DBGrid2.columns("isc") = 0 'Val("" & mytablex.Fields("isc"))
    DBGrid2.columns("impuesto") = 0
    DBGrid2.columns("igv") = 18 'Val("" & mytablex.Fields("igv"))
    DBGrid2.columns(17) = "" '& mytablex.Fields("linea")
    DBGrid2.columns("serviciopo") = 0 'Val("" & mytablex.Fields("serviciomesa"))

    DBGrid2.columns("descuento") = 0
    DBGrid2.columns("neto") = sdx

    'If "" & mytablex.Fields("recetaprn") <> "S" Then
    '   dbgrid2.columns("dua") = "R"
    'End If

    'If xsw = 1 Then   'si es el precio que eligio grifos ojos..

    'sdx = 0
    'DBGrid2.columns("l1") = Trim("" & mytablex.Fields("percepcion"))

    'carga_minimo "" & mytablex.Fields("producto")
    'End If
    'mytables.Open "SELECT * FROM DUENO where  local='" & "" & mytable11.Fields("local") & "' and producto='" & "" & mytablex.Fields("producto") & "' ", cn, adOpenKeyset, adLockOptimistic
    'If mytables.RecordCount > 0 Then  'si existe
    '   DBGrid2.columns(48) = Trim("" & mytables.Fields("codigo"))  'ojo si no es por local
    'End If
    'mytables.Close

    '---------pone a quien pertenece --------------------
    'DBGrid2.Columns(34) = "" & mytablex.Fields("c11")
    'DBGrid2.Columns(35) = "" & mytablex.Fields("c12")
    'DBGrid2.Columns(36) = "" & mytablex.Fields("c13")
    'DBGrid2.Columns(37) = "" & mytablex.Fields("c14")
    '-----------------------------
    'le pone las familias+subfamil+seccion+marca
    DBGrid2.columns(45) = "ABONO" '& mytablex.Fields("Familia")
    DBGrid2.columns(46) = "" '& mytablex.Fields("subFamilia")
    DBGrid2.columns(47) = "" '& mytablex.Fields("marca")
    DBGrid2.columns("total") = sdx ' Val(DBGrid2.columns("cantidad")) * Val(DBGrid2.columns("precio"))
    DBGrid2.columns("ivap") = 0 'Val("" & mytablex.Fields("ivap"))
    'DBGrid2.Col = 5
    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus

End Sub

Sub abono_checkin()

    Dim buf   As String

    Dim sdx   As Double

    Dim found As Integer

    buf = "ABONO CHECKIN Nro." & " " & axcnumero
    sdx = Val("" & rcconsulta.Fields("saldo"))
    DBGrid2.refresh
    DBGrid2.columns("zona") = ""
    DBGrid2.columns("nroprecio") = "1"
    DBGrid2.columns(52) = Format(Now, "hh:mm:ss")
    DBGrid2.columns(56) = ""
    DBGrid2.columns(0) = "XXX" '& mytablex.Fields("producto")
    DBGrid2.columns(38) = "" '& mytablex.Fields("proveedor1")
    DBGrid2.columns(44) = ""
    DBGrid2.columns(14) = ""
    DBGrid2.columns(15) = ""
    DBGrid2.columns(16) = ""  '& mytablex.Fields("vendedor")
    DBGrid2.columns(1) = buf
    'MsgBox xxca
    DBGrid2.columns("cantidad") = 1 'Val(Format(Val(xxca), "0.000"))
    'DBGrid2.Columns("descuento") = Val("" & mytablex.Fields("isc"))

    DBGrid2.columns(2) = "UND" '& mytabley.Fields("unidad1")  'ojo se cambio por placa
    DBGrid2.columns(4) = 1 'Val("" & mytabley.Fields("factor1"))
    DBGrid2.columns("precio") = sdx
    DBGrid2.columns("total") = sdx
    DBGrid2.columns("subtotal") = sdx

    'DBGrid2.Columns("neto") = Val("" & mytablex.Fields("tax"))
    'DBGrid2.Columns(2) = "" & mytabley.Fields("unidad1")

    'dbgrid2.columns("COMISION") = Val("" & mytabley.Fields("comision"))
    DBGrid2.columns(4) = 1
    DBGrid2.columns("precio") = sdx
    DBGrid2.columns("total") = sdx
    DBGrid2.columns("subtotal") = sdx

    'DBGrid2.Columns("deslipo") = 0
    DBGrid2.columns("deslipo") = 0
    DBGrid2.columns(9) = 0
    DBGrid2.columns("isc") = 0 'Val("" & mytablex.Fields("isc"))
    DBGrid2.columns("impuesto") = 0
    DBGrid2.columns("igv") = 18 'Val("" & mytablex.Fields("igv"))
    DBGrid2.columns(17) = "" '& mytablex.Fields("linea")
    DBGrid2.columns("serviciopo") = 0 'Val("" & mytablex.Fields("serviciomesa"))

    DBGrid2.columns("descuento") = 0
    DBGrid2.columns("neto") = sdx

    'If "" & mytablex.Fields("recetaprn") <> "S" Then
    '   dbgrid2.columns("dua") = "R"
    'End If

    'If xsw = 1 Then   'si es el precio que eligio grifos ojos..

    'sdx = 0
    'DBGrid2.columns("l1") = Trim("" & mytablex.Fields("percepcion"))

    'carga_minimo "" & mytablex.Fields("producto")
    'End If
    'mytables.Open "SELECT * FROM DUENO where  local='" & "" & mytable11.Fields("local") & "' and producto='" & "" & mytablex.Fields("producto") & "' ", cn, adOpenKeyset, adLockOptimistic
    'If mytables.RecordCount > 0 Then  'si existe
    '   DBGrid2.columns(48) = Trim("" & mytables.Fields("codigo"))  'ojo si no es por local
    'End If
    'mytables.Close

    '---------pone a quien pertenece --------------------
    'DBGrid2.Columns(34) = "" & mytablex.Fields("c11")
    'DBGrid2.Columns(35) = "" & mytablex.Fields("c12")
    'DBGrid2.Columns(36) = "" & mytablex.Fields("c13")
    'DBGrid2.Columns(37) = "" & mytablex.Fields("c14")
    '-----------------------------
    'le pone las familias+subfamil+seccion+marca
    DBGrid2.columns(45) = "ABONO" '& mytablex.Fields("Familia")
    DBGrid2.columns(46) = "" '& mytablex.Fields("subFamilia")
    DBGrid2.columns(47) = "" '& mytablex.Fields("marca")
    DBGrid2.columns("total") = sdx ' Val(DBGrid2.columns("cantidad")) * Val(DBGrid2.columns("precio"))
    DBGrid2.columns("ivap") = 0 'Val("" & mytablex.Fields("ivap"))
    'DBGrid2.Col = 5
    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus

End Sub

Function valida_orden(buf As String)

    Dim mytablex As New ADODB.Recordset

    mytablex.Open "select * from fpagov   where orden='" & buf & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        valida_orden = 1

    End If

    mytablex.Close

End Function

''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas
Sub menu_abonocredito()

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    '-------------------------------------

    cgusuario = gocabeza
    dgusuariog = godetalle
    found = sumar_detalle()

    If Val(txtotal) > 0 Then
        MsgBox "No deben existir pedidos Pendientes", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    menu_carga_pedidos_credito
    Exit Sub

End Sub

''' 25/08/2017 kenyo. Cobro Credito desde ventana de ventas

Sub menu_abonoot()

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    '-------------------------------------

    cgusuario = gocabeza
    dgusuariog = godetalle
    found = sumar_detalle()

    If Val(txtotal) > 0 Then
        MsgBox "No deben existir pedidos Pendientes", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    menu_carga_pedidos_abono
    Exit Sub

End Sub

Sub menu_cargaot()

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    '-------------------------------------
    cgusuario = gocabeza
    dgusuariog = godetalle
    found = sumar_detalle()

    If Val(txtotal) > 0 Then
        MsgBox "No deben existir pedidos Pendientes", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    menu_carga_pedidos_ot
    Exit Sub

End Sub

Sub menu_carga_pedidos_ot()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "15000B"
    sw_consulta = 0
    found = sql_consulta(1)

End Sub

Sub administra_orden(sw As Integer, buf As String)

    Dim i        As Integer

    Dim found    As Integer

    Dim mytablex As New ADODB.Recordset

    Dim mytabley As New ADODB.Recordset

    Dim mytablez As New ADODB.Recordset

    'MsgBox buf
    If buf <> "15000B" Then Exit Sub  'si no es orden trabajo
    If sw = 1 Then  'si es anulacion
        mytablez.Open "SELECT * FROM factura where  local='" & Trim("" & rcconsulta.Fields("local")) & "' and tipo1='" & Trim("" & rcconsulta.Fields("tipo")) & "' and serie1='" & Trim("" & rcconsulta.Fields("serie")) & "' and numero1='" & Trim("" & rcconsulta.Fields("numero")) & "'", cn, adOpenStatic, adLockOptimistic  'adOpenDynamic

        If mytablez.RecordCount > 0 Then
            mytablex.Open "SELECT * FROM detalle where  local='" & Trim("" & mytablez.Fields("local")) & "' and tipo='" & Trim("" & mytablez.Fields("tipo")) & " and serie='" & Trim("" & mytablez.Fields("serie")) & "' and numero='" & Trim("" & mytablez.Fields("numero")) & "'", cn, adOpenStatic, adLockOptimistic  'adOpenDynamic

            If mytablex.RecordCount > 0 Then 'si existe
                found = descarga_saldo1(Trim("" & mytablez.Fields("local")), mytablex, Trim("" & mytablez.Fields("tipo")), Trim("" & mytablez.Fields("serie")), Trim("" & mytablez.Fields("numero")), 1, 1)

            End If

            mytablex.Close
            cn.Execute ("delete from factura WHERE local='" & Trim("" & mytablez.Fields("local")) & "' and tipo='" & Trim("" & mytablez.Fields("tipo")) & "' and serie='" & Trim("" & mytablez.Fields("serie")) & "' and numero='" & Trim("" & mytablez.Fields("numero")) & "'")
            cn.Execute ("delete from detalle WHERE local='" & Trim("" & mytablez.Fields("local")) & "' and tipo='" & Trim("" & mytablez.Fields("tipo")) & "' and serie='" & Trim("" & mytablez.Fields("serie")) & "' and numero='" & Trim("" & mytablez.Fields("numero")) & "'")

        End If

        mytablez.Close
        Exit Sub

    End If

    'MsgBox "abc"
    mytablex.Open "SELECT * FROM factura where 2=1", cn, adOpenStatic, adLockOptimistic  'adOpenDynamic
    mytabley.Open "SELECT * FROM cpedidov where  local='" & Trim("" & rcconsulta.Fields("local")) & "' and tipo='" & Trim("" & rcconsulta.Fields("tipo")) & "' and serie='" & Trim("" & rcconsulta.Fields("serie")) & "' and numero='" & Trim("" & rcconsulta.Fields("numero")) & "'", cn, adOpenStatic, adLockOptimistic  'adOpenDynamic

    If mytabley.RecordCount > 0 Then 'si existe
        mytablex.AddNew

        For i = 0 To mytabley.Fields.count - 1
            mytablex.Fields(i) = mytabley.Fields(i)
        Next i

        mytablex.Fields("tipo") = "GV"
        mytablex.Fields("acu") = "T"
        mytablex.Fields("tipo1") = "" & mytabley.Fields("tipo")
        mytablex.Fields("serie1") = "" & mytabley.Fields("serie")
        mytablex.Fields("numero1") = "" & mytabley.Fields("numero")
        mytablex.Fields("acu1") = "" & mytabley.Fields("acu")
        mytablex.Update

    End If

    mytablex.Close
    mytabley.Close
    mytablex.Open "SELECT * FROM detalle where 2=1", cn, adOpenStatic, adLockOptimistic  'adOpenDynamic
    mytabley.Open "SELECT * FROM dpedidov where  local='" & Trim("" & rcconsulta.Fields("local")) & "' and tipo='" & Trim("" & rcconsulta.Fields("tipo")) & "' and serie='" & Trim("" & rcconsulta.Fields("serie")) & "' and numero='" & Trim("" & rcconsulta.Fields("numero")) & "'", cn, adOpenStatic, adLockOptimistic  'adOpenDynamic

    'MsgBox mytabley.RecordCount
    If mytabley.RecordCount > 0 Then 'si existe
        Do

            If mytabley.EOF Then Exit Do
            mytablex.AddNew

            For i = 0 To mytabley.Fields.count - 1
                mytablex.Fields(i) = mytabley.Fields(i)
            Next i

            mytablex.Fields("tipo") = "GV"
            mytablex.Fields("acu") = "T"
            'mytablex.Fields("tipo1") = "" & mytabley.Fields("tipo")
            'mytablex.Fields("serie1") = "" & mytabley.Fields("serie")
            'mytablex.Fields("numero1") = "" & mytabley.Fields("numero")
            mytablex.Fields("acu1") = "" & mytabley.Fields("acu")
            mytablex.Update
            found = descarga_saldo1(Trim("" & mytablex.Fields("local")), mytablex, Trim("" & mytablex.Fields("tipo")), Trim("" & mytablex.Fields("serie")), Trim("" & mytablex.Fields("numero")), -1, 0)
            mytabley.MoveNext
        Loop

    End If

    mytabley.Close
    mytablex.Close
    'mytablex.Open "SELECT * FROM detalle where  local='" & Trim("" & rcconsulta.Fields("local")) & "' and tipo='T' and serie='" & Trim("" & rcconsulta.Fields("serie")) & "' and numero='" & Trim("" & rcconsulta.Fields("numero")) & "'", cn, adOpenStatic, adLockOptimistic  'adOpenDynamic
    'If mytablex.RecordCount > 0 Then 'si existe
    '   found = descarga_saldo(Trim("" & rcconsulta.Fields("local")), mytablex, Trim("" & rcconsulta.Fields("tipo")), Trim("" & rcconsulta.Fields("serie")), Trim("" & rcconsulta.Fields("numero")), 1, 1)
    'End If
    'mytablex.Close
    imprime_guia_pedido

End Sub

Function proceso_15000()

    On Error GoTo cmd_er15000

    Select Case opcion1

        Case "15", "15000", "15000A", "15000B"

            'si es copia se puede grabar como ok devolvio delivery
            If Trim("" & rcconsulta.Fields("ok")) = "PENDIENTE" Then
                rcconsulta.Fields("OK") = "ENTREGADO"
                rcconsulta.Update
                administra_orden 0, "" & opcion1
                proceso_15000 = 1
        
                Exit Function

            End If

            If Trim("" & rcconsulta.Fields("ok")) = "ENTREGADO" Then
                rcconsulta.Fields("OK") = "PENDIENTE"
                rcconsulta.Update
                administra_orden 1, "" & opcion1
                proceso_15000 = 1
                Exit Function

            End If

            'If Len(Trim("" & rcconsulta.Fields("ok"))) = "" Then
            rcconsulta.Fields("OK") = "ENTREGADO"
            rcconsulta.Update
            administra_orden 0, "" & opcion1
            proceso_15000 = 1
         
            Exit Function
            'End If
      
            'If Trim("" & rcconsulta.Fields("ok")) = "OK" Then
            '   rcconsulta.Fields("OK") = ""
            '   rcconsulta.Update
            '   administra_orden 1
            '   Exit Sub
            'End If
            'If Trim("" & rcconsulta.Fields("OK")) <> "OK" Then
            '   rcconsulta.Fields("OK") = "OK"
            '   rcconsulta.Update
            '   administra_orden 0
            '
            '
            '   Exit Sub
            'End If
     
    End Select

    Exit Function
cmd_er15000:
    MsgBox "Seleccione un dato ", 48, "Aviso"

End Function

Function borrar_pedido_ot(bxlocal As String, _
                          bxtipo As String, _
                          bxserie As String, _
                          bxnumero As String)

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd7778_err

    mytablex.Open "SELECT * FROM factura where  local='" & bxlocal & "' and tipo1='" & bxtipo & "' and serie1='" & bxserie & "' and numero1='" & bxnumero & "'", cn, adOpenStatic, adLockOptimistic 'adOpenDynamic

    If mytablex.RecordCount > 0 Then
        If "" & mytablex.Fields("estado") = "2" Then
            MsgBox "Existe Documento de Venta No se puede borra Pedido ", 48, "Aviso"
            mytablex.Close
            Exit Function

        End If

    End If

    mytablex.Close

    If MsgBox("Desea Borrar Pedido", 1, "Aviso") <> 1 Then Exit Function
    cn.Execute ("delete from dpedidov where local='" & bxlocal & "' and tipo='" & bxtipo & "' and serie='" & bxserie & "' and numero='" & bxnumero & "'")
    cn.Execute ("delete from cpedidov where local='" & bxlocal & "' and tipo='" & bxtipo & "' and serie='" & bxserie & "' and numero='" & bxnumero & "'")
    'rcconsulta.Delete
    rcconsulta.Requery
    MsgBox "Pedido Borrado ", 48, "Aviso"
    borrar_pedido_ot = 1
    Exit Function
cmd7778_err:
    MsgBox "Aviso en borrar_pedido_ot " + error$, 48, "Aviso"
    Exit Function
 
End Function

Sub envio_correos()

    Dim txtserver     As String

    Dim txtusername   As String

    Dim txtpassword   As String

    Dim txtport       As String

    Dim txtto         As String

    Dim chkssl        As String

    Dim txtfromname   As String

    Dim txtfromemail  As String

    Dim txtattach     As String

    Dim txtsubject    As String

    Dim txtmsg        As String

    Dim retval        As String

    Dim txtselecciona As String

    Dim txthtml       As String

    Dim mytablex      As New ADODB.Recordset

    Dim buf           As String

    On Error GoTo cmd0905677_err

    buf = Trim("" & mytable11.Fields("correo"))

    If Trim(buf) = 0 Then Exit Sub
    mytablex.Open "select * from correos where cosms='" & buf & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        txtselecciona = Trim("" & mytablex.Fields("txtselecciona"))
        txtserver = Trim("" & mytablex.Fields("txtserver"))
        txthtml = Trim("" & mytablex.Fields("txthtml"))
        txtusername = Trim("" & mytablex.Fields("txtusername"))
        txtpassword = Trim("" & mytablex.Fields("txtpassword"))
        txtfromname = Trim("" & mytablex.Fields("txtfromname"))
        txtfromemail = Trim("" & mytablex.Fields("txtfromemail"))

        txtport = Trim("" & mytablex.Fields("txtport"))
        'txtto = Trim("" & mytablex.Fields("txtto"))
        chkssl = Trim("" & mytablex.Fields("chkssl"))
        'txtfromname = Trim("" & nombre) 'Trim("" & mytablex.Fields("txtfromname"))
        txtto = Trim("" & correo) 'Trim("" & mytablex.Fields("txtfromemail"))
        txtattach = Trim("" & mytablex.Fields("txtattach"))
        txtsubject = Trim("" & mytablex.Fields("txtsubject"))
        txtmsg = Trim("" & mytablex.Fields("txtmsg"))
        txtmsg = txtmsg & Chr$(10) & Chr$(13) & ""
        txtmsg = txtmsg & Format(Now, "dd/mm/yyyy") + " " + Format(Now, "hh:mm:ss")

        retval = SendMail(Trim$(txtto), Trim$(txtsubject), Trim$(txtfromname) & "<" & Trim$(txtfromemail) & ">", Trim$(txtmsg), Trim$(txtserver), CInt(Trim$(txtport)), Trim$(txtusername), Trim$(txtpassword), Trim$(txtattach), True, txtselecciona, txthtml)

        'MsgBox retval
    End If

    mytablex.Close
    Exit Sub
cmd0905677_err:
    MsgBox "No se Pudo enviar Correo... " + error$, 48, "Aviso"
    Exit Sub

End Sub

Sub imprime_guia_pedido()

    Dim found    As Integer

    Dim archivot As String

    Dim ottipo   As String

    Dim otserie  As String

    Dim olocal1  As String

    Dim otnumero As String

    On Error GoTo cmd6_err:

    olocal1 = "" & rcconsulta.Fields("local")
    ottipo = "GV" '& rcconsulta.Fields("tipo")
    otserie = "" & rcconsulta.Fields("serie")
    otnumero = "" & rcconsulta.Fields("numero")
    cerrar_archivo
    factura_formato olocal1, "" & ottipo, "" & otserie, "" & otnumero, "", 0
    cerrar_archivo
    'MsgBox gusuario
    genver.file = globaldir & "\temporal\" & gusuario & ".txt"
    genver.Show 1
    Exit Sub
cmd6_err:
    MsgBox "Mensaje, Error al iniciar Impresion " & error$
    Exit Sub

End Sub

Function dia_dela_semana() As String

    Dim buf As String

    'MsgBox Weekday(Now)
    Select Case Weekday(Now)

        Case 1: dia_dela_semana = "DOMINGO"

        Case 2: dia_dela_semana = "LUNES"

        Case 3: dia_dela_semana = "MARTES"

        Case 4: dia_dela_semana = "MIERCOLES"

        Case 5: dia_dela_semana = "JUEVES"

        Case 6: dia_dela_semana = "VIERNES"

        Case 7: dia_dela_semana = "SABADO"

        Case Else
            dia_dela_semana = ""
    
    End Select

    Exit Function

End Function

Sub carga_subfamilia(buf As String)

    Dim mytablex As New ADODB.Recordset

    Dim i        As Integer

    For i = 0 To 14999
        msfamcod(i) = ""
        wsfamcod(i) = ""
    Next i

    i = -1
    mytablex.Open "select * from subfamil where familia='" & buf & "' order by subfamilia ", cn, adOpenStatic, adLockOptimistic
    Do

        If mytablex.EOF Then Exit Do
        i = i + 1
        msfamcod(i) = "" & mytablex.Fields("descripcio")
        wsfamcod(i) = "" & mytablex.Fields("subfamilia")
        mytablex.MoveNext
    Loop
    msfamtop = i
    mytablex.Close
    msfampag = 0
    menu_subfamilia "INI"

End Sub

Sub menu_subfamilia(buf As String)

    Dim i As Integer

    Dim j As Integer

    Select Case buf

        Case "INI"
            msfampag = 0

        Case "SIG"
            msfampag = msfampag + 15

            If msfampag > 102 Then
                msfampag = 0

            End If

        Case "ANT"
            msfampag = msfampag - 15

            If msfampag < 0 Then
                msfampag = 0

            End If

    End Select

    j = -1

    For i = msfampag To 15 + msfampag
        j = j + 1
        zFamilias(j).Caption = msfamcod(i)
        wwsfamcod(j) = wsfamcod(i)
    Next i

End Sub

Sub menu_abonoReserva()

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    '-------------------------------------
    cgusuario = gocabeza
    dgusuariog = godetalle
    found = sumar_detalle()

    If Val(txtotal) > 0 Then
        MsgBox "No deben existir pedidos Pendientes", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    menu_carga_reserva_abono
    Exit Sub

End Sub

Sub menu_carga_reserva_abono()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "15000Z"
    sw_consulta = 0
    found = sql_consulta(1)

End Sub

Sub menu_abonoCheckin()

    Dim found As Integer

    If dbgrid6.Visible = True Then Exit Sub
    If Framefp.Visible = True Then Exit Sub
    If Frame7.Visible = True Then Exit Sub
    If Frame6.Visible = True Then Exit Sub
    If Frame1.Visible = True Then Exit Sub
    '-------------------------------------

    cgusuario = gocabeza
    dgusuariog = godetalle
    found = sumar_detalle()

    If Val(txtotal) > 0 Then
        MsgBox "No deben existir pedidos Pendientes", 48, "Aviso"
        DBGrid2.SetFocus
        Exit Sub

    End If

    menu_carga_checkin_abono
    Exit Sub

End Sub

Sub menu_carga_checkin_abono()

    Dim found As Integer

    Combo1.Clear
    Combo1.AddItem "Nombre"
    Combo1.ListIndex = 0
    Frame1.Visible = True
    Frame1.Enabled = True
    buffer = ""
    opcion1 = "15000Y"
    sw_consulta = 0
    found = sql_consulta(1)

End Sub

Sub menu_carga_habitacion()

    Dim found As Integer

    tcheckin.xsw = "TPV"
    tcheckin.Show 1
    found = sumar_detalle()
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus

End Sub

Sub busca_cod_producto1(buff As String, XCantidad As String, sw As Integer)

    Dim mytablex As New ADODB.Recordset

    Dim bufy     As String

    Dim found    As Integer

    Dim canti    As String

    Dim buf      As String

    Dim xcampo   As String

    Dim buf1     As String

    Dim xsw      As Integer

    Dim abuf     As String

    'Dim xcantidad As String

    'xcantidad = ""
    Data2.refresh
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    DBGrid2.SetFocus
    stkminimo = ""

    xsw = 0

    If Not Data2.Recordset.EOF Then
        Data2.Recordset.MoveLast
        DBGrid2.Col = 0
        DBGrid2.Row = DBGrid2.VisibleRows - 1
        DBGrid2.SetFocus

    End If

    'xcantidad = hknumero
    If sw = 1 Then
        XCantidad = "1"

    End If
   
    If "" & mytable11.Fields("nosaldo") = "S" Then
        '-------------------------
        found = verifica_saldo_receta(buff, Val(XCantidad))

        If found = 2 Then
            MsgBox "Se detecto un saldo receta con saldo<=0 ", 48, "Aviso"
            Exit Sub

        End If

        '-------------------------
        mytablex.Open "SELECT * FROM producto where producto='" & buff & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            If familia_saldo("" & mytablex.Fields("familia")) = 0 Then
                If consulta_saldo(buff, Val(XCantidad), 0) <= 0 Then
                    MsgBox "x.No existe saldo", 48, "Aviso"
                    Exit Sub

                End If

            End If

        End If

    End If
     
    stkminimo = ""

    If "" & mytable11.Fields("stkminimo") = "S" And Len(Trim(Label12)) = 0 Then

        'If "" & mytable11.Fields("stkminimo") = "S" Then
        'MsgBox buff
        If mytablex.State = 1 Then mytablex.Close
        mytablex.Open "SELECT * FROM producto where producto='" & buff & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            If familia_saldo("" & mytablex.Fields("familia")) = 0 Then
                consulta_minimo buff, "" & mytablex.Fields("minimo")

            End If

        End If

        mytablex.Close

    End If
     
    'MsgBox "abcd"
    canti = XCantidad
    buf = buff  'se modifico en U. Union
    bufy = buf
    found = 0
         
    control_flujo = 0
    '-------------------------------------------------
    '---------- verificamos si existe /----------
    'MsgBox canti
     
    found = InStr(canti, "/")

    If found > 1 Then  ' si es cantidad
        'MsgBox found
        xcampo = Mid$(canti, found + 1, Len(canti) - found)
        canti = Mid$(canti, 1, found - 1)

        If Val(canti) = 0 Then
            Exit Sub

        End If

        xsw = 1

    End If

    'AQUI SOLO SE DEBE EXTRAER LA CANTIDAD
     
    'MsgBox xcampo
    'SI EXISTE / ES PORQUE CANTIDAD ES TOTAL
    found = busca_producto(buff, 0, canti, xsw)

    'found = busca_producto(buf, 0, canti)
    'MsgBox found
    If found = 2 Then  'si es precio 0
        'MsgBox "XX-XX"
        control_flujo = 1
        Exit Sub

    End If
     
    'MsgBox "" & mytable11.Fields("obligavendedor")
     
    If ver_si_puedo_dbgrid("" & DBGrid2.columns(0)) = 1 Then  'existe mas de un precio
        'MsgBox "abc"
        xproducto = "" & DBGrid2.columns(0)
        carga_dbgrid4 "" & DBGrid2.columns(0)
        Exit Sub

    End If

    If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Len(Trim("" & DBGrid2.columns("linea"))) > 0 Then
        DBGrid2.Col = 3
        DBGrid2.SetFocus
        ingreso_tallas "" & DBGrid2.columns("linea")
        Exit Sub
               
    End If
            
    '' kenyo 02/11/2017 Configuración Productos Comentarios Obligatorios
    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT obligacomentario FROM producto where producto='" & DBGrid2.columns("producto") & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And ("" & mytablex.Fields("obligacomentario")) = "S" Then
            DBGrid2.Col = 1
            DBGrid2.SetFocus
            txobserv.Show 1

        End If

    End If

    mytablex.Close
    '' kenyo 02/11/2017 Configuración Productos Comentarios Obligatorios
            
    'MsgBox "abc"
    'MsgBox "" & DBGrid2.columns("producto")
    If Len(Trim("" & DBGrid2.columns("producto"))) > 0 And Trim("" & mytable11.Fields("obligavendedor")) = "S" Then
        DBGrid2.Col = 3
        DBGrid2.SetFocus
        carga_vendedorpp
        'ingreso_tallas "" & DBGrid2.columns("linea")
        Exit Sub

    End If

    'If Len(dbgrid2.columns(0)) > 0 And Len(dbgrid2.columns(17)) > 0 Then
    'dbgrid2.Col = 3
    'ingreso_tallas "" & dbgrid2.columns(17)
    'Exit Sub
    'End If
     
    found = existe_fuel("" & DBGrid2.columns(0))

    If found = 1 And Val("" & DBGrid2.columns("cantidad")) = 1 Then
        DBGrid2.Col = 7
        DBGrid2.SetFocus
        Exit Sub

    End If

    'MsgBox ""
    found = sumar_detalle()
    'Data2.Refresh
    'Data2.Recordset.MoveLast
    DBGrid2.Col = 0
    DBGrid2.Row = DBGrid2.VisibleRows - 1
    'Data2.Refresh
    hknumero = ""
    'MsgBox ""

End Sub

Function busca_productorapido(buf As String) As String

    Dim mytablex As New ADODB.Recordset

    mytablex.Open "SELECT * FROM producto where tecla='" & buf & "'", cn, adOpenStatic, adLockOptimistic

    If mytablex.RecordCount > 0 Then
        busca_productorapido = Trim("" & mytablex.Fields("producto"))

    End If

    mytablex.Close
   
End Function

Sub icerrar_puertosmscomm()

    Dim i As Integer

    For i = 1 To 10
        icerrando_mscomm i
    Next i

End Sub

Sub icerrando_mscomm(D As Integer)

    'On Error GoTo cmdini4_err
    'MSComm1.CommPort = d
    'If MSComm1.PortOpen = True Then
    'MSComm1.PortOpen = False
    'End If
    'Exit Sub
    'cmdini4_err:
    'Exit Sub
End Sub

Private Sub imprime_comandas()

    Dim found As Integer

    FileName = globaldir & "\temporal\" & gusuario & ".txt"
    borrar_archivo FileName
    cerrar_archivo
    found = borra_nombre("" & FileName)
    Open FileName For Append As #1
    '------------------------------------
    cabecera_documento1
    cuerpo_programa_documento1
    '------------------------------------
    Close #1
    cerrar_archivo
    genver.file = globaldir & "\temporal\" & gusuario & ".txt"
    genver.Show 1

End Sub

Sub cabecera_documento1()

    Dim buf   As String

    Dim found As Integer

    buf = "Comandas Pendientes"
    buf = Format(Now, "dd/mm/yyyy") & " " & Format(Now, "HH:MM:SS")
    found = formateaa(buf, 30, 2, 0)
    
    buf = "Descripcio"
    found = formateaa(buf, 15, 0, 0)
    found = formateaa("", 1, 0, 0)
    buf = "Und"
    found = formateaa(buf, 4, 0, 0)
    found = formateaa("", 1, 0, 0)
    buf = "fact"
    found = formateaa(buf, 4, 0, 1)
    found = formateaa("", 1, 0, 0)
    buf = "Cant"
    found = formateaa(buf, 6, 0, 1)
    found = formateaa("", 1, 0, 0)
    buf = "Total"
    found = formateaa(buf, 8, 0, 1)
    found = formateaa("", 1, 2, 0)

End Sub

Sub cuerpo_programa_documento1()

    Dim buf      As String

    Dim found    As Integer

    Dim sdx      As Double

    Dim mytablex As New ADODB.Recordset

    On Error GoTo cmd78812_err

    sdx = 0
    mytablex.Open "SELECT * FROM dcomanda order by vendedor", cn, adOpenStatic, adLockOptimistic
    Do

        If mytablex.EOF Then Exit Do
        buf = "" & mytablex.Fields("Descripcio")
        found = formateaa(buf, 15, 0, 0)
        found = formateaa("", 1, 0, 0)
        buf = "" & mytablex.Fields("Unidad")
        found = formateaa(buf, 4, 0, 0)
        found = formateaa("", 1, 0, 0)
        buf = "" & mytablex.Fields("factor")
        found = formateaa(buf, 4, 0, 1)
        found = formateaa("", 1, 0, 0)
        buf = "" & mytablex.Fields("cantidad")
        found = formateaa(buf, 6, 0, 1)
        found = formateaa("", 1, 0, 0)
        buf = "" & mytablex.Fields("Total")
        found = formateaa(buf, 8, 0, 1)
        found = formateaa("", 1, 2, 0)
        sdx = sdx + Val("" & mytablex.Fields("Total"))
        mytablex.MoveNext
    Loop
    mytablex.Close
    buf = "Total--->" & Format(sdx, "0.00")
    found = formateaa(buf, 30, 2, 1)
    Exit Sub
cmd78812_err:
    Exit Sub

End Sub

Sub sql_controlpeso(buf As String)

    '''Dim sdx1 As Double
    '''Dim sdx2 As Double
    '''Dim sdx3 As Double
    '''Dim sdx4 As Double
    '''Dim sdx5 As Double
    '''Dim sdx6 As Double
    '''sdx1 = 0
    '''sdx2 = 0
    '''sdx3 = 0
    '''sdx4 = 0
    '''sdx5 = 0
    '''sdx6 = 0
    ''''If mytablepeso.State = 1 Then
    ''''   mytablepeso.Close
    ''''End If
    '''Set mytablepeso = Nothing
    '''mytablepeso.Open "SELECT * FROM controlpeso where producto='" & buf & "'", cn, adOpenKeyset, adLockOptimistic
    '''Set dbgrid13.DataSource = mytablepeso
    '''Do
    '''If mytablepeso.EOF Then Exit Do
    '''sdx1 = sdx1 + Val("" & mytablepeso.Fields("nrojabas"))
    '''sdx2 = sdx2 + Val("" & mytablepeso.Fields("cantprod"))
    '''sdx3 = sdx3 + Val("" & mytablepeso.Fields("pesobruto"))
    '''sdx4 = sdx4 + Val("" & mytablepeso.Fields("tara"))
    '''sdx5 = sdx5 + Val("" & mytablepeso.Fields("pesoneto"))
    '''sdx6 = sdx6 + Val("" & mytablepeso.Fields("total"))
    '''mytablepeso.MoveNext
    '''Loop
    '''xpesoneto = Format(sdx5, "0.00")
    '''xpesocobrar = Format(sdx6, "0.00")
    '''
    ''''nsdx1 = Format(sdx1, "0.00")
    ''''nsdx2 = Format(sdx2, "0.00")
    ''''nsdx3 = Format(sdx3, "0.00")
    ''''nsdx4 = Format(sdx4, "0.00")
    ''''nsdx5 = Format(sdx5, "0.00")
    ''''nsdx6 = Format(sdx6, "0.00")
    ''''Frame6.Visible = True
    '''Frame11.Visible = True
    ''''sql_controlpeso
    '''dbgrid13.refresh
    '''dbgrid13.SetFocus
End Sub

Sub borra_controlpeso()
    cn.Execute ("delete from controlpeso ")

End Sub

Sub borra_controlpesop(buf As String)
    cn.Execute ("delete from controlpeso where producto='" & buf & "'")

End Sub

Sub suma_controlespeso()
    '''Dim mytablex As New ADODB.Recordset
    '''Dim sdx1 As Double
    '''Dim sdx2 As Double
    '''Dim sdx3 As Double
    '''Dim sdx4 As Double
    '''Dim sdx5 As Double
    '''Dim sdx6 As Double
    '''sdx1 = 0
    '''sdx2 = 0
    '''sdx3 = 0
    '''sdx4 = 0
    '''sdx5 = 0
    '''sdx6 = 0
    ''''If mytablepeso.State = 1 Then
    ''''   mytablepeso.Close
    ''''End If
    '''mytablex.Open "SELECT * FROM controlpeso ", cn, adOpenKeyset, adLockOptimistic
    '''Do
    '''If mytablex.EOF Then Exit Do
    ''''sdx1 = sdx1 + Val("" & mytablepeso.Fields("nrojabas"))
    ''''sdx2 = sdx2 + Val("" & mytablepeso.Fields("cantprod"))
    ''''sdx3 = sdx3 + Val("" & mytablepeso.Fields("pesobruto"))
    ''''sdx4 = sdx4 + Val("" & mytablepeso.Fields("tara"))
    '''sdx5 = sdx5 + Val("" & mytablex.Fields("pesoneto"))
    '''sdx6 = sdx6 + Val("" & mytablex.Fields("total"))
    '''mytablex.MoveNext
    '''Loop
    '''xpesoneto = Format(sdx5, "0.00")
    '''xpesocobrar = Format(sdx6, "0.00")
    '''
    ''''nsdx1 = Format(sdx1, "0.00")
    ''''nsdx2 = Format(sdx2, "0.00")
    ''''nsdx3 = Format(sdx3, "0.00")
    ''''nsdx4 = Format(sdx4, "0.00")
    ''''nsdx5 = Format(sdx5, "0.00")
    ''''nsdx6 = Format(sdx6, "0.00")
    ''''Frame6.Visible = True
    ''''Frame11.Visible = True
    '''

End Sub

Sub descarga_grafico()

    'If Not La_Imagen Is Nothing Then
    '   Set La_Imagen = Nothing
    'End If
End Sub

Sub ordencomanda17022015()

    Dim found           As Integer

    Dim archivo_formato As String

    Dim archivo_orden   As String

    Dim mytablex        As New ADODB.Recordset

    Dim mytabley        As New ADODB.Recordset

    Dim Tmp             As String

    Dim sw              As Integer

    Dim xprinter        As String

    sw = 0
    Tmp = ""
    'borrar_todo
    'sql_detalle9
    archivo_formato = globaldir & "\formatos\despacho"
    archivo_orden = globaldir & "\temporal\" & gusuario & ".txt"
    borrar_archivo archivo_orden
    mytabley.Open "SELECT * FROM dcomanda where salon='" & "" & salon.Caption & "' and mesa='" & mesa.Caption & "' and numero='" & comanda.Caption & "'", cn, adOpenKeyset, adLockOptimistic
    xprinter = ""
    'MsgBox salon.Caption
    Do

        If mytabley.EOF Then Exit Do
        If sw = 0 Then
            found = proceso_formatoso(mytabley, archivo_formato, archivo_orden, "{", "}")
            Tmp = "" & mytabley.Fields("familia")
            xprinter = busca_printer_familia(mytabley)
            sw = 1

        End If

        If Tmp <> "" & mytabley.Fields("familia") Then
            found = imprime_archivo_ordenc(mytabley, xprinter)
            xprinter = busca_printer_familia(mytabley)
            Tmp = "" & mytabley.Fields("familia")
            borrar_archivo archivo_orden
            found = proceso_formatoso(mytabley, archivo_formato, archivo_orden, "{", "}")

        End If

        found = proceso_formatoso(mytabley, archivo_formato, archivo_orden, "/", "\")
        mytabley.MoveNext
    Loop
    found = imprime_archivo_ordenc(mytabley, xprinter)
    mytabley.Close

End Sub

Sub orden13012015(xlocal As String, _
                  xtipo As String, _
                  xserie As String, _
                  xnumero As String)  'no comandas

    Dim found           As Integer

    Dim archivo_formato As String

    Dim archivo_orden   As String

    Dim mytablex        As New ADODB.Recordset

    Dim mytabley        As New ADODB.Recordset

    Dim Tmp             As String

    Dim sw              As Integer

    Dim xprinter        As String

    On Error GoTo cmd43234_err

    sw = 0
    Tmp = ""
    'MsgBox "ABC"
    'borrar_todo
    'sql_detalle9
    'MsgBox xlocal & " " & xtipo & " " & xserie & " " & xnumero
    archivo_formato = globaldir & "\formatos\despacho"
    mytabley.Open "SELECT * FROM " & gocabeza & " where local='" & "" & xlocal & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "'", cn, adOpenKeyset, adLockOptimistic

    If mytabley.RecordCount > 0 Then
        If "" & mytabley.Fields("servicio") = "A" Then
            archivo_formato = globaldir & "\formatos\llevar"

        End If

        If "" & mytabley.Fields("servicio") = "D" Then
            archivo_formato = globaldir & "\formatos\deliveri"

        End If

    End If

    mytabley.Close

    archivo_orden = globaldir & "\temporal\_" & gusuario & ".txt"
    borrar_archivo archivo_orden
    mytabley.Open "SELECT * FROM " & godetalle & " where local='" & "" & xlocal & "' and tipo='" & xtipo & "' and serie='" & xserie & "' and numero='" & xnumero & "' order by familia", cn, adOpenKeyset, adLockOptimistic
    'MsgBox mytabley.RecordCount
    'MsgBox godetalle
    xprinter = ""
    Tmp = ""
    Do

        If mytabley.EOF Then Exit Do
        If "" & mytabley.Fields("dua") = "R" Then GoTo kkordenx

        'MsgBox "" & mytabley.Fields("descripcio")
        If sw = 0 Then
            'MsgBox "1"
            found = proceso_formatoso(mytabley, archivo_formato, archivo_orden, "{", "}")
            'MsgBox "2"
      
            Tmp = "" & mytabley.Fields("familia")
            ' MsgBox "abcd"
   
            xprinter = busca_printer_familia(mytabley)
            sw = 1

        End If

        'MsgBox "abcd"
   
        If Tmp <> "" & mytabley.Fields("familia") Then
            found = imprime_archivo_ordenc(mytabley, xprinter)
            xprinter = busca_printer_familia(mytabley)
            Tmp = "" & mytabley.Fields("familia")
            borrar_archivo archivo_orden
            found = proceso_formatoso(mytabley, archivo_formato, archivo_orden, "{", "}")

        End If
   
        found = proceso_formatoso(mytabley, archivo_formato, archivo_orden, "/", "\")
kkordenx:
        mytabley.MoveNext
    Loop
    found = imprime_archivo_ordenc(mytabley, xprinter)
    mytabley.Close
    Exit Sub
cmd43234_err:
    MsgBox "Aviso en orden13012015 " + error$, 48, "Aviso"
    Exit Sub

    'borrar_archivo archivo_orden
End Sub

Function busca_printer_familia(mytablex As ADODB.Recordset) As String

    Dim mytabley As New ADODB.Recordset

    mytabley.Open "SELECT * FROM familia where familia='" & Trim("" & mytablex.Fields("familia")) & "'", cn, adOpenKeyset, adLockOptimistic

    If mytabley.RecordCount > 0 Then
        busca_printer_familia = Trim("" & mytabley.Fields("red"))

    End If

    mytabley.Close

End Function

Function imprime_archivo_ordenc(mytablex As ADODB.Recordset, xbuf1 As String)

    Dim sFile As String

    Dim found As Integer

    Dim oldprinter

    Dim mytabley As New ADODB.Recordset

    sFile = globaldir & "\temporal\_" & gusuario & ".txt"
    oldprinter = Printer.DeviceName
    selecciona_impresoras (Trim(xbuf1))
    found = Imprime_archivojj(sFile, 0, "" & mytable11.Fields("tamanorden"), "" & mytable11.Fields("nombrefont"), "" & mytable11.Fields("BOLD"), "" & mytable11.Fields("letrainterna"))

End Function

Function selecciona_mesa()
    salon.Caption = ""
    mesa.Caption = ""

End Function

Function graba_sistema_comanda()

    Dim found    As Integer

    Dim xcomanda As String

    xcomanda = busca_nroc()
    comanda = xcomanda

    If Len(Trim(salon.Caption)) = 0 Then
        MsgBox "No ha seleccionado Salon", 24, "Aviso"
        Exit Function

    End If

    If Len(Trim(mesa.Caption)) = 0 Then
        MsgBox "No ha seleccionado Mesa", 24, "Aviso"
        Exit Function

    End If

    If Len(Trim(mesero)) = 0 Then
        MsgBox "No ha seleccionado Mesero", 24, "Aviso"
        Exit Function

    End If

    If Len(Trim(comanda)) = 0 Then
        MsgBox "No ha seleccionado comanda", 24, "Aviso"
        Exit Function

    End If
                        
    found = grabar_comanda()

    If found = 0 Then
        MsgBox "No existen datos ", 48, "Aviso"
        Exit Function

    End If

    ordencomanda17022015
    flag_comanda = 1

End Function

Function busca_nroc() As String

    Dim sdx      As Double

    Dim mytablex As Table

    Dim xcomanda As String

    sdx = Val("" & mytable11.Fields("comandanro")) + 1
    xcomanda = "" & sdx
    'mytable11.Edit
    mytable11.Fields("comandanro") = xcomanda
    mytable11.Update
    busca_nroc = xcomanda

End Function

Function grabar_comanda()

    On Error GoTo cmd788_err

    Dim buf       As String

    Dim sdx       As Double

    Dim mytablezx As New ADODB.Recordset

    Dim mytablex  As New ADODB.Recordset

    Dim i         As Integer

    Dim sw        As Integer

    sdx = 0
    'sum2 = 0
    sw = 0

    '-----------
    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT * FROM dcomanda where caja='" & Trim(comanda) & "'", cn, adOpenDynamic, adLockOptimistic
    '  ------- grabar chicas --------
    Data2.refresh
    'MsgBox  Data2.Recordset.Fields.count - 1
    Do

        If Data2.Recordset.EOF Then Exit Do
        If Len("" & Data2.Recordset.Fields("producto")) > 0 And (Val("" & Data2.Recordset.Fields("cantidad")) > 0 Or Val("" & Data2.Recordset.Fields("cantidad")) < 0) Then
            mytablex.AddNew

            For i = 0 To Data2.Recordset.Fields.count - 1
                mytablex.Fields(i) = Data2.Recordset.Fields(i)
            Next i
                 
            'MsgBox glocal & " " & gusuario
            mytablex.Fields("local") = Trim(glocal)
            mytablex.Fields("usuario") = Trim(gusuario)
            mytablex.Fields("caja") = Trim(caja)
            mytablex.Fields("turno") = Trim(turno)
            mytablex.Fields("vendedor") = Trim(mesero)
                 
            mytablex.Fields("salon") = Trim(salon.Caption)
            mytablex.Fields("mesa") = Trim(mesa.Caption)
            mytablex.Fields("comanda") = Trim(comanda)
            mytablex.Fields("numero") = Trim(comanda)
            mytablex.Fields("estado") = "0"
            mytablex.Fields("servicio") = "C"
            mytablex.Fields("fecha") = Format(Now, "dd/mm/yyyy")
            mytablex.Fields("Hora") = Format(Now, "hh:mm:ss")
                 
            'MsgBox "b"
            mytablex.Update
            sw = 1

        End If

        '------------- verficamos el combo
        'If verifica_combo("" &  Data2.Recordset.Fields("producto")) = 1 Then
        'If mytablezx.State = 1 Then mytablezx.Close
        '    mytablezx.Open "SELECT * FROM _c" & gusuario & " where producto='" &  Data2.Recordset.Fields("producto") & "'", cn, adOpenDynamic, adLockOptimistic
        '    If mytablezx.RecordCount > 0 Then
        '      Do
        '      If mytablezx.EOF Then Exit Do
        '      mytablex.AddNew
        '      For i = 0 To  Data2.Recordset.Fields.count - 1
        '      mytablex.Fields(i) =  Data2.Recordset.Fields(i)
        '      Next i
        '
        '      mytablex.Fields("sentido") = ""
        '      mytablex.Fields("local") = Trim("" & mytable11.Fields("local"))
        '      mytablex.Fields("tipo") = ""
        '      mytablex.Fields("serie") = ""
        '      mytablex.Fields("numero") = ""
        '      mytablex.Fields("vendedor") = ""
        '      mytablex.Fields("tipoclie") = "C"
        '      mytablex.Fields("moneda") = Trim("" & mytable11.Fields("moneda"))
        '      mytablex.Fields("bodega") = Trim("" & mytable11.Fields("bodega"))
        '      mytablex.Fields("bodegaf") = ""
        '      mytablex.Fields("acu") = ""
        '      mytablex.Fields("localf") = Trim("" & mytable11.Fields("local"))  '& codigo  'si no es traslado
        
        '      mytablex.Fields("flage") = ""
        '      mytablex.Fields("codigo") = ""
        '      mytablex.Fields("caja") = "" &  caja
        '      mytablex.Fields("turno") = "" &  turno
        '      mytablex.Fields("usuario") = "" &  cajero
        '      mytablex.Fields("fecha") = Format(dia, "dd/mm/yyyy")
        '      mytablex.Fields("hora") = Format(Now, "hh:MM")
        '      mytablex.Fields("fechacrea") = Format(Now, "dd/mm/yyyy")
        '      mytablex.Fields("estado") = "2"
    
        '      mytablex.Fields("producto") = "" & mytablezx.Fields("productop")
        '      mytablex.Fields("descripcio") = "" & mytablezx.Fields("descripciop")
        '      mytablex.Fields("unidad") = "UND" '& mytablezx.Fields("unidad")
        '      mytablex.Fields("cantidad") = Val("" &  Data2.Recordset.Fields("cantidad")) * Val("" & mytablezx.Fields("cantidad")) * 1 ' Val("" & mytablezx.Fields("factor"))
        '      mytablex.Fields("dua") = "C"  'C ES COMBO flag que dice que es receta
        '      mytablex.Fields("acu") = "T"  'guia de salida
        '      mytablex.Fields("precio") = 0
        '      mytablex.Fields("total") = 0
        '      mytablex.Fields("subtotal") = 0
        '      mytablex.Fields("impuesto") = 0
        '             mytablex.Fields("local") = Trim(glocal)
        '             mytablex.Fields("usuario") = Trim(gusuario)
        '             mytablex.Fields("caja") = Trim( caja)
        '             mytablex.Fields("turno") = Trim( turno)
        '             mytablex.Fields("vendedor") = Trim(mesero)
        '             mytablex.Fields("salon") = Trim(salon)
        '             mytablex.Fields("mesa") = Trim(mesa)
        '             mytablex.Fields("comanda") = Trim(comanda)
        '             mytablex.Fields("numero") = Trim(comanda)
        '      mytablex.Update
        '    mytablezx.MoveNext
        '    Loop
        '    End If
        '    mytablezx.Close
        'End If
        '------------- finalizamos el combo
        Data2.Recordset.MoveNext
    Loop
    mytablex.Close

    'MsgBox "abc"
    If sw = 1 Then 'si se ha gravado bien graba en mesa salon la fecha y hora
        mytablex.Open "SELECT * FROM mesa where salon='" & Trim(salon.Caption) & "' and mesa='" & Trim(mesa.Caption) & "'", cn, adOpenDynamic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            mytablex.Fields("fecha") = Format(Now, "dd/mm/yyyy")
            mytablex.Fields("Hora") = Format(Now, "hh:mm:ss")
            mytablex.Update

        End If

        mytablex.Close

    End If

    grabar_comanda = sw
    Exit Function
cmd788_err:
    MsgBox "Aviso en tcomanda " + error$ + " " & i, 48, "Aviso"
    Exit Function

End Function

'----- LEONARDO CODIGO PARA BUSQUEDA DE RUC POR CLIENTE ----------
Private Sub GetRGB(ByVal Col As String)

    On Error Resume Next

    Bblue = Col \ (256 ^ 2)
    Ggreen = (Col - Bblue * 256 ^ 2) \ 256
    Rred = (Col - Bblue * 256 ^ 2 - Ggreen * 256)

End Sub

''27/10/2017 Actualizacion Consulta Ruc
Sub BUSCARRUC()

    Dim hWeb As String

    'Generando el Captcha desde la pagina de la Sunat http://www.sunat.gob.pe/cl-ti-itmrconsruc/captcha?accion=image
    'Jalando Datos de la Pagina http://www.sunat.gob.pe/cl-ti-itmrconsruc/jcrS00Alias?accion=consPorRuc&nroRuc=?&search1=?&codigo=NTPY&tipdoc=1
    If CboDocumento.ListIndex = 0 Then
        If Len(codigo.Text) <> 11 Then MsgBox "Por favor ingrese RUC de 11 Digitos", vbExclamation, "Atencion": codigo.SetFocus: Exit Sub
        'hWeb = "http://www.sunat.gob.pe/cl-ti-itmrconsruc/jcrS00Alias?accion=consPorRuc&nroRuc="
        'hWeb = "http://e-consultaruc.sunat.gob.pe/cl-ti-itmrconsruc/jcrS00Alias?accion=consPorRuc&nroRuc="
        hWeb = "http://e-consultaruc.sunat.gob.pe/cl-ti-itmrconsruc/jcrS00Alias?accion=consPorRuc&nroRuc="
    Else

        If Len(codigo.Text) <> 8 Then MsgBox "Por favor ingrese DNI de 8 Digitos", vbExclamation, "Atencion": codigo.SetFocus: Exit Sub
        hWeb = "http://www.sunat.gob.pe/cl-ti-itmrconsruc/jcrS00Alias?accion=consPorTipdoc&nrodoc="

    End If

    Call Limpiar
    Call DescargaCaptcha
  
    If ConvertirImagenTexto = True Then
        If Len(Trim(TxtCaptcha.Text)) = 0 Then
            btnCon = True
        Else
            Call Descargar(hWeb & codigo.Text & "&codigo=" & TxtCaptcha.Text & "&tipdoc=1")

            If OTROsunat(codigo.Text) = False Then
                btnCon = True

            End If

        End If

    End If

End Sub

''27/10/2017 Actualizacion Consulta Ruc

Function DescargaCaptcha()
  
    On Error Resume Next

    ''27/10/2017 Actualizacion Consulta Ruc
    'Call Descargar("http://www.sunat.gob.pe/cl-ti-itmrconsruc/captcha?accion=image")
    Call Descargar("http://e-consultaruc.sunat.gob.pe/cl-ti-itmrconsruc/captcha?accion=image")
    ''27/10/2017 Actualizacion Consulta Ruc

    PicCaptcha.Picture = LoadPicture(GetDirTemp & "\sunat.tmp")

End Function

Function ConvertirImagenTexto() As Boolean

    On Error Resume Next

    Dim ShellPath As String

    Dim Texto     As String

    Dim X         As Integer, Y As Integer
    
    TxtCaptcha.Text = ""

    '    If chkCambiarResolucion.Value = 1 Then    ' Si deseamos convertir la imagen
    For Y = 0 To PicCaptcha.ScaleHeight - 1
        For X = 0 To PicCaptcha.ScaleWidth - 1
            Pixel = GetPixel(PicCaptcha.hDC, X, Y)
            GetRGB Pixel
            Rred = 250 - Rred
            Ggreen = 250 - Ggreen
            Bblue = 250 - Bblue
            SetPixelV PicCaptcha.hDC, X, Y, RGB(Rred, Ggreen, Bblue)
        Next
        PicCaptcha.refresh
    Next
    PicCaptcha.refresh
    '    End If
    Call SavePicture(PicCaptcha.Image, GetDirTemp & "\sunat.tmp")   'Guardando la Imagen para convertir a Texto
    ShellPath = GetShortDir(App.path) & "\modulo.dll " & GetDirTemp & "\sunat.tmp " & GetDirTemp & "\output" & " -psm"

    If ShellAndWait(ShellPath, vbMinimizedNoFocus) = True Then  ' Esperando a que el OCR Convierta el Texto
        Open GetDirTemp & "\output.txt" For Input As #1   'Mostrando el texto Convertido

        While Not EOF(1)

            Line Input #1, Texto
            TxtCaptcha.Text = UCase(Replace(Texto, Chr(13), ""))
        Wend
        Close #1
        Kill GetDirTemp & "\output.txt"   'Borrando el texto generado
        ConvertirImagenTexto = True
    Else
        '        MsgBox "La imagen no se pudo Convertir a Texto"
        ConvertirImagenTexto = False

    End If

End Function

Function OpenTxt() As String

    On Error Resume Next

    'Open "d:\sunat.txt" For Input As #1
    Open GetDirTemp & "\sunat.tmp" For Input As #1

    Dim linea As String, total As String

    Do Until EOF(1)
        Line Input #1, linea
        total = total + linea + vbcrlf
    Loop
    Close #1
    OpenTxt = total

    If Len(Dir(GetDirTemp & "\sunat.tmp")) Then
        Kill GetDirTemp & "\sunat.tmp"

    End If

End Function

Function OTROsunat(ByVal xnum As String) As Boolean

    'On Error Resume Next
    On Error GoTo EsteErr

    Dim tmpVal         As String

    Dim xTabla()       As String

    Dim PosisionScript As Integer, PosisionScript1 As Integer

    Dim RecRow         As Long

    Call Limpiar
    xDat = OpenTxt 'xWml.responseText
    xDat = Replace(xDat, vbcrlf, "")
    xDat = Replace(xDat, Chr(34), "'")
    xDat = Replace(xDat, "</td>", "")

    If CboDocumento.ListIndex = 0 Then
        If InStr(xDat, "La aplicaci&oacute;n ha retornado el siguiente problema") > 0 Then OTROsunat = True: MsgBox "A ocurrido un error" & vbcrlf & "- Verifique su conexion a Internet" & vbcrlf & "- Pagina de sunat en Mantenimiento", vbCritical, "Error": Exit Function
        If InStr(xDat, "consultado no es válido") > 0 Then MsgBox "El número de RUC " & codigo.Text & " consultado no es válido. Debe verificar el número y volver a ingresar.", vbCritical, "Error":  OTROsunat = True: Exit Function
        If InStr(xDat, "El codigo ingresado es incorrecto") > 0 Then MsgBox "El número de RUC " & codigo.Text & " consultado no es válido. Debe verificar el número y volver a ingresar.", vbCritical, "Error": codigo.SetFocus: OTROsunat = True: Exit Function
    Else

        If InStr(xDat, "El Sistema RUC NO REGISTRA") > 0 Then MsgBox "El Sistema RUC NO REGISTRA un número de RUC para el DNI número " & codigo.Text & " consultado.", vbCritical, "Error": codigo.SetFocus: OTROsunat = True: Exit Function
        PosisionScript = InStr(xDat, "<a href='javascript:sendNroRuc(")

        If PosisionScript > 0 Then CboDocumento.ListIndex = 0: codigo.Text = Mid$(xDat, PosisionScript + 31, 11): OTROsunat = True: btnCon = True: Exit Function Else MsgBox "El número de DNI " & codigo.Text & " consultado no tiene nigun RUC asociado", vbCritical, "Error": codigo.SetFocus: OTROsunat = True: Exit Function

    End If
        
    'Call Habilitar(True)
        
    PosisionScript = InStr(xDat, "width='100%' class='form-table'>")

    If PosisionScript > 0 Then xDat = Mid(xDat, PosisionScript + Len("width='100%' class='form-table'>"))
    PosisionScript = InStr(xDat, "<!--")

    If PosisionScript > 0 Then xDat = Mid(xDat, 1, PosisionScript - Len("<!--"))

    xTabla = Split(xDat, "<tr>")
        
    For RecRow = 0 To UBound(xTabla)
        '          List1.AddItem Replace(Trim(xTabla(RecRow)), "</tr>", "")
        xTabla(RecRow) = Replace$(xTabla(RecRow), "</tr>", "")
          
        If InStr(xTabla(RecRow), "N&uacute;mero de RUC:") > 0 Then  'Razon Social
            If InStr(xTabla(RecRow), codigo.Text) > 0 Then
                PosisionScript = InStr(xTabla(RecRow), codigo.Text)
                xRazSoc = Trim(Replace(Mid(xTabla(RecRow), PosisionScript), codigo.Text & " - ", ""))

            End If

        End If

        If InStr(xTabla(RecRow), "Estado del Contribuyente:") > 0 Then  'Estado del Contribuyente:
            If InStr(xTabla(RecRow), "<td class='bg' colspan=1>") > 0 Then
                PosisionScript = InStr(xTabla(RecRow), "<td class='bg' colspan=1>") + Len("<td class='bg' colspan=1>")
                xTabla(RecRow) = Trim(Mid(xTabla(RecRow), PosisionScript))
                PosisionScript = InStr(xTabla(RecRow), "<td class='bgn'") - 1
                xEst = Trim(Mid(xTabla(RecRow), 1, PosisionScript))

            End If

        End If

        If InStr(xTabla(RecRow), "index.html") > 0 Then  'Condicion del Contribuyente:
            If InStr(xTabla(RecRow), "' >") > 0 Then
                PosisionScript = InStr(xTabla(RecRow), "' >") + Len("' >")
                xCon = Trim(Replace(Mid(xTabla(RecRow), PosisionScript), "</a>", ""))

            End If

        Else

            If InStr(xTabla(RecRow), "Condici&oacute;n del Contribuyente:") > 0 Then  'Condicion del Contribuyente:
                If InStr(xTabla(RecRow), "<td class='bg' colspan=3>") > 0 Then
                    PosisionScript = InStr(xTabla(RecRow), "<td class='bg' colspan=3>") + Len("<td class='bg' colspan=3>")
                    xTabla(RecRow) = Trim(Mid(xTabla(RecRow), PosisionScript))
                    xCon = xTabla(RecRow)

                End If

            End If

        End If

        If InStr(xTabla(RecRow), "Direcci&oacute;n del Domicilio Fiscal:") > 0 Then  'Direccion del Contribuyente:
            If InStr(xTabla(RecRow), "<td class='bg' colspan=3>") > 0 Then
                PosisionScript = InStr(xTabla(RecRow), "<td class='bg' colspan=3>") + Len("<td class='bg' colspan=3>")
                xTabla(RecRow) = Trim(Mid(xTabla(RecRow), PosisionScript))
                xdir = Trim(Replace(xTabla(RecRow), "</", ""))

            End If

        End If
          
    Next

    'txtRazSoc.Text = xRazSoc
    'txtEst.Text = xEst
    'txtCon.Text = xCon
    'txtDir.Text = xDir
        
    'LEONARDO 28-10-20126 --------------------------
    nombre.Text = Left(Trim(xRazSoc), 80)
    ydireccion.Text = Left(Trim(Replace(xdir, "                         ", " ")), 200)
    '---------------De LA COBRANZA----------
    xnombre.Text = Left(Trim(xRazSoc), 80)
    xdireccion.Text = Left(Trim(Replace(xdir, "                         ", " ")), 200)
        
    If Trim$(xRazSoc) = "" Then OTROsunat = False Else OTROsunat = True
        
    'tptovta.clasesunat.Text = xCon 'HABIDO O NO HABIDO EN LA SUNAT
    '-----------------------------------
    Exit Function
EsteErr:
    OTROsunat = False

End Function

Private Sub Limpiar()
    xRazSoc = ""
    xEst = ""
    xCon = ""
    xdir = ""
    nombre.Text = "": xnombre.Text = ""
    ydireccion.Text = "": xdireccion.Text = ""

    'txtRazSoc.Text = ""
    'txtEst.Text = ""
    'txtCon.Text = ""
    'txtDir.Text = ""
End Sub

'fin 21/04/2017 pll
'inicio 21/04/2017 pll
Sub proceso_cobro_tipo5()

    Dim found As Integer

    local1 = ""

    found = sumar_detalle()

    If found = 0 Then
        MsgBox "debe de Existir un Precio=0", 48, "Aviso"
        Exit Sub

    End If

    If Val(txtotal) = 0 Then
        If exisdev <> -10 Then  'si existe devolucion
            If Val(ntcant) = 0 Then
                Exit Sub

            End If
      
        End If

    End If

    If Val(txtotal) = 0 Then
        If exisdev <> -10 Then  'si existe devolucion
      
            DBGrid2.SetFocus
            Exit Sub

        End If

        Exit Sub

    End If

    If mytable11.Fields("terminal") = "T" Or (ot = "S" And Len(petipo) = 0) Then 'pedidos o a cuenta ha dado
        habilita_lab7 1

        If ot = "S" Then
            xtipo = "" & mytable11.Fields("tipope")

        End If

        If flag_servicio <> "A" And flag_servicio <> "C" And flag_servicio <> "D" Then
            xtipo = "5"

        End If

        xtipo.SetFocus
        Exit Sub

    End If

    If flag_servicio = "A" Then  'venta rapida

    End If

    If flag_servicio = "D" Then  'validar el deliveri si ingreso datos

    End If

    If flag_servicio = "C" Then  'venta mesas

    End If

    found = proceso_cobros()

    habilita_lab7 0

    carga_tiposdoc "%"

End Sub

'fin 21/04/2017 pll

'' 10/07/2018 Edicion Comanda
Function busca_TipoComanda()

    Dim mytablex As New ADODB.Recordset

    mytablex.Open "SELECT comanda FROM parame where  codigo='01'", cn, adOpenKeyset, adLockOptimistic

    If mytablex.RecordCount > 0 Then  'si existe
        If mytablex.Fields("comanda") = "CO" Or mytablex.Fields("comanda") = "DC" Then
            busca_TipoComanda = "" & mytablex.Fields("comanda")
        Else
            busca_TipoComanda = "DL"

        End If
      
    End If

    mytablex.Close

End Function

'' 10/07/2018 Edicion Comanda

'''' 17/07/2018 Factura de Exportación
Sub inicia_TipoOperacion()

    Dim cad      As String

    Dim mytablex As New ADODB.Recordset

    CboTipoOperacion.Clear
    cad = "SELECT * FROM tbltipooperacion    order by orden"

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open cad, cn, adOpenStatic, adLockOptimistic
    Do

        If mytablex.EOF Then Exit Do
        CboTipoOperacion.AddItem "" & mytablex.Fields("tipooperacion") & "|" & mytablex.Fields("descripcio")
        mytablex.MoveNext
    Loop
    CboTipoOperacion.ListIndex = 0
    mytablex.Close

End Sub

Sub inicia_TipoIgv()

    Dim cad      As String

    Dim mytablex As New ADODB.Recordset

    CboTipoIgv.Clear
    cad = "SELECT * FROM tbltipoigv   order by orden"

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open cad, cn, adOpenStatic, adLockOptimistic
    Do

        If mytablex.EOF Then Exit Do
        CboTipoIgv.AddItem "" & mytablex.Fields("tipoigv") & "|" & mytablex.Fields("descripcio")
        mytablex.MoveNext
    Loop
    CboTipoIgv.ListIndex = 0
    mytablex.Close

End Sub

'''' 17/07/2018 Factura de Exportación
'''' 25/07/2018 Delivery y Para Llevar desde mozo

' Mesas Nombre 21/05/2018
Function busca_clienteDeliveryXmesa(buf As String, buf1 As String)

    Dim mytabley As New ADODB.Recordset

    mytabley.Open "SELECT  codigo FROM mesa  where salon='" & buf & "' and mesa='" & buf1 & "'", cn, adOpenKeyset, adLockOptimistic

    If mytabley.RecordCount > 0 Then
        busca_clienteDeliveryXmesa = "" & Trim$("" & mytabley.Fields("codigo"))

    End If

    mytabley.Close

End Function

' Mesas Nombre 21/05/2018
'''' 25/07/2018 Delivery y Para Llevar desde mozo

'13/08/2018 Integración FE - Pizzeria
'13/08/2018 Integración FE - Pizzeria

''' 11/12/2017 SubReceta
'Verifica si stock de producto se descarga del inventario
Function verifica_descargaproducto(buf As String)

    Dim mytablex As New ADODB.Recordset

    If mytablex.State = 1 Then mytablex.Close
    mytablex.Open "SELECT seccion FROM producto where seccion='INSUMO' and producto='" & buf & "'", cn, adOpenDynamic, adLockOptimistic

    If mytablex.RecordCount > 0 Then 'si existe
        verifica_descargaproducto = 1

    End If

    mytablex.Close

End Function

''' 11/12/2017 SubReceta
''' 16/07/2018 Clave en forma de pago
Function busca_ConfigFPago(buf As String)

    Dim mytabley As New ADODB.Recordset

    mytabley.Open "SELECT  dias FROM fpago  where fpago='" & buf & "'", cn, adOpenKeyset, adLockOptimistic

    If mytabley.RecordCount > 0 Then
        busca_ConfigFPago = "" & Trim$("" & mytabley.Fields("dias"))

        If busca_ConfigFPago = "1" Then
            busca_ConfigFPago = True
        Else
            busca_ConfigFPago = False

        End If
   
    End If

    mytabley.Close

End Function

''' 16/07/2018 Clave en forma de pago

'13/08/2018 Integración FE - Pizzeria
'13/08/2018 Integración FE - Pizzeria
'24/08/2018  Delivery por mesa
Function extrae_datos_codnombre(tipo As Integer, salon As String, mesa As String)

    Dim mytablex As New ADODB.Recordset

    If Len(salon) > 0 And Len(mesa) > 0 Then
        mytablex.Open "select * from mesa where salon='" & salon & "' and mesa='" & mesa & "'", cn, adOpenStatic, adLockOptimistic

        If mytablex.RecordCount > 0 Then
            If tipo = 1 Then
                extrae_datos_codnombre = Trim("" & mytablex.Fields("codigo"))
            ElseIf tipo = 2 Then
                extrae_datos_codnombre = Trim("" & mytablex.Fields("dnombre"))

            End If
      
        End If

        mytablex.Close

    End If

End Function

'24/08/2018  Delivery por mesa

